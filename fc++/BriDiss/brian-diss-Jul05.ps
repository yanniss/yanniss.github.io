%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: brian-dissertation.dvi
%%Pages: 178
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -f brian-dissertation.dvi
%DVIPSParameters: dpi=600, compressed, comments removed
%DVIPSSource:  TeX output 2004.07.06:0311
%%BeginProcSet: texc.pro
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (brian-dissertation.dvi)
@start
%DVIPSBitmapFont: Fa cmtt10 10 15
/Fa 15 118 df<1507ED1F80153F15FF14034A1300EC1FFC4A5AECFFE0491380010790C7
FCEB0FFCEB3FF8EB7FE048485A4890C8FCEA0FFEEA1FF8EA7FF0EAFFC05BA27FEA7FF0EA
1FF8EA0FFEEA03FF6C13C06C6C7EEB3FF8EB0FFC6DB4FC01017F6D13E0EC3FF86E7EEC07
FF6E13801400153F151FED0700212A7BAD2C>60 D<127012FC7E6C7E13E06C7EEA1FFC6C
7E3803FF80C67FEB7FF0EB1FF8EB0FFEEB03FF6D13C06D6C7EEC3FF8EC0FFC6EB4FC0201
138080A25C02071300EC0FFCEC3FF8EC7FE049485A4990C7FCEB0FFEEB1FF8EB7FF0EBFF
C000035BD80FFEC8FC485AEA7FF0485A138048C9FC5A1270212A7BAD2C>62
D<3801FFF0000713FE001F6D7E15E048809038C01FF81407EC01FC381F80000006C77EC8
127EA3ECFFFE131F90B5FC1203120F48EB807E383FF800EA7FC090C7FC12FE5AA47E007F
14FEEB8003383FE01F6CB612FC6C15FE6C14BF0001EBFE1F3A003FF007FC27247CA32C>
97 D<903803FFE0011F13F8017F13FE48B5FC48804848C6FCEA0FF0485A49137E484813
1890C9FC5A127EA25AA8127EA2127F6C140F6DEB1F806C7E6D133F6C6CEB7F003907FE03
FF6CB55A6C5C6C6C5B011F13E0010390C7FC21247AA32C>99 D<EC0FF8EC3FFE91B5FC49
14805B903807FC7F14F090390FE03F0014C092C7FCA6007FB512FEB7FCA36C5C26000FC0
C7FCB3A8003FB512F04880A36C5C21337DB22C>102 D<ED03F8903907F80FFC90391FFE
3FFE017FB6FC48B7FC48ECFE7F9038FC0FF82607F003133E3A0FE001FC1CD9C000130000
1F8049137EA66D13FE000F5CEBE0016C6C485A3903FC0FF048B5FC5D481480D99FFEC7FC
EB87F80180C8FCA37F6C7E90B512F06C14FE48ECFF804815E04815F03A3FC0001FF848C7
EA03FC007E1400007C157C00FC157E48153EA46C157E007E15FCD87F801303D83FE0EB0F
F8D81FFCEB7FF06CB612E0000315806C1500D8003F13F8010713C028387EA42C>I<EA7F
F0487EA3127F1201AAEC1FE0EC7FFC9038F9FFFE01FB7F90B6FC9138F03F80ECC01F0280
7FEC000F5B5BA25BB3267FFFE0B5FCB500F11480A36C01E0140029337FB22C>I<1307EB
1FC0A2497EA36D5AA20107C7FC90C8FCA7387FFFC080B5FC7EA2EA0007B3A8007FB512FC
B612FEA36C14FC1F3479B32C>I<387FFFE0B57EA37EEA0003B3B3A5007FB61280B712C0
A36C158022337BB22C>108 D<3A7F83F007E09039CFFC1FF83AFFDFFE3FFCD87FFF13FF
91B57E3A07FE1FFC3E01FCEBF83F496C487E01F013E001E013C0A301C01380B33B7FFC3F
F87FF0027F13FFD8FFFE6D13F8D87FFC4913F0023F137F2D2481A32C>I<397FF01FE039
FFF87FFC9038F9FFFE01FB7F6CB6FC00019038F03F80ECC01F02807FEC000F5B5BA25BB3
267FFFE0B5FCB500F11480A36C01E0140029247FA32C>I<EB07FCEB1FFF017F13C048B5
12F048803907FC07FC390FF001FE48486C7E0180133F003F158090C7121F007EEC0FC0A3
48EC07E0A76C140F007E15C0A2007F141F6C15806D133F6C6CEB7F006D5B6C6C485A3907
FC07FC6CB55A6C5C6C6C13C0011F90C7FCEB07FC23247CA32C>I<D87FFEEB3FC0B53801
FFF0020713F8021F13FC6C5B39003F7FE1ECFF019138FC00F84A13704A13005CA25C5CA3
91C8FCAF007FB512E0B67EA36C5C26247EA32C>114 D<131E133FA9007FB6FCB71280A3
6C1500D8003FC8FCB1ED03C0ED07E0A5EC800F011FEB1FC0ECE07F6DB51280160001035B
6D13F89038003FE0232E7EAD2C>116 D<3A7FF003FF80486C487FA3007F7F0001EB000F
B3A3151FA2153F6D137F3900FE03FF90B7FC6D15807F6D13CF902603FE07130029247FA3
2C>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmmi10 10.95 1
/Fb 1 111 df<01F8EB0FF0D803FEEB3FFC3A078F80F03E3A0F0F83C01F3B0E07C7800F
80001CEBCF0002FE80003C5B00385B495A127800705BA200F049131F011F5D00005BA216
3F013F92C7FC91C7FC5E167E5B017E14FE5EA201FE0101EB03804914F8A2030313070001
03F013005B170E16E000035E49153C17385F0007913801F1E0496DB45AD801C0023FC7FC
31297EA737>110 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmti9 9 11
/Fc 11 122 df<EB03F0EB0FF890383E1C6090387C0FF0EBF807EA01F0EA03E00007EB03
E0EA0FC0A2381F800715C0EA3F00A2140F481480127EA2141F00FE14005A1506EC3F07EC
3E0F150E147E007C141EECFE1CEB01FCD83C03133C393E07BE38391F0E1E783907FC0FF0
3901F003C0202278A027>97 D<137EEA0FFE121F5B1200A35BA21201A25BA21203A25BA2
1207A2EBC3E0EBCFF8380FDC3EEBF81F497E01E01380EA1FC0138015C013005AA2123EA2
007E131F1580127CA2143F00FC14005AA2147EA25CA2387801F85C495A6C485A495A6C48
C7FCEA0FFCEA03F01A3578B323>I<EB03F8EB0FFEEB3E0F9038F807803801F003EA03E0
EA07C0120FEA1F801407D83F0013005C007E133EEB03F8387FFFE04848C7FC00FCC8FCA4
5AA4EC0180EC03C0A2007CEB0780EC1F00003C133E6C13F8380F03E03807FF80D801FCC7
FC1A2277A023>101 D<143FECFF80903803E1E6903807C0FF90380F807FEB1F00133E01
7E133F49133EA24848137EA24848137CA215FC12074913F8A21401A2D80FC013F0A21403
120715E01407140F141F3903E03FC00001137FEBF0FF38007FCF90381F0F801300141FA2
1500A25C143E1238007E137E5C00FE5B48485A387803E0387C0F80D81FFFC7FCEA07F820
317CA023>103 D<EB0180EB07E0A2130FEB07C0EB038090C7FCABEA01F0EA03FCEA0F1E
120E121C123C1238EA783E1270A2137EEAF07CEA60FCC65AA212015BA212035BA2000713
C0EBC1E0000F13C01381A21383EB038013071400130E131EEA07F8EA01F013337AB118>
105 D<133FEA07FF5A13FEEA007EA3137CA213FCA213F8A21201A213F0A21203A213E0A2
1207A213C0A2120FA21380A2121FA21300A25AA2123EA2127EA2127C1318EAFC1C133CEA
F838A21378137012F013F0EAF8E01279EA3FC0EA0F00103579B314>108
D<3903C007F0390FF01FFC391E787C1E391C7CF01F393C3DE00F26383FC01380EB7F8000
781300EA707EA2D8F0FC131F00E01500EA60F8120000015C153E5BA20003147E157C4913
FCEDF8180007153C0201133801C013F0A2000F1578EDE070018014F016E0001FECE1C015
E390C7EAFF00000E143E26227AA02B>110 D<011E137C90387F81FF9039F3C387C09039
E3EF03E03901E1FE01D9C1FC13F0EBC3F8000313F0018314F814E0EA07871307000313C0
1200010F130316F01480A2011F130716E01400A249EB0FC0A2013EEB1F80A2017EEB3F00
017F133E5D5D9038FF81F09038FDC3E09038F8FF80027EC7FC000190C8FCA25BA21203A2
5BA21207A25BB5FCA325307FA027>112 D<EB03F0EB1FFCEB3C1EEB780FEBF007EA01E0
140F0003131F13C0A2EBE00414007FEBFF8014E06C13F06C13F8EB7FFC1307EB00FE147E
143E123800FC133CA3147C00F013784813F0EAF001387803E0383C0F80381FFE00EA03F8
18227AA01F>115 D<1303EB0F80A3131FA21400A25BA2133EA2137EA2137C387FFFF8A2
B5FC3800F800A21201A25BA21203A25BA21207A25BA2120FA25B1460001F13F014E01300
130114C01303001E1380EB07005BEA0F1EEA07F8EA01E015307AAE19>I<13F0D803FC13
07D80F1E130F000E141F121C123C0038143FD8783E133E1270A2017E137ED8F07C137CEA
60FCC65A15FC000114F85BA21401000314F013E0A2140315E0EA07C0A20003130715C0EB
E00F141F0001133F9038F07F8038007FEFEB1F8FEB001F1500A25C003E133E007E137E14
7C5C007C5BEA7001495A38380780D83C1FC7FCEA0FFCEA07F020317AA025>121
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmtt9 9 38
/Fd 38 122 df<EB01C0EB03E0130F131FEB3FC0EB7F80EBFE00485A5B1203485A5B485A
A2485AA248C7FCA3127EA45AAC127EA47EA36C7EA26C7EA26C7E7F6C7E12017F6C7EEB7F
80EB3FC0EB1FE0130F1303EB01C0133A73B327>40 D<127012F812FE7E6C7E6C7EEA0FE0
6C7E12037F6C7E1200137EA27FA2EB1F80A3EB0FC0A4EB07E0ACEB0FC0A4EB1F80A3EB3F
00A2137EA25B1201485A5B1207485AEA3FC0485A48C7FC5A12F81270133A7AB327>I<EB
03C0497EAD007FB512FEB7FCA46C14FE390007E000AD6D5A20227DA727>43
D<120FEA3FC013E0EA7FF0A213F8A2123FA2120F120113F01203EA07E0121FEA7FC0EAFF
8013005A12700D14738927>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A728927>
46 D<EB07E0EB3FFC497E90B5FC4814803903FC3FC03907F00FE0390FE007F0EBC00339
1F8001F8A248C712FCA2003E147C007E147EA3007C143E00FC143FAC007E147EA46C14FC
A2EB8001001F14F8EBC003000F14F0EBE0073907F00FE03903FC3FC06CB512806C14006D
5A6D5AEB07E020307DAE27>48 D<121EEA7F80A2EAFFC0A4EA7F80A2EA1E00C7FCAC121E
EA7F80A2EAFFC0A4EA7F80A2EA1E000A20729F27>58 D<153815FC14011407140FEC3FF8
EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA0FFC485AEA7FF0EA
FFC05BA27FEA7FF0EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E010013C0EC
7FE0EC3FF8EC0FFC14071401140015381E287CAA27>60 D<127012FC7E6C7E7FEA7FF0EA
1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07FE6D7E010013C0EC7FE0EC3FF8EC0FFC14
07A2140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8495A495A3801FF804890C7FCEA0F
FC485AEA7FF0EAFFC05B48C8FC5A12701E287CAA27>62 D<903803F80E90381FFE1F9038
3FFFBF90B6FC5A3803FE0F3807F803497E48487E485A49137FA248C7123FA25A127E151E
150012FE5AAA7E127EA2151E007F143F7EA26C7E157F6D137E6C6C13FE3907F001FCEBF8
033903FE0FF86CB512F06C14E0013F13C06D1300EB03F820307DAE27>67
D<007FB61280B712C0A37E3907E0000FA6ED078092C7FCA4EC07804A7EA390B5FCA5EBE0
0FA36E5A91C8FCAC387FFF80B57EA36C5B222E7EAD27>70 D<903807F03890381FFC7C90
387FFFFC90B5FC5A3803FC1F3807F00F380FE007EBC003001F13011380123F90C7FCA212
7EA2157892C7FC5AA8EC1FFF4A1380A3007E6D1300EC00FCA36C1301A21380121FEBC003
120FEBE0073807F00F3803FC1F6CB5FC7EEB7FFE90381FFC78D907F0C7FC21307DAE27>
I<387FFFF0B512FE6E7E816C803907E01FF014076E7E1401811400A514015D14034A5A14
1F90B55A5D5DA281EBE01F6E7E14076E7EA816F0EDF1F8A4397FFE01FBB5EBFFF08016E0
6C48EB7FC0C8EA1F00252F7FAD27>82 D<90387FC0E03901FFF1F0000713FF5A5AEA3FE0
EB801F387F000F007E130712FE5A1403A3EC01E06C90C7FC127E127FEA3FC013F86CB47E
6C13F86C13FE6CEBFF80C614C0010F13E0010013F0140FEC07F81403140115FC14001278
12FCA46CEB01F8A26C130390388007F09038F01FE090B5FC15C0150000F85B38701FF81E
307CAE27>I<007FB61280B712C0A439FC03F00FA60078EC0780000091C7FCB3AB90B512
C04880A36C5C222E7EAD27>I<3803FFC0000F13F04813FC4813FF811380EC1FC0381F00
0F000480C71207A2EB0FFF137F0003B5FC120F5A383FFC07EA7FC0130012FE5AA46C130F
007F131FEBC0FF6CB612806C15C07E000313F1C69038807F8022207C9F27>97
D<EA7FE0487EA3127F1203A914FF01F313C090B512F08181EC81FE49C67E49EB3F804913
1F16C049130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FEECFF
FC5D5D01F313C02601E0FEC7FC232E7FAD27>I<EB0FFF017F13C048B512E04814F05A38
0FF807EA1FE0393FC003E0903880008048C8FC127EA212FE5AA67E127EA2007F14F0393F
8001F813C0381FE003390FF80FF06CB5FC6C14E06C14C06C6C1300EB0FF81D207B9F27>
I<EC3FF04A7EA3143F1401A9EB0FE1EB7FFD48B5FC5A5A380FF83F381FE00F383FC007EB
8003EA7F00007E1301A212FE5AA67E007E1303A2127F6C1307EB800F381FE01F380FF03F
6CB612C06C15E06C13FD38007FF9D91FE013C0232E7EAD27>I<EB0FF8EB3FFE90B51280
000314C04814E0390FFC0FF0391FE003F8EBC001D83F8013FC48C7FC127E157E12FEB612
FEA415FC00FCC8FC7E127E127F6C143C6D137E6C7E01F013FE390FFC07FC6CB5FC000114
F86C14F0013F13C0903807FE001F207D9F27>I<EC1FF0ECFFF84913FC4913FE5BEB0FF0
14C0011F137CEC8000A6007FB512F0B612F8A36C14F039001F8000B3A4003FB512C04814
E0A36C14C01F2E7EAD27>I<153F90391FC0FF80D97FF313C048B612E05A4814EF390FF0
7F873A1FC01FC3C0EDC000EB800F48486C7EA66C6C485AEBC01FA2390FF07F8090B5C7FC
5C485BEB7FF0EB1FC090C9FCA27F6CB5FC15E015F84814FE4880EB8001007EC7EA3F8000
7C140F00FC15C0481407A46C140F007C1580007F143F6C6CEB7F009038F807FF6CB55A00
0714F86C5CC614C0D90FFCC7FC23337EA027>I<EA7FE0487EA3127F1203A9147F9038F1
FFC001F713F090B5FC8114C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713F0A36C
018313E0242E7FAD27>I<130F497E497EA46D5A6DC7FC90C8FCA7383FFF80487FA37EEA
000FB3A4007FB512F0B6FC15F815F07E1D2F7BAE27>I<EA7FE07F12FF127FA21201A991
383FFFC04A13E0A36E13C0913803F8004A5A4A5A4A5A4A5A02FFC7FCEBF1FEEBF3FCEBF7
F8EBFFFC8080143F496C7E496C7E01F87FEBF0076E7E6E7E816E7E157E3A7FFFC1FFF002
C313F8B512E36C13C316F0252E80AD27>107 D<387FFF80B57EA37EEA000FB3B2007FB5
12F8B612FCA36C14F81E2E7CAD27>I<397F07C01F3AFF9FF07FC09039FFF9FFE091B57E
7E3A0FFC7FF1F89038F03FC001E0138001C01300A3EB803EB03A7FF0FFC3FF486C01E313
8001F913E701F813E36C4801C313002920819F27>I<387FE07F39FFF1FFC001F713F090
B5FC6C80000313C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0B500C713F0A36C018313E0
24207F9F27>I<EB1FE0EB7FF83801FFFE487F481480390FF03FC0391FC00FE0393F8007
F0EB00034814F8007E1301A248EB00FCA76C1301007E14F8A2007F1303393F8007F0A239
1FE01FE0390FF03FC06CB512806C14006C5B38007FF8EB1FE01E207C9F27>I<387FE0FF
D8FFF313C090B512F0816C800003EB81FE49C67E49EB3F8049131F16C049130FA216E015
07A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FEECFFFC5D5D01F313C0D9F0FE
C7FC91C8FCAC387FFF80B57EA36C5B23317F9F27>I<90380FF03C90383FFE7E90B5FC00
0314FE5A380FFC1F381FE007EBC003383F800148C7FC127EA200FE147E5AA67E007E14FE
A2007F1301EA3F80EBC003381FE007380FF81F6CB5FC7E6C147E38007FFCEB0FF090C7FC
AC91381FFFF8A24A13FC6E13F8A226317E9F27>I<397FFC03FC39FFFE0FFF023F13804A
13C0007F90B5FC39007FFE1F14F89138F00F809138E002004AC7FC5CA291C8FCA2137EAD
007FB57EB67EA36C5C22207E9F27>I<9038FFF3800007EBFFC0121F5A5AEB803F38FC00
0F5AA2EC07806C90C7FCEA7F8013FC383FFFF06C13FC000713FF00011480D8000F13C090
38003FE014070078EB03F000FC1301A27E14036CEB07E0EBE01F90B512C01580150000FB
13FC38707FF01C207B9F27>I<133C137EA8007FB512F0B612F8A36C14F0D8007EC7FCAE
1518157EA415FE6D13FC1483ECFFF86D13F06D13E0010313C0010013001F297EA827>I<
397FE01FF8486C487EA3007F131F00031300B21401A21403EBFC0F6CB612E016F07EEB3F
FE90390FF87FE024207F9F27>I<3A7FFC0FFF80486C4813C0A36C486C13803A07C000F8
00EBE00100035CA2EBF00300015CA2EBF80700005CA390387C0F80A36D48C7FCA3EB3F3F
EB1F3EA214FE6D5AA36D5AA26D5A22207E9F27>I<3A7FFE07FFE000FF15F06D5A497E00
7F15E03A0F80001F00A36D5B0007143EA414F0EBC1F83903E3FC7CA4EBE79EA200011478
A301F713F8A2EBFF0F6C5CA3EBFE0790387C03E024207F9F27>I<3A7FFC0FFF80486C48
13C0A36C486C13803A07E000F800000313015D13F00001130301F85B1200A26D485A137C
A290387E0F80133EA2011F90C7FC5CA2130F149E14BE130714FC1303A25C1301A25CA213
035CA213075C1208EA3E0F007F5B131FD87E7FC8FCEA7FFE6C5A5B6C5AEA07C022317E9F
27>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmr9 9 59
/Fe 59 123 df<91393FE00FE0903A01FFF83FF8903A07E01EF83C903A1F800FF07E903A
3F001FE0FE017E133F4914C0485A1738484890381F8000ACB812C0A33B03F0001F8000B3
A7486C497EB50083B5FCA32F357FB42D>11 D<EC1FE0ECFFFC903803F01E90390FC00780
EB1F8090393F000FC0017E131F5BA2485AED0F8092C7FCA9ED0FC0B7FCA33901F8001F15
0FB3A6486CEB1FE0267FFFC1B5FCA328357FB42B>I<123C127E12FFA8127EAB123E123C
AB1218A61200A7123C127E12FFA4127E123C08367AB515>33 D<003C13F0387E01F838FF
03FCA2EB83FEA2EA7F81383D80F600011306A40003130EEB000CA248131C00061318000E
1338000C1330001C13704813E0387001C00060138017177EB326>I<123C127EB4FCA213
80A2127F123D1201A412031300A25A1206120E120C121C5A5A126009177AB315>39
D<14C01301EB0380EB0F00130E5B133C5B5BA2485A485AA212075B120F90C7FC5AA2121E
123EA3123C127CA55AB0127CA5123C123EA3121E121FA27E7F12077F1203A26C7E6C7EA2
13787F131C7F130FEB0380EB01C01300124A79B71E>I<12C07E1270123C121C7E120F6C
7E6C7EA26C7E6C7EA27F1378137C133C133EA2131E131FA37F1480A5EB07C0B0EB0F80A5
14005BA3131E133EA2133C137C137813F85BA2485A485AA2485A48C7FC120E5A123C1270
5A5A124A7CB71E>I<156015F0B3A4007FB812C0B912E0A26C17C0C800F0C8FCB3A41560
33327CAB3C>43 D<123C127EB4FCA21380A2127F123D1201A412031300A25A1206120E12
0C121C5A5A126009177A8715>I<B512F0A514057F921A>I<123C127E12FFA4127E123C08
087A8715>I<1530157815F8A215F01401A215E01403A215C01407A21580140FA215005C
A2143EA2143C147CA2147814F8A25C1301A25C1303A25C1307A2495AA291C7FC5BA2131E
133EA2133C137CA2137813F8A25B1201A25B1203A2485AA25B120FA290C8FC5AA2121E12
3EA2123C127CA2127812F8A25A12601D4B7CB726>I<EB3FC0EBFFF0000313FC380F80FF
391E007F80001CEB3FC048EB1FE048130F15F00060130712FC6C14F87E1403A3007E1307
123CC7FC15F0A2140F15E0EC1FC0A2EC3F801500147E5C495A5C495A495A495A49C7FC13
3E133C4913185B485A48481330485A48C7FC001C1470001FB512F05A5AB612E0A31D327C
B126>50 D<EB1FE0EBFFFC4813FF3907E03F80390F001FC0001EEB0FE0001CEB07F0123F
018013F8140313C01380A2381F0007C7FC15F0A2EC0FE015C0141FEC3F80EC7E00EB01F8
EB7FE014FCEB003FEC1FC0EC0FE0EC07F015F8140315FC140115FEA3127EB4FCA415FC48
130312780070EB07F86C14F0003C130F001FEB1FE0390FE03F800003B51200C613FCEB1F
E01F347DB126>I<000C14C0380FC00F90B5128015005C5C14F014C0D80C18C7FC90C8FC
A9EB0FC0EB7FF8EBF07C380FC03F9038001F80EC0FC0120E000CEB07E0A2C713F01403A2
15F8A41218127E12FEA315F0140712F8006014E01270EC0FC06C131F003C14806CEB7F00
380F80FE3807FFF8000113E038003F801D347CB126>53 D<EB0FE0EB7FF8EBFFFE3803F8
3F3907E00F80390FC007C0D81F8013E0EC03F0EA3F0048EB01F8127EA200FE14FC1400A4
15FEA5007E1301A2127F7E1403EA1F80000F13073807C00E3803E01C3801F03838007FF0
90381FC0FC90C7FC1401A215F8A215F01403001F14E0383F800715C0140FEC1F80903800
3F00001C137E381F01FC380FFFF0000313C0C690C7FC1F347DB126>57
D<123C127E12FFA4127E123C1200B0123C127E12FE12FFA3127F123F1203A412071206A3
120E120C121C1238123012701260082F7A9F15>59 D<EBFFC0000313F8380F00FE001C13
3F48EB1F804814C0140F00FC14E07EA4127CC7EA1FC0A2EC3F80EC7F0014FE14F8495A49
5A5C495AA249C7FC130EA2130C131CA21318A890C8FCA7133C137E13FFA4137E133C1B35
7CB424>63 D<15E0A34A7EA24A7EA34A7EA3EC0DFE140CA2EC187FA34A6C7EA202707FEC
601FA202E07FECC00FA2D901807F1507A249486C7EA301066D7EA2010E80010FB5FCA249
800118C77EA24981163FA2496E7EA3496E7EA20001821607487ED81FF04A7ED8FFFE49B5
12E0A333367DB53A>65 D<B7FC16E016F83A03FC0003FE0001EC00FFEE7F80EE3FC0161F
17E0160F17F0A617E0161F17C0EE3F80EE7F0016FEED03FC90B612F05E9039FC0007FCED
00FEEE3F80EE1FC0EE0FE017F0160717F8160317FCA617F81607A2EE0FF0EE1FE0163FEE
7FC00003913803FF00B75A16F816C02E337DB236>I<DA03FE130C91393FFF801C91B512
E0903A03FE01F83C903A0FF0003C7CD91FC0EB0EFCD97F80130701FEC712034848140100
0315005B4848157C485A173C485A171C123F5B007F160CA390C9FC481600AB7E6D150CA3
123F7F001F161C17186C7E17386C6C15306C6C15706D15E012016C6CEC01C0D97F80EB03
80D91FC0EB0F00D90FF0131ED903FE13FC0100B512F0023F13C0DA03FEC7FC2E377CB437
>I<B81280A3D803FCC7FC0001151FEE07C01603A21601A21600A41760150CA31700A215
1CA2153C15FC90B5FCA3EBFC00153C151CA2150CA592C8FCAB487EB512FEA32B337DB232
>70 D<B512FEA3000113006C5AB3B3A7487EB512FEA317337EB21C>73
D<B512FEA3D803FEC9FC6C5AB3A9EE0180A416031700A45EA25E5E5E5E16FE00031407B7
FCA329337DB230>76 D<D8FFFC923801FFF86D5DA20003EFFE00D801BFED06FCA3D99F80
140CA2D98FC01418A3D987E01430A2D983F01460A3D981F814C0A3D980FCEB0180A2027E
EB0300A36E1306A26E6C5AA36E6C5AA36E6C5AA26E6C5AA36E6C5AA3913800FD80A2037F
C7FCA3486C133ED80FF04B7EB5011C90387FFFF8A33D337CB246>I<EC07FC91387FFFC0
903901FC07F0903907E000FCD90F80133E013FC76C7E017E6E7E496E7E48486E7E48486E
7EA248486E7E000F8249157E001F167FA24848ED3F80A2007F17C0A290C9121FA24817E0
AB6C17C06D153FA3003F17806D157FA2001F17006D5D000F5E6C6C4A5AA26C6C4A5A0001
5E6C6C4A5A017E4A5A6D4A5AD91FC0017FC7FCD907E013FC903901FC07F09039007FFFC0
DA07FCC8FC33377CB43C>79 D<90381FE00390387FFC0748B5FC3907F01FCF390F8003FF
48C7FC003E80814880A200788000F880A46C80A27E92C7FC127F13C0EA3FF013FF6C13F0
6C13FF6C14C06C14F0C680013F7F01037F9038003FFF140302001380157F153FED1FC015
0F12C0A21507A37EA26CEC0F80A26C15006C5C6C143E6C147E01C05B39F1FC03F800E0B5
12E0011F138026C003FEC7FC22377CB42B>83 D<007FB712FEA390398007F001D87C00EC
003E0078161E0070160EA20060160600E01607A3481603A6C71500B3AB4A7E011FB512FC
A330337DB237>I<B500FE90381FFFF8A3000190C813006C48153C1718B3AF1738017F15
30A217706D6C1460011F15E06E495A010F14036D6C495A6D6C49C7FCD901FC131E6DB413
FC91383FFFF0020F13C0020190C8FC35357EB23A>I<B5D8F007B539800FFFF0A3000390
C7273FF000011300D801FC6E48EB007C1A386D140F00001930836D020715706D1860A26E
496C14E0013F60A26ED919FC1301011F60A26ED930FE1303010F95C7FCA26ED9607F5B01
071706A26E9039C03F800E0103170CA2913BFC01801FC01C01011718A2913BFE03000FE0
3801001730A2DAFF06EB07F0027F5EA2038CEB03F8023F5EA203D8EB01FC021FEDFD80A2
03F0EB00FF020F93C8FCA24B800207157EA24B143E0203153CA24B141C020115184C357F
B24F>87 D<EAFFF0A4EAF000B3B3B3ADEAFFF0A40C4B79B715>91
D<0003130C48131C000E133848137000181360003813E0003013C0EA700100601380A2EA
E00300C01300A400DE137800FF13FCEB83FEA2EA7F81A2383F00FC001E1378171774B326
>I<EAFFF0A41200B3B3B3AD12FFA40C4B7FB715>I<EB7F803803FFF0380F80FC381C003E
003F133F6D6C7E6E7EA26E7EEA1F00C7FCA4EB01FF131FEBFF873803FC07EA0FF0EA1FC0
EA3F80127F13004815C05AA3140FA26C131F6C133B3A3F8071F180391FC1E1FF2607FFC0
13003900FE003C22237DA126>97 D<EA03F012FFA312071203AEEC3F80ECFFE09038F3C0
F89038F7007E01FE7F49EB1F8049EB0FC05BED07E016F0A2150316F8AA16F0150716E0A2
ED0FC07F6DEB1F8001ECEB3F0001CF137C90388381F8903801FFE0C76CC7FC25357EB32B
>I<EB07F8EB3FFF9038FC07C03901F000E03903E003F03807C007120FEA1F80123F9038
0003E04890C7FCA2127E12FEAA127FA26C14187F001F14386D1330000F14706C6C13E039
03F001C03900FC0F8090383FFE00EB07F01D237EA122>I<153FEC0FFFA3EC007F81AEEB
07F0EB3FFCEBFC0F3901F003BF3907E001FF48487E48487F8148C7FCA25A127E12FEAA12
7E127FA27E6C6C5BA26C6C5B6C6C4813803A03F007BFFC3900F81E3FEB3FFCD90FE01300
26357DB32B>I<EB0FE0EB7FFCEBF83F3903F00F80D807E013C0390FC007E0381F800315
F0EA3F0014014814F8127EA212FEA2B6FCA248C8FCA5127E127FA26C1418A26C6C133800
0F14306D13706C6C13E03901F003C03900FC0F00EB3FFEEB07F01D237EA122>I<EB01FC
EB07FF90381F078090383E0FC0EB7C1F13FCEA01F8A20003EB070049C7FCACB512F0A3D8
03F0C7FCB3A7487E387FFFE0A31A357FB417>I<151F90391FC07F809039FFF8E3C03901
F07FC73907E03F033A0FC01F83809039800F8000001F80EB00074880A66C5CEB800F000F
5CEBC01F6C6C48C7FCEBF07C380EFFF8380C1FC0001CC9FCA3121EA2121F380FFFFEECFF
C06C14F06C14FC4880381F0001003EEB007F4880ED1F8048140FA56C141F007C15006C14
3E6C5C390FC001F83903F007E0C6B51280D91FFCC7FC22337EA126>I<EA03F012FFA312
071203AEEC1FC0EC7FF09038F1E0FC9038F3807C9038F7007E13FE497FA25BA25BB3486C
EB7F80B538C7FFFCA326347EB32B>I<EA0780EA0FC0EA1FE0A4EA0FC0EA0780C7FCAAEA
07E012FFA3120F1207B3A6EA0FF0B5FCA310337EB215>I<EB03C0EB07E0EB0FF0A4EB07
E0EB03C090C7FCAAEB03F013FFA313071303B3B01238127C00FE13E0130714C0130F007C
138038381F00EA1FFCEA07F0144384B217>I<EA03F012FFA312071203AF913803FFE0A3
6E1300EC00F8EC01E05D4A5A020FC7FC141C5C5C14F0EBF3F8EBF7FC13FEEBFC7EEBF87F
496C7E141F6E7E8114076E7E8114016E7E81486CEBFF80B500C313F0A324347EB329>I<
EA07E012FFA3120F1207B3B3A7EA0FF0B5FCA310347EB315>I<2703F01FE013FF00FF90
267FF80313C0903BF1E07C0F03E0903BF3803E1C01F02807F7003F387FD803FE1470496D
486C7EA2495CA2495CB3486C496C487EB53BC7FFFE3FFFF0A33C217EA041>I<3903F01F
C000FFEB7FF09038F1E0FC9038F3807C3907F7007EEA03FE497FA25BA25BB3486CEB7F80
B538C7FFFCA326217EA02B>I<EB07F0EB3FFE9038FC1F803901F007C03903C001E00007
8048486C7E48C7127CA248147E003E143E007E143FA300FE1580A8007E1500A36C147EA2
6C147C6D13FC6C6C485A00075C3903F007E03900FC1F80D93FFEC7FCEB07F021237EA126
>I<3903F03F8000FFEBFFE09038F3C0F89038F7007ED807FE7F6C48EB1F804914C04913
0F16E0ED07F0A3ED03F8A9150716F0A216E0150F16C06D131F6DEB3F80160001FF13FC90
38F381F89038F1FFE0D9F07FC7FC91C8FCAA487EB512C0A325307EA02B>I<903807F003
90383FFC07EBFC0F3901F8038F3807E001000F14DF48486CB4FC497F123F90C77E5AA25A
5AA9127FA36C6C5B121F6D5B000F5B3907E003BF3903F0073F3800F81EEB3FF8EB0FE090
C7FCAAED7F8091380FFFFCA326307DA029>I<3803E07C38FFE1FF9038E38F809038E71F
C0EA07EEEA03ECA29038FC0F8049C7FCA35BB2487EB512E0A31A217FA01E>I<EBFF0600
0713CE381F00FE003C133E48131E140E5A1406A27EA200FE90C7FC6C7EEA7FFC383FFFC0
14F0000F7F6C7FC67FEB0FFF1300EC3F8000C0131F140F6C1307A37E15006C5B6C130E6C
5B38F7807838E1FFE038C07F8019237EA11E>I<1330A51370A313F0A21201A212031207
381FFFFEB5FCA23803F000AF1403A814073801F806A23800FC0EEB7E1CEB1FF8EB07E018
2F7FAD1E>I<D803F0133F00FFEB0FFFA30007EB007F000380B35DA35D12016D48138000
00903803BFFC90387E073FEB1FFED907F8130026227EA02B>I<B5EBFFF0A3D80FF0EB3F
800007EC1F000003140E150C6D131C00011418A26C6C5BA26D1370017E1360137F6D5BA2
90381F8180A214C3010F90C7FCA2EB07E6A214FE6D5AA26D5AA36D5AA2146024217E9F29
>I<B53A1FFF81FFF0A33C07F801FC003F8001F049EB1E0000030100141C816C6C017C13
18A26D017E1338000002FE1330A290267E01FF5B159F168090263F030F5BA216C0903A1F
8607C180A202C613E390260FCC0390C7FCA2D907FC13F6ECF80116FE6D486C5AA36D4813
78A36D48133034217F9F37>I<B53801FFF8A32603FE0013806C48EB7C0000001478017E
1370017F5B90383F81C090381F8380D90FC3C7FCEB07E614FE6D5A6D5A6D7E80805B9038
039F809038071FC09038060FE0EB0C0790381C03F0496C7E01707FEBF000000180000FEC
FF8026FFFC0313FCA326207F9F29>I<3A7FFF807FF8A33A07F8001FC00003EC0F800001
EC070015066C6C5BA26D131C017E1318A26D5BA2EC8070011F1360ECC0E0010F5BA29038
07E180A214F3010390C7FC14FBEB01FEA26D5AA31478A21430A25CA214E05CA2495A1278
D8FC03C8FCA21306130EEA701CEA7838EA1FF0EA0FC025307F9F29>I<003FB512F0A2EB
000F003C14E00038EB1FC00030EB3F800070137F1500006013FE495A13035CC6485A495A
A2495A495A49C7FC153013FE485A12035B48481370485A001F14604913E0485A387F0003
48130F90B5FCA21C207E9F22>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmr6 6 9
/Ff 9 58 df<13E01201120712FF12F91201B3A7487EB512C0A212217AA01E>49
D<EA01FC3807FF80381C0FC0383003E0386001F0EB00F812F86C13FCA2147C1278003013
FCC7FC14F8A2EB01F0EB03E014C0EB0780EB0F00131E13385B5B3801C00CEA0380380600
185A5A383FFFF85AB512F0A216217CA01E>I<13FF000313C0380F03E0381C00F014F800
3E13FC147CA2001E13FC120CC712F8A2EB01F0EB03E0EB0FC03801FF00A2380003E0EB00
F01478147C143E143F1230127812FCA2143E48137E0060137C003813F8381E03F0380FFF
C00001130018227DA01E>I<14E01301A213031307A2130D131D13391331136113E113C1
EA01811203EA07011206120C121C12181230127012E0B6FCA2380001E0A6EB03F0EB3FFF
A218227DA11E>I<00101330381E01F0381FFFE014C01480EBFE00EA1BF00018C7FCA513
FE381BFF80381F03C0381C01E0381800F014F8C71278A2147CA21230127812F8A2147848
13F8006013F0387001E01238381E07803807FF00EA01F816227CA01E>I<EB0FC0EB7FF0
3801F0383803C0183807803C380F007C121E001C1338003C1300A2127C1278EB7FC038F9
FFE038FB80F038FE0038143C48131EA248131FA41278A36C131EA2001C133C001E13386C
1370380781E03801FFC038007F0018227DA01E>I<1230123C003FB5FCA24813FE14FC38
60001C143814704813E014C0EA0001EB0380EB07001306130E5BA25BA21378A35BA41201
A76C5A18237CA11E>I<137F3803FFC0380781E0380E00704813380018131C1238A3123C
003F1338381FC078EBE0F0380FF9E03807FF80120114C0000713F0380F0FF8381C03FC38
3801FE3870007E141F48130F1407A314060070130E0078130C6C1338001F13F03807FFC0
C6130018227DA01E>I<13FE3803FFC0380781E0380E0070481378003C133848133CA200
F8131EA3141FA40078133FA26C137F121C380F01DF3807FF9F3803FE1EC7FCA2143E143C
001C1338003E13781470003C13E0381801C0381C0780380FFE00EA03F818227DA01E>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmr8 8 9
/Fg 9 58 df<130C133C137CEA03FC12FFEAFC7C1200B3B113FE387FFFFEA2172C7AAB23
>49 D<EB7F803801FFF0380780FC380E003F48EB1F8048EB0FC05A0060EB07E012F000FC
14F07E1403A3007C1307C7FCA215E0140F15C0141F1580EC3F00147E147C5C495A495A49
5A495A011EC7FC5B5B4913305B485A4848136048C7FC000E14E0001FB5FC5A4814C0B6FC
A21C2C7DAB23>I<EB3FC03801FFF03807C0FC380E007E487FEC1F80003F14C0A2EB800F
1300A2000C131FC7FC1580A2EC3F00143E5C5CEB03F0EBFFC014F0EB00FC143FEC1F8015
C0140F15E0A2EC07F0A21238127C12FEA3EC0FE012F8006014C00070131F6C1480001EEB
3F00380780FC3801FFF038007FC01C2D7DAB23>I<140EA2141E143EA2147E14FEA2EB01
BE1303143E1306130E130C131813381330136013E013C0EA0180120313001206120E120C
5A123812305A12E0B612FCA2C7EA3E00A9147F90381FFFFCA21E2D7EAC23>I<000CEB01
80380FC01F90B512005C5C14F014C0D80C7EC7FC90C8FCA8EB1FC0EB7FF8380DE07C380F
801F01001380000E130F000CEB07C0C713E0A2140315F0A4127812FCA448EB07E012E000
6014C00070130F6C14806CEB1F006C133E380780F83801FFE038007F801C2D7DAB23>I<
EB03F8EB0FFE90383E0780EBF8013901F007C03803E00FEA07C0EA0F80A2391F00078091
C7FC123EA2127EA2127CEB0FC038FC3FF0EBF07C38FDC01EB4487E01001380EC07C04814
E0A214034814F0A4127CA3127EA2003E14E01407121E001F14C06CEB0F803907801F0038
03C03E6C6C5A38007FF0EB1FC01C2D7DAB23>I<1230123C003FB512F8A215F05A15E039
700001C000601480140348EB0700140E140CC7121C5C143014705C495AA2495AA249C7FC
A25B130E131EA2133EA3133C137CA413FCA913781D2E7CAC23>I<EB1FC0EBFFF03803E0
7C3807801E48487E001EEB0780A248EB03C0A4123E1407003F1480381FC00F01E01300EB
F81E6C6C5A3807FFF86C13E0C6FCEB3FF8EBFFFC3803C7FFD807831380D81F0013C0001E
133F48EB1FE0007C13070078EB03F012F84813011400A46C14E000781301007C14C0003C
13036CEB0780390F800F003807E03C3801FFF038003FC01C2D7DAB23>I<EB3F80EBFFF0
3803E0783807C03E48487E48487E003E14801407007E14C0127C00FC14E01403A315F0A5
007C1307127EA2003E130F7E6C131F3807803B3803E0F33800FFC390383F03E013001407
A215C0A2140F001E1480003F14005C143E143C003E5B001C5B380E03E03807FF80D801FE
C7FC1C2D7DAB23>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmsy10 10.95 2
/Fh 2 25 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712C0
AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D<D91FE01620D97FF816703801FFFE486D7E48804814F09038E01FF8271F8007FC15F027
3E0001FE15E0003CD9007F1401007CDA3FC013030078DA0FE014C00070DA07F8130700F0
DA03FEEB1F8048913A01FF807F006F90B5FC043F5B705B04075B040113E000409238007F
803C157BA047>24 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fi cmti10 10.95 71
/Fi 71 124 df<DC0FF0EB0F80DC7FFEEB3FE0922601FC0FEBF878923B03F00381F03C92
3B07C007C3E07C923B0F801FC7E1FC031F013F13C318CFED3F001983069F13F8037E9039
0E1F80E005001400183F03FE92C7FC5DA3600201157E5DA318FE02035D0103B9FCA26190
290003F00001FCC7FC14074B5CA41703020F5D5DA31707021F5D5DA3170F023F5D92C7FC
A3171F4A5D147EA3173F02FE92C8FC5CA35F0101157E5CA35F495AA34C5A495AA2001E02
F05B007F9038C3F803010F5D00FF018713075F0207495AD8FE1F4948C9FCD8F81EEBC01E
3A703C03803C3A787801E0F83A1FF000FFE0D807C0EB3F80465383BF38>11
D<933807FF80043F13E09338FE00F8DB01F0133EDB07E0130E4B48131F4C137F031F14FF
4BC7FCA218FE157E1878180015FE5DA31401A25DA414030103B712F0A218E0903A0003F0
00070207140F4B14C0A3171F020F15805DA2173F1800141F5D5F177EA2143F92C712FE5F
A34A1301027EECF81CA3160302FEECF03C4A1538A21878187013014A010113F018E09338
00F1C0EF7F804948EC1F0094C7FCA35C1307A2001E5B127F130F00FF5BA249CAFC12FEEA
F81EEA703CEA7878EA1FF0EA07C0385383BF33>I<143C14FEEB01FF5BA414FE1307A214
FCA314F8130FA214F0A314E0131FA214C0A31480133FA21400A3133E137EA2137CA31378
13F8A25BA35B1201A26C5A90C7FCA8120FEA3FC0127FA212FFA35B6CC7FC123C184177C0
1C>33 D<EA01E0EA07F8120F13FC121FA4120FEA03D8EA0018A2133813301370136013E0
13C01201EA038013005A120E5A5A5A5A5A0E1C6DBE1C>39 D<ED01801507ED0F00151C5D
5D5D14014A5A4A5A4AC7FC141E143E5C14785C1301495AA2495A5C130F49C8FCA2133EA2
5BA213FC5B12015BA212035B1207A25B120FA25BA2121FA290C9FCA25AA2123EA2127EA2
127CA65AAB1278A67EA47EA2120E120F7EA26C7EA26C7E6C7E1360215A73C325>I<1403
1580A2EC01C0EC00E0A21570A215781538153CA3151EA4151FA2150FA7151FA9153FA215
3EA3157EA2157CA215FCA215F8A21401A215F0A2140315E0A2140715C0A2EC0F80A2141F
15005C143EA25CA25CA2495A5C1303495A5C130F49C7FC131E5B137C5B5B485A485A485A
48C8FC121E5A12705A5A205A7FC325>I<16E01501A31503A25EA21507A25EA2150FA293
C8FCA25DA2151EA2153EA2153CA2157CA2B912F818FCA218F8C800F0C8FCA21401A25DA2
1403A25DA21407A25DA2140FA292C9FCA25CA2141EA2143EA2143C141C363873B246>43
D<EA01E0EA07F8120FA2EA1FFCA4EA0FF8EA0798EA001813381330A21370136013E013C0
1201EA0380EA07001206120E5A5A5A5A5A0E1C7A891C>I<387FFFFCA3B5FCA216057995
21>I<120FEA3FC0127FA212FFA31380EA7F00123C0A0A77891C>I<1838187CA218F81701
18F0EF03E0A2EF07C0A2EF0F80171F1800173EA25FA25F16015F4C5AA24C5AA24C5A161F
94C7FC163EA25EA25E15015E4B5AA24B5AA24B5A151F93C8FC153EA25DA25D14015D4A5A
A24A5AA24A5A141F92C9FC143EA25CA25C13015C495AA2495AA2495A131F91CAFC133EA2
5BA25B12015B485AA2485AA2485A121F90CBFC123EA25AA25AA25A5A365B7FC32E>I<15
FE913807FF8091381F07C091387C01F0ECF000494813F8494813780107147C495A49C7FC
167E133E137EA25BA2485AA2000315FEA25B000715FCA2491301120FA34848EB03F8A448
48EB07F0A448C7EA0FE0A316C0007E141F12FE1680153FA2481500A2157EA25DA25D4813
015D6C495A127C4A5A4A5A6C49C7FC143E6C5B380FC1F03803FFC0C648C8FC273F76BC2E
>I<15031507150F151F151E153E157EEC01FEEC03FC1407141FEB01FF90380FFBF8EB1F
C3EB0E07130015F0A2140FA215E0A2141FA215C0A2143FA21580A2147FA21500A25CA25C
A21301A25CA21303A25CA21307A25CA2130FA25CA2131FA25CEB7FE0B612F0A215E0203D
77BC2E>I<15FE913803FFC091380F01F091383C00F84A137C4A7F4948133F49487F4A14
8049C7FC5BEB0E0C011E15C0EB1C0EEB3C06133813781370020E133FD9F00C148013E014
1C0218137F00011600EBC0384A13FEEC600102E05B3A00E3C003F89039FF0007F0013C49
5A90C7485A5E037FC7FC15FC4A5A4A5AEC0FC04AC8FC147E14F8EB03E0495A011FC9FC13
3E49141801F0143C48481438485A1678485A48C85A120E001E4A5AD83FE0130301FF495A
397C3FF01FD8780FB55AD8700391C7FCD8F0015B486C6C5A6E5AEC07C02A3F79BC2E>I<
ED7F80913803FFE091380F80F891383C007C02F87FD901E07F494814804948130F49C7FC
010E15C0131EEB1C18EB3C1CEB380C0178141F17801370A2021C133F6D4814004A5BD91F
E0137ED90F805B90C8FC4B5A4B5A4B5AED1F8003FFC7FCECFFFC15F0A2EC00FC153E153F
8182150F82A4151FA2121E127F153F485DA3484AC7FC12F800E014FE5D14016C495A0070
495A0078EB0FC00038495A6C017EC8FC380F01F83803FFE0C690C9FC2A3F78BC2E>I<16
38167E16FE16FCA3150116F8A3150316F0A2150716E0A2ED0FC0A3ED1F80A216005DA215
7EA2157C15FC5D14015D14035D4A5AA24A5AA24AC7FC143EED038091387C0FC014F8ECF0
1F01011480EB03E014C0903807803F010F1400EB1F00133E495B49137E485A485A484813
FE48B46C5A4813F04813FE267C00FF130800F090380FFFFC00601301C714E0913803F800
5DA314075DA3140F5DA3141F5DA3020EC7FC274F7DBC2E>I<02C0EB018002F0130FD901
FEEB7F0091B512FE5E5E4914E016804BC7FCECBFF8D90780C8FC91C9FCA35B130EA3131E
131CA3133C9038381FC0ECFFF090383BE07C90387F003E017E133F017C7F0178805B4980
90C7FCA6153FA4001F147F486C5C487EA24913FF00FF92C7FC90C7FC48495A12E04A5A5D
6C495A140F00705C0078495A6C495A003E01FEC8FC381F03FC380FFFF0000313C0C648C9
FC293F77BC2E>I<ED0FE0ED7FF8913801F01C913807C00E91381F800F91383E00074A13
1F4A137F494813FF1303495A494813FE131F4948137891C8FC5B13FEA2485AA212035B00
07EB1FC0EC7FF0390FF1E07C9038F3803EEBF700D81FFE7F4914805BED0FC0485A5B151F
4914E0127FA25BED3FC0A248C7FCA2157F16805AA215FF1600A24A5AA2485C007C495AA2
007E495A4A5A003E495A003F495A261F807EC7FC380FC1FC6CB45A6C13E0C66CC8FC283F
76BC2E>I<D9703FEB01C09138FF800301F3158001EFEBC00790B5EB0F0048151E148326
03FE015B01F8147C2607F0005B49EBE3F04848137F496D5A48C71201001E4A5A1507485D
0038140F007892C7FC00705C00F0143E5A5DC8FC5DA24A5AA214035D14074A5AA2141F5D
A24AC8FCA25C147E14FEA2495AA3495AA313075C130FA25C131FA35C133FA35C91C9FC13
1E2A3F73BC2E>I<157F913801FFE0913807C0F091381F007C023C133C4A133E4A131F13
01495A5C1307A2495AA2163F011F143EA2167E6E137C16F8ECE00102F013F09138F803E0
9138FC07C090390FFE0F00ECFFBE6D13F86D5B7F6D7F8101037F90380F9FFFD91F0F1380
D97C0713C0497E48486C13E03903E0007F4848133F4848131F001F140F90C7FC003E1407
A2127E127CA200FC15C05AA2ED0F80A2ED1F00153E007C143C157C007E5C6CEB03F0391F
8007C0390FE03F802607FFFEC7FC000113F838003FC0283F78BC2E>I<15FF020713C091
381F81E091383E00F002FC13F84948137C495A4948137E010F143E495A133F4A133F017F
147F91C7FC5BA2485AA216FF12035B16FE150112075B1503A216FC491307A20003140F16
F8151F12016D133F0000EC7FF015EF90387C01CF90393E079FE090380FFE1FD903F813C0
90C7123FA21680157F160015FEA24A5A001C5C007F1303485C4A5A4A5A4A5A4849C7FC00
F8137E00E05B6C485A387C07E0383FFFC06C90C8FCEA03F8283F77BC2E>I<131EEB3F80
137FEBFFC05AA214806C13005B133C90C7FCB3120FEA3FC0127FA212FFA35B6CC7FC123C
122777A61C>I<171C173C177CA217FCA216011603A21607A24C7EA2161DA21639167916
7116E1A2ED01C1A2ED038115071601150EA2031C7FA24B7EA25D15F05D4A5AA24A5AA24A
C7FC5C140E5C021FB6FC4A81A20270C7127FA25C13015C495AA249C8FCA2130E131E131C
133C5B01F882487ED807FEEC01FFB500E0017FEBFF80A25C39417BC044>65
D<49B712C018F818FE903B0003FC0001FF9438007F804BEC3FC0A2F01FE014074B15F018
0FA2140F5D181FA2021F16E05D183F19C0023FED7F804B14FF19004D5A027F4A5A92C7EA
07F0EF1FE0EF7F804AD903FEC7FC92B512F017FE4AC7EA3F800101ED1FE04A6E7E170784
01036F7E5CA30107825CA3010F5E4A1407A260011F150F5C4D5A60013F153F4A4A5A4D5A
017F4A90C7FC4C5A91C7EA0FF849EC3FF0B812C094C8FC16F83C3E7BBD40>I<9339FF80
01C0030F13E0033F9038F803809239FF807E07913A03FC001F0FDA0FF0EB071FDA1FC0EC
BF00DA7F806DB4FC4AC77E495AD903F86E5A495A130F4948157E4948157C495A13FF91C9
FC4848167812035B1207491670120FA2485A95C7FC485AA3127F5BA312FF5BA490CCFCA2
170FA2170EA2171E171C173C173817786C16706D15F04C5A003F5E6D1403001F4B5A6D4A
C8FC000F151E6C6C5C6C6C14F86C6C495A6C6CEB07C090397FC03F8090261FFFFEC9FC01
0713F0010013803A4272BF41>I<49B712C018F818FE903B0003FE0003FF9438007F804B
EC1FC0F00FE0F007F014074BEC03F8F001FCA2140F4BEC00FEA3141F4B15FFA3143F5DA3
027F5D5DA219FE14FF92C81203A34917FC4A1507A219F813034A150F19F0A20107EE1FE0
5CF03FC0A2010FEE7F804A16006060011F4B5A4A4A5A4D5AA2013F4B5A4AEC3FC04DC7FC
017F15FEEE03FC4AEB0FF001FFEC7FE0B8128004FCC8FC16E0403E7BBD45>I<49B812F8
A390260003FEC7121F18074B14031801F000F014075DA3140F5D19E0A2141F4B1338A2EF
7801023F027013C04B91C7FCA217F0027F5CED80011603160F91B65AA3ED001F49EC0780
5CA3010392C8FC5CF003804C13070107020E14005C93C75A180E010F161E4A151C183CA2
011F5E5C60A2013F15014A4A5A1707017F150F4D5A4A147F01FF913807FF80B9FCA295C7
FC3D3E7BBD3E>I<49B812F0A390260003FEC7123F180F4B1403A2F001E014075DA3140F
5D19C0A2141F5D1770EFF003023F02E013804B91C7FCA21601027F5CED8003A2160702FF
EB1F8092B5FCA349D9003FC8FC4A7F82A20103140E5CA2161E0107141C5CA293C9FC130F
5CA3131F5CA3133F5CA2137FA25C497EB612E0A33C3E7BBD3B>I<9339FF8001C0030F13
E0033F9038F803809239FF807E07913A03FC001F0FDA0FF0EB071FDA1FC0ECBF00DA7F80
6DB4FC4AC77E495AD903F86E5A495A130F4948157E4948157C495A13FF91C9FC48481678
12035B1207491670120FA2485A95C7FC485AA3127F5BA312FF5BA30303B512FC90C7FCA2
DB000190C7FCA25FA216035FA316076C5E7FA2003F150F6D5D121F6D141F000F153F6C6C
4A5A6C6C14F76C6CEB01E36CB4EB07C1903A7FC03F81C090391FFFFE00010701F890C8FC
010013803A4272BF46>I<49B648B6FC495DA2D9000390C7000313004B5D4B5DA2180714
074B5DA2180F140F4B5DA2181F141F4B5DA2183F143F4B5DA2187F147F4B5DA218FF91B8
FC96C7FCA292C712015B4A5DA2170313034A5DA2170713074A5DA2170F130F4A5DA2171F
131F4A5DA2173F133F4A5DA2017F157FA24A5D496C4A7EB66CB67EA3483E7BBD44>I<49
B6FC5BA2D9000313005D5DA314075DA3140F5DA3141F5DA3143F5DA3147F5DA314FF92C7
FCA35B5CA313035CA313075CA3130F5CA3131F5CA3133F5CA2137FA25C497EB67EA3283E
7BBD23>I<4AB61280A2180091C713C0167F5FA216FF94C7FCA35D5EA315035EA315075E
A3150F5EA3151F5EA3153F5EA3157FA25EA215FFA293C8FCA25CA25DA2380F8003EA3FC0
D87FE05BA21407D8FFC05B140F01805B49485A12FC0070495A4A5A6C01FEC9FC383C01FC
380F07F03807FFC0C648CAFC314079BD30>I<49B612C0A25FD9000390C8FC5D5DA31407
5DA3140F5DA3141F5DA3143F5DA3147F5DA314FF92C9FCA35B5CA313035C18C0EF01E001
0716C05C17031880130F4A140718005F131F4A141EA2173E013F5D4A14FC1601017F4A5A
16074A131F01FFECFFF0B8FCA25F333E7BBD39>76 D<49B5933807FFFC496062D90003F0
FC00505ADBBF805E1A771AEF1407033F923801CFE0A2F1039F020FEE071F020E606F6C14
0E1A3F021E161C021C04385BA2F1707F143C023804E090C7FCF001C0629126780FE0495A
02705FF00700F00E0114F002E0031C5BA2F03803010116704A6C6C5D18E019070103ED01
C00280DA03805BA2943807000F13070200020E5C5FDB03F8141F495D010E4B5CA24D133F
131E011CDAF9C05CEEFB80197F013C6DB4C7FC013895C8FC5E01784A5C13F8486C4A5CD8
07FE4C7EB500F04948B512FE16E01500563E7BBD52>I<902601FFFE020FB5FC496D5CA2
D900016D010013C04AEE3F00193E70141C193CEC07BFDB3FE01438151F1978020F7FDA0E
0F15708219F0EC1E07021C6D5CA203031401023C7FDA38015DA2701303EC780002700280
5BA2047F130702F014C04A013F91C7FCA2715A0101141F4AECF00EA2040F131E010315F8
4A151C1607EFFC3C0107140391C7143817FE040113784915FF010E16708218F0131E011C
6F5AA2173F133C01385E171F137813F8486C6F5AEA07FEB500F01407A295C8FC483E7BBD
44>I<EEFFC0030713F892383F80FE9238FC003FDA03F0EB0F804A486D7EDA1F80804AC7
6C7E027E6E7E4A81494814004948811307495A4948157F133F5C49C9FC4917805B120148
5AA212075B000F17FFA25B121F190048485DA448484B5AA34D5AA25B4D5A12FF60171F60
007F163F604D5AA24DC7FC5F003F15014C5A6D5D001F4B5A4C5A6C6C4A5A4C5A6C6C4AC8
FC000315FC6C6C495A6C6CEB07E0017FEB1F8090261FC07EC9FC903807FFF80100138039
4273BF46>I<49B77E18F018FC903B0003FE0003FEEF00FF4BEC7F80F03FC00207151F19
E05DA2020F16F0A25DA2141FF03FE05DA2023F16C0187F4B1580A2027FEDFF00604B495A
4D5A02FF4A5A4D5A92C7EA3FC04CB4C7FC4990B512FC17E04ACAFCA21303A25CA21307A2
5CA2130FA25CA2131FA25CA2133FA25CA2137FA25C497EB67EA33C3E7BBD3E>I<49B612
FCEFFF8018F0903B0003FE000FF8EF03FE4BEB00FF8419800207ED3FC05DA219E0140F5D
A3021FED7FC05DA2F0FF80143F4B15004D5A60027F4A5A4B495A4D5AEF3F8002FF02FEC7
FC92380007F892B512E01780499038000FE04A6D7E707E707E0103814A130083A213075C
A25E130F5C5F1603131F5CA3013F020714404A16E05F017F160119C04A01031303496C16
80B6D8800113079438FE0F009338007E1ECAEA3FFCEF07F03B407BBD42>82
D<92391FE00380ED7FFC913A01FFFE0700913907F01F8F91390FC007DF4AC66CB4FC023E
6D5A4A130014FC495A4948147CA2495AA2010F15785CA3011F1570A46E91C7FCA2808014
FE90380FFFE015FC6DEBFF8016E06D806D806D6C7F141F02037FEC003FED07FF1501A281
A282A212075A167E120EA2001E15FE5EA25E003E14015E003F14034B5A486C5C150F6D49
5A6D49C8FCD8F9F0137C39F8FE01F839F03FFFF0D8E00F13C026C001FEC9FC314279BF33
>I<48B9FCA25A903AFE001FF00101F89138E0007FD807E0163E49013F141E5B48C75BA2
001E147FA2001C4B131C123C003814FFA2007892C7FC12704A153C00F01738485CC71600
1403A25DA21407A25DA2140FA25DA2141FA25DA2143FA25DA2147FA25DA214FFA292C9FC
A25BA25CA21303A25CEB0FFE003FB67E5AA2383D71BC41>I<001FB500F090B512F0485D
A226003FF0C7380FFC004AEC03F04A5D715A017F1503A24A5DA201FF150795C7FC91C8FC
A2485E170E5BA20003161E171C5BA20007163C17385BA2000F167817705BA2001F16F05F
5BA2003F1501A2495DA2007F1503A2495DA2160794C8FC48C8FC5E160E161E6C151C163C
5E5E5E6C6C13014B5A001F4A5A6C6C011FC9FC6D133E6C6C13F83903FC07F0C6B512C001
3F90CAFCEB07F83C406FBD44>I<B500FE91387FFFE094B5FC19C00003018091380FFC00
49C8EA07F000015F606095C7FC170EA25F173C17386D5DA26C5E16015F4C5AA24CC8FC5E
160E5E805E137F5E5EA24B5AA24B5A150793C9FCECC00EA2013F5B153C15385DA25D14C1
5DECC38014E302E7CAFCEB1FEF14EE14FCA25CA25CA25C5C130F5CA291CBFC130E3B406D
BD44>I<277FFFFE01B500FC90B512E0B5FCA20003902680000790C7380FFC006C90C701
FCEC07F049725A04035EA26350C7FCA20407150EA2040F5D1A3C041F153862163B621673
4F5A6D14E303014B5A6C15C303034BC8FC1683DB0703140E191E030E151C61031C7F61ED
380161157003F04A5A15E002014B5A15C0DA03804AC9FC60DA0700140E60140E605C029C
5D14B8D97FF85D5C715A5C4A5DA24A92CAFC5F91C7FC705A137E5F137C5F137801705D53
406EBD5B>I<91B690383FFFFC605E020101E0010F13006E49EB07F84C6D5A19C06F6C49
5A96C7FC033F140E705B183C031F5C705B4D5A030F5C70485A4DC8FC0307130EEEFC1E5F
03035BEEFE705F6F6C5A5FA26F90C9FC83A2707EA216FF4B7F5DED079FEE1FF0150EED1C
0F03387F1578EDF007DA01E07F15C09138038003DA07007F140E021E13014A805C02707F
4A81495A4948147F01078249C8FC013F6F7E496C147F2603FFC049487EB500F8011FEBFF
E0A261463E7CBD44>I<147E49B47E903907C1C38090391F80EFC090383F00FF017E137F
4914804848133F485AA248481400120F5B001F5C157E485AA215FE007F5C90C7FCA21401
485C5AA21403EDF0385AA21407EDE078020F1370127C021F13F0007E013F13E0003E137F
ECF3E1261F01E313C03A0F8781E3803A03FF00FF00D800FC133E252977A72E>97
D<EB1FC0EA0FFF5CA2EA003FA291C7FCA25BA2137EA213FEA25BA21201A25BA21203A25B
147E3907F1FF809038F783E09038EF01F013FE390FF800F8A24913FC49137C485A157E5B
15FE123FA290C7FCA248130115FC127EA2140300FE14F85AA2EC07F0A215E048130F15C0
141F15800078EB3F00127C147E003C5B383E01F8381E03E06C485A6CB4C7FCEA01F81F40
76BE2A>I<EC1FC0ECFFF0903803F03C903807C01E90381F800E90383F000F017E133F49
13FF485A485A000714FE5B000F14FC48481300A2485AA3127F90C8FCA35A5AA648140300
7E1407150F151E003E143C15786C14F0EC03E0390F800F803903E07E003801FFF838003F
C0202977A72A>I<EE3F80ED1FFF1700A2ED007FA2167EA216FEA25EA21501A25EA21503
A25EA21507A25E147E903801FF8F903807C1CF90391F80EFC090383F00FF017E137F5B48
486D5A485AA2485A000F92C7FC5B001F5CA24848137EA215FE127F90C75AA214015A485C
A2140316384814F0A21407167891380FE070127C021F13F0007E013F5B003E137FECF3E1
261F01E35B3A0F8781E3802703FF00FFC7FCD800FC133E294077BE2E>I<EC3F80903801
FFE0903807E0F890381F803CEB3E0001FC131E485A485A12074848133E49133C121F4848
137C15F8EC03F0397F000FE0ECFF809038FFFC00B512C048C8FCA45AA61506150E151E00
7C143C15786C14F0EC01E06CEB07C0390F801F003807C0FC3801FFF038007F801F2976A7
2A>I<167C4BB4FC923807C78092380F83C0ED1F87161FED3F3FA2157EA21780EE0E004B
C7FCA414015DA414035DA30103B512F8A390260007E0C7FCA3140F5DA5141F5DA4143F92
C8FCA45C147EA414FE5CA413015CA4495AA4495AA4495A121E127F5C12FF49C9FCA2EAFE
1EEAF83C1270EA7878EA3FE0EA0F802A5383BF1C>I<EC03F0EC0FFC91383E0E1C9138FC
077E903901F003FE1303903807E001D90FC013FCEB1F80A2EB3F004914F8137E01FE1303
A2484814F0A2150712034914E0A2150F12074914C0A2151FA216805B153F1203ED7F006D
5BA200015B0000495A9038F80F7E90387C1EFEEB1FF8903807E0FC90C7FC1401A25DA214
03A25D001C1307007F5C48130F5D4A5A4AC7FC48137E00F85B387C03F0381FFFC0D803FE
C8FC273B7CA72A>I<EB01FC13FF5CA21303A25CA21307A25CA2130FA25CA2131FA25CA2
133FA291C8FCEC03F890387F0FFE91383E0F80D97E7813C0ECE007D9FFC013E014801400
A2485A5BA25B0003140F16C05BA20007141F16805BA2000F143F16005B5D001F147EEDFE
074913FCA2003F0101130FEDF80E1300161E48ECF01CA2007E1538A200FE1570020013E0
48EC7FC00038EC1F0028407ABE2E>I<1478EB01FCA21303A314F8EB00E01400AD137C48
B4FC38038F80EA0707000E13C0121E121CEA3C0F1238A2EA781F00701380A2EAF03F1400
12005B137E13FE5BA212015BA212035B1438120713E0000F1378EBC070A214F0EB80E0A2
EB81C01383148038078700EA03FEEA00F8163E79BC1C>I<1507ED1FC0A2153FA31680ED
0E0092C7FCADEC07C0EC3FF0EC78F8ECE07CEB01C01303EC807EEB0700A2010E13FE5D13
1E131CEB3C01A201005BA21403A25DA21407A25DA2140FA25DA2141FA25DA2143FA292C7
FCA25CA2147EA214FEA25CA213015CA2121C387F03F012FF495A5C495A4848C8FCEAF83E
EA707CEA3FF0EA0FC0225083BC1C>I<EB01FC13FF5CA21303A25CA21307A25CA2130FA2
5CA2131FA25CA2133FA291C8FCED03E049EB0FF8ED3C3C017EEB707CEDE1FC9038FE01C1
EC03839038FC0703140E0001011C13F891383800E0494813001460000313E0EBF9C0EBF7
8001FEC8FC1207EBFFE0EBE7F8EBE0FE000F137F6E7EEBC01F81001F130F16701380A200
3F15F0021F13E001001380A248148116C0007EEB0F83168000FE14879138078F0048EB03
FE0038EB00F826407ABE2A>I<EB07F0EA03FF14E0A2EA000FA214C0A2131FA21480A213
3FA21400A25BA2137EA213FEA25BA21201A25BA21203A25BA21207A25BA2120FA25BA212
1FA25BA2123FA290C7FCA25A1307127EA2EAFE0F130E12FCA2131E131CA2EA7C381378EA
3C70EA1FE0EA0780144079BE17>I<D801F0D93F80137F3D07FC01FFE003FFC03D0F3E07
C1F80F83F03D0E1F0F00FC1E01F8001E011C90387C3800001C49D97E707F003C01F05C00
38157F4A5C26783FC05C12704A91C7FC91C7127E00F003FE1301494A5CEA007EA2030114
0301FE5F495CA203031407000160495C180F03075D0003051F13E0494A1480A2030FEC3F
810007F001C0495CA2031F91383E0380120F494AEC0700A2033F150E001FEF1E1C4991C7
EA0FF80007C7000EEC03E0432979A74A>I<D801F0EB3F803A07FC01FFE03A0F3E07C1F8
3A0E1F0F00FC001E011C137C001C49137E003C13F012385C38783FC012705C91C7FC00F0
15FE495CEA007EA2150101FE5C5BA2150300015D5B15075E0003020F13704914C0A2031F
13F00007ED80E05B1681EE01C0120F49EC0380A2EE0700001FEC0F0E49EB07FC0007C7EA
01F02C2979A733>I<EC1FC0ECFFF8903803F07C90380FC01FEB1F8090393F000F80017E
14C0491307484814E0485A12075B000F15F0485AA2485AA2ED0FE0127F90C7FCA2151F48
15C05AA2ED3F80A2ED7F00A248147E007C5C007E13015D4A5A003E495A6C495A4A5A260F
803EC7FC3807C0FC3801FFF038003F80242977A72E>I<903903E001F890390FF807FE90
3A1E7C1E0F80903A1C3E3C07C0013C137801389038E003E0EB783F017001C013F0ED8001
9038F07F0001E015F8147E1603000113FEA2C75AA20101140717F05CA20103140F17E05C
A20107EC1FC0A24A1480163F010F15005E167E5E131F4B5A6E485A4B5A90393FB80F80DA
9C1FC7FCEC0FFCEC03E049C9FCA2137EA213FEA25BA21201A25BA21203A2387FFFE0B5FC
A22D3A80A72E>I<027E1360903901FF81E0903807C1C390391F80E7C090383F00F7017E
137F5B4848EB3F80485AA2485A000F15005B121F5D4848137EA3007F14FE90C75AA34813
01485CA31403485CA314074A5A127C141F007E133F003E495A14FF381F01EF380F879F39
03FF1F80EA00FC1300143F92C7FCA35C147EA314FE5CA21301130390B512F05AA2233A77
A72A>I<D801F013FC3A07FC07FF803A0F3E0F03C0260E1F1C13E0001EEB380F001C1370
003CEBE01F123814C0D8783F14C00070903880070092C7FC91C8FC12F05BEA007EA313FE
5BA312015BA312035BA312075BA3120F5BA3121F5B0007C9FC232979A726>I<EC7F8090
3801FFE0903807C0F890381F003C013E131C013C131E017C133E49137E15FEA2000114FC
A215706D13007FEBFFC014FC6C13FF15806D13C06D13E0010F13F01300140F1407140312
0C123F387F80011403D8FF0013E0A300FCEB07C000F0EB0F8012700078EB1F006C133C38
1F01F83807FFE0C690C7FC1F297AA725>I<EB01C0EB03F01307A25CA2130FA25CA2131F
A25CA2133FA291C7FCA2007FB51280B6FC1500D8007EC7FC13FEA25BA21201A25BA21203
A25BA21207A25BA2120FA25BA2121F141C1380A2003F133C1438EB0078147014F05C495A
EA1F03495A6C48C7FCEA07FCEA01F0193A78B81E>I<137C48B4141C26038F80137EEA07
07000E7F001E15FE121CD83C0F5C12381501EA781F007001805BA2D8F03F130314000000
5D5B017E1307A201FE5C5B150F1201495CA2151F0003EDC1C0491481A2153F1683EE0380
A2ED7F07000102FF13005C01F8EBDF0F00009038079F0E90397C0F0F1C90391FFC07F890
3907F001F02A2979A731>I<017CEB01C048B4EB07F038038F80EA0707000E01C013F812
1E001C1403EA3C0F0038EC01F0A2D8781F130000705BA2EAF03F91C712E012005B017E13
0116C013FE5B1503000115805BA2ED07001203495B150EA25DA25D1578000114706D5B00
00495A6D485AD97E0FC7FCEB1FFEEB03F0252979A72A>I<017C167048B491387001FC3A
038F8001F8EA0707000E01C015FE001E1403001CEDF000EA3C0F0038177C1507D8781F4A
133C00701380A2D8F03F130F020049133812005B017E011F14784C137013FE5B033F14F0
000192C712E05BA2170100034A14C049137E17031880A2EF070015FE170E00010101141E
01F86D131C0000D9039F5BD9FC076D5A903A3E0F07C1E0903A1FFC03FFC0902703F0007F
C7FC372979A73C>I<903903F001F890390FFC07FE90393C1E0E0F9026780F1C138001F0
EBB83FD801E013F89039C007F07FEA0380000714E0D9000F140048151C000E4AC7FCA200
1E131FA2C75BA2143F92C8FCA35C147EA314FE4A131CA30101143C001E1538003F491378
D87F811470018314F000FF5D9039077801C039FE0F7C033A7C0E3C078027783C1E1EC7FC
391FF80FFC3907E003F029297CA72A>I<137C48B4143826038F8013FCEA0707000E7F00
1E1401001C15F8EA3C0F12381503D8781F14F000701380A2D8F03F1307020013E012005B
017E130F16C013FE5B151F1201491480A2153F000315005BA25D157EA315FE5D00011301
EBF8030000130790387C1FF8EB3FF9EB07E1EB00035DA21407000E5CEA3F80007F495AA2
4A5AD8FF0090C7FC143E007C137E00705B387801F0383803E0381E0FC06CB4C8FCEA03F8
263B79A72C>I<D901F01370D907FC13F0010F14E090381FFE0190393FFF03C049EB8380
90387C0FCF9039F803FF009038F0007E49133C000114386C48137890C75A4A5A4A5A4A5A
4AC7FC141E5C5C5C495A495A495A49C8FC131E4913075B5B48485B4848131E485A01F05B
D80FFE137C391F1F81F8383E0FFFD83C075B486C5B00705CD8F00190C7FC38E0007C2429
7BA725>I<B8FCA2280278982E>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmbxti10 14.4 44
/Fj 44 122 df<183C187E18FFA35F60A3170360A3170760A3170F60A3171F60A3173F60
A3177F60A317FF95CAFCA35E003FBC12E0481BF0A2BD12F8A26C1BF0A26C1BE0C9D807F8
CAFCA3160F5FA3161F5FA3163F5FA3167F5FA316FF94CBFCA35D5EA315035EA315075EA4
6F5A6F5A55546EC76A>43 D<003FB612E04815F0A216E0A2B7FCA216C0A46C1500240C75
9F32>45 D<13FCEA03FF000F13804813C05AA25AA2B5FCA31480A214006C5A6C5A6C5AEA
0FE0121271912B>I<171E173E177E17FE16011603EE07FC160F161F167FEEFFF8150315
0F157F0203B512F00103B6FC5BA203F713E015C7ECFC0F90C7FC17C0A25DA21780A25DA2
1700A25DA25EA215FFA25EA25CA25EA25CA25EA25CA25EA25CA25EA25CA25EA25CA293C7
FCA25CA25DA214FFA25DA25B007FB712E0B812F0A46C16E02F4F71CE47>49
D<EE1FFE93B512C0030714F8031F14FE4B809226FFF01F13804AD9800713C0912703FE00
0113E0DA07F86D13F04A5A4A48EC7FF84A5ADA7F8315FC4A487E4948487E02FC16FE0103
1307D907F87F14F0010F1303DAE00714FF5E131F14C0030F5B013F028014FCEC801F1600
4B5B037E15F85D02814A13F0EC87F86DB4484913E04B4913C06D018015806D90C75AD901
FC4A130090C9485A4C13F84C5B4C5B4C5B043F90C7FC4C5AEEFFF803035B030F13C0033F
90C8FC4B5A913801FFF8020713E04A1380DA3FFEC9FCEC7FF8ECFFE0495B4990C8EA01F0
4948ED03F8EB0FF849481507494816F04948150F4948151F4890C9EA3FE04848167FD9FF
F8913801FFC04890B5130F4892B61280A248180001F15E263FC01F5DD980075D007F6D5D
90C75D033F5C486E5C48020749C7FC030113F8489138003FE03F5175CE47>I<EE0FFF93
B512F0030714FC031F14FF037F1580912701FFF80713C04AD9800113E0DA0FFEC713F0DA
1FF8147FDA3FE0EC3FF84A5A4B15FCECFF0C903801FE1EECFC3F13034A6C6C137F1307EC
F00FA2031F14FF93C713F8A25D03FE4913F0ECFFFC6D5B6D494913E06D4915C0DA3F805B
91C814804D13004D5AEF7FFC4D5A04075B037FB55A92B6128095C7FC17F883839238001F
FF04077F707F848284A54C7FA2EA01E0EA0FF8486C4A5B123F487EA25E48485EA3494A5B
5B495E494A90C7FC90C8FC4C5A6C4B5A6D5D6C6C01035B6D495BD81FF8011F5B6CB490B5
C8FC6C90B512FC6C5DC615C0013F49C9FC010713C03E5173CE47>I<187E4DB4FC4D1380
5FA25FA35F1900A35F60A2177F60A217FF60A24C5BA2605EA2605E605E95C7FC5E5FA24C
5A5F167F5F16FF5F4B5B5D5F4B90C8FCA24B5A5E4B5A153F5E4B5A9239FFC01F804AEC7F
C04C487E4A01017FEC07FEEC0FFC4B485BEC1FF0EC3FE04A485ADAFF805C491300495A49
485B49485D495A495AD9FFC05B484992C7FC4813FF000F14F0003FECFE3F4891B55AB8FC
180FD9800391B51280007CC7003F15C000301407C97E93B5EAFE0018E005F8C7FCA25D5F
A35D5FA35D5FA45FA294C8FC6F5AED01F83A6679CE47>I<02061638DA0FC0EC01F803F8
141F913A1FFF8003FF93B612F019E019C04A1680190060604A15F06018804DC7FC91B612
F817C04CC8FCED1F804990CAFCA25CA21303A25CA21307A29138F80FFF037F13E0D90FFB
B512F891B612FE83DBF81F7F49D9C0077F4AC66C7F02F8814A7F4948815C5C6DC78090C8
5AA55EA401F05CD807FC5E487E487E485D605AA24C5BB5FC495E5E495E4993C7FC01E091
B5FC01805D6CC7485B6D495B4B5B6C6C495B6D495B6C6C017F5BD9FE03B5C8FC6CB612FC
6C15F06C5DC692C9FC013F13F8010713803D5172CE47>I<EFFFE0041F13FC93B57E0303
80030F1580033F01C013C0923A7FFE001FE0913801FFF04A49133F4A0180137F4A90C7EA
FFF0DA3FFE5B4A484913E04A485B5D5B495B494915C04917804B6D1300496F5A496F5A92
CAFC5B5C13FF5A5CED03FF48021F13E0DAF87F13F84891B57E02F914FF9126FBF81F7F48
9038F7E0079126FF80037F4B6C7F485B4A81A24A81485BA25C5E485BA25C5EA2B5C7FCA2
5E605BA25E605BA24C5BA2605B4C90C7FCA2007F5E4C5AA24B5B6C6C495B5F6C6C010F5B
6D495B6C9026C0FFFEC8FC6C90B55A6C15F06C5D6C6C1480011F01FCC9FC010313C03C51
70CE47>I<F10FE04F7E193F197FA24F7EA26060A260A26060A260866095B5FCA25FA25F
5FA25F06F77F171F18E7EF3FC3177F188317FF1803EE01FE160305FC80160717F84C487E
161F17E0163F17C0EE7F8016FF17004B835E4B5A0307805E150F5E4B5A153F5E4BB87EA2
92B9FC5CA25C03FCC87E14074A5A5D021F845D143F4A48815D14FF92C9FC5B495A5C1307
D97FFF84007FB500FE49B712FCB74916FEA34B18FC6C4A6D16F8575577D467>65
D<020FB912E04A18FEF3FFC01CF08888DA000149C700037F4B707F7414804D817513C05D
A24D17E0A25DA25FA25D1DC04D5DA24B198098B5FC4D1700624B60624D5E505B92B54B5B
505B94C8485B97B5C7FC4A040313FC071F5B94B712C098C8FC5C1BE01BF804FCC7000113
FE4A706C7E747F4C6F7F885C747F5E885CA25EA25CA25EA24A5F645E6291B560A293C948
5BA24995B55A4F91C7FC4B5D6349050F5B4F5B4B4B5B96B55A4904075C007FBBC8FCBB12
FC1AF01AC04FC9FC19C05B5278D162>I<DEFFFC140F053FD9FF80EB1F800403B600F0EB
3F00041F6F5B047F9238FE01FF4BB85A0307DAF003EB87FE031F49C713DF037F01F0EC3F
FF92B500C0140F4A91C86C5B020713FC4A49814A01E0814A495F4A498191B5CAFC495B49
49715A495B5B495B4B605B4949173FA290B54860481A7F92CBFC5A4A615A4A183F4897C8
FCA2485BA35A5CA35A5CA3B5FC5CA45CA3F207E01A0FA21A1F63A21A3F631A7F6C97C8FC
624F5A626C6D16034F5A6C4E5A6E4C5A6C4E5A6E4C5A6C6D4CC9FC6C6D4B5A6C6DED07FC
6C6D6CEC1FF86D01E0EC7FF06D01F8903801FFC06D9026FF801F5B010791B548CAFC6D16
F8010016E0021F1580020302FCCBFCDA001F13C059566CD363>I<020FB912C04A18FEF3
FFC01CF01CFC88DA000149C7001F6D7E4B040180746C7F4D031F7F874B717F757F4D8175
7F5D767E5FA24B1A80885FA25D1EC05FA25D645FA292B5FCA294CAFC99B512805CA25EA2
4A601E005EA24A60655EA24A4E5BA25E515B5C654C5E655C515B5E515B4A97C7FC98B5FC
4C5F505B91B55E505B93C95C505B494E5B505B4B93B5C8FC4F5B4905075B4F13F04B037F
5B4EB5128049043F91C9FC007FBA12FCBB12F01AC04FCAFC19E006FCCBFC625278D169>
I<020FBA12FC4A19FE5CA36E19FCDA000391C7120F1A004D153F1B1F5D1B0F5FF307F85D
A25FA25DA24D16F0A25D193E4D137FA24B4B130FA24D49EB07E0060191C7FC92B5FCA24D
485A18074A150F181F4DB45A94B5FC5CA261A25C4CC6FC4CEB3FE0A24A151FA24C5CA24A
153FA24C5CA24A157FA24C6DC9FC95CAFC5CA25EA291B5FCA25EA25BA293CCFCA25BA25D
A25B007FB712F8B87EA45F575178D057>70 D<020FB8FC4A83A497C7FCDA000191C9FC5D
A25FA25DA25FA25DA25FA25DA25FA25DA25FA25DA25FA292B5FCA25FA25CA294CAFCA25C
A25EA25CA25EA25CA24CED1F801BC04A173FA24CED7F80A25CF2FF005E4F5A5C19034C5D
190791B5FC4F5A4C141FA2494D5A197F93C812FF4E5B495E180F4B023F5B95B5FC490307
5C007FBAFCBBFC97C7FCA3614A5278D153>76 D<020FB600C04DB612F04A6F4D15F86666
A25415F0DA00015049C7FC4B80660CFD5BA24B4F5AF503F304F96D61F507E3030F4F5AA2
04F1DE1F875BF53F07031F6204F06D167E4C06FC5CA2033F4E485AA24CDD03F05C716CED
07E0037F62F40FC00480DD1F805CA203FF4E485A1C7E4C6C6C96C8FC644A4E4890B5FCA2
4B4D485C515A02036E6D5DF30FC04BDD1F805CA202074E485A1B7E4B63716D5B020F6250
5A4B4C485DA2021F4D485B716D485A4B63505A023F4DC75AA24B047E5E62027F6E01F05D
F1F1F84BDBF3F05EA202FFDCF7E05CF1FFC092C797C9FC715C4995C8B5FCA24A4C5EA201
034D5C715B4A6361D93FFF4C5C007FB66C043FB77EB76C4A498261187F96C7FC4C013E61
855278D180>I<020FB97E4A18F81BFF1CC0881CF8DA000149C7003F7F4B04077F08017F
4D801D804B83A24D17C0A25DA25FA25D98B5FC5FA25D5014805FA24B1900624D5EA292B5
4B5B6494C85A644A4D5B505B4C4B5B4FB5C7FC4A040713FC077F5B93B812E01B804A4DC8
FC1AF097C9FC04FCCCFC5CA25EA25CA25EA25CA25EA25CA25EA291B5FCA25EA25BA293CD
FCA25BA25DA25B007FB712C0B87EA45F5A5278D15E>80 D<020FB812FC4AEFFFE01BFCF3
FF801CE088DA000149C76C7F4B04077F747F4D6E7F7414804B831DC05FA25DA24D17E0A2
4B19C098B5FC5FA25D5014805F1D004B5E644D5E505B92B55D505B94C84813C0505B4A4C
B5C7FC070713FC4C027F13F093B812C04A95C8FC1AF862864A9026FC000313FE06007F4C
6E7F874A82874C80A24A84A25EA24A5EA24C5EA24A5EA25EA291B592B55AA293C8FCA249
5E1DF84BF001FC1B80491A03A24B9438C007F88449F20FF0007FB76C6DEC1FE0B86CEDE0
3F739038F07FC07390B51280070715004D010114FCCD6C5B080313C05E5478D167>82
D<932601FFE01307041F01FEEB1F80047F9038FF803F0303B638E07F004B6F5A031F15FB
4BD9807FB5FC92277FFC000F5BDBFFF013034A01C07F4A497F4A90C86C5A4A48153FA24A
48151F023F5F5D147F190F4A485EA35B62A26F151F5B735A6F92C8FC816F7E16F8EEFF80
17F86DEDFF8018F018FC6D82846E82856E826E826E828080020082153F1507DB007F8016
07EE007F170F17038383A3D801F8705A1203A30007605BA24E5A120F617F4D5B121F6D4B
5B5F6D94C8FC486C4B5A6E4A5A6E4A5A02F0ECFFF04801FC495B9126FFC00F5B01CF90B6
5A01874BC9FCD8FF015D26FC007F14F048010F148048010001F8CAFC495675D34E>I<01
1FBB12C0491AE05BA21CC090BCFCDB800F9038FC003FDAFC0016074801E04B13015C4A49
6F13804890C7FC494C147FA248485C5B4E1500485A5EA248484C5CA24991B55D123F605B
007F4A1601A26CC792C85AC895C7FC5DA25FA25DA25FA25DA25FA25DA25FA25DA25FA25D
A25FA292B5FCA25FA25CA294CBFCA25CA25EA25CA25EA25CA25EA25C003FB812F84883B9
FCA36C5F53516BD05F>I<007FB6D8FE03B700F0017FB512FCB8487090B6FCA2525A16FE
6C4B6C4C6C15F8D8003F01E0C7000191C9EBFC00F71FE0555A686F51C7FC755D676D1C01
72601E0367545A4E170F674E171F6F634E6E4A5A1E7F6D4C95C8FC4E5F664E4C5A1D034E
6C5E06FF160706FE5F6F01014D5A06FC80DD03F84C5A6D0307173F4E6C5E050F177F06E0
94C9FCDD1FC016FE053F160106805E057F160306005E6F494C5A4DEDF00F6D4A485F0403
171F4D6D5D04074D5A4D167F4C4894CAFC041F5F4D5E043F16F103FF495E4CC7ECFBF84C
16FF6D4A5F854C5F645E4C5FA24C94CBFC635E4C5E7F93C86C5BA24B5F4B5FA24B5FA24B
5F4B94CCFCA26E485E19034B5E92C95B7E5466D18B>87 D<ED3FF8913801FFFE020F9038
FF83F0023FECC7F891B6EAEFFC499038F83FFF0107D9E0077F49EB800349496C5B495A49
487F495AA248495D5A48495BA2485F5C485DA248495DA25E5A91C75CA25EB5FC495EA25E
A24993C7FCA24CEB01F8180317FE5B167FF007F017FCA2007F03FFEB0FE05D6D5B003F4A
9038F81FC0001F021F13FC6C6C017FEC3F809027FF81FFDFEB7F006C90B5388FFFFE0001
ECFE076CDAF8035B013FD9E00013F0010390C7EA3FC03D3773B547>97
D<EC7FF048B5FC5AA45DEA00035BA25DA25BA25DA25BA292C9FCA25BA25CA2137FA25CA2
13FFED1FFC4AB57E02FB14E04890B612F8839238F83FFE9238C00FFF48DA000713805C02
F86D13C05C484915E0A25CA24817F0A25CA2485DA291C7FCA2484B13E0A25BA25E007F17
C05BA25E18805B00FF17005E5FA26C484A5AA24B5B5F5D5F6C6C495B4B5B001F93C7FC6D
EB3FFE6C6C495A3A07FF83FFF06C90B55A6C15806C6C49C8FC011F13F801031380345473
D240>I<923807FF80037F13F00203B512FC020F80023F8091B500031380499038F8007F
010701E0EBFFC049EB800149495A49485B495A49485B5A485BA248491580180048496D5A
486F5A93C8FC485BA35A91CAFCA3B5FC5BA45BA65B17036C6CED0780170FEF3FC0003F16
7F6DEC01FF001F4B13806C6C021F13006C6DEB7FFC6C9039F00FFFF86C90B612E06C5E01
3F4AC7FC010F14F0010049C8FC323773B540>I<F00FFEEF3FFF5FA419FCEF007F18FFA2
19F8A25FA219F0A25FA219E0A25FA219C0A25FA21980A25FED3FF8912601FFFE1400020F
EBFF9F023F91B5FC91B8FC49D9F83F5B0107EBE00749EB800349497E49485D49487F495A
A248495D5A48495BA2485F5C485DA248495DA25E5A91C75CA25EB5FC495EA25EA24993C7
FCA24CEB01F8180317FE5B167FF007F017FCA2007F03FFEB0FE05D6D5B003F4A9038F81F
C0001F021F13FC6C6C017FEC3F809027FF81FFDFEB7F006C90B5388FFFFE0001ECFE076C
DAF8035B013FD9E00013F0010390C7EA3FC03F5473D247>I<923807FF8092B512E00207
14F8021F80027F80903A01FFFE03FF49D9F00013804901C0EB7FC0495B013F90C7123F49
5A495A5C5A485B4849147F18804816FF4A491300485DEE0FFE4849EB7FFC923807FFF891
B612E0485E94C7FC16F04BC8FCB5CAFC5BA45BA7007F1603EF0780170F003FEE3FC0177F
6C6CEC01FF4C13806C6C021F13006C01C0EB7FFC6C9039F00FFFF86C90B612E06C6C5D6D
4AC7FC010714F09026007FFEC8FC323773B540>I<4DB47E050F13F0053F13FC4D7F94B6
FC4C01C113804C5B4C5B4C5B17FE041F5BA2163F1A0017FC047F6D5A725AF003F095C8FC
4C5AA55D5FA45D5F91B812E04983A3616D5FDA000701C0C8FCA35D5FA45D94C9FCA55D5E
A4157F5EA515FF5EA45C5EA45C5EA54A5BA45E5CA393CAFCA25C5DEA07E0EA1FF0D83FF8
5B387FFC3F5D12FF5D147F01F85B5DEBF0FF01E15B4990CBFC6CB45A6C13F86C5B000713
C0C690CCFC416C81D330>I<EEFFE0030F13F8033F9038FE0FC092B6EA1FE00203EDBFF0
4A01E013FF021FD9801F13F84A48487E4A486D13F04A5A49497F495B5B4B15E05B49495B
A24917C092C7FC495DA249481680A25F5A4A1600A25F5A4A5DA2177FA24A5DA217FFA260
5C5EA2606C5D5E6C6D5B4C5B6D6C5B6D6C90B5FC90381FFE076DB75A7F7F0100148F9126
0FFC0F5B91C7FC5EA295C7FCA25EA2D803F05DEA0FF8486C147F003F5E486C14FF5F5D00
FF4A5B49495B031F5B49495B6C4848B448C8FC90B65A6C15F06C15C000074AC9FCD8003F
13C03D4E79B540>I<EC07FF011FB5FC5BA45DEB003F147FA25DA214FFA25DA25BA25DA2
5BA25DA25BA25DA25BEE3FFC0381B57E038714E049019F8003BF8092397FE07FFC9239FF
001FFE4913FC4B8003E07F5D495BA292C7FC5C49485CA25CA2485E605CA248167F605C17
FF485FA24A5B605A5E4A5DA2484BEC1F80F0C03F91C7FC5E48EF807F4C150049160019FE
127F4D485A5B4E5A00FF4D5A040F130F49EE3FE070B55A496E5C007F6F49C7FCD83FC06E
6C5A6C48ED1FE0415477D247>I<153FEDFF804A13C04A13E0A25CA316C0A2168016006E
5AEC00F892C7FCB0EB03FC90380FFF80013F7F497F90B57E3901FE3FF8D803F87FEA07F0
EA0FE0A2EA1FC0003F137F1380127FEB00FF5D5A485A5D5B00005CA25B5DA25B5D5B92C7
FCA25B5CA2137F5C01FFEB03F0ECF807A25AECF00F4815E014E0ED1FC0A29138C03F80A2
ED7F0015FE6C13C1ECC7FC6CEBFFF86D5B6D13C0010F5BD903FCC7FC245576D32B>I<EF
07E0EF1FF0EF3FF8EF7FFCA217FFA318F8A218F018E0EF7FC0EF1F0094C7FCB04BB4FC03
0F13E0033F7F4B13FC92B57E0203130FDA07FC7F91260FF007138015E0EC1FC0EC3F8002
7F5B150014FE13014A5BA249481500A25E90C8FC5FA2167FA25FA216FFA25FA25DA25FA2
5DA25FA25DA25FA25DA25FA25DA294C7FCA25DA25EA2157FA25EA215FFA2D803F05CEA0F
F8486C485B123F486C485BA24A5B00FF495B494890C8FC4A5A49485A397FF1FFF890B512
E06C5C6C91C9FC000713F800011380366C84D32B>I<EC07FF011FB5FC5BA45DEB003F14
7FA25DA214FFA25DA25BA25DA25BA25DA25BA25DA25BEF03F84BEB1FFEEF7FFF4992B5FC
4C148092390007FC1FEE0FF04991391FC0FFC0EE3F014AEB7E034C5A017F49485A4B4848
13809138FC07E0ED0FC001FFEB1F80DB3F001400DAF87E5C4B6D5A48D9FBF86D5ADAFFF0
6D5A4B90C8FC15804891CAFC15F015FF16E0488116FC02C77F02C07F48023F7F814A6C7F
A2486EEC0FC0181F1400A248173F4B1580491580A2007FEF7F00A24916FE8100FFEE81FC
6F5C4915C76FEBFFF0496D5C007F6F5BD83FC0021F90C7FC6C48EC03FC3A5477D240>I<
EC1FFCEB7FFF90B5FCA46D13F813005BA215F0A25BA215E0A25BA215C0A25BA21580A25B
A21500A25BA25CA2137FA25CA213FFA25CA25AA25CA25AA25CA25AA25CA25AA25CA25AA2
91C7FCA25AA25BA2007FEB07E0140F13FCA212FFEC1FC013F8A2143F158013F0EC7F0012
7FEBF8FEEA3FF96CB45A6C5B6C5B6C5B38007F801E5475D223>I<D91FE0DAFFF0EC1FFE
D97FFC010701FE91B512C0496C011F9026FF800314F0489026FF807FDAC00F80486EB66C
4880D807F101C10181903AF03FF03FFED80FE1903EE3FC007FF87F800FFF01E0D9FFF091
38F9FE0048484ADAFFFC8104806D01F07F484891C75C0181495E127F0101495E4B93C7FC
49494A485C12FE4B5DA24904FF5D00009AC7FC4B5DA2494B5E654B5D1C7F494B5FA292C7
4A14FF65495D634A4C5DA2017F4B4BEC0FC0F5E01F4A5E6301FF4BEFC03F5115804A93C7
1480F67F00485EF500FE4A5D535A48047F4D5A7513074A4BEE1FF075EBFFE04A4B6E5C6C
496E486E91C7FC6C90C86C48ED3FFE017E6F48ED0FF06A3776B571>I<D91FE0ECFFF0D9
7FFC010713FE496C011F6D7E489026FF807F80486EB67ED807F101C101817FD80FE1903A
E3FC007FF801E0EBFFF048484A800480133F484891C7FC01815B127F01015B5D4949147F
12FE5DA24916FF0000605DA2495D615D5F495FA292C75A615B5F4A5EA2017F4B147EF100
FE5C5F01FFEEFE01057F14FC4A15FCF103F85A9538F807F05CF10FE048F01FC0053F133F
4AEEFF8071B512004A6E5B6C496E13F86C90C800015B017E9238007F80473776B54E>I<
923807FFC0037F13FC0203B6FC020F15C0023F8191B5000313F8499039F8007FFC010701
E0133F4901806D7E4990C76C7E49481680495A4948804818C0485BA2485BA248494A13E0
5AA2485BA24D13C05A91C8FCA25FB517805BA25F19005B6017FF605E60495E5E6C6C4A5B
604C5B003F4B90C7FC6D4A5A001F4B5A6C6C4A5A6CD980035B6CD9F01F13C06C90B65A6C
4BC8FC013F14F0010F14C0010001F8C9FC3B3773B547>I<DA3FC0EB0FFEDAFFF890387F
FFC0496D48B512F049D9FF0714FC49028F80D90FE39039BFFC1FFFD91FC39026FFE00713
8002C1DA800313C0D93F81140004FC6D13E0D97F015B4A4915F013FF01FE5CA24A17F8EA
01FC5EA24A5DC7FC5EA24A4B13F0A293C7FCA24A5D1AE05DA2027F5D1AC05D1A8002FF5D
1A005D4E5A5B4E5A4B5D5F495F6F495B4D5B6F5D49031F90C7FC03FF495A9338C1FFF893
B55A4916C003DF91C8FC038713FC038013C04991CAFCA292CBFCA25BA25CA2137FA25CA2
13FFA25CA2007FEBFFF0B67EA46C5C454D7DB547>I<D91FE0EB07FED97FFC90383FFFC0
496C90B512F048D9FF83804802C780D807F19039CFFC07FED80FE09039FFF001FFDCC000
138048484A5A4C5A4848495B0181495B4B5BEA7F015D5B00FE18004B5C715A496F5A0000
705A4B90C8FCA25BA25DA25BA292CAFCA25BA25CA2137FA25CA213FFA25CA25AA25CA25A
A25CA25C6C5B6C90CBFC137E393776B53C>114 D<ED3FFC0203B51280020F14E0023F14
F04A14F89139FFE01FFC4990380003FE4948130102F813030107EC07FF49485BA2011FEC
1FFE5CA26E14FC013FEC0FF86EEB07F002FEEB03C0DAFFE0C7FC15FF16F06D14FC826DEC
FF8017C06D15E07F6D15F06D6C14F8141F1401EC000F030013FCD807F0143F486C141F48
6CEC0FF8123F487EA2484815F0A217E049141FEE3FC05B01C0EC7F80007F913801FF00D8
3FF0EB07FE01FEEB3FFC6CB65A000715E06C1580C66C49C7FC010713E0303776B53A>I<
EC03F04A7E4A7E4A7E143FA3147F5DA314FF5DA35B5DA35B5DA35B003FB612FC4815FEB7
FCA216FC7ED8000FEB80005B92C7FCA35B5CA3137F5CA313FF5CA35A5CA35A5CA35A5CA2
16FC4814011480150316F8481407020013F0150FED1FE016C0ED3F8049137F6C6CEBFF00
EC03FE6CEB0FFC6CEBFFF86C14E06C5C013F90C7FCEB0FF8274E75CC2E>I<EB03FC9026
0FFF80EC0FC0013F6D4A7E496D4A7E90B56C4A7E2701FE3FF814FFD803F87FD807F05DD8
0FE05FA2EA1FC0003F017F5C01805F127FEB00FF4B5B4860485A5D5FC6485F5D5B4B5B96
C7FC5B5D5F495E92C7FCA2177F495E5CA205FFEB07E0F0F80F495AA25E9538F01FC0A301
3F4AEC3F80A25E6E499038E07F00011F4AEBF07E6E017F14FE6D903A81FF7FF1FC6D903A
FFFE3FFFF86D4A6C5B0100DAF00F5B023FD9C0035B020790C790C7FC433776B54A>I<D9
03FCEC07E090260FFF80EB0FF8013F6DEB1FFC496DEB3FFE90B56C137F2701FE3FF813FF
D803F86D14FFD807F05CEA0FE0A2EA1FC0003F017F7F1380007F82D900FF141F4BEB0FFE
481607484815035DA2C648ED01FC5D5B4B130318F85B5D17074916F092C7FCA2EF0FE05B
5CEF1FC0A218804948143F18005F177E17FE013F5D16015F6E495A011F14076E495A6D6D
485A6D9038E0FF806D90B5C7FC6D5C6D14F8021F5B02031380383776B540>I<D903FC18
7E90260FFF80DA1F80EBFF80013F6D4A6C4813C0496D4A6C4813E090B56C4A6C5A2701FE
3FF8495CD803F86D18F0D807F04B5CD80FE017E0A2EA1FC0003F017F4A80018017C0007F
85D900FF17014B496E13E0484E137F4848193F5D5FC64894C7EA1FC05D5B4B49153F4E15
805B5D057F157F494C150092C7FCA205FF5D494C5C5CA2505AA24A49495C017F1803A201
3F4E5AA2505AA26E494B5A84011F4A4B5A6D6C496D49C7FC6F486D13FE6D903BF07FDFFF
83FC6D90B5008FEBFFF86D03075C6D6CD9FC035C021F49C66C1380020101C0D90FFEC8FC
543776B55C>I<EB03FC90260FFF80EC0FC0013F6DEC1FE0496DEC3FF090B56CEC7FF827
01FE3FF814FFD803F87FD807F05DD80FE017F0A2EA1FC0003F017F5C018017E0127FEB00
FF4B5B4818C0485A5D5FC64817805D5B4B5B19005B5D5F495E92C7FCA2177F495E5CA217
FF60495AA25E60A3013F5C605E6E5B011F5C6E017F5B6D0181B5FC6D90B6FC7F01005E02
3F13CF0207130F91C75A95C7FCA201105CD801FE5D486C147F486D5C484B5AA2484A5B5F
4B5B4B5B4A4890C8FC49495A49495A6C48EBFFF8D9FE0713E06CB65A6C92C9FC6C14FC6C
6C13E0010790CAFC3D4E76B543>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk cmtt10 10.95 93
/Fk 93 127 df<121C127FEAFF80B3EA7F00B2123EC7FCA8121C127FA2EAFF80A3EA7F00
A2121C09396DB830>33 D<00101304007C131F00FEEB3F80A26C137FA248133FB2007E14
00007C7F003C131E00101304191C75B830>I<903907C007C0A2496C487EA8011F131FA2
02C05BA3007FB7FCA2B81280A36C16006C5D3A007F807F80A2020090C7FCA9495BA2003F
90B512FE4881B81280A36C1600A22701FC01FCC7FCA300031303A201F85BA76C486C5AA2
29387DB730>I<D803C0EB01E0D80FF01303486C497E487E150F487ED87E7E495AEAFE7F
5E486C133FA25E157FA24BC7FC6C5A5D387E7E01EA7FFED83FFC5B1403EA1FF86C48485A
EA03C0C75B140FA25D141FA24A5AA25D147FA292C8FC5CA2495AA25C1303A25C1307A290
390FF001E0ED07F84A487E011F497EA24A487E133F163F90267F807F1380ED7E1F14005B
A25B1201A24848EB7F3F033F13004914FF12076F5A5B6F5A6C486D5A0001EC01E029477D
BE30>37 D<EB07E0EB1FF8497E137F497E803801FC7F497E810003131F13F0A6143F92C8
FC91387F0FFF9026F87E1F1380000113FEEBF9FC13FB4A6C1300D9FFF013C06C13E0151F
02C05BEB7F809038FF003F4892C7FC485C48EB807E5A15FE391FDFC0FC383F8FE014E139
7F07F1F8EB03F300FEEBFBF0EB01FF5D7FEDC006027F130F91393F801F8015C06C137F6C
EBFFE049EBF83F018701FC1300263FFFFBB5FC6C01F15B14E06C9038C03FFC0003903800
1FF8D801FCEB07E0293A7DB830>I<EA07C0EA0FF0EA1FF8A213FCA213FE120F1207EA00
7EA513FE13FCA2120113F81203EA07F0120FEA1FE0127FEAFFC013801300127C12380F1D
70B730>I<141E147F14FF5BEB03FEEB07FCEB0FF0EB1FE0EB3FC0EB7F80EBFF00485A5B
12035B485A120F5BA2485AA2123F5BA2127F90C7FCA412FEAD127FA47F123FA27F121FA2
6C7EA27F12076C7E7F12017F6C7EEB7F80EB3FC0EB1FE0EB0FF0EB07FCEB03FEEB01FF7F
147F141E184771BE30>I<127812FE7E7F6C7E6C7EEA0FF06C7E6C7E6C7E6C7EEB7F8013
3F14C0131FEB0FE014F01307A2EB03F8A214FC1301A214FE1300A4147FAD14FEA4130114
FCA2130314F8A2EB07F0A2130F14E0EB1FC0133F1480137FEBFF00485A485A485A485AEA
3FE0485A485A90C7FC5A1278184778BE30>I<14E0497E497EA60038EC0380007EEC0FC0
D8FF83EB3FE001C3137F9038F3F9FF267FFBFB13C06CB61280000FECFE00000314F86C5C
6C6C13C0011F90C7FC017F13C048B512F04880000F14FE003FECFF80267FFBFB13C026FF
F3F913E09038C3F87F0183133FD87E03EB0FC00038EC0380000091C7FCA66D5A6D5A2327
7AAE30>I<143EA2147FAF007FB7FCA2B81280A36C1600A2C76CC8FCAF143EA229297DAF
30>I<EA03E0EA0FF0EA1FF813FCEA3FFEA213FFA27EA27E1203EA007FA2137E13FEEA01
FC1203EA07F8EA3FF0127FEAFFE0EA7F801300123C1019708B30>I<007FB612F0A2B712
F8A36C15F0A225077B9E30>I<120FEA3FC0EA7FE0A2EAFFF0A4EA7FE0A2EA3FC0EA0F00
0C0C6E8B30>I<16F01501ED03F8A21507A2ED0FF0A2ED1FE0A2ED3FC0A2ED7F80A2EDFF
00A24A5AA25D1403A24A5AA24A5AA24A5AA24A5AA24A5AA24AC7FCA2495AA25C1303A249
5AA2495AA2495AA2495AA2495AA249C8FCA2485AA25B1203A2485AA2485AA2485AA2485A
A2485AA248C9FCA25AA2127CA225477BBE30>I<14FE903807FFC0497F013F13F8497F90
B57E48EB83FF4848C6138049137F4848EB3FC04848EB1FE049130F001F15F0491307A248
48EB03F8A290C712014815FCA400FEEC00FEAD6C14016C15FCA36D1303003F15F8A26D13
07001F15F0A26D130F6C6CEB1FE0A26C6CEB3FC06C6CEB7F806D13FF2601FF8313006CEB
FFFE6D5B6D5B010F13E06D5BD900FEC7FC273A7CB830>I<EB03C0497EA2130FA2131FA2
133F137F13FF1203123FB5FCA213EF138FEA7E0F1200B3B0003FB512F84814FCB612FEA2
6C14FC6C14F81F3977B830>I<EB07FC90383FFFC090B512F00003804814FE4880261FF8
0F1380263FE00113C09038C0007F4848EB3FE090C7121FED0FF04814075A6C15F81503A3
127E1218C8FCA2150716F0150F16E0151F16C0153FED7F8015FF4A13005DEC07FC4A5A4A
5A4A5A4A5A4A5A4990C7FC495A495AEB0FF0EB3FE0495A495A4890C8FC4848EB01F04848
EB03F8485AEA1FE048B6FCB7FCA37E6C15F025397BB830>I<EB03FF013F13E090B512F8
4814FE4880481580260FFE0113C09038F0007F4848EB1FE0150F16F01507A26C5A6C5AC8
FC150F16E0A2151FED3FC0157FEDFF8002071300903807FFFE495B5D8115FF6D1480D900
0113C09138003FE0ED1FF0ED07F8150316FC150116FE1500A21218127EB4FCA2150116FC
4814036C15F86C6C13076DEB1FF0D83FF0133F3A1FFE01FFE06CB612C06C15806CECFE00
C65C013F13F001031380273A7CB830>I<EC03FC4A7E140F141FA2143F147F157E14FEA2
EB01FCEB03F8A2EB07F0A2EB0FE0EB1FC0A2EB3F80A2EB7F0013FEA2485A485AA2485AA2
485A485AA2485AA248C7FC12FEB8FC1780A46C1600C8007EC7FCAA91387FFFFE91B6FCA4
6E5B29397DB830>I<000FB612804815C05AA316800180C8FCAEEB83FF019F13C090B512
F015FC8181D9FE0313809039F0007FC049133F0180EB1FE06CC7120F000E15F0C81207A2
16F81503A31218127EA2B4FC150716F048140F6C15E06C141F6DEB3FC06D137F3A3FE001
FF80261FFC0F13006CB55A6C5C6C5C6C14E06C6C1380D90FFCC7FC25397BB730>I<EC0F
F8EC7FFF49B51280010714E0131F4914F090387FF80F9039FFC007F84813803803FE005B
485A4848EB03F0ED01E0484890C7FC5B123F5BA2127FEB000C903803FFE0010F13F8D8FF
3F13FE48B6FCB7128016C09039FE007FE001F8EB1FF001E0130F49EB07F849EB03FCA290
C7120116FE1500A37EA46C7E15016D14FC121F6D1303000FEC07F86D130F6C6CEB1FF06D
EB3FE03A03FF81FFC06C90B512806C15006D5B011F13F8010713E001011380273A7CB830
>I<127CB712FC16FEA416FC48C7EA0FF816F0ED1FE0007CEC3FC0C8EA7F80EDFF00A24A
5A4A5A5D14075D140F5D4A5AA24A5AA24AC7FCA25C5C13015CA213035CA213075CA4495A
A6131F5CA96D5A6DC8FC273A7CB830>I<49B4FC011F13F0017F13FC90B57E0003ECFF80
4815C048010113E03A1FF8003FF049131FD83FC0EB07F8A24848EB03FC90C71201A56D13
03003F15F86D13076C6CEB0FF06C6CEB1FE0D807FCEB7FC03A03FF83FF806C90B512006C
6C13FC011F13F0497F90B512FE48802607FE0013C0D80FF8EB3FE0D81FE0EB0FF04848EB
07F8491303007F15FC90C712014815FE481400A66C14016C15FC6D1303003F15F86D1307
D81FF0EB1FF06D133F3A0FFF01FFE06C90B512C06C1580C6ECFE006D5B011F13F0010190
C7FC273A7CB830>I<49B4FC010F13E0013F13F890B57E4880488048010113803A0FFC00
7FC0D81FF0EB3FE04848131F49EB0FF048481307A290C7EA03F85A4815FC1501A416FEA3
7E7E6D1303A26C6C13076C6C130F6D133FD80FFC13FF6CB6FC7E6C14FE6C14F9013FEBE1
FC010F138190380060011400ED03F8A2150716F0150F000F15E0486C131F486CEB3FC015
7FEDFF804A1300EC07FE391FF01FFC90B55A6C5C6C5C6C1480C649C7FCEB3FF0273A7CB8
30>I<120FEA3FC0EA7FE0A2EAFFF0A4EA7FE0A2EA3FC0EA0F00C7FCAF120FEA3FC0EA7F
E0A2EAFFF0A4EA7FE0A2EA3FC0EA0F000C276EA630>I<EA03C0EA0FF0EA1FF8A2EA3FFC
A4EA1FF8A2EA0FF0EA03C0C7FCAFEA03C0EA0FF0121F13F8123F13FCA3121FA2120F1203
1200120113F8120313F01207EA1FE0123FEA7FC0EAFF80EA7F00127E12380E3470A630>
I<16F01503ED07F8151F157FEDFFF014034A13C0021F138091383FFE00ECFFF8495B0107
13C0495BD93FFEC7FC495A3801FFF0485B000F13804890C8FCEA7FFC5BEAFFE05B7FEA7F
F87FEA1FFF6C7F000313E06C7F38007FFC6D7E90380FFF806D7F010113F06D7FEC3FFE91
381FFF80020713C06E13F01400ED7FF8151F1507ED03F01500252F7BB230>I<007FB7FC
A2B81280A36C16006C5DCBFCA7003FB612FE4881B81280A36C1600A229157DA530>I<12
78127EB4FC13C07FEA7FF813FEEA1FFF6C13C000037F6C13F86C6C7EEB1FFF6D7F010313
E06D7F9038007FFC6E7E91380FFF806E13C0020113F080ED3FF8151F153FEDFFF05C0207
13C04A138091383FFE004A5A903801FFF0495B010F13804990C7FCEB7FFC48485A4813E0
000F5B4890C8FCEA7FFE13F8EAFFE05B90C9FC127E1278252F7BB230>I<EB1FFE90B512
E0000314F8000F14FE4880481580267FF80313C09038C0007F48C7121F16E0150FA3127E
151F0018EC7FC0C812FF020313804A13004A5AEC1FF84A5AEC7FC04A5A92C7FC495AA249
5A5CA213075CA86D5A90C9FCA8EB01C0EB07F0A2497EA36D5AA2EB01C023397AB830>I<
EC1FE0ECFFF8010313FE010F7F4914804914C090397FF03FE09038FF800F4890380007F0
D803FC13033A07F801FBF89038F007FF380FE01F4A13FCEA1FC0495A003FEBFF0F903800
FE07903901FC03FE007FEBF801EA7E03ECF000A2EAFE0700FC49137EAA00FE6D13FED87E
0314FCA2ECF801D87F0114F8003FEBFC03903900FE07F0903880FF0F001F90387FFFE06D
6C13C0EA0FE06E13803A07F007FE009038F801F86C6CC7127C6CB414FE6CEB800390387F
F01F6DB512FC6D14F86D14E0010314C00100EBFE00EC1FF0273A7CB830>I<147F4A7EA2
497FA4497F14F7A401077F14E3A3010F7FA314C1A2011F7FA490383F80FEA590387F007F
A4498049133F90B6FCA34881A39038FC001F00038149130FA4000781491307A2D87FFFEB
7FFFB56CB51280A46C496C130029397DB830>I<007FB512F0B612FE6F7E82826C813A03
F8001FF815076F7E1501A26F7EA615015EA24B5A1507ED1FF0ED7FE090B65A5E4BC7FC6F
7E16E0829039F8000FF8ED03FC6F7E1500167FA3EE3F80A6167F1700A25E4B5A1503ED1F
FC007FB6FCB75A5E16C05E6C02FCC7FC29387EB730>I<91387F803C903903FFF03E49EB
FC7E011F13FE49EBFFFE5B9038FFE07F48EB801F3903FE000F484813075B48481303A248
4813015B123F491300A2127F90C8FC167C16005A5AAC7E7EA2167C6D14FE123FA27F121F
6D13016C6C14FCA26C6CEB03F86D13076C6CEB0FF03901FF801F6C9038E07FE06DB512C0
6D14806D1400010713FC6D13F09038007FC0273A7CB830>I<003FB512E04814FCB67E6F
7E6C816C813A03F8007FF0ED1FF8150F6F7E6F7E15016F7EA2EE7F80A2163F17C0161FA4
EE0FE0AC161F17C0A3163F1780A2167F17005E4B5A15034B5A150F4B5AED7FF0003FB65A
485DB75A93C7FC6C14FC6C14E02B387FB730>I<007FB7FCB81280A47ED803F8C7123FA8
EE1F0093C7FCA4157C15FEA490B5FCA6EBF800A4157C92C8FCA5EE07C0EE0FE0A9007FB7
FCB8FCA46C16C02B387EB730>I<003FB712804816C0B8FCA27E7ED801FCC7121FA8EE0F
8093C7FCA5153E157FA490B6FCA69038FC007FA4153E92C8FCAE383FFFF8487FB5FCA27E
6C5B2A387EB730>I<02FF13F00103EBC0F8010F13F1013F13FD4913FF90B6FC4813C1EC
007F4848133F4848131F49130F485A491307121F5B123F491303A2127F90C7FC6F5A92C8
FC5A5AA892B5FC4A14805CA26C7F6C6D1400ED03F8A27F003F1407A27F121F6D130F120F
7F6C6C131FA2D803FE133F6C6C137FECC1FF6C90B5FC7F6D13FB010F13F30103EBC1F001
0090C8FC293A7DB830>I<3B3FFF800FFFE0486D4813F0B56C4813F8A26C496C13F06C49
6C13E0D803F8C7EAFE00B290B6FCA601F8C7FCB3A23B3FFF800FFFE0486D4813F0B56C48
13F8A26C496C13F06C496C13E02D387FB730>I<007FB6FCB71280A46C1500260007F0C7
FCB3B3A8007FB6FCB71280A46C1500213879B730>I<49B512F04914F85BA27F6D14F090
C7EAFE00B3B3123C127EB4FCA24A5A1403EB8007397FF01FF86CB55A5D6C5C00075C0001
49C7FC38003FF025397AB730>I<D83FFF90380FFF80486D4813C0B56C5AA26C497E6C49
6C1380D803F0903803F8004B5A4B5A151F4B5A5E4BC7FC15FE14014A5A5D4A5A4A5A141F
5D4A5A4AC8FC5C13F18101F37F13F790B57E14EFECC7F01483EC03F8140101FE7F496C7E
5B157F497F82151F82150F826F7EA26F7E1501821500D83FFF903803FFC0486D4813E0B5
6C5AA26C497E6C496C13C02B387FB730>I<383FFFF8487FB57EA26C5B6C5BD801FCC9FC
B3B0EE0F80EE1FC0A9003FB7FC5AB8FCA27E6C16802A387EB730>I<D83FF8ECFFE0486C
4913F0486C4913F8A2007F16F06C6C4913E00007160001EF14BFEC800FA39039E7C01F3F
A4ECE03F01E3133EA2ECF07EA201E1137CA2ECF8FCA201E013F8A214FDEC7DF0A3147FEC
3FE0A3EC1FC0A2EC070091C7FCADD83FFC903801FFE0486C4913F0B54913F8A26C486D13
F06C486D13E02D387FB730>I<D83FFC90381FFF80486C4913C0B54913E0A26C6D6C13C0
6C6E13800003913801F800EBF7C0A3EBF3E0A314F013F1A214F8A213F014FCA2147C147E
A2143E143FA2141FA21581A2140F15C1A2140715E1A2140315F1A21401A215F91400A315
7DA3153FEA3FFF481380B5EAC01FA26CEB800F6C496C5A2B387EB730>I<90383FFFE048
B512FC000714FF4815804815C04815E0EBF80001E0133FD87F80EB0FF0A290C71207A448
15F8481403B3A96C1407A26C15F0A36D130FA26D131F6C6CEB3FE001F813FF90B6FC6C15
C06C15806C1500000114FCD8003F13E0253A7BB830>I<007FB512F0B612FE6F7E16E082
6C813903F8003FED0FFCED03FE15016F7EA2821780163FA6167F17005EA24B5A1503ED0F
FCED3FF890B6FC5E5E16804BC7FC15F001F8C9FCB0387FFFC0B57EA46C5B29387EB730>
I<90383FFFE048B512FC000714FF4815804815C04815E0EBF80001E0133F4848EB1FF049
130F90C71207A44815F8481403B3A8147E14FE6CEBFF076C15F0EC7F87A2EC3FC7018013
CF9038C01FFFD83FE014E0EBF80F90B6FC6C15C06C15806C1500000114FCD8003F7FEB00
016E7EA21680157F16C0153F16E0151F16F0150FED07E025467BB830>I<003FB57E4814
F0B612FC15FF6C816C812603F8017F9138003FF0151F6F7E15071503821501A515035E15
07150F4B5A153F4AB45A90B65A5E93C7FC5D8182D9F8007FED3FE0151F150F821507A817
F8EEF1FCA53A3FFF8003FB4801C0EBFFF8B56C7E17F06C496C13E06C49EB7FC0C9EA1F00
2E397FB730>I<90390FF803C0D97FFF13E048B512C74814F74814FF5A381FF80F383FE0
01497E4848137F90C7123F5A48141FA2150FA37EED07C06C91C7FC7F7FEA3FF0EA1FFEEB
FFF06C13FF6C14E0000114F86C80011F13FF01031480D9003F13C014019138007FE0151F
ED0FF0A2ED07F8A2007C140312FEA56C140716F07F6DEB0FE06D131F01F8EB3FC001FF13
FF91B51280160000FD5CD8FC7F13F8D8F81F5BD878011380253A7BB830>I<003FB712C0
4816E0B8FCA43AFE003F800FA8007CED07C0C791C7FCB3B1011FB5FC4980A46D91C7FC2B
387EB730>I<3B7FFFC007FFFCB56C4813FEA46C496C13FCD803F8C7EA3F80B3B16D147F
00011600A36C6C14FE6D13016D5CEC800390393FE00FF890391FF83FF06DB55A6D5C6D5C
6D91C7FC9038007FFCEC1FF02F3980B730>I<D87FFE90380FFFC0B54913E06E5AA24A7E
6C486D13C0D807F0903801FC00A26D130300035DA46C6C495AA46C6C495AA46D131F6D5C
A3EC803F013F5CA46D6C48C7FCA490380FE0FEA401075B14F1A301035BA314FB01015BA3
14FFA26D5BA46E5A6E5A2B397EB730>I<D83FFC903801FFE0486C4913F000FF16F8A200
7F16F06C486D13E0D81FC09038001FC0000F1680A76D143F00071600A7000390380F803E
9039F01FC07EEC3FE0A3EC7FF0A2147D0001157CA29039F8FDF8FCA314F8A300005D01F9
13FCA2ECF07CA201FD137DA2017D5CECE03DA3017F133FA2ECC01FA2013F5CA2EC800F6D
486C5A2D397FB730>I<3A3FFF01FFF84801837F02C77FA202835B6C01015B3A01FC007F
806D91C7FC00005C6D5BEB7F01EC81FCEB3F8314C3011F5B14E7010F5B14FF6D5BA26D5B
A26D5BA26D90C8FCA4497FA2497FA2815B81EB0FE781EB1FC381EB3F8181EB7F0081497F
49800001143F49800003141F49800007140FD87FFEEB7FFFB590B5128080A25C6C486D13
0029387DB730>I<D87FFF90381FFFC0B56C4813E0A46C496C13C0D803F8903803F8006D
1307A26C6C495AA26C6C5C151F6D5CEC803F013F5CECC07F011F91C7FCA290380FE0FEA2
14F101075BA2903803FBF8A201015B14FF6D5BA26E5AA36E5AB1903803FFF8497F497FA2
6D5B6D5B2B387EB730>I<001FB612FC4815FE5AA490C7EA03FCED07F816F0150FED1FE0
16C0153FED7F80003E1500C85A4A5A5D14034A5A5D140F4A5A5D143F4A5A92C7FC5C495A
5C1303495A5C130F495A5C133F495A91C8FC5B4848147C4914FE1203485A5B120F485A5B
123F485A90B6FCB7FCA46C15FC27387CB730>I<007FB5FCB61280A4150048C8FCB3B3B3
A5B6FC1580A46C140019476DBE30>I<127CA212FEA27EA26C7EA26C7EA26C7EA26C7EA2
6C7EA26C7EA212017FA26C7EA26D7EA26D7EA26D7EA26D7EA26D7EA26D7EA2130180A26D
7EA26E7EA26E7EA26E7EA26E7EA26E7EA26E7EA2140181A26E7EA2ED7F80A2ED3FC0A2ED
1FE0A2ED0FF0A2ED07F8A21503A2ED01F0150025477BBE30>I<007FB5FCB61280A47EC7
123FB3B3B3A5007FB5FCB6FCA46C140019477DBE30>I<1307EB1FC0EB7FF0497E000313
FE000FEBFF80003F14E0D87FFD13F039FFF07FF8EBC01FEB800F38FE0003007CEB01F000
10EB00401D0E77B730>I<007FB612F0A2B712F8A36C15F0A225077B7D30>I<1338137CEA
01FE12031207EA0FFC13F0EA1FE013C0EA3F8013005A127EA212FE5AA5EAFFC013E013F0
127FA2123FA2EA1FE0EA07C00F1D70BE30>I<EB7FF80003B5FC4814C048804880488090
38E01FFC9038C003FE14016E7E6C487F6CC77FC8123FA491B5FC130F137F48B6FC12075A
48EB803F383FF800EA7FE0138048C7FC5AA4157F7E6C6C13FFEBC003263FF01FEBFF8090
B712C07E6C14EF000314876CD9FE01138026003FE0C8FC2A2A7BA830>I<EA3FFC487E12
FFA2127F123F1200AAEC03FE91381FFF80027F13E091B57E90B612FC82ECFE079138F001
FF4A6C13804A137F4AEB3FC091C7121F17E049140FA217F01607A8160FA217E07F161F6E
EB3FC0A26EEB7F806E13FFDAF00313009138FC0FFE91B55A5E495CD97E7F13C0D93C1F90
C7FC90380003FC2C3980B730>I<ECFFE0010713FC011F7F017F7F90B612804815C048EB
807F3907FC003F485A485A49EB1F804848EB0F004990C7FC127F90C9FCA25A5AA87E7EA2
7F003FEC07C06DEB0FE06C7E6D131F6C6C14C0D807FE133F9039FFC0FF806C90B5FCC615
006D5B011F13F801075B01011380232A7AA830>I<913801FFE04A7F5CA28080EC0007AA
EB03FE90381FFF874913E790B6FC5A5A481303380FFC00D81FF0133F49131F485A150F48
48130790C7FCA25AA25AA87E6C140FA27F003F141F6D133F6C7E6D137F390FF801FF2607
FE07EBFFC06CB712E06C16F06C14F76D01C713E0011F010313C0D907FCC8FC2C397DB730
>I<49B4FC010713E0011F13F8017F7F90B57E488048018113803A07FC007FC04848133F
D81FE0EB1FE0150F484814F0491307127F90C7FCED03F85A5AB7FCA516F048C9FC7E7EA2
7F003FEC01F06DEB03F86C7E6C7E6D1307D807FEEB1FF03A03FFC07FE06C90B5FC6C15C0
013F14806DEBFE00010713F8010013C0252A7CA830>I<EDFF80020713E0021F13F05C4A
13F891B5FC491387903803FE079138FC03F0903907F800C04A1300A8003FB612C04815E0
B7FCA36C15C0260007F0C7FCB3A9003FB512FE4880B71280A26C15006C5C25397DB830>
I<D903FC13FF90261FFF8713C04913DF90B712E05A5A2607FE07138F903AF801FE07C048
486C6CC7FCA2497F001F8149133FA56D137F000F92C7FC6D5BA26C6C485AEBFE0790B55A
5D485C15C001DF5BD9C3FCC8FC01C0C9FCA37F7F6CB512F015FF6C15C04815F048814881
3A3FE0001FFE0180130148C8127F007E8100FE168048151FA56C153F007FED7F006D5C6C
6C495A01F013076CB4EB7FFC6C90B55A6C5D000115C06C6C91C7FC011F13FC010113C02B
3E7DA730>I<EA3FFC487E12FFA2127F123F1200AAEC01FE91380FFF80023F13E091B57E
90B67EA29138FE07FCECF8039138E001FE14C0EC8000A291C7FCA25BB3A23B3FFFF81FFF
F8486D4813FCB500FE14FEA26C01FC14FC6C496C13F82F3880B730>I<14E0EB03F8A249
7EA36D5AA2EB00E091C8FCA9381FFFF8487F5AA27E7EEA0001B3A9003FB612C04815E0B7
FCA27E6C15C023397AB830>I<EC01C0EC07F0A2EC0FF8A3EC07F0A2EC01C091C7FCA990
B512F04814F8A47EEB0003B3B3A5EC07F0A2123C007EEB0FE0B4131FEC3FC0147F90B512
806C14005C6C5B000F13F0000313C01D4E7CB830>I<EA7FF8487EA4127F1200AB0203B5
12804A14C017E0A217C06E14809139001FE0004B5A4B5A4BC7FC4A5A4A5AEC0FF84A5A4A
5A4A5A4A5A01FD7F90B57E8114F7ECE3F8ECC1FCEC81FEEC00FF497F496D7E6F7E826F7E
15076F7E6F7E3B7FFFF81FFFE0B56C4813F017F8A217F06C496C13E02D387FB730>I<38
7FFFF8B57EA47EEA0001B3B3A8007FB612F0B712F8A46C15F025387BB730>I<02FC137E
3B7FC3FF01FF80D8FFEF01877F90B500CF7F15DF92B57E6C010F13872607FE07EB03F801
FC13FE9039F803FC01A201F013F8A301E013F0B3A23C7FFE0FFF07FF80B548018F13C0A4
6C486C01071380322881A730>I<EC01FE3A3FFC0FFF80267FFE3F13E000FF90B57E90B6
7E7E6C9038FE07FCC6EBF8039138E001FE14C0EC8000A291C7FCA25BB3A23B3FFFF81FFF
F8486D4813FCB500FE14FEA26C01FC14FC6C496C13F82F2880A730>I<49B4FC010F13E0
013F13F8497F90B57E0003ECFF8014013A07FC007FC04848EB3FE0D81FE0EB0FF0A24848
EB07F8491303007F15FC90C71201A300FEEC00FEA86C14016C15FCA26D1303003F15F86D
13076D130F6C6CEB1FF06C6CEB3FE06D137F3A07FF01FFC06C90B512806C15006C6C13FC
6D5B010F13E0010190C7FC272A7CA830>I<EC03FE3A3FFC1FFF80267FFE7F13E000FF90
B57E90B612FC6C816CEBFE07C69038F001FF4A6C13804A137F4AEB3FC091C7121F17E049
140FA217F01607A8160FA217E07F161F6EEB3FC0A26EEB7F806E13FFDAF00313009138FC
0FFE91B55A5E495C6E13C0021F90C7FCEC03FC91C9FCAD383FFFF8487FB57EA26C5B6C5B
2C3C80A730>I<49B413F8010FEBC1FC013F13F14913FD48B6FC5A481381390FFC007F49
131F4848130F491307485A491303127F90C7FC15015A5AA77E7E15037FA26C6C1307150F
6C6C131F6C6C133F01FC137F3907FF01FF6C90B5FC6C14FD6C14F9013F13F1010F13C190
3803FE0190C7FCAD92B512F84A14FCA46E14F82E3C7DA730>I<ED07F83A3FFF803FFF48
6DB51280B512C302CF14C06C13DF6C9038FFFC3FD8001F13E09238801F809238000F004A
90C7FC5C5C5CA25CA45CAF003FB512FC4880B7FCA26C5C6C5C2A287EA730>I<90381FFC
1E48B5129F000714FF5A5A5A387FF007EB800100FEC7FC4880A46C143E007F91C7FC13E0
6CB4FC6C13FC6CEBFF806C14E0000114F86C6C7F01037F9038000FFF02001380007C147F
00FEEC1FC0A2150F7EA27F151F6DEB3F806D137F9039FC03FF0090B6FC5D5D00FC14F0D8
F83F13C026780FFEC7FC222A79A830>I<EB0780497E131FA9003FB612E04815F0B7FCA3
6C15E026001FC0C7FCB216F8ED01FCA5ECE003010FEB07F814F09138FC1FF06DB512E06D
14C016806D14009038007FFCEC1FF026337EB130>I<D83FFCEB3FFC486C497E00FF14FF
A2007F147F003F143F00001400B3A41501A2150315076D130F903A7FC07FFFF891B612FC
6D15FE7F6D4913FC6D9038F87FF8010001C0C7FC2F2880A630>I<3B3FFFC07FFF80486D
B512C0B515E0A26C16C06C496C13803B01F80003F000A26D130700005DA26D130F017E5C
A2017F131F6D5CA2EC803F011F91C7FCA26E5A010F137EA2ECE0FE01075BA214F101035B
A3903801FBF0A314FF6D5BA36E5A6E5A2B277EA630>I<3B3FFFC01FFFE0486D4813F0B5
15F8A26C16F06C496C13E0D807E0C7EA3F00A26D5C0003157EA56D14FE00015DEC0F80EC
1FC0EC3FE0A33A00FC7FF1F8A2147DA2ECFDF9017C5C14F8A3017E13FBA290393FF07FE0
A3ECE03FA2011F5C90390F800F802D277FA630>I<3A3FFF81FFFC4801C37FB580A26C5D
6C01815BC648C66CC7FC137FEC80FE90383F81FC90381FC3F8EB0FE3ECE7F06DB45A6D5B
7F6D5B92C8FC147E147F5C497F81903803F7E0EB07E790380FE3F0ECC1F890381F81FC90
383F80FE90387F007E017E137F01FE6D7E48486D7E267FFF80B5FCB500C1148014E3A214
C16C0180140029277DA630>I<3B3FFFC07FFF80486DB512C0B515E0A26C16C06C496C13
803B01FC0003F000A2000014076D5C137E150F017F5C7F151FD91F805BA214C0010F49C7
FCA214E00107137EA2EB03F0157C15FCEB01F85DA2EB00F9ECFDF0147D147FA26E5AA36E
5AA35DA2143F92C8FCA25C147EA2000F13FE486C5AEA3FC1EBC3F81387EB8FF0EBFFE06C
5B5C6C90C9FC6C5AEA01F02B3C7EA630>I<001FB612FC4815FE5AA316FC90C7EA0FF8ED
1FF0ED3FE0ED7FC0EDFF80003E491300C7485A4A5A4A5A4A5A4A5A4A5A4A5A4990C7FC49
5A495A495A495A495A495A4948133E4890C7127F485A485A485A485A485A48B7FCB8FCA4
6C15FE28277DA630>I<ED3FF0913803FFF8140F5C147F16F09138FFF00092C7FC495A5C
B3A21303495A133F383FFFF0B55A5C91C8FC14C080003F7F38003FF813076D7E1301B3A2
806D7E15F091387FFFF016F8141F8014039138003FF025477BBE30>I<127CA212FEB3B3
B3AD127CA207476CBE30>I<EA7FE0EAFFFE6D7E8014F07EC66C7E13076D7E1301B3A280
6D7E15E091387FFFE06E13F8801407141F5C4A13E09138FFE00092C7FC495A5CB3A21303
495A137F387FFFF0B5FC14C05C49C8FCEA7FE025477BBE30>I<017C133848B4137C48EB
80FE4813C14813C348EBEFFC397FEFFFF0D8FF8713E0010713C0486C1380D87C01130038
38007C1F0C78B730>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fl cmbx10 10.95 71
/Fl 71 124 df<EDFFF8020F13FF027F8049B612E001079038C01FF090390FFE0007D91F
F8497ED93FE0131F4948497E13FF5C5A91C7FCA2705A705AEE03C093C8FCA6EE03FCB8FC
A50001903880001F160FB3AB007FD9FE03B512F0A534407EBF3A>12
D<D80FC0EB1F80486CEB3FC0486CEB7FE0486CEBFFF0486C4813F8A301FE14FCA3007F7F
003F147F001F143FD80FDEEB1FBCD8001EEB003CA2013E147C013C1478A2017C14F80178
14F0A201F813014848EB03E0A24848EB07C04848EB0F804848EB1F00001F5C48C7127E00
3E147C001C143826207DBE37>34 D<EC0780140F141FEC3E0014FE495A495A5C495A130F
495A495AA249C7FC5B5B1201485AA212075BA2120F5B121FA3485AA4127F5BA512FFB012
7FA57F123FA46C7EA3120F7F1207A27F1203A26C7E12007F7F6D7EA26D7E6D7E13076D7E
806D7E6D7E143EEC1F80140F1407195A77C329>40 D<127012F8127C7EEA3F806C7E6C7E
12076C7E7F6C7E6C7EA2137F80133F806D7EA280130FA280130780A36D7EA4807FA51580
B01500A55B5CA4495AA35C130F5CA2131F5CA2495A5C137F91C7FC13FEA2485A485A5B48
5A120F485A485A003EC8FC5A5A1270195A7AC329>I<16F04B7EB3AD007FBA12E0BB12F0
A46C19E0C8D801F8C9FCB3AD6F5A44467AB951>43 D<EA0FC0EA1FE0EA3FF0EA7FF8EAFF
FCA313FEA3127F123F121FEA0FDEEA001EA2133E133CA2137C1378A213F8EA01F0A2EA03
E0EA07C0EA0F80121FEA3F00121E120C0F20798D1D>I<B612E0A91B097F9823>I<EA0FC0
EA1FE0EA3FF0EA7FF8EAFFFCA6EA7FF8EA3FF0EA1FE0EA0FC00E0E798D1D>I<161C163E
167EA216FE16FC150116F8A2150316F0A2150716E0150F16C0A2151F1680153F1600A25D
157E15FE5DA214015DA214035D14075DA2140F5D141F5DA2143F92C7FC5C147EA214FE5C
A213015C13035CA213075C130F5CA2131F5C133F91C8FCA25B137EA213FE5B12015BA212
035B12075BA2120F5B121F5BA2123F90C9FCA25A127E12FE5AA25A1278275B7AC334>I<
ECFFE0010713FC011F13FF017F14C0D9FFE07F489038803FF03A03FE000FF848486D7EA2
48486D7E001F81A348486D1380A3007F16C0A500FF16E0B3A2007F16C0A5003F16806D5B
A2001F1600A2000F5D6D13076C6C495A6C6C495A6C6D485A6C9038E0FFE06DB55A011F91
C7FC010713FC010013E02B3D7CBB34>I<140F143F5C495A130F48B5FCB6FCA313F7EAFE
071200B3B3A8007FB612F0A5243C78BB34>I<903803FF80013F13F890B512FE00036E7E
4881260FF80F7F261FC0037F4848C67F486C6D7E6D6D7E487E6D6D7EA26F1380A46C5A6C
5A6C5A0007C7FCC8FC4B1300A25E153F5E4B5AA24B5A5E4A5B4A5B4A48C7FC5D4A5AEC1F
E04A5A4A5A9139FF000F80EB01FC495A4948EB1F00495AEB1F8049C7FC017E5C5B48B7FC
485D5A5A5A5A5AB7FC5EA4293C7BBB34>I<903801FFE0010F13FE013F6D7E90B612E048
01817F3A03FC007FF8D807F06D7E82D80FFC131F6D80121F7FA56C5A5E6C48133FD801F0
5CC8FC4B5A5E4B5A4A5B020F5B902607FFFEC7FC15F815FEEDFFC0D9000113F06E6C7E6F
7E6F7E6F7E1780A26F13C0A217E0EA0FC0487E487E487E487EA317C0A25D491580127F49
491300D83FC0495A6C6C495A3A0FFE01FFF86CB65A6C5DC61580013F49C7FC010313E02B
3D7CBB34>I<ED01F815031507A2150F151F153FA2157F15FF5C5CA25C5CEC1FBFEC3F3F
143E147C14FCEB01F814F0EB03E01307EB0FC0EB1F801400133E137E5B485A5B485A1207
485A5B48C7FC5A127E5AB812F8A5C8387FF800AA49B612F8A52D3C7DBB34>I<00071538
D80FE0EB01F801FE133F90B6FC5E5E5E5E93C7FC5D15F85D15C04AC8FC0180C9FCA9ECFF
C0018713FC019F13FF90B67E020113E09039F8007FF0496D7E01C06D7E5B6CC77FC8120F
82A31780A21207EA1FC0487E487E12FF7FA21700A25B4B5A6C5A01805C6CC7123F6D495A
D81FE0495A260FFC075B6CB65A6C92C7FCC614FC013F13F0010790C8FC293D7BBB34>I<
EC07FF023F13C049B512F001078049EB03FC90383FF80090397FE001FE9038FFC0034849
487E48495AA2485A120FA2485A6F5A003F6E5A6F5A92C8FC485AA21402EC3FFE00FF496C
7E01F9B512E001FB809138E03FF89039FF800FFC4A6C7E825B6F13804915C0A317E05BA4
127FA5123FA26D15C0121FA2000F4A13806D150012076C6C495A6C6D485A6C9038E07FF8
6DB55A6D5C6D1480010749C7FC010013F02B3D7CBB34>I<121F7F13F890B712F0A45A17
E017C0178017005E5E5A007EC7EA01F84B5A007C4A5A4B5A4B5A93C7FC485C157E5DC748
5A4A5AA24A5A140F5D141F143F5D147FA214FF92C8FC5BA25BA3495AA3130FA5131FAA6D
5A6D5A6D5A2C3F7ABD34>I<ECFFF0010713FE011F6D7E017F14E09039FFC07FF03A01FE
001FF848486D7E48486D7E1503485A8281121FA27F7F7F6D5B02C05B14F06C6D485A9138
FE0FF89138FF9FF06CECFFE06C5D5E6C92C7FC6C816D14E0011F80498090B67E48812607
FE3F7F48486C1480381FF807D9F00114C048486C7E007F8049010F13E0150348487F8116
7FA2163FA36D15C0127FEE7F807F6C6CECFF006C6C5B01FEEB07FE3A0FFFC03FFC6C90B5
5A000115E06C6C5C011F49C7FC010113F02B3D7CBB34>I<903801FFE0010F13FC013F13
FF90B612C04801E07F489038003FF048486D7E000F6E7E485A6F7E123F48488081178012
FFA217C0A517E0A4007F5CA4003F5C6C7E5D6C7E00075C3903FF80FB6C13FF6C6C13F36D
13C3010F018313C090380008031400A24B1380EA03F0487E486C1500487E4B5AA25E151F
4B5A495C6C48EBFFE049485B2607FC0F5B6CB6C7FC6C14FC6C14F06D13C0D90FFEC8FC2B
3D7CBB34>I<EA0FC0EA1FE0EA3FF0EA7FF8EAFFFCA6EA7FF8EA3FF0EA1FE0EA0FC0C7FC
ACEA0FC0EA1FE0EA3FF0EA7FF8EAFFFCA6EA7FF8EA3FF0EA1FE0EA0FC00E2879A71D>I<
16FCA24B7EA24B7EA34B7FA24B7FA34B7FA24B7FA34B7F157C03FC7FEDF87FA2020180ED
F03F0203804B7E02078115C082020F814B7E021F811500824A81023E7F027E81027C7FA2
02FC814A147F49B77EA34982A2D907E0C7001F7F4A80010F835C83011F8391C87E498313
3E83017E83017C81B500FC91B612FCA5463F7CBE4F>65 D<B812F8EFFF8018F018FC8426
003FFCC7EA3FFF050F13807113C07113E08319F0A27113F8A719F05FA24D13E019C04D13
804D1300EF3FFE933801FFF891B712E0188018F818FE02FCC7380FFF80050313C07113E0
7113F019F8F07FFCA2F03FFEA219FFA38460A419FE187FA2F0FFFC4D13F85F4D13F0053F
13E0BA12C0190018FC18F095C7FC403E7DBD4A>I<922607FFC0130E92B500FC131E0207
02FF133E023FEDC07E91B7EAE1FE01039138803FFB499039F80003FF4901C01300013F90
C8127F4948151FD9FFF8150F48491507485B4A1503481701485B18004890CAFC197E5A5B
193E127FA349170012FFAC127F7F193EA2123FA27F6C187E197C6C7F19FC6C6D16F86C6D
150119F06C6D15036C6DED07E0D97FFEED0FC06D6CED3F80010F01C0ECFF006D01F8EB03
FE6D9039FF801FFC010091B55A023F15E002071580020002FCC7FC030713C03F407ABE4C
>I<B812F8EFFF8018F018FC18FF26003FFCC76C13C005077F05017F716C7E727E727E72
7E721380A27213C0A27213E0A21AF084A21AF8A41AFCA5197FA319FFA51AF8A41AF0A260
1AE0A24E13C0A24E13804E1300604E5A4E5A4D485A050713E0057F5BBA5A4EC7FC18F818
C005F8C8FC463E7DBD50>I<BAFCA4198026003FFEC7123F1707170183183FA2181FF00F
C0A31807EE07C0A3F003E0A3160F95C7FC161F163F16FF91B6FCA54AC6FC163F161F040F
147CA2160719F8A593C71201A219F01803A21807A2180FF01FE0183F18FF1703173FBAFC
A219C0A33E3D7DBC45>I<B912FEA48426003FFEC77E170F1703170084A284F01F80A318
0FA2EE07C0A2F007C0A4040F90C7FCA2161F163F16FF91B6FCA54AC6FC163F161F160FA2
1607A693C9FCACB712E0A53A3D7DBC42>I<922607FFC0130E92B500FC131E020702FF13
3E023FEDC07E91B7EAE1FE01039138803FFB499039F80003FF4901C01300013F90C8127F
4948151FD9FFF8150F48491507485B4A1503481701485B18004890CAFC197E5A5B193E12
7FA34994C7FC12FFAB0407B612FC127F7FA3003F92C7383FFE00A27F7EA26C7FA26C7F6C
7FA26C7F6C7FD97FFE157F6D6C7E010F01E014FF6D01F813036D9038FF801F010091B512
F3023F15C00207ED803E02009138FE000E030701E090C7FC46407ABE52>I<B7D8803FB6
12E0A526003FFEC8000FEB8000B3A491B9FCA54AC8120FB3A7B7D8803FB612E0A54B3E7D
BD52>I<B71280A526003FFEC7FCB3B3B0B71280A5213E7DBD28>I<B76C90B6FCA526003F
FEC8D801FCC7FCF007F84E5A4E5AF03F804EC8FC18FEEF03FC4D5A4D5AEF1FC04D5A4DC9
FCEE01FE4C5A4C5AEE0FE04C5A4C5A16FF4B7F4B7F5D4B7F4B7F037F7F92B5FC6E486C7E
9238F83FFF03F0804B7E4B6C7F4B6C7F0300804A7F707F707F84717E83717F85717F8371
7F85717F83727E85727F84B7D88007B612C0A54A3E7DBD52>75 D<B712E0A526003FFEC9
FCB3AD183EA4187E187CA418FCA21701A2EF03F8A21707170F171F177FEE01FF160FB9FC
18F0A4373E7DBD3F>I<B6051FB512C06F5EA26F5EA2D8003F97C7FC6F16F7A26E6CED01
E7A26E6CED03C7A36E6CED0787A26E6CED0F07A26E6C151EA36E6D143CA26E6D1478A26E
6D14F0A26F6CEB01E0A36F6CEB03C0A26F6CEB0780A26F6CEB0F00A36F6C131EA26F6D5A
A26F6D5AA26F6D5AA393387FF1E0A293383FFBC0A270B45AA37090C7FCA2705AA2705AB6
00C0031FB612C0A2705AA2705A5A3E7CBD63>I<B6037FB512E0A2818181D8003F6D9139
001F800081A281816E7E6E7F6E7F80826E7F6E7F6E7F6E7F157F826F7F6F7F6F7F6F7F81
836F7F6F7F707E701380A27013C07013E07013F07013F87013FCA27013FEEF7FFF71139F
7113DF8319FF8383838384A28484848484A284B600C080197F193F191FA24B3E7DBD52>
I<ED3FFF0203B512F0021F14FE027F6E7E902701FFF80713E00107D9C00013F84990C7EA
3FFCD93FFCEC0FFF49486E7F49486E7F48496E7F4A80488448496F7EA24890C96C7E4884
A249161F003F84A34848701380A400FF19C0AD007F19806D5EA3003F1900A26D5E6C60A2
6C6D4B5AA26C6D4B5A6C6D4A5BA26C6D4A5B6C6D4A5B6D6C4A5B6DB4023F90C7FC6D01C0
EBFFFE0107D9F80713F8010190B612E06D5E021F4AC8FC020314F0DA003F90C9FC42407A
BE4F>I<B812F017FF18C018F018FC26003FFCC77FEF1FFF7113807113C07113E0A27113
F0A319F8A819F0A34D13E019C05F4D1380053F1300EFFFFE91B712F860188005FCC7FC4A
CAFCB3A4B77EA53D3E7DBD47>I<ED3FFF0203B512F0021F14FE027F6E7E902701FFF807
13E00107903980007FF84948C7EA1FFCD93FFC6EB4FC49486E7F49486E7F48496E7F4A80
48496F7E488491C9123F48844848707EA34848707EA3007F1980A24982A200FF19C0AD00
7F1980A26D5EA2003F1900A36C6C4C5AA26C6C4C5AED07F06C9026801FFC495A6C4AB45C
6E48EB80FF6C9027E07E0FC15B6C9126F807E15B90287FF0F003E35BD93FFC6DB5C7FCD9
1FFE6D5B902607FFF814F80101D9FE0313E06D90B65A021F4AC7124002036E14E0DA003F
EB3F8092C77FF0E001F0F80F71B5FCA21AC083A21A8083A271140061715B715B725AF01F
C043517ABE4F>I<B87E17FCEFFF8018F08428003FFC000113FE9338003FFF050F7F717F
717FA2858385A761A25F61614D5B4D90C8FCEF3FFE4CB45A91B712F018C04DC9FC717E91
26FC000F7F040113F0707F717EA2717EA2717EA685A6F207C019C0A271140F07E01380B7
6DEBF01F719038FC3F007190B5FC716C5B061F13F8CB000113E04A3F7DBD4E>I<903A03
FFC001C0011FEBF803017FEBFE0748B6128F4815DF48010013FFD80FF8130F4848130349
7F4848EB007F127F49143F161F12FF160FA27F1607A27F7F01FC91C7FCEBFF806C13F8EC
FFC06C14FCEDFF806C15E016F86C816C816C816C16806C6C15C07F010715E0EB007F0207
14F0EC003F1503030013F8167F163F127800F8151FA2160FA27EA217F07E161F6C16E06D
143F01E015C001F8EC7F8001FEEB01FF9026FFE00713004890B55A486C14F8D8F81F5CD8
F00314C027E0003FFEC7FC2D407ABE3A>I<003FB912FCA5903BFE003FFE003FD87FF0EE
0FFE01C0160349160190C71500197E127EA2007C183EA400FC183F48181FA5C81600B3AF
010FB712F8A5403D7CBC49>I<B76C90B61280A526003FFEC9003EC7FCB3B3A4197E011F
177C80A26D17FC616D6D14014E5A6D6D4A5A6D6D140F6D01F8EC3FC0DA7FFEECFF809127
3FFFC00F90C8FC020F90B512FC02035D020015E0031F1480030101F8C9FC493F7DBD50>
I<B600FC020FB512C0A5C66C48C9381F8000013F95C7FC80616D173E6F157E6D177C6F15
FC6D5F8118016D6D5D18036D5F6F14076D5F6F140F027F5E81181F023F93C8FC6F5C6E15
3E70137E6E157C8218FC6E6D5B17016E5DEEF0036E5DEEF8076E5D16FC170F037F5CEEFE
1F033F91C9FC705A6F133E17BE17FE6F5BA26F5BA26F5BA26F5BA36F5BA2705AA270CAFC
A24A3F7EBD4F>I<B6D8FC03B600F090B512FEA5C601FCC7000301F0C8EA7E00017F6F17
7C856E6E17FC013F63856D6C037F4B5AA26F4A6C14036D634D7F6F18076D634D806F02EF
150F6D636F01076E131F6D04C793C7FC050F806F02835D6D1A3E051F806F0201157E027F
197C6F013F6E13FC023FDA3E005D057E806F017C017F13016E6105FC14FE7048013F1303
6E6104C1EDFF076E4A6D5C04C31687DCE3E06D138F6E6104E716CFDCF7C06D13DF6E96C8
FC04FF16FF6E4A6D5BA294C77E6F5FA24C80033F5FA26F486F5AA24C153F030F5FA24C15
1F03075FA26F486F5A673F7EBD6C>I<B600FE020FB512C0A5C66C90C9381F80006D6D4B
C7FC6D6D157EA26D6D5D6D6D4A5A816D4C5A6D6D4A5A816D4C5A6E6C4A5A6E7F4EC8FC6E
6D137E6E7F606E6D485A6E13F84D5A6E6D485A6E13FE70485A6F495A6F139F05FFC9FC6F
5B815F6F5B816F5B5FB3A20207B612F8A54A3E7EBD4F>89 D<003FB812E0A59126E0001F
13C091C7148001FC5C01F04A1300495D4914FF4848495B5F90C75A4B5B007E5E5D4B5B00
7C5E5D4B90C7FC5E15FFC7485B5E4A5B5C5E4A5B5C5E4A90C8FC5C5D4A5A5B4BEB01F049
5B5B495B5D491503494914E092C7FC5B495A4A14075A4849140F5C48161F4849143F4A14
7F4816FF48495B91C7000713C048157FB9FCA5343E7ABD40>I<017014E001F8EB01F000
0114034848EB07E04914C04848EB0F804848EB1F0048C7123EA2003E5C003C1478A2007C
14F800785CA200F81301485CA2D8F7E0EBEFC0D8FFF0EBFFE001F814F001FC14F801FE14
FCA3007F7FA36C48EB7FF86C48EB3FF06C48EB1FE06C48EB0FC0262073BE37>92
D<903807FFC0013F13F848B6FC48812607FE037F260FF8007F6DEB3FF0486C806F7EA36F
7EA26C5A6C5AEA01E0C8FC153F91B5FC130F137F3901FFFE0F4813E0000F1380381FFE00
485A5B485A12FF5BA4151F7F007F143F6D90387BFF806C6C01FB13FE391FFF07F36CEBFF
E100031480C6EC003FD91FF890C7FC2F2B7DA933>97 D<13FFB5FCA512077EAFEDFFE002
0713FC021FEBFF80027F80DAFF8113F09139FC003FF802F06D7E4A6D7E4A13074A807013
80A218C082A318E0AA18C0A25E1880A218005E6E5C6E495A6E495A02FCEB7FF0903AFCFF
01FFE0496CB55AD9F01F91C7FCD9E00713FCC7000113C033407DBE3A>I<EC7FF00107B5
FC011F14C0017F14E09039FFF01FF0489038800FF848EB001F4848EB3FFC120F485AA248
5AA2007FEC1FF849EB0FF0ED03C000FF91C7FCAB127F7FA3003F153E7F001F157E6C6C14
7C6C6C14FC91388001F86C9038C003F0C69038F81FE06DB512C0011F14800107EBFE0090
38007FF0272B7DA92E>I<EE07F8ED07FFA5ED003F161FAFEC7FF0903807FFFE011FEBFF
9F017F14DF9039FFF01FFF48EBC00348EB00014848EB007F485A001F153F5B123FA2127F
5BA212FFAA127FA37F123FA26C6C147F120F6D14FF6C6C01037F6C6D48EBFFE06CEBF03F
6C6CB512BF6D143F010713FC010001E0EBE00033407DBE3A>I<ECFFF0010713FE011F6D
7E017F809039FFE07FE0489038801FF048496C7E48486D7E48486D7E121F491301003F81
A2485A6F1380A212FFA290B7FCA401F0C9FCA5127FA27F123FEE0F806C7E161F6C6C1500
6C6C5C6C6D137E6C9038E001FC6C9038F80FF8013FB55A6D14C0010391C7FC9038007FF8
292B7DA930>I<EC07FE91387FFF8049B512C0010714E090390FFE3FF0EB1FF090393FE0
7FF8EB7FC013FF1480A2489038003FF0ED1FE0ED0FC092C7FCAAB612E0A500010180C7FC
B3AC007FEBFF80A525407DBF20>I<903A03FF8007F0013F9038F83FF8499038FCFFFC48
B712FE48018313F93A07FC007FC34848EB3FE1001FEDF1FC4990381FF0F81700003F81A7
001F5DA26D133F000F5D6C6C495A3A03FF83FF8091B5C7FC4814FC01BF5BD80F03138090
CAFCA2487EA27F13F06CB6FC16F016FC6C15FF17806C16C06C16E01207001F16F0393FE0
00034848EB003F49EC1FF800FF150F90C81207A56C6CEC0FF06D141F003F16E001F0147F
D81FFC903801FFC02707FF800F13006C90B55AC615F8013F14E0010101FCC7FC2F3D7DA8
34>I<13FFB5FCA512077EAFED1FF8EDFFFE02036D7E4A80DA0FE07F91381F007F023C80
5C4A6D7E5CA25CA35CB3A4B5D8FE0FB512E0A5333F7CBE3A>I<EA01F8487E487E487E48
1380A66C13006C5A6C5A6C5AC8FCA913FFB5FCA512077EB3ABB512F8A515407CBF1D>I<
13FFB5FCA512077EB092380FFFFEA5DB01FEC7FC4B5AED07F0ED1FE04B5A4B5A4BC8FCEC
03FC4A5A4A5A141F4A7EECFFFCA2818102E77F02C37F148102007F826F7E6F7E151F6F7E
826F7F6F7F816F7FB5D8FC07EBFFC0A5323F7DBE37>107 D<13FFB5FCA512077EB3B3AF
B512FCA5163F7CBE1D>I<01FFD91FF8ECFFC0B590B5010713F80203DAC01F13FE4A6E48
7FDA0FE09026F07F077F91261F003FEBF8010007013EDAF9F0806C0178ECFBC04A6DB448
6C7FA24A92C7FC4A5CA34A5CB3A4B5D8FE07B5D8F03FEBFF80A551297CA858>I<01FFEB
1FF8B5EBFFFE02036D7E4A80DA0FE07F91381F007F0007013C806C5B4A6D7E5CA25CA35C
B3A4B5D8FE0FB512E0A533297CA83A>I<EC7FF0903803FFFE011FEBFFC0017F14F09039
FFE03FF8489038800FFC3A03FE0003FE48486D7E000F168048486D13C0A2003F16E04914
7F007F16F0A400FF16F8AA007F16F0A46C6CECFFE0A2001F16C06C6C491380A26C6C4913
003A03FF800FFE6C9038E03FFC6C6CB512F0011F14C0010791C7FC9038007FF02D2B7DA9
34>I<01FFEBFFE0B5000713FC021FEBFF80027F80DAFF8113F09139FC007FF8000701F0
6D7E6C496D7E4A130F4A6D7E1880A27013C0A38218E0AA4C13C0A318805E18005E6E5C6E
495A6E495A02FCEBFFF0DAFF035B92B55A029F91C7FC028713FC028113C00280C9FCACB5
12FEA5333B7DA83A>I<DA7FE01378902607FFFC13F8011FEBFF01017F14819039FFF81F
C3489038E007E74890388003F74890380001FF48487F001F157F5B003F153F5B127F161F
A2485AAA127F7FA36C6C143F167F121F6C6C14FF6D5B6C6D5A6CEBC00F6CEBF03F6C6CB5
12BF6DEBFE3F010713F8010013C091C7FCAC030FB512E0A5333B7DA837>I<3901FE01FE
00FF903807FF804A13E04A13F0EC3F1F91387C3FF8000713F8000313F0EBFFE0A29138C0
1FF0ED0FE091388007C092C7FCA391C8FCB3A2B6FCA525297DA82B>I<90383FFC1E48B5
12BE000714FE5A381FF00F383F800148C7FC007E147EA200FE143EA27E7F6D90C7FC13F8
EBFFE06C13FF15C06C14F06C806C806C806C80C61580131F1300020713C014000078147F
00F8143F151F7EA27E16806C143F6D140001E013FF9038F803FE90B55A15F0D8F87F13C0
26E00FFEC7FC222B7DA929>I<EB07C0A5130FA4131FA3133F137FA213FF5A1207001FEB
FFFEB6FCA40001EBC000B3151FA96CEBE03EA2017F137EECF8FC90383FFFF86D13F00107
13E001001380203B7EB929>I<D9FF80EB0FF8B5EB0FFFA50007EC007F6C153FB3A5167F
A316FF6C5C4B7F6C903AC007DFFFE09138F01F9F6DB5121F6D13FE010F13F8010101E0EB
E000332A7CA83A>I<B500FC90383FFFC0A5000101C0903803E0006E1307A26C5E6E130F
017F5D6E131F013F92C7FC6E5B011F143E6E137E010F147C6E13FCA26D5C15816D5C15C3
6D5C15E76D5C15FF6E5BA36E90C8FCA26E5AA26E5AA26E5AA26E5AA232287EA737>I<B5
3CFC3FFFFC03FFFEA50003D980009039C0000F806E161F6C037F15006E496C5B6C183E83
6E48157E017F177C6E486D13FC013F02EF5C83DAFC071401011F02C75CDAFE0FEBFE0301
0F02835C17FFDAFF1F14076D02015C03BF148F6DD9BE005C18CF03FE14DF6D49017F90C7
FC18FF6D496D5AA36E486D5AA26E486D5AA36E486D5AA26E486D5A47287EA74C>I<B5D8
FC03B51280A5C69026E0007FC7FC6E13FE6D6C5B6D6C485A6D6C485A010F13076D6C485A
ED9FC06DEBFF806D91C8FC6D5B6E5AA2143F6E7E140F814A7F4A7F4A7F02FE7F903801FC
7F49486C7E02F07F49486C7E49486C7E011F7F49486C7FD97F008001FE6D7FB5D8C007EB
FFC0A532287EA737>I<B500FC90383FFFC0A5000101C0903803E0006E1307A26C5E6E13
0F017F5D6E131F013F92C7FC6E5B011F143E6E137E010F147C6E13FCA26D5C15816D5C15
C36D5C15E76D5C15FF6E5BA36E90C8FCA26E5AA26E5AA26E5AA26E5AA35D14075D000E13
0FD83F805B387FC01FD8FFE090C9FC5C143E147E5CEBC1F8387FC3F0387E0FE06CB45A6C
5B6C48CAFCEA03F8323B7EA737>I<003FB612F8A4D9F80113F001C014E0495A494813C0
4A1380007E15005C4A5A007C5C147F4A5A495B5DC65A495B495BA249EB007C495A5C137F
494813FC484913F85C5A48EBC00114804814034813004848130749131F007FECFFF0B7FC
A426287DA72E>I<B912E0A43304809A34>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fm cmr10 10.95 87
/Fm 87 128 df<4AB4EB0FE0021F9038E03FFC913A7F00F8FC1ED901FC90383FF03FD907
F090397FE07F80494801FF13FF4948485BD93F805C137F0200ED7F00EF003E01FE6D91C7
FC82ADB97EA3C648C76CC8FCB3AE486C4A7E007FD9FC3FEBFF80A339407FBF35>11
D<EC03FE91383FFF809138FE03E0903903F800F0D90FE013384948137C90393F8001FE90
387F00035B5BA2485A6F5AED007093C7FCAA16FEB7FCA33901FC000315011500B3AC486C
497EB5D8F87F13FCA32E407EBF33>I<EC03FF023F13EE9138FE01FEEB03F090380FE003
EB1FC0EB3F80EB7F005B5B150148481300AEB7FCA3D801FCC7FCB3AE486C497EB5D8F87F
13FCA32E407EBF33>I<DA03FE49B4FC91273FFF801F13C0913BFE03E07F01F0903C03F0
00F1FC0078D90FE0D97FF0131C49484948133E4948484913FF494848495A5B491500A248
485C03016E5A0300153896C7FCAA197FBBFCA3D801FCC738FE00018485B3AC486C496CEC
FF80B5D8F87FD9FC3F13FEA347407EBF4C>I<133E133F137F13FFA2EA01FEEA03FCEA07
F813F0EA0FE0EA1FC01380EA3E005A5A1270122010116EBE2D>19
D<121EEA7F80EAFFC0A9EA7F80ACEA3F00AC121EAB120CC7FCA8121EEA7F80A2EAFFC0A4
EA7F80A2EA1E000A4179C019>33 D<001E130F397F803FC000FF137F01C013E0A201E013
F0A3007F133F391E600F3000001300A401E01370491360A3000114E04913C00003130101
001380481303000EEB070048130E0018130C0038131C003013181C1C7DBE2D>I<EC0F80
EC7FE0ECF870903803E0380107133CECC01CEB0F80011F131E150EA2EB3F00A55D1480A2
5D157815705D6D6C5A14C1ECC38002C7CAFC02EE91387FFFFCEB0FEC14FC4A020713C06D
48913801FE006E5DEF00F06D7E01074B5A496C5D011D1503D939FF4A5A017093C7FC496D
5B0001017F140E496C6C131E00036E131C2607801F143C000F6E5B001F6D6C1370263F00
0714F0486E485ADA03FE5B913801FF03486D495A0487C8FCED7FCFED3FFE6F4814386D5C
150F007F6E6C14786D6D6C1470003F4A6C14F06D496C6C13E0001F91393E3FC0016C6C90
3AFC1FF003C03D07FC07F007FC1F800001B5D8C001B512006C6C90C7EA7FFCD90FF8EC0F
F03E437CC047>38 D<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A312
011380120313005A120E5A1218123812300B1C79BE19>I<1430147014E0EB01C0EB0380
1307EB0F00131E133E133C5B13F85B12015B1203A2485AA2120F5BA2121F90C7FCA25AA3
123E127EA6127C12FCB2127C127EA6123E123FA37EA27F120FA27F1207A26C7EA212017F
12007F13787F133E131E7FEB07801303EB01C0EB00E014701430145A77C323>I<12C07E
12707E7E121E7E6C7E7F12036C7E7F12007F1378137CA27FA2133F7FA21480130FA214C0
A3130714E0A6130314F0B214E01307A614C0130FA31480A2131F1400A25B133EA25BA213
7813F85B12015B485A12075B48C7FC121E121C5A5A5A5A145A7BC323>I<1506150FB3A9
007FB912E0BA12F0A26C18E0C8000FC9FCB3A915063C3C7BB447>43
D<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A312011380120313005A
120E5A1218123812300B1C798919>I<B512FEA617067F961E>I<121EEA7F80A2EAFFC0A4
EA7F80A2EA1E000A0A798919>I<ED0180ED03C01507A21680150FA216005DA2151E153E
A2153C157CA2157815F8A25D1401A25D1403A25D1407A25D140FA24AC7FCA2141E143EA2
143C147CA2147814F8A25C1301A25C1303A25C1307A25C130FA291C8FC5BA2131E133EA2
5BA2137813F8A25B1201A25B1203A25B1207A25B120FA290C9FC5AA2121E123EA2123C12
7CA2127812F8A25A1260225B7BC32D>I<EB01FE90380FFFC090383F03F090387C00F849
137C48487F48487F4848EB0F80A2000F15C04848EB07E0A3003F15F0A290C712034815F8
A64815FCB3A26C15F8A56C6CEB07F0A3001F15E0A36C6CEB0FC0A26C6CEB1F8000031500
6C6C133E6C6C5B017C5B90383F03F090380FFFC0D901FEC7FC263F7DBC2D>I<EB01C013
031307131F137FEA07FFB5FC139FEAF81F1200B3B3ACEB7FF0B612F8A31D3D78BC2D>I<
EB07FC90383FFF8090B512E03903F01FF83907C007FC390F0001FE001E6D7E001C158000
3CEC7FC05AED3FE01270B4FC6DEB1FF07FA56C5A6CC7FC120CC813E0153FA216C0157F16
8015FF16004A5A5D4A5A4A5A5D4A5A4A5A4AC7FC147E147C5C495A495A495A495A49C712
70133E133C5B4914E0485A485A485A48C7120148B6FCA25A4815C0B7FCA3243D7CBC2D>
I<EB07FC90383FFF809038F80FE03901E003F839078001FCD80F007F000E6D7E001E1580
D81F80137F486C14C07FA27F5BA2121F6C5AC8138015FF1600A24A5AA24A5A5DEC07E04A
5A023FC7FCEB1FFCECFF809038000FE0EC07F86E7E6E7E6E7E1680ED7FC0A216E0153FA2
16F0A2120C123F487E487EA316E0A249137F6CC713C01278EDFF807E6C4913006C495A39
07C007FC3903F80FF0C6B55A013F1380D907F8C7FC243F7CBC2D>I<150E151E153EA215
7EA215FE1401A21403EC077E1406140E141CA214381470A214E0EB01C0A2EB0380EB0700
A2130E5BA25B5BA25B5B1201485A90C7FC5A120E120C121C5AA25A5AB8FCA3C8EAFE00AC
4A7E49B6FCA3283E7EBD2D>I<00061403D80780131F01F813FE90B5FC5D5D5D15C092C7
FC14FCEB3FE090C9FCACEB01FE90380FFF8090383E03E090387001F8496C7E49137E497F
90C713800006141FC813C0A216E0150FA316F0A3120C127F7F12FFA416E090C7121F12FC
007015C012780038EC3F80123C6CEC7F00001F14FE6C6C485A6C6C485A3903F80FE0C6B5
5A013F90C7FCEB07F8243F7CBC2D>I<EC1FE0ECFFF8903803F03E90380FC00F90391F00
0780133E017EEB1FC049133F4848137F12035B12074848EB3F80ED1F00001F91C7FC5BA2
123FA3485AA214FE903887FF8039FF8F07E090389C01F09038B800FC01B0137E13F0497F
16804914C0A2ED1FE0A34914F0A5127FA6123F6D14E0A2121FED3FC0A26C6C1480A20007
EC7F006C6C137E6C6C5B6C6C485A90387E07F06DB45A010F1380D903FCC7FC243F7CBC2D
>I<1238123C123F90B612FCA316F85A16F016E00078C712010070EC03C0ED078016005D
48141E151C153C5DC8127015F04A5A5D14034A5A92C7FC5C141EA25CA2147C147814F8A2
13015C1303A31307A3130F5CA2131FA6133FAA6D5A0107C8FC26407BBD2D>I<EB03FC90
381FFF8090387C07E09038F001F83901E0007C48487F48487F48C7FCED0F80121E16C000
3E1407A4123FA26DEB0F807F6C6C131F6D140001FC133E6C6C5B9038FF80786C6D5A6CEB
F3E06CEBFF806C91C7FC133F6D13C06D7F013F13F801787F48486C7E3903E01FFF48486C
1380260F800313C048487E489038007FE0003E143F007E141F007CEC0FF01507481403A3
1501A46C15E0007C1403A2007E15C06C14076CEC0F806DEB1F006C6C133ED807F05B3901
FC03F86CB512E0011F1380D903FCC7FC243F7CBC2D>I<EB03FCEB1FFF90387E07C09038
FC03F048486C7E48486C7E4848137C000F147E4848137F81003F15805B007F15C0A2151F
12FF16E0A516F0A5127F153FA36C7EA2001F147F120F6C6C13FF6D13DF000313013900F8
039F90387E0F1FD91FFE13E0EB07F090C7FCA2ED3FC0A41680157FD80F801400487E486C
13FEA24A5A5D49485AEB8007391E000FE0001F495A260FC07FC7FC3803FFFE6C13F83800
3FC0243F7CBC2D>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E00C7FCB3121EEA7F80A2EA
FFC0A4EA7F80A2EA1E000A2779A619>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E00C7FC
B3121E127FEAFF80A213C0A4127F121E1200A412011380A3120313005A1206120E120C12
1C5A1230A20A3979A619>I<007FB912E0BA12F0A26C18E0CDFCAE007FB912E0BA12F0A2
6C18E03C167BA147>61 D<EB1FF890B5FC3903E01FC0390F0007F0001EEB03F848EB01FC
4814FE140000FE14FF7E7FA46CC7FC123EC7EA01FEA2EC03FCEC07F815F0EC0FC0EC1F80
EC3F00143E5C147814F85C13015CA2495AA25CAB91C7FC90C8FCA8EB0780EB1FE0A2497E
A46D5AA2EB078020407BBF2B>63 D<15074B7EA34B7EA34B7EA34B7EA34B7E15E7A29138
01C7FC15C3A291380381FEA34AC67EA3020E6D7EA34A6D7EA34A6D7EA34A6D7EA34A6D7E
A349486D7E91B6FCA249819138800001A249C87EA24982010E157FA2011E82011C153FA2
013C820138151FA2017882170F13FC00034C7ED80FFF4B7EB500F0010FB512F8A33D417D
C044>65 D<B712FCEEFF8017F00001903980000FF86C6CC7EA03FE707E701380EF7FC0EF
3FE0A2EF1FF0A218F8A3170F171FA318F0A2EF3FE0177F18C0EFFF804C1300EE03FCEE0F
F8EE7FE091B6C7FC17E091C7EA07FCEE01FE933800FF80EF7FC0EF3FE0EF1FF018F8170F
18FC1707A218FEA718FC170FA2EF1FF818F0173FEF7FE0EFFFC00403138048486C90380F
FE00B85A17E094C7FC373E7DBD40>I<DB3FF01306912603FFFE130E020F9038FF801E91
3A3FF007E03E9139FF8000F8D903FEC7EA7C7ED907F8EC1EFE4948140FD93FE014074948
1403495A91C812014848150012034848167E5B000F173EA24848161EA2123F5B180E127F
A349160012FFAC127F7F180EA2123FA27F001F171E181C6C7EA20007173C6D16386C6C16
78000117706C6C16F06EEC01E06D6C15C06D6C1403D90FF0EC07806D6CEC1F00D903FE14
3E902600FF8013F891393FF007F0020FB512C0020391C7FC9138003FF037427BBF42>I<
B712FCEEFF8017E000019039C0001FF86C6C48EB03FEEE00FF717E717EEF0FE084717E71
7E170184717EA21980187F19C0A3F03FE0A519F0AB19E0A5F07FC0A21980A218FF19004D
5AA24D5A6017074D5A4D5AEF7FC04DC7FCEE03FE48486CEB1FF8B85A178004FCC8FC3C3E
7DBD45>I<B912E0A300019038C000016C6C48EB001FEF0FF01703A217011700A31870A4
18381638A41800A21678A216F81501150791B5FCA3EC8007150115001678A21638A2180E
A3181C93C7FCA4183C1838A21878A318F8EF01F0A21707170F173F48486CEB03FFB912E0
A3373E7DBD3E>I<B91280A300019038C000036C6C48EB007FEF1FC0170F1707A21703A3
1701A4EF00E0A21638A31800A31678A216F81501150791B5FCA3EC8007150115001678A2
1638A693C8FCAF3801FFE0B612F0A3333E7DBD3B>I<DB3FE0130C912603FFFE131C021F
9038FF803C913A7FF00FC07C9139FF0001F0D903FC90380078FC4948143DD91FE0141F49
48140F4948140701FF15034890C8FC491501485A000716005B000F177C5B001F173CA248
5AA2181C127FA25B95C7FC12FFAB041FB512F0127FA26D9139000FFE00EF03FC123FA27F
121FA26C7EA212077F12036C7E7F6C7F6D6C14076D7E6D6C140FD907F8141ED903FEEC3C
7C902600FF80EBF83C913A7FF007F01C021FB5EAC00C020391C8FC9138003FF03C427BBF
47>I<B6D8C01FB512F8A3000101E0C7383FFC0026007F80EC0FF0B3A691B7FCA30280C7
120FB3A92601FFE0EC3FFCB6D8C01FB512F8A33D3E7DBD44>I<B612F0A3C6EBF000EB3F
C0B3B3B2EBFFF0B612F0A31C3E7EBD21>I<011FB512FCA3D9000713006E5A1401B3B3A6
123FEA7F80EAFFC0A44A5A1380D87F005B007C130700385C003C495A6C495A6C495A2603
E07EC7FC3800FFF8EB3FC026407CBD2F>I<B600C090387FFFFCA3000101E0C7000F1380
26007F80913807FE0018F818E0604D5A4DC7FC173E5F5F4C5A4C5A4C5A4C5A4CC8FC163E
5E5E4B5A4B5AED07804B7E151F4B7E4B7E15FF913881EFF8913883C7FCEC878791388F03
FE91389E01FF14BCDAF8007F4A6D7E5C4A6D7E4A6D7EA2707E707EA2707E707EA2707F71
7E84173F717E717EA2717E848419802601FFE04A13C0B600C090B6FCA3403E7DBD47>I<
B612F8A3000101E0C9FC38007F80B3B0EF0380A517071800A45FA35FA25F5F5F4C5A1607
48486C133FB8FCA3313E7DBD39>I<B500C093B512C0A300016D4BEBE000D8007F1880D9
77F0ED03BFA3D973F8ED073FA3D971FC150EA2D970FE151CA3027F1538A36E6C1470A36E
6C14E0A26E6CEB01C0A36E6CEB0380A36E6CEB0700A26E6C130EA36E6C5BA3037F5BA26F
6C5AA36F6C5AA392380FE1C0A3923807F380A26FB4C7FCA36F5AA213F8486C6D5AD807FF
EFFFE0B500F80178017FEBFFC0A34A3E7CBD53>I<B56C91B512F88080D8007F03071300
6EEC01FC6E6E5A1870EB77FCEB73FEA2EB71FF01707FA26E7E6E7EA26E7E6E7EA26E7E6E
7EA26E7E6E7FA26F7E6F7EA26F7E6F7EA26F7E6F7EA26F7E6F1380A2EE7FC0EE3FE0A2EE
1FF0EE0FF8A2EE07FCEE03FEA2EE01FF7013F0A2177F173FA2171F170FA2170701F81503
487ED807FF1501B500F81400A218703D3E7DBD44>I<ED7FE0913807FFFE91391FC03F80
91397E0007E04948EB03F8D907F0EB00FE4948147F49486E7E49486E7E49C86C7E01FE6F
7E00018349150300038348486F7EA248486F7EA2001F188049167F003F18C0A3007F18E0
49163FA300FF18F0AC007F18E06D167FA4003F18C0A26C6CEEFF80A36C6C4B1300A26C6C
4B5A00035F6D150700015F6C6C4B5A6D5E6D6C4A5A6D6C4A5A6D6C4AC7FC6D6C14FED901
FCEB03F8D9007FEB0FE091391FC03F80912607FFFEC8FC9138007FE03C427BBF47>I<B7
12F8EEFF8017E000019039C0003FF86C6C48EB07FCEE01FE707EEF7F80EF3FC018E0A2EF
1FF0A218F8A818F0A2EF3FE0A218C0EF7F80EFFF004C5AEE07FCEE3FF091B612C04CC7FC
0280C9FCB3A73801FFE0B612C0A3353E7DBD3E>I<ED7FE0913807FFFE91391FC03F8091
397F000FE0D901FCEB03F8D907F0EB00FE4948147F49486E7E49486E7E49C86C7E498248
486F7E49150300038348486F7EA2000F834981001F1880A24848EE7FC0A3007F18E0A249
163FA200FF18F0AC007F18E0A26D167FA3003F18C0A26C6CEEFF80A3000F18006D5D0007
DA0F805B6C6C90393FE003FCED70706C6C496C485A6C6C48486C485A017FD9800E5BD93F
819038061FC0D91FC19038073F80D90FE14AC7FCD907F1EB03FE902601FDC013F8903A00
7EE007E091271FF03FC013180207B5FC9139007FE1E0DB0001143883711378A2706C13F0
EFFF0318FFA27113E0A37113C0711380711300715AEF01F83D527BBF47>I<B712C016FC
EEFF800001D9C00013E06C6C48EB1FF0EE07FCEE01FE707E84717EA2717EA284A760177F
606017FF95C7FCEE01FCEE07F8EE1FE0EEFF8091B500FCC8FC16F091388001FCED003FEE
1FC0707E707E83160383160183A383A484A4F0C004190EA28218E0057F131E2601FFE016
1CB600C0EB3FF094381FF83805071370CA3801FFE09438003F803F407DBD43>I<D907FC
131890391FFF8038017FEBE0783901FC03F83A03F0007CF8D807C0133F4848130F001F14
0748C7FC003E1403007E1401A2007C140012FC1678A46C1538A27EA26C6C14007F7FEA3F
F8EBFF806C13F86CEBFF806C14F06C14FC6C14FF6C15C0013F14E0010714F0EB007F0207
13F89138007FFC150FED07FE15031501ED00FFA200E0157FA3163FA27EA3163E7E167E6C
157C6C15FC6C15F86D13016DEB03F06DEB07E0D8F9FCEB0FC03AF07F803F8090391FFFFE
00D8E00713F839C0007FC028427BBF33>I<003FB91280A3903AF0007FE001018090393F
C0003F48C7ED1FC0007E1707127C00781703A300701701A548EF00E0A5C81600B3B14B7E
4B7E0107B612FEA33B3D7DBC42>I<B600C090B512F8A3000101E0C70007130026007F80
EC01FC715A1870B3B3A4013F16F06E5DA21701011F5E80010F15036E4A5A010793C7FC6D
6C5C6D6C141E6D6C5C027F14F86E6C485A91390FF00FE00203B51280020049C8FCED1FF0
3D407DBD44>I<B691380FFFFEA3000301E0020113E06C01809138007F806CEF3F00017F
163E181C6E153C013F1638A26E1578011F1670A26D6C5DA26E140101075EA26E14030103
5EA26D6C4AC7FCA2806D150EA26F131E027F141CA26F133C023F1438A26E6C5BA26F13F0
020F5CA2EDF80102075CA26E6C485AA2EDFE07020191C8FCA26F5A6E130EA2ED7F9CA216
DCED3FF8A36F5AA36F5AA26F5AA36F5A3F407EBD44>I<B500FE017FB5D88007B5FCA300
0301C0010101E0C713F86C90C849EC3FE07148EC0F807E7215006E143F017F190E84A26D
6C60A24D7E6D6C60A2EFE7F86D6C60A2933801C3FC6E18F001076104037F6E0281140101
036104077F17006D6C4D5AA2040EEB7F806D6C4DC7FCA24CEB3FC0DA7F80160EA24CEB1F
E003C0161E023F171C047814F0DBE070010F133C021F173804F014F84C1307DA0FF05EA2
DBF1C0EB03FCDA07F95EA2DBFB80EB01FEDA03FF6F5AA293C8FCA26E5FA24B157F020094
C8FCA24B81037C153EA20378151E0338151C58407EBD5D>I<007FB5D8C003B512E0A3C6
49C7EBFC00D93FF8EC3FE06D48EC1F806D6C92C7FC171E6D6C141C6D6C143C5F6D6C1470
6D6D13F04C5ADA7FC05B023F13036F485ADA1FF090C8FC020F5BEDF81E913807FC1C163C
6E6C5A913801FF7016F06E5B6F5AA26F7E6F7EA28282153FED3BFEED71FF15F103E07F91
3801C07F0203804B6C7EEC07004A6D7E020E6D7E5C023C6D7E02386D7E14784A6D7E4A6D
7F130149486E7E4A6E7E130749C86C7E496F7E497ED9FFC04A7E00076DEC7FFFB500FC01
03B512FEA33F3E7EBD44>I<B66C0103B51280A3000101F0C8EBF8006C6C48ED3FC0725A
013F041EC7FC6D7E606D6C15386D6C1578606D6C5D6E14016D5E6D6D1303606E6C49C8FC
6E6C5B170E6E6C131E171C6E6C5B6E6C137817706E6C13F06F5B6E13016EEB83C05FED7F
C7DB3FE7C9FC16EFED1FFE5E150F6F5AB3A4ED1FFC020FB512FCA3413E7FBD44>I<EAFF
FCA4EAF000B3B3B3B3ABEAFFFCA40E5B77C319>91 D<486C13C000031301010013804813
03000EEB070048130E0018130C0038131C003013180070133800601330A300E013704813
60A400CFEB678039FFC07FE001E013F0A3007F133FA2003F131F01C013E0390F0007801C
1C73BE2D>I<EAFFFCA4EA003CB3B3B3B3ABEAFFFCA40E5B7FC319>I<EB0FF8EBFFFE3903
F01F8039078007E0000F6D7E9038E001F8D81FF07F6E7EA3157F6C5AEA0380C8FCA4EC1F
FF0103B5FC90381FF87FEB7F803801FC00EA07F8EA0FE0485A485AA248C7FCEE038012FE
A315FFA3007F5BEC03BF3B3F80071F8700261FC00E13CF3A07F03C0FFE3A01FFF807FC3A
003FC001F0292A7DA82D>97 D<EA01FC12FFA3120712031201B1EC03FC91381FFF809138
7C07E09039FDE001F09039FFC000FC4A137E91C77E49158049141F17C0EE0FE0A217F0A2
160717F8AA17F0A2160FA217E0161F17C06D1580EE3F006D5C6E13FE9039F3C001F89039
F1E003F09039E0780FC09026C03FFFC7FCC7EA07F82D407EBE33>I<49B4FC010F13E090
383F00F8017C131E4848131F4848137F0007ECFF80485A5B121FA24848EB7F00151C007F
91C7FCA290C9FC5AAB6C7EA3003FEC01C07F001F140316806C6C13076C6C14000003140E
6C6C131E6C6C137890383F01F090380FFFC0D901FEC7FC222A7DA828>I<ED01FC15FFA3
150715031501B114FF010713E190381F80F990387E003D49131FD803F81307485A491303
48481301121F123F5B127FA290C7FCA25AAA7E7FA2123FA26C7E000F14037F000714076C
6C497E6C6C497ED8007C017913F890383F01F190380FFFC1903A01FE01FC002D407DBE33
>I<EB01FE90380FFFC090383F03F09038FC01F848486C7E4848137E48487F000F158049
131F001F15C04848130FA2127F16E090C7FCA25AA290B6FCA290C9FCA67EA27F123F16E0
6C7E1501000F15C06C6C13036DEB07806C6C1400C66C131E017E5B90381F80F8903807FF
E0010090C7FC232A7EA828>I<EC1FC0EC7FF8903801F83C903807E07E90380FC0FFEB1F
C1EB3F811401137FEC00FE01FE137C1500AEB6FCA3C648C7FCB3AE487E007F13FFA32040
7EBF1C>I<167C903903F801FF903A1FFF078F8090397E0FDE1F9038F803F83803F001A2
3B07E000FC0600000F6EC7FC49137E001F147FA8000F147E6D13FE00075C6C6C485AA239
01F803E03903FE0FC026071FFFC8FCEB03F80006CAFC120EA3120FA27F7F6CB512E015FE
6C6E7E6C15E06C810003813A0FC0001FFC48C7EA01FE003E140048157E825A82A46C5D00
7C153E007E157E6C5D6C6C495A6C6C495AD803F0EB0FC0D800FE017FC7FC90383FFFFC01
0313C0293D7EA82D>I<EA01FC12FFA3120712031201B1EC01FE913807FFC091381E07E0
91387803F09138E001F8D9FDC07F148001FF6D7E91C7FCA25BA25BB3A6486C497EB5D8F8
7F13FCA32E3F7DBE33>I<EA01E0EA07F8A2487EA46C5AA2EA01E0C8FCACEA01FC127FA3
120712031201B3AC487EB512F0A3143E7DBD1A>I<1478EB01FEA2EB03FFA4EB01FEA2EB
00781400AC147FEB7FFFA313017F147FB3B3A5123E127F38FF807E14FEA214FCEB81F8EA
7F01387C03F0381E07C0380FFF803801FC00185185BD1C>I<EA01FC12FFA31207120312
01B292B51280A392383FFC0016E0168093C7FC153C5D5D4A5AEC07C04A5A4AC8FC143E14
7F4A7E13FD9038FFDFC0EC9FE0140F496C7E01FC7F496C7E1401816E7E81826F7E151F82
6F7EA282486C14FEB539F07FFFE0A32B3F7EBE30>I<EA01FC12FFA3120712031201B3B3
B1487EB512F8A3153F7DBE1A>I<2701F801FE14FF00FF902707FFC00313E0913B1E07E0
0F03F0913B7803F03C01F80007903BE001F87000FC2603F9C06D487F000101805C01FBD9
00FF147F91C75B13FF4992C7FCA2495CB3A6486C496CECFF80B5D8F87FD9FC3F13FEA347
287DA74C>I<3901F801FE00FF903807FFC091381E07E091387803F000079038E001F826
03F9C07F0001138001FB6D7E91C7FC13FF5BA25BB3A6486C497EB5D8F87F13FCA32E287D
A733>I<14FF010713E090381F81F890387E007E01F8131F4848EB0F804848EB07C04848
EB03E0000F15F04848EB01F8A2003F15FCA248C812FEA44815FFA96C15FEA36C6CEB01FC
A3001F15F86C6CEB03F0A26C6CEB07E06C6CEB0FC06C6CEB1F80D8007EEB7E0090383F81
FC90380FFFF0010090C7FC282A7EA82D>I<3901FC03FC00FF90381FFF8091387C0FE090
39FDE003F03A07FFC001FC6C496C7E6C90C7127F49EC3F805BEE1FC017E0A2EE0FF0A3EE
07F8AAEE0FF0A4EE1FE0A2EE3FC06D1580EE7F007F6E13FE9138C001F89039FDE007F090
39FC780FC0DA3FFFC7FCEC07F891C9FCAD487EB512F8A32D3A7EA733>I<02FF131C0107
EBC03C90381F80F090397F00387C01FC131CD803F8130E4848EB0FFC150748481303121F
485A1501485AA448C7FCAA6C7EA36C7EA2001F14036C7E15076C6C130F6C7E6C6C133DD8
007E137990383F81F190380FFFC1903801FE0190C7FCAD4B7E92B512F8A32D3A7DA730>
I<3901F807E000FFEB1FF8EC787CECE1FE3807F9C100031381EA01FB1401EC00FC01FF13
30491300A35BB3A5487EB512FEA31F287EA724>I<90383FC0603901FFF8E03807C03F38
1F000F003E1307003C1303127C0078130112F81400A27E7E7E6D1300EA7FF8EBFFC06C13
F86C13FE6C7F6C1480000114C0D8003F13E0010313F0EB001FEC0FF800E01303A214017E
1400A27E15F07E14016C14E06CEB03C0903880078039F3E01F0038E0FFFC38C01FE01D2A
7DA824>I<131CA6133CA4137CA213FCA2120112031207001FB512C0B6FCA2D801FCC7FC
B3A215E0A912009038FE01C0A2EB7F03013F138090381F8700EB07FEEB01F81B397EB723
>I<D801FC14FE00FF147FA3000714030003140100011400B3A51501A31503120015076D
EB06FF017E010E13806D4913FC90381FC078903807FFE00100903880FE002E297DA733>
I<B539E00FFFE0A32707FE000313006C48EB00FC5E00015D7F00005DA26D13016D5CA26D
6C485AA2ECC007011F91C7FCA290380FE00EA2ECF01E0107131CA26D6C5AA2ECFC780101
1370A2ECFEF001005BA2EC7FC0A36E5AA26EC8FCA3140E2B287EA630>I<B53BC3FFFE03
FFF8A3290FFE003FE00013C06C486D48EB3F806C4817006D010F141E00016F131C15076D
163C00004A6C1338A2017F5E4B7E151DD93F805DED3DFC1538D91FC04A5AED78FE923870
7E03D90FE0017F5BEDE03F02F0140701070387C7FC9138F1C01F02F9148F010315CE9138
FB800F02FF14DE6D15FCED00076D5DA24A1303027E5CA2027C1301023C5C023813003D28
7EA642>I<B539F01FFFE0A30003D9C00F1300C690388007F8D97F0013E002805BD93FC0
5B011F49C7FC90380FE00EECF01E6D6C5A01035B6D6C5A6E5AEB00FF6E5A6E5A81141F81
4A7E81147BECF1FC903801E1FEECC0FF01037F49486C7ED90F007F011E6D7E013E130F49
6D7E01FC80486C80000F4A7EB539803FFFF8A32D277FA630>I<B539E00FFFE0A32707FE
000313006C48EB01FC6F5A00015D7F00005DA2017F495AA2EC8003013F5CA26D6C48C7FC
A26E5A010F130EA26D6C5AA2ECF83C01031338A26D6C5AA2ECFEF001005BA2EC7FC0A36E
5AA36EC8FCA2140EA2141E141C143C1438A2147800181370127EB45BA2495AA248485AD8
7E07C9FCEA780EEA3C3CEA1FF8EA07E02B3A7EA630>I<001FB61280A2EBE00001801400
49485A001E495A121C4A5A003C495A141F00385C4A5A147F5D4AC7FCC6485AA2495A495A
130F5C495A90393FC00380A2EB7F80EBFF005A5B484813071207491400485A48485BA248
485B4848137F00FF495A90B6FCA221277EA628>I<B812F0A22C0280982D>I<BE12C0A25A
0280985B>I<001C130E007FEB3F8039FF807FC0A5397F003F80001CEB0E001A0977BD2D>
127 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fn cmbx12 14.4 42
/Fn 42 119 df<171FA24D7EB3B3A4007FBD1280A2BE12C0A36C1C80A2CAD83F80CAFCB3
B3A471CBFCA25A5B79CA69>43 D<EA07F0487E487E487E487EB51280A76C13006C5A6C5A
6C5A6C5AC8FCB3EA07F0487E487E487E487EB51280A76C13006C5A6C5A6C5A6C5A113576
B425>58 D<171F4D7E4D7EA24D7EA34C7FA24C7FA34C7FA34C7FA24C7FA34C8083047F80
167E8304FE804C7E03018116F8830303814C7E03078116E083030F814C7E031F81168083
033F8293C77E4B82157E8403FE824B800201835D840203834B800207835D844AB87EA24A
83A3DA3F80C88092C97E4A84A2027E8202FE844A82010185A24A820103854A82010785A2
4A82010F855C011F717FEBFFFCB600F8020FB712E0A55B547BD366>65
D<BA12C019FEF1FFC01AF01AFCD8000701F0C7000313FFDE007F7F737F070F7F737F8785
87858785A287A84F5BA263616361634F5B4F5B077F90C7FC4E485A060713F892B812E097
C8FC861AF003F0C7000313FE9539003FFF80070F13E0737F07017F87737F747E1C807413
C0A27413E0A31CF0A386A362A31CE0A2621CC0A250138097B5FC1C004F5B19074F5B073F
13F04EB55ABC128098C7FC1AF81AC007F8C8FC54527CD160>I<932601FFFCEC01C0047F
D9FFC013030307B600F81307033F03FE131F92B8EA803F0203DAE003EBC07F020F01FCC7
383FF0FF023F01E0EC0FF94A01800203B5FC494848C9FC4901F882494982494982494982
4949824990CA7E494883A2484983485B1B7F485B481A3FA24849181FA3485B1B0FA25AA2
98C7FC5CA2B5FCAE7EA280A2F307C07EA36C7FA21B0F6C6D1980A26C1A1F6C7F1C006C6D
606C6D187EA26D6C606D6D4C5A6D6D16036D6D4C5A6D6D4C5A6D01FC4C5A6D6DEE7F806D
6C6C6C4BC7FC6E01E0EC07FE020F01FEEC1FF80203903AFFE001FFF0020091B612C0033F
93C8FC030715FCDB007F14E0040101FCC9FC525479D261>I<BA7E19FCF1FF801AF01AFC
D8000701F0C7000F13FF060014C0071F7F070713F807017F737F747E747F747F86747F74
7F8886888688A2757EA31D8087A21DC0A51DE0A387A963A31DC0A51D80A2631D00A3515A
A2646264505B6264505B505B5090C7FCF2FFFE4F5B07075B071F5B96B512C0060F91C8FC
BB5A1AF01AC007FCC9FC19805B527CD167>I<BC1280A5D8000701F8C7000114C0F0001F
19071901851A7F1A3F1A1FA2F20FE0A21A07A31A03A318F81BF01A01A497C7FC1701A317
031707170F177F92B6FCA59238F8007F170F170717031701A317001B3EA31B7CA395C8FC
A21BFCA21BF8A21A01A31A031BF01A071A0FA21A1F1A3FF27FE0F101FF1907191F0603B5
FCBCFCA21BC0A34F517CD058>I<BB12FEA5D8000701F8C700077FF0007F191F19078585
8586861B80A21A1FA31A0FA41BC006F81307A497C7FCA31701A317031707170F177F92B6
FCA59238F8007F170F170717031701A31700A795C9FCB3B812F8A54A517CD055>I<9326
01FFFCEC01C0047FD9FFC013030307B600F81307033F03FE131F92B8EA803F0203DAE003
EBC07F020F01FCC7383FF0FF023F01E0EC0FF94A01800203B5FC494848C9FC4901F88249
49824949824949824949824990CA7E494883A2484983485B1B7F485B481A3FA24849181F
A3485B1B0FA25AA298C8FC5CA2B5FCAE6C057FB712E0A280A36C94C7003FEBC000A36C7F
A36C7FA27E6C7FA26C7F6C7FA26D7E6D7F6D7F6D6D5E6D7F6D01FC93B5FC6D13FF6D6C6D
5C6E01F0EC07FB020F01FEEC1FF10203903AFFF001FFE0020091B6EAC07F033FEE001F03
0703FC1307DB007F02E01301040149CAFC5B5479D26A>I<B8D8C003B8FCA5D8000701F8
C9001FEBE000B3AE92BAFCA503F8C9121FB3B1B8D8C003B8FCA560527CD169>I<B812C0
A5D8000701F8C7FCB3B3B3B2B812C0A52A527CD132>I<B800C091B612F8A5D8000701F8
C90003EBF8009738007F8051C7FC505AF203F8F20FF0505A505A505A50C8FCF101FCF107
F84F5A4F5A4F5A4F5A07FEC9FCF003FC4E5A4E5A4E5A4E5A4E5ADD01FECAFC4D5A4D5A4D
5A4D7E173F4D7E4C487E4C7F5E4C804C804C80EEFF7F9226F9FE3F7FDBFBFC809226FFF8
1F7F4C7EDCC0077F0480804C7E4B6D804B6D804B8284727F727F8684727F727F87847280
87737F85737F87737F85737F88857380747F888697B512FCB800C0013FECFFFEA55F527C
D169>75 D<B812F8A5D8000701F8CAFCB3B3A91A7CA41AFC1AF8A51901A31903A219071A
F0190FA2191F193F197F19FF180360183F4DB5FCBB12E0A546527CD151>I<B600FC073F
B512FE6F61A26F96B6FCA2D80007F5C00070EF01EFA202EF6DEF03CFA202E76DEF078FA2
02E36DEF0F0FA202E16D171EA302E06D173CA26F6C1778A26F6C17F0A26F6DED01E0A26F
6DED03C0A36F6DED0780A26F6DED0F00A26F6D151EA26F6D5DA3706C5DA2706C5DA2706D
495AA2706D495AA2706D495AA3706D49C7FCA2706D131EA2706D5BA2716C5BA3716C5BA2
71EB81E0A271EBC3C0A271EBE780A27101FFC8FCA3715BA2715BA2725AA2725AA2D93FFC
6F5AB74DB712FEA2725AA2725A77527CD180>I<B600FC93B7FC8181A282D800076E9239
003FFC0070EE07E08282A28202EF7F02E77F02E380A202E18002E0806F7F6F7F6F7FA26F
7F6F7F6F806F80A26F80707F707F707F707FA2707F7080708070808583717F717F717F71
7FA27114807114C07114E07213F07213F8A27213FC7213FE7213FF721487A27214C77214
E77313F77313FF85A285858585A28586868686A286868686A2D93FFC187FB7173F1B1F1B
0F1B07755A60527CD169>I<93380FFFC00303B6FC031F15E092B712FC0203D9FC0013FF
020F01C0010F13C0023F90C7000313F0DA7FFC02007F494848ED7FFE4901E0ED1FFF4949
6F7F49496F7F4990C96C7F49854948707F4948707FA24849717E48864A83481B804A8348
1BC0A2481BE04A83A2481BF0A348497113F8A5B51AFCAF6C1BF86E5FA46C1BF0A26E5F6C
1BE0A36C6D4D13C0A26C6D4D1380A26C1B006C6D4D5A6E5E6C626D6C4C5B6D6D4B5B6D6D
4B5B6D6D4B5B6D6D4B5B6D6D4B90C7FC6D6D4B5A6D01FF02035B023F01E0011F13F0020F
01FC90B512C0020390B7C8FC020016FC031F15E0030392C9FCDB001F13E0565479D265>
I<BAFC19F819FF1AE086D8000701F0C7001F13FC060113FF726C13807313C0070F13E01B
F0857313F81BFCA27313FEA41BFFA81BFEA31BFC61A21BF84F13F04F13E0614F13C04F13
004E485A061F5B92B812F01AC04FC7FC19E003F8CBFCB3AEB812C0A550527CD15C>I<B9
12F0F0FF8019F819FF1AC0D8000701F0C714F0060F7F060113FE727F737F737F85737F87
A2737FA387A863A2616363A24F5B4F5B4F90C8FC4F5A06035B060F13F095B512C092B8C9
FC19F819E019F89226F0000313FE9439007FFF80727F727F727F727F727F8684A28684A7
87A71D1C75133EA38575137E73157C7513FC731401B86C6D9038F803F807039038FE07F0
7390B512E0736C14C0080F1400CEEA7FFC5F537CD164>82 D<91260FFF80130791B500F8
5B010702FF5B011FEDC03F49EDF07F9026FFFC006D5A4801E0EB0FFD4801800101B5FC48
48C87E48488149150F001F824981123F4981007F82A28412FF84A27FA26D82A27F7F6D93
C7FC14C06C13F014FF15F86CECFF8016FC6CEDFFC017F06C16FC6C16FF6C17C06C836C83
6D826D82010F821303010082021F16801400030F15C0ED007F040714E01600173F050F13
F08383A200788200F882A3187FA27EA219E07EA26CEFFFC0A27F6D4B13806D17006D5D01
FC4B5A01FF4B5A02C04A5A02F8EC7FF0903B1FFFC003FFE0486C90B65AD8FC0393C7FC48
C66C14FC48010F14F048D9007F90C8FC3C5479D24B>I<003FBC1280A59126C0003F9038
C0007F49C71607D87FF8060113C001E08449197F49193F90C8171FA2007E1A0FA3007C1A
07A500FC1BE0481A03A6C994C7FCB3B3AC91B912F0A553517BD05E>I<B800C00103B612
FCA5D8000701F8CAEBF000F31F80B3B3B11B3FA26D97C7FC81637F1B7E6D6D17FE505A6E
7E505A6E6D15076E4D5A6E6D4B5A6E6D4B5A6E01F84B5A6E6DDA03FFC8FC6E6CB46CEB0F
FE6F9039F001FFF8030F90B65A030316C0DB007F92C9FC040F14F8DC007F13805E537CD1
67>I<B700FE031FB512FEA5D8001F01F0CA383FFE00F307F06D626F170F6D62811B1F6D
6D601B3F6D97C7FC6F5F6D197E821BFE6E6D5E1A016E6D5E1A036E60701507A26E6D5E1A
0F6E6D5E1A1F6E6070153FA26E6D93C8FC626E6E147E1AFE6F5E711301A26F6D5C19036F
6D5C19076F5E71130FA26F6D5C191F6F6D5C193F6F93C9FC715BA26FEC807E19FE706D5A
18C1705C18E3705C18F318F770EBFFE0A2705CA2705CA37091CAFCA2705BA2715AA3715A
A2715AA2715A715A5F537DD166>I<B700FC017FB600FE91B612F0A5D8003F01C0C8001F
01E0C9EBF8006F71EE0FC06D7161876F1C1F6D7196C7FC6F8373606D1E3E6F836D716087
6F1CFC6D666F4B801F016D66704A806E525A88704A17076E059F5F70021F80080F160F6E
6570023F806EDC3E074CC8FC8870027E5F6EDC7C03163E7002FC804F6C167E6E1C7C7001
01814F6C16FC6E745B70010317016E4C6D5D060716C00580496D14036F63DDC00F16E04F
6D14076F07F05BDDE01F170F6F92C76C5D1DF8DDF03E6E141F6F98C9FCDDF87E16FC067C
6E5C6FF1FE3EDDFCFC177E6F4A6E147C1DFFDDFFF06E14FC6F62A24E816F62A270496F5B
A24E817061A295C97E7061A270487090CAFCA37048705AA24D1601040360A27048705A84
537DD18B>I<B8030FB61280A5D8000F01FCCA003F90C7FC6FEF07F86D6D606D4F5A826D
6E4C5A6D4F5A826E6D4CC8FC6E18FE826E6D4B5A6E4D5A826E6D4B5A6E4D5A836E6E4A5A
6E4D5A836F6D4AC9FC6F5E715C6F6D495A6F1503715C6F6D495A6F150F06805B6F6E485A
6F153F06E05B706D48CAFC705C725A70EBFDFC7013FF61705C82705C6182715B96CBFCB3
AA030FB712F8A561527ED166>89 D<001FBA12C01AE0A40380C714C002F8C75A02C01780
91C8481400495D495F494B5B495D495F48484B5B5F495F94B55A5E90C85D4C91C7FC5E60
003E4B5B5E604C5B5EC95C93B55A5D604B91C8FC5D5F4B5B5D5F4B5B5D5F92B55A5C5F4A
91C9FC5C5E4A5B5C4CEC03E04A5B5C5E91B55A5B4C14074991C8FC4918C05D495B5B4B15
0F495B5B4B151F90B55A48183F5D4891C9127F4818FF4A5D48495D485F4A5D4849033F13
80484CB5FC4A143FBBFCA47E435279D152>I<EC7FFF0107B512F0013F14FE90B77E48D9
E00F7F2703FE000113F0486C6D7F6EEB3FFC48826E131F83707FA36C496D7FA26C90C7FC
6C5AC9FCA6037FB5FC020FB6FC91B7FC01071487013FEBF0074913803901FFFC004813F0
485B485B485B4890C7FC5A5BA2485AA45EA26D5C007F151D163D6C6C02797F6C6D01F113
F86C9026C003E1EBFFE06C9026F81FC014F06C90B5487EC6ED001F011F01FC010713E001
0101E090C8FC3C387CB641>97 D<913801FFF8021FEBFF8091B612F0010315FC010F9038
C00FFE903A1FFE0001FFD97FFC491380D9FFF05B4817C048495B5C5A485BA2486F138091
C7FC486F1300705A4892C8FC5BA312FFAD127F7FA27EA2EF03E06C7F17076C6D15C07E6E
140F6CEE1F806C6DEC3F006C6D147ED97FFE5C6D6CEB03F8010F9038E01FF0010390B55A
01001580023F49C7FC020113E033387CB63C>99 D<4DB47E0407B5FCA5EE001F1707B3A4
913801FFE0021F13FC91B6FC010315C7010F9038E03FE74990380007F7D97FFC0101B5FC
49487F4849143F484980485B83485B5A91C8FC5AA3485AA412FFAC127FA36C7EA37EA26C
7F5F6C6D5C7E6C6D5C6C6D49B5FC6D6C4914E0D93FFED90FEFEBFF80903A0FFFC07FCF6D
90B5128F0101ECFE0FD9003F13F8020301C049C7FC41547CD24B>I<913803FFC0023F13
FC49B6FC010715C04901817F903A3FFC007FF849486D7E49486D7E4849130F48496D7E48
178048497F18C0488191C7FC4817E0A248815B18F0A212FFA490B8FCA318E049CAFCA612
7FA27F7EA218E06CEE01F06E14037E6C6DEC07E0A26C6DEC0FC06C6D141F6C6DEC3F806D
6CECFF00D91FFEEB03FE903A0FFFC03FF8010390B55A010015C0021F49C7FC020113F034
387CB63D>I<ED3FFC0203B5FC020F14C0023F14E09139FFF81FF0499038C03FF849EB80
7F49903800FFFC495A495AA2495AA2EE7FF8495AEE3FF0EE0FC093C7FCAEB712E0A52600
7FF8C8FCB3B3A7007FB512FEA52E547CD329>I<DA3FFF14FF0103B5D8F00713C0010FDA
FC1F13E0013FECFF7F90267FFC0F9038FF9FF09026FFE001EBF83F48496C13E048499038
7FF01F4890C7D83FF813E0489338FC0FC0F0078048486E6CC7FCA2003F82A9001F5EA26C
6C4A5AA26C5E6C6D495A6C6D495A6C6D485BDAFC0F5B4890B6C8FCD803EF14FC01C314F0
2607C03F90C9FC91CBFCA2120FA37FA213F813FE90B7FC6C16F817FF18C06C836C836C83
6D828448B9FC12074848C700031480D81FF8EC003F4848150748486F13C083485A83A56D
5D007F18806D5D003F18006C6C4B5AD80FFEED1FFC6C6C6CEC7FF86C01E049485A6C01FE
011F5B6C6CB71280010F03FCC7FC010115E0D9000F01FCC8FC3C4F7CB543>I<137F497E
000313E0487FA2487FA76C5BA26C5BC613806DC7FC90C8FCADEB3FF0B5FCA512017EB3B3
A6B612E0A51B547BD325>105 D<EB3FF0B5FCA512017EB3B3B3B1B612F0A51C537BD225>
108 D<D93FF0D91FFCEDFFE0B591B500C0010713FE030302F0011F6D7E030F6E017F8092
271FE07FFCD9FF037F922A3F001FFE01F8007F0003027C9126FF03E080C602F06DD90780
137FDAF1E0038FC77FDAF3C0159EDAF7806D01BC143F07FC8102FFC75C4A5EA24A5EA44A
5EB3ACB6D8F807B6D8C03FB512FEA567367BB570>I<D93FF0EB1FFCB591B512C0030314
F0030F8092391FE07FFC92393F001FFE0003027C80C602F07FDAF1E081ECF3C0DAF7807F
8502FFC7FC5CA25CA45CB3ACB6D8F807B612C0A542367BB54B>I<913801FFE0021F13FE
91B612C0010315F0010F9038807FFC903A1FFC000FFED97FF86D6C7E49486D7F48496D7F
48496D7F4A147F48834890C86C7EA24883A248486F7EA3007F1880A400FF18C0AC007F18
80A3003F18006D5DA26C5FA26C5F6E147F6C5F6C6D4A5A6C6D495B6C6D495B6D6C495BD9
3FFE011F90C7FC903A0FFF807FFC6D90B55A010015C0023F91C8FC020113E03A387CB643
>I<903A3FF001FFE0B5010F13FE033FEBFFC092B612F002F301017F913AF7F8007FFE00
03D9FFE0EB1FFFC602806D7F92C76C7F4A824A6E7F4A6E7FA2717FA285187F85A4721380
AC1A0060A36118FFA2615F616E4A5BA26E4A5B6E4A5B6F495B6F4990C7FC03F0EBFFFC91
26FBFE075B02F8B612E06F1480031F01FCC8FC030313C092CBFCB1B612F8A5414D7BB54B
>I<90397FE003FEB590380FFF80033F13E04B13F09238FE1FF89139E1F83FFC0003D9E3
E013FEC6ECC07FECE78014EF150014EE02FEEB3FFC5CEE1FF8EE0FF04A90C7FCA55CB3AA
B612FCA52F367CB537>114 D<903903FFF00F013FEBFE1F90B7FC120348EB003FD80FF8
1307D81FE0130148487F4980127F90C87EA24881A27FA27F01F091C7FC13FCEBFFC06C13
FF15F86C14FF16C06C15F06C816C816C81C681013F1580010F15C01300020714E0EC003F
030713F015010078EC007F00F8153F161F7E160FA27E17E07E6D141F17C07F6DEC3F8001
F8EC7F0001FEEB01FE9039FFC00FFC6DB55AD8FC1F14E0D8F807148048C601F8C7FC2C38
7CB635>I<143EA6147EA414FEA21301A313031307A2130F131F133F13FF5A000F90B6FC
B8FCA426003FFEC8FCB3A9EE07C0AB011FEC0F8080A26DEC1F0015806DEBC03E6DEBF0FC
6DEBFFF86D6C5B021F5B020313802A4D7ECB34>I<D93FF8913801FFC0B50207B5FCA500
03ED001FC61607B3AE5FA35FA2017F5D173B177B6D6C14F3DC01E313F06D6CD907C3EBFF
C0903A0FFFC03F836D90B51203010114FE6D6C13F8020701E091C7FC42377BB54B>I<B6
00F00107B5FCA5000101F8C8EA7FE06C6DED3F00A2017F163E6E157E013F167C6E15FC6D
5E6F13016D5E8117036D5E6F13076D5E6F130F6D5E6F131F6D93C7FC815F6E6C133E177E
023F147C6F13FC6E5C16816E5C16C3A26EEBE3E016E76E5C16FF6E5CA26E91C8FCA26F5A
A36F5AA26F5AA26F5AA26F5A6F5A40367DB447>I E
%EndDVIPSBitmapFont
end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 691 91 a Fn(Multiparadigm)46 b(programming:)61
b(No)l(v)l(el)47 b(devices)e(for)359 279 y(implemen)l(ting)i
(functional)f(and)e(logic)i(programming)g(constructs)1868
466 y(in)f(C++)1924 2117 y Fm(A)30 b(Thesis)1850 2230
y(Presen)m(ted)h(to)1651 2343 y(The)f(Academic)h(F)-8
b(acult)m(y)2052 2568 y(b)m(y)1586 2794 y Fn(Brian)45
b(McNamara)1678 3567 y Fm(In)30 b(P)m(artial)g(F)-8 b(ul\014llmen)m(t)
1400 3680 y(of)30 b(the)h(Requiremen)m(ts)f(for)g(the)g(Degree)1678
3793 y(Do)s(ctor)h(of)g(Philosoph)m(y)1667 5057 y(College)f(of)h
(Computing)1469 5170 y(Georgia)h(Institute)d(of)i(T)-8
b(ec)m(hnology)1835 5283 y(July)29 b(12,)j(2004)p eop
%%Page: 2 2
2 1 bop 691 91 a Fn(Multiparadigm)46 b(programming:)61
b(No)l(v)l(el)47 b(devices)e(for)359 279 y(implemen)l(ting)i
(functional)f(and)e(logic)i(programming)g(constructs)1868
466 y(in)f(C++)300 3370 y Fm(Appro)m(v)m(ed)30 b(b)m(y:)p
321 3663 1657 6 v 321 3728 a(Professor)46 b(Y)-8 b(annis)45
b(Smaragdakis,)k(Commit-)321 3841 y(tee)31 b(Chair)p
321 4053 V 321 4166 a(Professor)f(Y)-8 b(annis)30 b(Smaragdakis,)f
(Adviser)p 321 4443 V 321 4556 a(Professor)h(Mary)h(Jean)f(Harrold)p
2223 3663 V 2223 3776 a(Professor)g(Sp)s(encer)g(Rugab)s(er)p
2223 4053 V 2223 4175 a(Professor)g(Olin)e(Shiv)m(ers)p
2223 4443 V 2223 4515 a(Professor)i(Philip)d(W)-8 b(adler)2223
4628 y(\(Edin)m(burgh)28 b(Univ)m(ersit)m(y\))2244 5283
y(Date)k(Appro)m(v)m(ed)p 2879 5283 1021 6 v eop
%%Page: 3 3
3 2 bop 1301 91 a Fn(A)l(CKNO)l(WLEDGEMENTS)300 828 y
Fm(First)32 b(o\013,)i(I)f(thank)f(m)m(y)h(mother,)h(who)e(patien)m
(tly)g(endured)f(her)i(son's)f(sev)m(en)h(long)g(y)m(ears)g(of)g(b)s
(eing)f(a)300 1015 y(graduate)h(\(\\gradual"?\))45 b(studen)m(t.)h(She)
31 b(w)m(as)h(alw)m(a)m(ys)h(there)f(to)g(o\013er)h(supp)s(ort)d(and)h
(encouragemen)m(t)300 1203 y(and)f(to)h(remind)d(me)j(of)f(what)g(w)m
(as)h(really)e(imp)s(ortan)m(t)h(in)f(the)i(grand)e(sc)m(heme)j(of)e
(things.)441 1390 y(I)37 b(thank)h(m)m(y)f(advisor,)i(Professors)e(Y)-8
b(annis)37 b(Smaragdakis,)h(for)f(all)g(his)f(supp)s(ort.)60
b(Y)-8 b(annis)37 b(ga)m(v)m(e)300 1578 y(me)42 b(the)g(freedom)g(to)g
(explore)g(man)m(y)f(of)h(m)m(y)g(o)m(wn)g(ideas,)j(y)m(et)e(he)e(w)m
(as)h(adept)g(at)h(gen)m(tly)f(steering)300 1765 y(me)36
b(to)m(w)m(ards)h(the)f(most)g(p)s(oten)m(tially)f(fruitful)e(ones.)58
b(His)35 b(o\016ce)i(do)s(or)f(w)m(as)g(alw)m(a)m(ys)h(op)s(en,)g
(enabling)300 1952 y(in)m(teresting)26 b(discussions)f(of)i(researc)m
(h)g(ideas)g(at)g(all)f(hours)g(of)h(the)g(da)m(y)-8
b(.)41 b(I)27 b(feel)f(v)m(ery)i(fortunate)f(to)h(ha)m(v)m(e)300
2140 y(had)i(an)g(advisor)f(who)h(w)m(as)h(suc)m(h)f(a)h(go)s(o)s(d)f
(\014t)g(for)g(me.)441 2327 y(I)23 b(thank)g(the)g(rest)h(of)f(m)m(y)g
(committee:)39 b(Professors)23 b(Mary)g(Jean)g(Harrold,)h(Sp)s(encer)e
(Rugab)s(er,)i(Olin)300 2515 y(Shiv)m(ers,)k(and)g(Philip)d(W)-8
b(adler.)41 b(Both)29 b(Mary)g(Jean)g(and)f(Sp)s(encer)g(ha)m(v)m(e)i
(a)f(k)m(een)h(ey)m(e)f(and)g(ask)g(probing)300 2702
y(questions;)40 b(their)c(atten)m(tion)i(has)e(b)s(oth)h(ensured)e
(that)j(this)e(w)m(ork)h(k)m(ept)h(a)f(clear)g(fo)s(cus)g(and)f(help)s
(ed)300 2890 y(impro)m(v)m(e)25 b(the)h(writing)d(in)h(terms)h(of)h
(clarit)m(y)f(and)f(precision.)38 b(Olin)23 b(\014elded)g(man)m(y)j(of)
f(m)m(y)h(more)f(esoteric)300 3077 y(questions)k(and)h(p)s(oin)m(ted)f
(me)i(at)g(relev)m(en)m(t)g(researc)m(h)g(pap)s(ers|often)e(with)h(en)m
(tertaining)f(stories)h(that)300 3264 y(help)s(ed)22
b(k)m(eep)i(me)g(motiv)-5 b(ated)24 b(and)f(reminded)e(me)j(ho)m(w)g
(\\co)s(ol")g(it)f(is)g(to)h(b)s(e)f(a)h(programming)f(languages)300
3452 y(hac)m(k)m(er.)58 b(Philip)32 b(w)m(as)k(supp)s(ortiv)m(e)e
(throughout;)k(when)c(the)i(w)m(ork)g(on)f(F)m(C++)h(w)m(as)g(new,)g
(he)g(help)s(ed)300 3639 y(create)30 b(ties)e(to)i(the)e(functional)f
(programming)g(comm)m(unit)m(y)-8 b(,)30 b(and)e(as)g(the)h(w)m(ork)g
(matured,)f(he)h(o\013ered)300 3827 y(useful)g(feedbac)m(k,)i(esp)s
(ecially)e(with)g(regards)h(to)h(design)e(aesthetics.)441
4014 y(I)22 b(also)h(thank)f(Ric)m(h)g(Leblanc,)i(m)m(y)e(original)f
(researc)m(h)i(advisor.)37 b(He)23 b(has)g(encouraged)g(me)f(to)i
(pursue)300 4202 y(m)m(y)30 b(in)m(terest)g(in)f(programming)g
(languages)h(since)g(ev)m(en)g(b)s(efore)g(I)g(b)s(ecame)g(a)h
(graduate)f(studen)m(t,)h(and)300 4389 y(he)26 b(has)f(con)m(tin)m(ued)
h(to)h(b)s(e)e(a)h(participan)m(t)f(and)g(supp)s(orter)f(of)i(m)m(y)g
(w)m(ork)g(ev)m(en)h(after)f(mo)m(ving)g(on)g(to)g(new)300
4576 y(p)s(ositions.)441 4764 y(Finally)-8 b(,)33 b(I)h(thank)f(all)f
(m)m(y)i(friends)e(and)h(family)f(who)h(help)s(ed)f(mak)m(e)i(m)m(y)g
(whole)f(exp)s(erience)g(as)h(a)300 4951 y(graduate)f(studen)m(t)f
(enjo)m(y)m(able.)47 b(There)32 b(are)h(to)s(o)g(man)m(y)g(p)s(eople)e
(to)i(name,)g(but)f(these)h(p)s(eople)e(help)s(ed)300
5139 y(k)m(eep)j(me)f(sane)g(during)e(the)i(o)s(ccasional)g(tough)h(sp)
s(ots,)f(and)f(they)i(shared)e(man)m(y)h(happ)m(y)g(times)f(with)300
5326 y(me)e(during)f(the)h(rest.)2062 5700 y(iii)p eop
%%Page: 4 4
4 3 bop 1359 91 a Fn(T)-11 b(ABLE)43 b(OF)i(CONTENTS)300
453 y Fl(A)m(CKNO)m(WLEDGEMENTS)51 b Fm(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)142 b Fl(iii)300 659 y(LIST)34 b(OF)g(T)-9
b(ABLES)88 b Fm(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)116 b Fl(vii)300 865 y(LIST)34 b(OF)g(FIGURES)93
b Fm(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
87 b Fl(viii)300 1072 y(SUMMAR)-9 b(Y)25 b Fm(.)46 b(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)145
b Fl(ix)300 1278 y(I)d(INTR)m(ODUCTION)42 b Fm(.)k(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)177 b Fl(1)482 1453
y Fm(1.1)94 b(Motiv)-5 b(ation)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)184 b(1)482 1628
y(1.2)94 b(Thesis)84 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)184 b(2)482 1803
y(1.3)94 b(Con)m(tributions)71 b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)184 b(2)691 1978 y(1.3.1)106
b(Comparing)29 b(F)m(C++)h(and)g(LC++)f(to)i(other)g(m)m(ultiparadigm)d
(w)m(ork)62 b(.)46 b(.)f(.)h(.)184 b(2)691 2153 y(1.3.2)106
b(Reusable)29 b(lessons)h(of)g(our)g(w)m(ork)37 b(.)46
b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)184 b(4)482 2328 y(1.4)94 b(Roadmap)29
b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)184 b(5)300 2534 y Fl(I)s(I)99 b(F)m(C++)35
b Fm(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)177 b Fl(7)482 2709 y Fm(2.1)94
b(Motiv)-5 b(ation)31 b(and)e(o)m(v)m(erview)62 b(.)46
b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)184 b(7)482 2884
y(2.2)94 b(Description)29 b(of)i(basic)f(library)e(features)47
b(.)f(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)138 b(10)691 3059 y(2.2.1)106 b(Library)28
b(in)m(tro)s(duction)77 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(11)691 3234 y(2.2.2)106 b(Direct)31 b(functoids)44
b(.)i(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(13)691
3409 y(2.2.3)106 b(Indirect)29 b(functoids)51 b(.)46
b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(18)691 3584
y(2.2.4)106 b(Use)31 b(of)f(direct)g(functoids)68 b(.)46
b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(22)691 3759 y(2.2.5)106
b(F)-8 b(ull)29 b(functoids)67 b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)138 b(26)691 3934 y(2.2.6)106 b(In\014x)29
b(syn)m(tax)71 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
138 b(27)691 4109 y(2.2.7)106 b(Currying)42 b(.)k(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(28)691 4284
y(2.2.8)106 b(Subt)m(yp)s(e)29 b(p)s(olymorphism)41 b(.)46
b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(30)691 4459 y(2.2.9)106
b(C++)29 b(in)m(terface)38 b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)138 b(32)482 4634 y(2.3)94 b(Description)29 b(of)i(adv)-5
b(anced)30 b(library)e(features)91 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(35)691
4809 y(2.3.1)106 b(Lam)m(b)s(da)76 b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(35)691 4984 y(2.3.2)106
b(Monads)90 b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)138 b(45)691 5159 y(2.3.3)106 b(Static)30 b(analysis)f(and)h
(error)g(c)m(hec)m(king)52 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(63)691 5334
y(2.3.4)106 b(Lazy)31 b(lists:)39 b(ev)m(en)31 b(and)f(o)s(dd)60
b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(65)2063 5700 y(iv)p
eop
%%Page: 5 5
5 4 bop 691 91 a Fm(2.3.5)106 b(Strict)30 b(lists)e(and)i(a)h
(generalized)f(list)f(in)m(terface)92 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(69)482 266 y(2.4)94
b(Applications)51 b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)138 b(71)691 441 y(2.4.1)106 b(Higher-order)29
b(functions)g(and)h(design)f(patterns)36 b(.)45 b(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(71)691 616 y(2.4.2)106
b(P)m(arametric)31 b(p)s(olymorphism)26 b(and)k(design)g(patterns)36
b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(77)691 791 y(2.4.3)106 b(Other)30 b(applications)86
b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(86)482
966 y(2.5)94 b(Practical)30 b(considerations)d(.)46 b(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)138 b(87)691 1142 y(2.5.1)106
b(P)m(erformance)47 b(.)e(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)138 b(87)691 1317 y(2.5.2)106 b(P)m(erformance)31
b(analysis)e(and)h(optimizations)91 b(.)46 b(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(95)691 1492 y(2.5.3)106
b(Expressiv)m(eness)29 b(and)h(limitations)k(.)45 b(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(104)482 1667 y(2.6)h(Discussion)64 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(108)300
1873 y Fl(I)s(I)s(I)56 b(LC++)35 b Fm(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)72
b Fl(110)482 2048 y Fm(3.1)94 b(Description)29 b(of)i(the)f(library)k
(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(110)691
2223 y(3.1.1)106 b(In)m(tro)s(ductory)30 b(example)g(and)g(syn)m(tax)g
(o)m(v)m(erview)43 b(.)i(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)93 b(110)691 2398 y(3.1.2)106 b(Declaring)30 b(relations)f(and)h
(logic)g(v)-5 b(ariables)89 b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)93 b(112)691 2573 y(3.1.3)106
b(Calling)28 b(out)j(to)g(C++)e(functions)64 b(.)45 b(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(112)691 2748 y(3.1.4)106 b(Asserting)30 b(facts)h(and)f(rules,)f
(running)e(basic)j(queries)76 b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)93 b(113)691 2923 y(3.1.5)106 b(More)31 b(on)f(queries,)g(en)m
(vironmen)m(ts,)g(and)g(result)f(lists)91 b(.)46 b(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)93 b(114)691 3098 y(3.1.6)106 b(F)-8
b(unctors)31 b(and)e(data)i(structures)24 b(.)46 b(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(116)691 3273 y(3.1.7)106 b(Limitations)85 b(.)45 b(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(118)482 3448 y(3.2)h(Beneath)31
b(the)g(Surface)e(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)93 b(119)691 3623 y(3.2.1)106 b(Query)29 b(execution)i(and)f(C++)f
(in)m(terfacing)87 b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)93 b(119)691 3798 y(3.2.2)106 b(P)m(arsing)30
b(and)f(seman)m(tic)i(analysis)56 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(124)482 3973 y(3.3)h(P)m(oten)m(tial)31 b(applications)37
b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(129)482 4148 y(3.4)h(Detailed)30 b(comparison)g(to)h(related)f(w)m
(ork)92 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)93 b(130)482 4323 y(3.5)h(Discussion)64
b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)93 b(132)300 4529 y Fl(IV)63 b(GENERALIZING)34
b(FR)m(OM)g(C++)83 b Fm(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)72
b Fl(133)482 4704 y Fm(4.1)94 b(Reusable)30 b(lessons)36
b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(133)691 4879 y(4.1.1)106 b(T)m(yp)s(e)39 b(system)h(for)g
(higher-order)e(p)s(olymorphic)g(functions)g(\(using)h(C++-)982
4992 y(st)m(yle)30 b(t)m(yp)s(e)h(inference)f(and)f(template)i
(computation\))68 b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(134)691 5167 y(4.1.2)106 b(Currying)42 b(.)k(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(134)691 5342 y(4.1.3)106
b(In\014x)29 b(function)g(syn)m(tax)68 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)93 b(136)2076 5700 y(v)p eop
%%Page: 6 6
6 5 bop 691 91 a Fm(4.1.4)106 b(Ov)m(erloaded)30 b(list)f(in)m(terface)
68 b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(139)691 266 y(4.1.5)106
b(List)29 b(optimizations)35 b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)93 b(140)691 441 y(4.1.6)106 b(Subt)m(yping)28 b(for)i(functoids)h
(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(142)691 616 y(4.1.7)106
b(Lazy)31 b(lists)e(as)h(an)h(in)m(terface)f(to)i(logic)e(query)f
(results)35 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(144)691 791 y(4.1.8)106 b(F)-8 b(unctoids)30 b(as)g(mec)m(hanism)g
(for)g(logic)g(co)s(de)h(to)g(\\call)f(out")43 b(.)j(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)93 b(145)691 966 y(4.1.9)106 b(Domain-sp)s(eci\014c)29
b(static)i(analyses)87 b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(145)482 1142
y(4.2)h(Capabilities)27 b(of)k(C++)e(and)h(o)m(v)m(erview)h(of)g
(useful)d(language)j(features)85 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)93
b(146)482 1317 y(4.3)h(Limitations)29 b(of)h(C++)f(and)h(advice)h(to)g
(language)f(designers)42 b(.)k(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)93 b(147)691 1492 y(4.3.1)106 b(C++)29 b(limitations)91
b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(149)691
1667 y(4.3.2)106 b(Advice)30 b(to)h(language)g(designers)25
b(.)46 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)93 b(151)300 1873 y Fl(V)103 b(RELA)-9
b(TED)35 b(W)m(ORK)91 b Fm(.)46 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)72 b Fl(155)482 2048 y Fm(5.1)94 b(W)-8
b(ork)31 b(adding)e(functional)g(comp)s(onen)m(ts)h(to)h(ob)5
b(ject-orien)m(ted)32 b(languages)80 b(.)46 b(.)g(.)f(.)h(.)93
b(155)691 2223 y(5.1.1)106 b(Represen)m(ting)30 b(functions)f(in)g(C++)
69 b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)93 b(155)691 2398 y(5.1.2)106 b(Lam)m(b)s(da)76
b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(156)691 2573 y(5.1.3)106 b(Applications)43 b(.)i(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(158)482 2748 y(5.2)h(W)-8
b(ork)31 b(on)f(m)m(ultiparadigm)e(languages)j(with)e(logic)h(comp)s
(onen)m(ts)g(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(159)691 2923 y(5.2.1)106 b(Logic)31 b(programming)e(extensions)g(to)j
(OO)d(languages)48 b(.)e(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(160)691 3098 y(5.2.2)106 b(Other)30 b(languages)g(with)f(a)i
(logic-programming)e(comp)s(onen)m(t)73 b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)
93 b(160)300 3304 y Fl(VI)63 b(CONCLUSIONS)58 b Fm(.)45
b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)72
b Fl(162)482 3479 y Fm(6.1)94 b(Con)m(tributions)71 b(.)45
b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(162)482 3654 y(6.2)h(F)-8 b(uture)30 b(w)m(ork)65 b(.)46
b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(163)2063 5700 y(vi)p eop
%%Page: 7 7
7 6 bop 1551 91 a Fn(LIST)44 b(OF)h(T)-11 b(ABLES)436
453 y Fm(1)164 b(Primes)30 b(\(all)f(times)h(in)f(seconds\))83
b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(89)436 628
y(2)164 b(T)-8 b(ree)31 b(\(all)f(times)g(in)f(seconds\))42
b(.)k(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(91)436
803 y(3)164 b(Hamming)30 b(\(all)g(times)g(in)f(seconds\))42
b(.)k(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(93)436 978 y(4)164
b(Comparison)29 b(of)i(di\013eren)m(t)f(list)f(structures)70
b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)138 b(98)436 1153 y(5)164 b(The)30 b(v)-5
b(alue)30 b(of)h(in)m(trusiv)m(e)e(reference)h(coun)m(ting)37
b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)138 b(99)436 1328 y(6)164 b(The)30 b(v)-5
b(alue)30 b(of)h(reusing)e(functoids)h(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)93 b(100)436 1503 y(7)164 b(The)30 b(v)-5 b(alue)30
b(of)h(using)e(global)g(data)d(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(103)436 1679 y(8)164 b(The)30 b(v)-5 b(alue)30 b(of)h(transforming)e
(tail)g(recursion)g(in)m(to)h(iteration)84 b(.)46 b(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)93 b(103)436 1854 y(9)164 b(The)30
b(v)-5 b(alue)30 b(of)h(four)e(optimizations)h(com)m(bined)69
b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)93 b(104)436 2029 y(10)119 b(Latest)32 b(comparison)e(with)f
(L\177)-45 b(aufer's)30 b(library)73 b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93
b(104)436 2204 y(11)119 b(Syn)m(tax)31 b(mapping)e(b)s(et)m(w)m(een)i
(Prolog)f(and)g(LC++)37 b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(112)436 2379 y(12)119
b(Minim)m(um)29 b(features)h(required)f(for)h(v)-5 b(arious)29
b(reusable)h(ideas.)82 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)93 b(148)2051 5700 y(vii)p eop
%%Page: 8 8
8 7 bop 1509 91 a Fn(LIST)44 b(OF)h(FIGURES)436 453 y
Fm(1)164 b(Some)31 b(examples)f(of)g(what)h(F)m(C++)f(can)g(do)65
b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)138 b(12)436 628 y(2)164 b(P)m(olymorphic)29
b(functions)g(as)i(templates)f(o)m(v)m(er)i(indirect)d(functoids)23
b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(23)436
803 y(3)164 b(P)m(olymorphic)29 b(functions)g(as)i(direct)f(functoids)
71 b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)138 b(23)436 978 y(4)164 b(F)m(C++)31 b(and)e(nativ)m(e)i
(C++)f(functions)g(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(34)436
1153 y(5)164 b(F)m(C++)31 b(and)e(STL)23 b(.)45 b(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(34)436
1328 y(6)164 b(Lam)m(b)s(da)30 b(in)f(F)m(C++)84 b(.)46
b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(42)436 1503 y(7)164 b(The)30 b Fk(Maybe)f Fm(datat)m(yp)s(e)j(in)d(F)
m(C++)c(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(51)436
1679 y(8)164 b(Do)s(cumen)m(tation)32 b(of)e(the)h(monad)f(concept)h
(requiremen)m(ts)e(in)g(F)m(C++)63 b(.)46 b(.)f(.)h(.)g(.)g(.)f(.)h(.)
138 b(52)436 1854 y(9)164 b(De\014nition)29 b(of)i(the)g
Fk(Maybe)d Fm(monad)i(\()p Fk(MaybeM)p Fm(\))49 b(.)d(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(52)436 2029 y(10)119 b(De\014nition)29 b(of)i(the)g
Fk(IdentityM)c Fm(monad)34 b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(55)436 2204 y(11)119 b(Primes)30 b(in)f(Hask)m(ell)40
b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(89)436 2379 y(12)119 b(Primes)30 b(in)f(F)m(C++)62
b(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(90)436 2554 y(13)119 b(T)-8 b(ree)31 b(in)e(Hask)m(ell)71
b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(91)436 2729 y(14)119 b(T)-8 b(ree)31 b(in)e(F)m(C++)93
b(.)45 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(92)436 2904 y(15)119 b(Hamming)30 b(in)f(Hask)m(ell)71
b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(93)436 3079 y(16)119 b(Hamming)30 b(in)f(F)m(C++)93
b(.)45 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138
b(94)436 3254 y(17)119 b(Three)30 b(p)s(ossible)e(list)h(implemen)m
(tations)j(.)46 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)138 b(97)436 3429
y(18)119 b(Non-in)m(trusiv)m(e)30 b(reference)h(coun)m(ting)f(\(left\))
h(and)e(in)m(trusiv)m(e)g(reference)i(coun)m(ting)f(\(righ)m(t\))53
b(98)436 3604 y(19)119 b(tak)m(e\(\))33 b(without)d(functoid)f(reuse)67
b(.)46 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(100)436 3779
y(20)119 b(tak)m(e\(\))33 b(with)c(functoid)g(reuse)58
b(.)46 b(.)f(.)h(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(100)436
3954 y(21)119 b(tak)m(e\(\))33 b(with)c(reuse)h(via)g(a)h(Reuser)f(.)46
b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)93 b(101)436 4129 y(22)119
b(Simpsons)28 b(family)h(relationships)f(in)h(LC++)76
b(.)46 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)93 b(111)2038 5700 y(viii)p eop
%%Page: 9 9
9 8 bop 1737 91 a Fn(SUMMAR)-11 b(Y)578 828 y Fm(Constructs)25
b(for)h(functional)e(and)h(logic)g(programming)g(can)g(b)s(e)g(smo)s
(othly)g(in)m(tegrated)h(in)m(to)g(an)300 1015 y(existing)e(ob)5
b(ject-orien)m(ted)26 b(language.)39 b(W)-8 b(e)26 b(demonstrate)g
(this)e(in)f(the)j(con)m(text)g(of)f(C++)f(\(a)i(statically-)300
1203 y(t)m(yp)s(ed)c(ob)5 b(ject-orien)m(ted)24 b(language)f(with)f
(e\013ects)i(and)e(parametric)g(p)s(olymorphism\))d(via)k(t)m(w)m(o)h
(libraries:)300 1390 y(F)m(C++)f(and)f(LC++.)37 b(F)m(C++)23
b(is)f(a)h(library)d(for)j(functional)e(programming)h(in)f(C++;)k(F)m
(C++)e(supp)s(orts)300 1578 y(higher-order)f(p)s(olymorphic)f
(functions,)i(lazy)h(lists,)f(and)g(a)h(small)e(lam)m(b)s(da)g
(language;)k(it)d(also)h(con)m(tains)300 1765 y(a)k(large)g(library)e
(of)i(useful)e(functions,)h(datat)m(yp)s(es,)i(com)m(binators,)g(and)e
(monads.)40 b(LC++)26 b(is)h(a)h(library)300 1952 y(for)33
b(logic)g(programming)g(in)f(C++;)i(LC++)e(pro)m(vides)h(the)h(same)f
(general)h(functionalit)m(y)e(as)i(Prolog,)300 2140 y(including)41
b(the)k(abilit)m(y)f(to)h(return)f(query)g(results)g(lazily)f(\(one)j
(at)g(a)f(time\).)84 b(Both)46 b(libraries)c(are)300
2327 y(em)m(b)s(edded)29 b(in)g(C++)g(so)h(that)g(they)g(share)g(C++'s)
f(static)i(t)m(yp)s(e)f(system,)g(and)g(the)g(library)e(in)m(terfaces)
300 2515 y(pro)m(vide)h(straigh)m(tforw)m(ard)i(w)m(a)m(ys)g(for)f(co)s
(de)h(from)e(within)f(one)j(paradigm)e(to)i(\\call)f(out")i(to)f
(another.)441 2702 y(Our)26 b(w)m(ork)i(describ)s(es)d(the)j(tec)m
(hniques)f(used)g(to)h(implemen)m(t)e(these)h(libraries)e(in)h(C++)g
(and)h(sho)m(ws)300 2890 y(that)37 b(the)g(resulting)e(m)m
(ultiparadigm)f(language)k(has)e(useful)f(applications)g(in)g(real-w)m
(orld)h(domains.)300 3077 y(W)-8 b(e)27 b(also)e(describ)s(e)f(ho)m(w)h
(man)m(y)h(of)g(the)f(implemen)m(tation)f(tec)m(hniques)h(can)h(b)s(e)f
(generalized)g(from)g(C++)300 3264 y(and)30 b(applied)e(to)j(other)g
(programming)e(languages)h(to)i(yield)c(similar)g(results.)2063
5700 y(ix)p eop
%%Page: 1 10
1 9 bop 1714 91 a Fn(CHAPTER)44 b(I)1550 588 y(INTR)l(ODUCTION)300
1025 y Fm(In)39 b(this)g(c)m(hapter)h(w)m(e)g(pro)m(vide)f(an)h(o)m(v)m
(erview)h(of)e(our)h(researc)m(h)g(w)m(ork.)69 b(W)-8
b(e)41 b(motiv)-5 b(ate)41 b(the)f(topic)g(of)300 1212
y(m)m(ulti-paradigm)30 b(programming,)i(state)h(our)f(thesis,)g(and)f
(pro)m(vide)h(a)g(high-lev)m(el)f(description)f(of)i(our)300
1400 y(con)m(tributions)19 b(to)j(the)f(\014eld|in)d(terms)j(of)g(our)f
(researc)m(h)h(artifacts)h(\(the)f(F)m(C++)g(and)f(LC++)f(libraries\))
300 1587 y(and)28 b(the)g(\\conceptual)h(con)m(tributions")e(of)i(our)e
(w)m(ork.)41 b(This)26 b(c)m(hapter)j(closes)f(with)f(a)i(short)f
(summary)300 1775 y(describing)g(eac)m(h)k(of)e(the)h(remaining)d(c)m
(hapters)j(of)g(the)f(dissertation.)300 2051 y Fj(1.1)140
b(Motivation)300 2297 y Fm(Multi-paradigm)38 b(programming)g(languages)
i(ha)m(v)m(e)h(b)s(een)e(a)h(topic)g(of)g(researc)m(h)g(for)g(decades.)
69 b(The)300 2485 y(basic)30 b(app)s(eal)g(is)g(clear:)41
b(o\013ering)30 b(the)h(programmer)f(a)h(c)m(hoice)h(of)f(paradigms)e
(enables)h(her)g(to)i(c)m(ho)s(ose)300 2672 y(the)f(one)f(b)s(est)g
(suited)f(to)i(the)g(problem)e(domain.)441 2860 y(Recen)m(tly)39
b(there)g(ha)m(v)m(e)g(b)s(een)f(a)h(n)m(um)m(b)s(er)e(of)h(go)s(o)s(d)
g(examples)g(of)h(languages)f(and)g(systems)g(that)300
3047 y(com)m(bine)h(functional)f(and)h(logic)g(programming)f(\(e.g.,)44
b([15)q(,)39 b(20)q(,)h(27)q(,)f(53)q(,)h(64)q(]\),)i(as)e(w)m(ell)e
(as)i(mature)300 3235 y(implemen)m(tations)25 b(that)i(add)f
(functional)f(features)i(to)g(ob)5 b(ject-orien)m(ted)28
b(languages)f(\(e.g.,)i([35)q(,)e(48)q(,)g(56)q(,)300
3422 y(60)q(]\),)i(and)f(few)f(examples)h(that)h(extend)f(ob)5
b(ject-orien)m(ted)29 b(languages)f(with)f(logic)h(programming)e
(\(e.g.)300 3609 y([11)q(,)31 b(10)q(,)f(19)q(]\).)41
b(But)31 b(it)f(is)f(rare)i(to)g(see)g(programming)e(systems)h(that)h
(com)m(bine)f(all)f(three)i(paradigms.)441 3797 y(There)f(app)s(ear)g
(to)h(b)s(e)e(t)m(w)m(o)j(main)d(reasons)h(for)h(the)f(paucit)m(y)g(of)
h(m)m(ultiparadigm)c(languages.)41 b(The)300 3984 y(\014rst)e(stems)g
(from)g(the)h(range)g(of)g(\\expression")f(that)h(m)m(ust)f(b)s(e)g(co)
m(v)m(ered.)70 b(A)m(t)40 b(one)g(extreme,)j(logic)300
4172 y(programming)23 b(pro)m(vides)g(a)i(purely)d(declarativ)m(e)i(sp)
s(eci\014cation)f(for)h(computing)g(a)g(result;)h(at)g(the)g(other)300
4359 y(extreme,)i(imp)s(erativ)m(e)c(OO)h(co)s(de)g(describ)s(es)f(an)h
(algorithm)f(for)h(implemen)m(ting)f(a)h(computation,)i(\014lled)300
4547 y(with)38 b(details)g(ab)s(out)h(whic)m(h)f(v)-5
b(ariables)38 b(get)j(side-e\013ected)f(when.)66 b(\(Consider,)40
b(e.g.,)j(ho)m(w)c(di\013eren)m(t)300 4734 y Fk(sort\(\))j
Fm(lo)s(oks)h(when)g(co)s(ded)h(in)e(C)i(v)m(ersus)f(Prolog.\))82
b(As)44 b(a)g(result,)i(the)e(mere)g(task)h(of)f(creating)300
4922 y(a)e(language)h(syn)m(tax)f(that)h(is)d(capable)i(of)g(represen)m
(ting)g(these)g(di\013eren)m(t)f(expressiv)m(e)h(mo)s(des)f(\(and)300
5109 y(ev)m(erything)30 b(in)f(b)s(et)m(w)m(een\))j(is)d(a)i(c)m
(hallenge.)441 5296 y(The)g(second)f(reason,)i(whic)m(h)e(seems)h(to)g
(b)s(e)f(more)i(di\016cult)c(to)k(o)m(v)m(ercome)h(than)e(the)g
(\014rst,)f(is)g(that)2077 5700 y(1)p eop
%%Page: 2 11
2 10 bop 300 91 a Fm(ev)m(en)42 b(if)e(a)i(language)f(can)h(co)m(v)m
(er)h(the)e(range)h(of)f(expression,)i(so)f(that)g(parts)f(of)g
(programs)g(can)h(b)s(e)300 279 y(written)28 b Fi(within)36
b Fm(eac)m(h)30 b(paradigm,)f(there)g(is)e(still)g(the)i(issue)e(of)i
(comm)m(unicating)g Fi(b)-5 b(etwe)g(en)36 b Fm(paradigms.)300
466 y(There)21 b(is)f(an)i(in)m(terface)f(mismatc)m(h)h(at)g(the)f(b)s
(orders)f(b)s(et)m(w)m(een)i(paradigms|di\013eren)m(t)e(paradigms)g
(treat)300 654 y(fundamen)m(tal)g(issues,)i(suc)m(h)f(as)g(e\013ects,)k
(calling)19 b(con)m(v)m(en)m(tions,)25 b(data)c(represen)m(tation,)j
(and)c(con)m(trol)i(\015o)m(w)300 841 y(di\013eren)m(tly)-8
b(.)39 b(There)28 b(is)g(a)g(great)i(c)m(hallenge)e(in)g(pro)m(viding)e
(smo)s(oth)i(in)m(terfaces)h(that)g(enable)f(co)s(de)g(from)300
1028 y(one)38 b(paradigm)f(to)h(\\call)g(out")g(to)h(co)s(de)f(in)f
(another,)j(so)e(that)g(the)g(b)s(est-matc)m(h)h(paradigm)d(can)j(b)s
(e)300 1216 y(used)30 b(b)m(y)g(the)g(programmer)g(to)h(solv)m(e)g(eac)
m(h)h(individual)25 b(p)s(ortion)k(of)i(the)g(problem)d(at)j(hand.)441
1403 y(W)-8 b(e)27 b(sho)m(w)e(that)g(a)h(smo)s(oth)f(in)m(tegration)g
(of)h(the)f(paradigms)f(can)i(b)s(e)e(ac)m(hiev)m(ed)i(in)e(C++.)38
b(W)-8 b(e)27 b(do)e(so)300 1591 y(with)k(t)m(w)m(o)j(libraries:)38
b(F)m(C++)30 b(for)g(functional)f(programming,)g(and)h(LC++)f(for)h
(logic)g(programming.)300 1867 y Fj(1.2)140 b(Thesis)300
2114 y Fm(Constructs)21 b(for)g(functional)e(and)i(logic)g(programming)
f(can)h(b)s(e)g(smo)s(othly)f(in)m(tegrated)i(in)m(to)f(an)g(existing)
300 2301 y(ob)5 b(ject-orien)m(ted)33 b(language.)47
b(W)-8 b(e)33 b(demonstrate)g(this)e(in)g(the)h(con)m(text)i(of)f(C++,)
e(and)h(sho)m(w)g(that)h(the)300 2488 y(resulting)28
b(m)m(ultiparadigm)g(language)j(has)f(useful)f(applications)f(in)i
(real-w)m(orld)f(domains.)300 2765 y Fj(1.3)140 b(Contributions)300
3011 y Fm(The)28 b(con)m(tributions)e(of)i(our)g(w)m(ork)g(can)h(b)s(e)
e(divided)f(in)m(to)i(t)m(w)m(o)h(main)e(categories.)42
b(The)28 b(\014rst)f(is)g(applied)300 3199 y(v)-5 b(alue;)37
b(this)d(category)i(compares)g(our)e(w)m(ork)h(in)f(C++)f(to)j(other)f
(w)m(ork)g(supp)s(orting)d(m)m(ultiparadigm)300 3386
y(programming.)37 b(The)21 b(second)h(is)f(conceptual)h(v)-5
b(alue;)24 b(this)d(category)j(describ)s(es)c(the)i(\\reusable)f
(lessons")300 3574 y(of)27 b(our)g(w)m(ork|that)g(is,)g(the)g(ideas)g
(whic)m(h)e(can)j(b)s(e)e(reapplied)f(in)g(the)i(con)m(text)i(of)e
(other)h(OO)e(program-)300 3761 y(ming)j(languages)i(to)g(extend)f
(them)h(with)e(m)m(ultiparadigm)f(features.)300 4001
y Fl(1.3.1)105 b(Comparing)35 b(F)m(C++)f(and)h(LC++)g(to)g(other)g(m)m
(ultiparadigm)e(w)m(ork)300 4247 y Fm(Our)28 b(libraries)f(compare)j
(fa)m(v)m(orably)g(with)f(prior)f(w)m(ork)h(in)g(m)m(ultiparadigm)e
(systems.)40 b(This)28 b(is)h(true)g(in)300 4435 y(terms)g(of)g(b)s
(oth)f(practicalit)m(y)h(\(e.g.)41 b(run-time)28 b(p)s(erformance)g
(and)h(pro)m(v)m(en)g(usefulness\))e(and)i(language)300
4622 y(design)k(\(e.g.)52 b(concision\).)e(W)-8 b(e)35
b(highligh)m(t)c(the)j(imp)s(ortan)m(t)f(p)s(oin)m(ts)g(here,)h(whic)m
(h)f(are)h(explored)f(more)300 4809 y(fully)28 b(in)h(later)i
(sections.)436 5097 y Fh(\017)46 b Fm(F)m(C++)40 b(has)h(an)f
(e\016cien)m(t)h(implemen)m(tation)e(thanks)h(to)h(a)f(n)m(um)m(b)s(er)
f(of)i(optimizations.)69 b(The)527 5284 y(optimization)28
b(tec)m(hniques)g(are)h(describ)s(ed)e(and)h(p)s(erformance)g(is)g
(quan)m(ti\014ed)f(in)h(Sections)g(2.5.1)2077 5700 y(2)p
eop
%%Page: 3 12
3 11 bop 527 91 a Fm(&)34 b(2.5.2.)55 b(F)m(C++)35 b(is)e(signi\014can)
m(tly)g(faster)i(than)f(the)h(prior)d(state)k(of)f(the)g(art)f(\(L\177)
-45 b(aufer's)35 b(C++)527 279 y(framew)m(ork)c(for)f(functions[45]\).)
436 539 y Fh(\017)46 b Fm(F)m(C++)40 b(has)h(b)s(een)e(sho)m(wn)h(to)h
(b)s(e)f(a)h(v)-5 b(aluable)39 b(to)s(ol)h(for)g(implemen)m(ting)e(ob)5
b(ject-orien)m(ted)42 b(de-)527 726 y(signs,)30 b(as)i(describ)s(ed)d
(in)g(Section)i(2.4.)44 b(Using)30 b(F)m(C++,)h(the)g(implemen)m
(tations)f(of)h(some)g(design)527 914 y(patterns[23)q(])24
b(are)f(simpler,)g(more)g(e\016cien)m(t,)i(or)e(more)g(t)m(yp)s(esafe)h
(than)f(their)f(con)m(v)m(en)m(tional)i(coun-)527 1101
y(terparts.)436 1361 y Fh(\017)46 b Fm(F)m(C++)23 b(pro)m(vides)g(a)h
(useful)d(infrastructure)h(for)h(building)c(other)24
b(libraries,)e(as)i(evidenced)e(b)m(y)h(our)527 1548
y(\\customers")33 b([12)q(,)f(46)q(,)g(16)q(].)45 b(F)m(C++)31
b(has)h(also)g(in\015uenced)d(the)j(dev)m(elopmen)m(t)g(of)g(a)g(n)m
(um)m(b)s(er)f(of)527 1736 y(Bo)s(ost)37 b(libraries|a)c(group)i(of)h
(widely-distributed,)c(p)s(eer-review)m(ed,)37 b(p)s(ortable)d(C++)h
(source)527 1923 y(libraries)24 b(whic)m(h)i(are)i(lik)m(ely)d(to)j(b)s
(e)f(incorp)s(orated)f(in)m(to)h(future)f(v)m(ersions)g(of)h(the)h(C++)
e(standard)527 2111 y(library)-8 b(.)436 2371 y Fh(\017)46
b Fm(F)m(C++)30 b(pro)m(vides)e(a)i(natural)e(syn)m(tax)i(for)f(doing)g
(functional)f(programming.)39 b(Indeed,)29 b(w)m(e)h(ha)m(v)m(e)527
2558 y(used)h(C++'s)f(extensibilit)m(y)f(features)j(to)g(pro)m(vide)e
(v)-5 b(arious)31 b(kinds)e(of)j(syn)m(tactic)g(sugar)f(for)g(fea-)527
2746 y(tures)36 b(lik)m(e)f(in\014x)e(function)i(call,)h(lam)m(b)s(da,)
g(and)f(monad)h(comprehensions.)55 b(This)34 b(mak)m(es)i(pro-)527
2933 y(gramming)i(in)e(F)m(C++)i(lo)s(ok)g(and)f(feel)h(more)h(lik)m(e)
e(programming)g(in)g(a)h(functional)f(language)527 3121
y(\(e.g.)73 b(Hask)m(ell\).)e(When)40 b(compared)g(to)i(other)e
(functional)f(C++)h(libraries)d(\(e.g.)72 b([35)r(,)40
b(60)q(]\),)527 3308 y(F)m(C++)30 b(is)g(often)h(more)f(concise)h(and)f
(expressiv)m(e.)436 3568 y Fh(\017)46 b Fm(Similarly)-8
b(,)31 b(LC++)h(pro)m(vides)g(an)h(in)m(terface)h(that)g(lo)s(oks)f(v)m
(ery)g(similar)e(to)j(that)g(of)f(a)h(logic)e(lan-)527
3755 y(guage)g(\(e.g.)42 b(Prolog\).)f(The)30 b(declarativ)m(e)h(sp)s
(eci\014cation)e(of)i(logic)f(programming)f(co)s(de)i(is)f(often)527
3943 y(cited)d(as)g(one)h(of)f(the)g(k)m(ey)h(assets)g(of)f(the)g
(paradigm,)g(th)m(us)g(preserving)e(this)h(declarativ)m(e)i(st)m(yle)f
(is)527 4130 y(imp)s(ortan)m(t)h(to)i(pro)m(viding)d(a)i(smo)s(oth)f
(in)m(tegration.)41 b(In)28 b(this)f(resp)s(ect,)j(LC++)d(compares)i
(fa)m(v)m(or-)527 4318 y(ably)35 b(to)h(other)g(attempts)g(to)g(add)f
(logic)g(programming)f(to)i(ob)5 b(ject-orien)m(ted)37
b(languages)e(\(e.g.)527 4505 y([10)q(,)c(19)q(]\).)436
4765 y Fh(\017)46 b Fm(Both)28 b(libraries)c(pro)m(vide)h(a)j(con)m(v)m
(enien)m(t)f(in)m(terface)h(b)s(et)m(w)m(een)f(paradigms.)38
b(F)m(C++,)28 b(LC++,)f(and)527 4953 y(C++)38 b(all)f(share)i(the)g
(same)g(t)m(yp)s(e)f(system)h(and)f(ob)5 b(ject)40 b(represen)m
(tation,)h(and)d(the)h(in)m(terfaces)527 5140 y(pro)m(vide)30
b(a)h(go)s(o)s(d)f(w)m(a)m(y)h(for)f(con)m(trol)h(to)g(\015o)m(w)g
(across)f(paradigms.)436 5400 y Fh(\017)46 b Fm(Finally)-8
b(,)25 b(the)f(libraries)e(include)g(a)j(n)m(um)m(b)s(er)e(of)i
(domain-sp)s(eci\014c)d(static)j(analyses.)39 b(This)23
b(enables)2077 5700 y(3)p eop
%%Page: 4 13
4 12 bop 527 91 a Fm(certain)24 b(t)m(yp)s(es)g(of)g(errors)f(to)h(b)s
(e)f(detected)i(at)g(compile-time,)f(and)f(the)h(C++)f(compiler)f(can)i
(emit)527 279 y(useful)29 b(diagnostics.)441 566 y(T)-8
b(o)42 b(reiterate)h(the)f(last)g(four)f(p)s(oin)m(ts)f(ab)s(o)m(v)m
(e,)47 b(w)m(e)42 b(ha)m(v)m(e)h(implemen)m(ted)d(the)i(libraries)d(in)
i(a)h(w)m(a)m(y)300 753 y(that)j(preserv)m(es)f(the)h(syn)m(tax)g(of)f
(the)h(functional)d(and)i(logic)g(programming)f(domains,)k(in)m
(tegrates)300 941 y(their)40 b(con)m(trol)h(\015o)m(w)g(and)f(t)m(yp)s
(e)g(systems)h(with)f(the)g(base)h(language)g(\(C++\),)j(and)c(pro)m
(vides)f(static)300 1128 y(analyses)31 b(sp)s(eci\014c)f(to)i(the)g
(domains.)42 b(Th)m(us,)31 b(although)g(w)m(e)h(ha)m(v)m(e)g(implemen)m
(ted)e(F)m(C++)h(and)g(LC++)300 1316 y(as)i(C++)g Fi(libr)-5
b(aries)p Fm(,)35 b(it)e(is)f(reasonable)h(to)h(think)d(of)j(them)f(as)
g Fi(domain-sp)-5 b(e)g(ci\014c)37 b(emb)-5 b(e)g(dde)g(d)37
b(languages)300 1503 y Fm(for)30 b(functional)f(and)h(logic)g
(programming.)300 1743 y Fl(1.3.2)105 b(Reusable)36 b(lessons)g(of)f
(our)g(w)m(ork)300 1989 y Fm(In)27 b(addition)e(to)j(the)g(concrete)h
(con)m(tributions)d(of)h(our)g(actual)h(library)d(implemen)m(tation,)i
(man)m(y)g(of)h(the)300 2177 y(ideas)39 b(in)g(our)h(w)m(ork)g(also)g
(generalize.)69 b(That)40 b(is,)i(w)m(e)e(describ)s(e)f(\\no)m(v)m(el)i
(devices)e(for)h(implemen)m(ting)300 2364 y(functional)29
b(or)i(logic)g(programming)f(constructs)h(using)f(C++-lik)m(e)f(mec)m
(hanisms".)43 b(Note)32 b(that)g(there)300 2552 y(are)d(t)m(w)m(o)h
(kinds)d(of)i(reusable)f(lessons)g(here:)40 b(those)29
b(that)h(are)f(reusable)f(within)e(C++,)j(and)f(those)h(that)300
2739 y(are)34 b(reusable)f(in)g(general.)51 b(Th)m(us,)34
b(this)e(information)h(is)g(p)s(oten)m(tially)f(v)-5
b(aluable)33 b(b)s(oth)g(to)h(researc)m(hers)300 2926
y(using)28 b(C++,)h(who)h(w)m(an)m(t)g(to)h(b)s(e)e(able)g(to)i
(replicate)e(asp)s(ects)h(of)g(our)f(w)m(ork,)i(as)f(w)m(ell)e(as)i
(those)h(w)m(orking)300 3114 y(in)39 b(other)i(OO)e(languages)i(who)e
(w)m(an)m(t)j(to)f(extend)f(them)g(with)f(functional)g(or)h(logic)g
(programming)300 3301 y(features.)49 b(Put)33 b(another)g(w)m(a)m(y)-8
b(,)36 b(w)m(e)d(answ)m(er)g(the)h(question)e(\\Where)i(is)e(the)h
(magic?")49 b(and)33 b(sho)m(w)g(ho)m(w)300 3489 y(w)m(e)j(ha)m(v)m(e)h
(succeeded)g(in)d(adding)h(certain)g(features)h(to)h(C++)e(where)g
(others)h(ha)m(v)m(e)h(previously)d(tried)300 3676 y(and)c(failed.)39
b(Some)30 b(of)h(the)g(most)f(imp)s(ortan)m(t)g(of)g(these)h(ideas)f
(are)h(brie\015y)d(listed)h(here:)436 3938 y Fh(\017)46
b Fm(W)-8 b(e)40 b(sho)m(w)f(ho)m(w)g(to)h(implemen)m(t)d(a)j(t)m(yp)s
(e)f(system)g(for)g(higher-order)e(p)s(olymorphic)f(functions,)527
4126 y(using)29 b(C++-st)m(yle)h(t)m(yp)s(e)h(inference)e(and)h
(template)h(computation.)436 4388 y Fh(\017)46 b Fm(W)-8
b(e)38 b(sho)m(w)e(a)g(general)g(mec)m(hanism)f(b)m(y)h(whic)m(h)f(a)i
(language)f(can)h(implemen)m(t)d(currying,)i(based)527
4575 y(on)31 b(op)s(erator)f(o)m(v)m(erloading)h(and)f(template)g
(partial)g(sp)s(ecialization.)436 4837 y Fh(\017)46 b
Fm(W)-8 b(e)27 b(sho)m(w)f(a)g(general)g(mec)m(hanism)f(to)i(obtain)e
(in\014x)f(syn)m(tax)i(for)g(an)m(y)g(arbitrary)e(pre\014x)h(function;)
527 5025 y(this)f(mec)m(hanism)g(can)i(b)s(e)e(used)g(in)g(an)m(y)h
(language)h(whic)m(h)d(supp)s(orts)g(either)i(ad-ho)s(c)g(o)m(v)m
(erloading)527 5212 y(or)31 b(creating)f(new)g(user-de\014nable)f(op)s
(erators.)2077 5700 y(4)p eop
%%Page: 5 14
5 13 bop 436 91 a Fh(\017)46 b Fm(W)-8 b(e)41 b(demonstrate)f(a)g
(general)f(w)m(a)m(y)i(to)f(mak)m(e)h(function)d(ob)5
b(jects)40 b(exhibit)e(subt)m(yp)s(e)g(p)s(olymor-)527
279 y(phism,)29 b(so)h(they)h(can)g(participate)e(in)g(OO)h(t)m(yp)s(e)
h(hierarc)m(hies.)436 539 y Fh(\017)46 b Fm(W)-8 b(e)34
b(sho)m(w)e(that)g(lazy)h(lists)d(pro)m(vide)i(a)g(smo)s(oth)g(w)m(a)m
(y)h(to)g(in)m(terface)g(logic)f(co)s(de)g(with)f(OO)g(co)s(de.)527
726 y(Notably)-8 b(,)39 b(returning)c(logic)h(query)h(results)e(as)i(a)
g(lazy)g(list)e(encapsulates)h(the)h(fact)h(that)f(logic)527
914 y(programming)29 b(is)h(implemen)m(ted)f(in)g(con)m(tin)m(uation)h
(passing)f(st)m(yle.)436 1174 y Fh(\017)46 b Fm(W)-8
b(e)25 b(demonstrate)g(a)f(common)h(list)d(in)m(terface)j(for)f(b)s
(oth)f(strict)h(\(eager\))i(lists)c(and)i(lazy)g(lists)e(\(and)527
1362 y(in)32 b(the)h(case)i(of)e(lazy)g(lists,)g(for)g(b)s(oth)f(the)h
(\\ev)m(en")i(and)e(\\o)s(dd")g(st)m(yle\).)49 b(This)32
b(in)m(terface,)i(based)527 1549 y(on)24 b(t)m(yp)s(eclass-lik)m(e)g(o)
m(v)m(erloading,)i(enables)e(list-pro)s(cessing)e(functions)h(to)i(b)s
(e)f(p)s(olymorphic)d(with)527 1736 y(resp)s(ect)31 b(to)g(the)f(t)m
(yp)s(e)h(of)f(list.)436 1997 y Fh(\017)46 b Fm(W)-8
b(e)29 b(sho)m(w)e(ho)m(w)g(to)h(do)g(static)g(analyses)f(sp)s
(eci\014c)f(to)i(the)f(domains)g(of)g(the)h(added)e(programming)527
2184 y(paradigms,)k(utilizing)d(the)k(T)-8 b(uring-complete)29
b(meta-programming)i(capabilities)d(of)i(C++.)300 2442
y(The)g(whole)f(of)i(Chapter)f(4)h(is)e(dev)m(oted)i(to)g(the)g(topic)f
(of)h(reusable)e(lessons.)300 2717 y Fj(1.4)140 b(R)-7
b(o)g(admap)300 2963 y Fm(The)30 b(rest)g(of)h(the)f(dissertation)g(is)
f(organized)h(as)h(follo)m(ws.)441 3151 y(Chapter)21
b(2)h(describ)s(es)d(the)j(F)m(C++)f(library)d(in)i(great)j(detail.)37
b(The)21 b(library's)e(in)m(terface)i(is)g(explained)300
3338 y(and)h(the)g(ma)5 b(jor)22 b(implemen)m(tation)f(issues)g(are)h
(discussed.)36 b(There)22 b(is)f(also)h(a)h(discussion)c(of)k
(applications)300 3526 y(of)39 b(the)h(library)d(and)h(comparisons)h
(to)h(directly)e(related)h(w)m(ork.)67 b(F)m(C++)40 b(is)e(the)h
(largest)h(and)f(most)300 3713 y(in)m(teresting)30 b(piece)g(of)h(our)e
(w)m(ork,)i(and)f(this)f(c)m(hapter)i(is)f(b)m(y)g(far)g(the)h(largest)
f(in)f(the)i(dissertation.)441 3901 y(Chapter)23 b(3)h(describ)s(es)d
(the)j(LC++)e(library)-8 b(.)37 b(As)23 b(with)f(F)m(C++,)j(the)f(LC++)
e(c)m(hapter)i(describ)s(es)e(the)300 4088 y(library)34
b(in)m(terface,)39 b(k)m(ey)e(implemen)m(tation)e(issues,)i
(applications,)f(and)g(relations)g(to)h(closely)f(related)300
4275 y(w)m(ork.)441 4463 y(Chapter)h(4)g(describ)s(es)f(the)h(reusable)
f(lessons)g(of)i(our)e(w)m(ork.)62 b(Some)37 b(of)g(these)h(lessons)e
(are)i(only)300 4650 y(useful)27 b(in)h(C++,)h(but)g(man)m(y)g(of)g
(them)g(generalize)h(to)g(other)f(programming)f(languages,)i(and)f(w)m
(e)g(giv)m(e)300 4838 y(a)35 b(n)m(um)m(b)s(er)e(of)i(illustrations)d
(of)j(ho)m(w)f(our)h(tec)m(hniques)f(can)h(b)s(e)f(implemen)m(ted)f
(using)g(features)i(found)300 5025 y(in)29 b(other)i(languages.)441
5213 y(Chapter)20 b(5)h(discusses)e(related)h(w)m(ork.)37
b(Whereas)22 b(b)s(oth)d(Chapters)h(2)h(&)f(3)h(mak)m(e)g(direct)f
(comparisons)300 5400 y(to)30 b(closely)e(related)h(w)m(ork,)g(Chapter)
f(5)h(sho)m(ws)g(the)g(\\bigger)g(picture")f(of)h(ho)m(w)g(our)f(w)m
(ork)h(is)f(related)g(to)2077 5700 y(5)p eop
%%Page: 6 15
6 14 bop 300 91 a Fm(a)31 b(n)m(um)m(b)s(er)e(of)h(m)m(ultiparadigm)e
(languages)j(and)f(systems.)441 279 y(Chapter)35 b(6)h(summarizes)e
(the)h(con)m(tributions)f(of)h(our)g(w)m(ork)g(and)g(suggests)h(p)s
(ossible)d(a)m(v)m(en)m(ues)k(of)300 466 y(further)29
b(exploration.)2077 5700 y(6)p eop
%%Page: 7 16
7 15 bop 1687 91 a Fn(CHAPTER)44 b(I)t(I)1906 588 y(F)l(C++)300
1025 y Fm(This)29 b(c)m(hapter)i(describ)s(es)e(F)m(C++,)i(a)g(library)
d(for)i(functional)f(programming)h(in)f(C++.)41 b(W)-8
b(e)32 b(describ)s(e)300 1212 y(the)h(m)m(ultitude)d(of)j(functional)e
(programming)g(features)i(supp)s(orted)e(b)m(y)h(the)h(library)-8
b(,)31 b(b)s(oth)h(in)f(terms)300 1400 y(of)i(their)e(C++)h(implemen)m
(tations)f(and)h(their)f(in)m(terfaces)i(with)e(the)i(rest)f(of)h(the)g
(language.)47 b(W)-8 b(e)34 b(also)300 1587 y(demonstrate)h(a)g(n)m(um)
m(b)s(er)f(of)h(applications)e(and)h(application)f(domains)g(of)i(the)g
(library)-8 b(.)52 b(Finally)32 b(w)m(e)300 1775 y(discuss)42
b(pragmatic)i(issues,)i(including)40 b(considerations)j(of)h(run-time)f
(e\016ciency)g(and)h(the)g(o)m(v)m(erall)300 1962 y(expressiv)m(eness)
30 b(of)g(the)h(library)-8 b(.)300 2239 y Fj(2.1)140
b(Motivation)47 b(and)i(overview)300 2485 y Fm(It)37
b(is)e(a)j(little)d(kno)m(wn)h(fact)i(that)f(part)f(of)h(the)g(C++)f
(Standard)f(Library)g(consists)h(of)h(co)s(de)g(written)300
2672 y(in)k(a)i(functional)e(st)m(yle.)78 b(Although)41
b(the)i(C++)f(Standard)f(Library)g(o\013ers)i(rudimen)m(tary)e(supp)s
(ort)300 2860 y(for)g(higher)f(order)h(functions)g(and)f(currying,)j
(it)e(stops)h(short)f(of)h(supplying)c(a)k(sophisticated)f(and)300
3047 y(reusable)f(mo)s(dule)g(for)h(general)g(purp)s(ose)e(functional)h
(programming.)72 b(This)39 b(is)i(the)g(gap)h(that)f(our)300
3235 y(w)m(ork)35 b(on)h(F)m(C++)f(\014lls.)53 b(The)35
b(result)f(is)g(a)i(full)d(em)m(b)s(edding)g(of)j(a)f(simple)f(pure)g
(functional)g(language)300 3422 y(in)d(C++,)h(using)f(the)h
(extensibilit)m(y)e(capabilities)g(of)i(the)h(language)g(and)e(the)i
(existing)e(compiler)g(and)300 3609 y(run-time)e(infrastructure.)441
3797 y(A)m(t)35 b(\014rst)e(glance)h(it)f(ma)m(y)h(seem)g(that)h(C++)d
(is)h(an)m(tithetical)h(to)g(the)g(functional)e(paradigm.)49
b(The)300 3984 y(language)23 b(not)g(only)f(supp)s(orts)f(direct)i
(memory)g(manipulation)d(but)i(also)h(only)f(has)g(primitiv)m(e)f
(capabil-)300 4172 y(ities)f(for)i(handling)d(functions.)36
b(F)-8 b(unction)21 b(p)s(oin)m(ters)f(are)i(\014rst)f(class)g(en)m
(tities,)i(but)e(they)h(are)f(of)h(little)e(use)300 4359
y(since)j(new)g(functions)f(cannot)i(b)s(e)f(created)i(on)f(the)f
(\015y)h(\(e.g.,)i(as)e(sp)s(ecializations)e(of)i(existing)e(functions)
300 4547 y(b)m(y)j(\014xing)f(some)i(state)g(information\).)38
b(Nev)m(ertheless,)27 b(the)e(elemen)m(ts)h(required)d(to)j(implemen)m
(t)e(a)i(func-)300 4734 y(tional)k(programming)f(framew)m(ork)i(are)f
(already)g(in)g(the)g(language.)42 b(The)30 b(tec)m(hnique)g(of)h
(represen)m(ting)300 4922 y(\014rst-class)26 b(functions)f(using)g
(classes)i(is)f(w)m(ell)f(kno)m(wn)h(in)g(the)h(ob)5
b(ject-orien)m(ted)27 b(w)m(orld.)39 b(Among)27 b(others,)300
5109 y(the)g(Pizza)h(language)f([56)q(])g(uses)g(this)f(approac)m(h)h
(in)f(translating)g(functionally-\015a)m(v)m(ored)g(constructs)h(to)
2077 5700 y(7)p eop
%%Page: 8 17
8 16 bop 300 91 a Fm(Ja)m(v)-5 b(a)35 b(co)s(de.)52 b(The)34
b(same)g(tec)m(hnique)g(is)f(used)h(in)e(previous)h(implemen)m(tations)
g(of)h(higher-order)f(func-)300 279 y(tions)23 b(in)g(C++)f([42)r(,)h
(45)q(].)39 b(C++)23 b(also)h(allo)m(ws)f(users)g(to)h(de\014ne)f(a)h
(familiar)e(syn)m(tax)i(for)g(function-classes,)300 466
y(b)m(y)29 b(o)m(v)m(erloading)h(the)g(function)e(application)f(op)s
(erator,)k(\\\(\)".)42 b(Additionally)26 b(one)k(can)f(declare)h(meth-)
300 654 y(o)s(ds)k(so)g(that)h(they)g(are)g(prev)m(en)m(ted)g(from)f
(mo)s(difying)e(their)h(argumen)m(ts;)k(this)d(prop)s(ert)m(y)f(is)h
(enforced)300 841 y(statically)29 b(b)m(y)g(C++)f(compilers.)39
b(Finally)-8 b(,)28 b(using)f(the)j(C++)e(inheritance)g(capabilities)f
(and)h(dynamic)300 1028 y(dispatc)m(h)34 b(mec)m(hanism,)h(one)f(can)h
(de\014ne)f(v)-5 b(ariables)33 b(that)i(range)g(o)m(v)m(er)g(all)f
(functions)f(with)g(the)i(same)300 1216 y(t)m(yp)s(e)29
b(signature.)40 b(In)28 b(this)g(w)m(a)m(y)-8 b(,)31
b(a)e(C++)f(user)g(can)i(\\hijac)m(k")f(the)g(underlying)d(language)k
(mec)m(hanisms)300 1403 y(to)h(pro)m(vide)f(a)g(functional)f
(programming)g(mo)s(del.)441 1591 y(All)h(of)i(the)g(ab)s(o)m(v)m(e)h
(tec)m(hniques)e(are)h(w)m(ell-kno)m(wn)e(and)h(ha)m(v)m(e)i(b)s(een)e
(used)g(b)s(efore.)44 b(In)31 b(fact,)i(sev)m(eral)300
1778 y(researc)m(hers)f(in)f(the)h(recen)m(t)g(past)g(\(e.g.,)i([60)q
(,)e(42)q(,)g(35)q(,)g(45)q(,)g(52)q(]\))g(ha)m(v)m(e)h(\(re\)disco)m
(v)m(ered)g(that)f(C++)f(can)300 1966 y(b)s(e)h(used)h(for)g
(functional)e(programming.)48 b(Nev)m(ertheless,)35 b(all)d(of)h(the)g
(ab)s(o)m(v)m(e)i(approac)m(hes,)f(as)g(w)m(ell)e(as)300
2153 y(that)f(of)g(the)f(C++)f(Standard)h(Library)-8
b(,)29 b(su\013er)h(from)f(one)i(of)g(t)m(w)m(o)g(dra)m(wbac)m(ks:)436
2429 y Fh(\017)46 b Fm(High)35 b(complexit)m(y)g(when)g(p)s(olymorphic)
d(functions)i(are)i(used:)50 b(P)m(olymorphic)34 b(functions)g(ma)m(y)
527 2616 y(need)23 b(to)g(b)s(e)f(explicitly)e(turned)i(in)m(to)h
(monomorphic)e(instances)h(b)s(efore)g(they)h(can)g(b)s(e)f(used.)38
b(This)527 2804 y(causes)c(the)f(implemen)m(tation)f(to)i(b)s(ecome)f
(v)m(ery)h(complex.)48 b(L\177)-45 b(aufer)33 b(observ)m(ed)g(in)f([45)
q(]:)47 b(\\...the)527 2991 y(t)m(yp)s(e)31 b(information)e(required)g
(in)g(more)i(complex)g(applications)e(of)h(the)h(framew)m(ork)g(is)f
(lik)m(ely)f(to)527 3179 y(get)j(out)e(of)h(hand,)e(esp)s(ecially)g
(when)g(higher)g(n)m(um)m(b)s(ers)g(of)i(argumen)m(ts)g(are)f(in)m(v)m
(olv)m(ed.")436 3437 y Fh(\017)46 b Fm(Lac)m(k)25 b(of)g(expressiv)m
(eness:)37 b(In)23 b(order)h(to)h(represen)m(t)f(p)s(olymorphic)d
(functions,)j(one)h(can)f(use)g(C++)527 3625 y(function)f(templates.)39
b(This)23 b(approac)m(h)h(do)s(es)g(not)h(su\013er)f(from)g(high)f
(complexit)m(y)h(of)g(parameter-)527 3812 y(ization,)j(b)s(ecause)f
(the)g(t)m(yp)s(e)g(parameters)g(do)f(not)h(need)g(to)g(b)s(e)f(sp)s
(eci\014ed)g(explicitly)e(whenev)m(er)j(a)527 3999 y(p)s(olymorphic)g
(function)i(is)g(used.)40 b(Unfortunately)-8 b(,)29 b(function)f
(templates)h(cannot)h(b)s(e)e(passed)h(as)527 4187 y(argumen)m(ts)35
b(to)f(other)h(function)e(templates.)52 b(Th)m(us,)34
b(using)f(C++)g(function)f(templates,)k(p)s(oly-)527
4374 y(morphic)j(functions)g(cannot)i(tak)m(e)g(other)g(p)s(olymorphic)
c(functions)i(as)i(argumen)m(ts.)70 b(This)39 b(is)527
4562 y(eviden)m(t)c(in)f(the)h(C++)f(Standard)g(Library)-8
b(,)35 b(where)f(\\higher)h(order")g(p)s(olymorphic)d(op)s(erators)527
4749 y(lik)m(e)f Fk(compose1)p Fm(,)e Fk(bind1st)p Fm(,)g(etc.)44
b(are)32 b(not)f(\\functions")g(inside)d(the)k(Standard)d(Library)h
(frame-)527 4937 y(w)m(ork)h(and,)f(hence,)h(cannot)g(b)s(e)e(passed)h
(as)h(argumen)m(ts)f(to)i(themselv)m(es)e(or)g(other)h(op)s(erators.)
441 5213 y(Our)21 b(w)m(ork)h(addresses)g(b)s(oth)f(of)h(the)h(ab)s(o)m
(v)m(e)g(problems.)36 b(Con)m(trary)22 b(to)h(prior)e(b)s(elief)f
(\(see)j(L\177)-45 b(aufer)21 b([45)q(],)300 5400 y(who)37
b(also)f(quotes)i(p)s(ersonal)d(comm)m(unication)i(with)e(Dami\))j(no)e
(mo)s(di\014cation)g(to)h(the)h(language)f(or)2077 5700
y(8)p eop
%%Page: 9 18
9 17 bop 300 91 a Fm(the)27 b(compiler)e(is)g(needed.)40
b(Instead,)27 b(w)m(e)g(are)g(relying)e(on)h(an)h(inno)m(v)-5
b(ativ)m(e)26 b(use)h(of)f(C++)g(t)m(yp)s(e)g(inference.)300
279 y(E\013ectiv)m(ely)-8 b(,)32 b(our)f(framew)m(ork)g(main)m(tains)f
(its)h(o)m(wn)g(t)m(yp)s(e)g(system,)h(in)e(whic)m(h)g(p)s(olymorphic)e
(functions)300 466 y(can)j(b)s(e)e(sp)s(eci\014ed)g(and)h(other)g(p)s
(olymorphic)e(functions)h(can)i(recognize)g(them)f(as)h(suc)m(h.)441
654 y([Imp)s(ortan)m(t)22 b(note:)38 b(Since)21 b(C++)h(t)m(yp)s(e)g
(inference)g(is)f(in)g(the)i(core)g(of)f(our)g(tec)m(hnique,)i(a)f
(disclaimer)d(is)300 841 y(in)g(order:)36 b(C++)21 b(t)m(yp)s(e)h
(inference)e(is)h(a)h(uni\014cation)e(pro)s(cess)h(matc)m(hing)g(the)h
(t)m(yp)s(es)g(of)g(actual)g(argumen)m(ts)300 1028 y(of)h(a)g(function)
f(template)i(to)f(the)g(declared)g(p)s(olymorphic)d(t)m(yp)s(es)j
(\(whic)m(h)f(ma)m(y)i(con)m(tain)f(t)m(yp)s(e)g(v)-5
b(ariables,)300 1216 y(whose)37 b(v)-5 b(alue)36 b(is)g(determined)f(b)
m(y)i(the)g(inference)f(pro)s(cess\).)59 b(C++)36 b(t)m(yp)s(e)h
(inference)f(do)s(es)h(not)g(solv)m(e)300 1403 y(a)j(system)g(of)g(t)m
(yp)s(e)g(equations)g(and)f(do)s(es)g(not)h(reliev)m(e)g(the)g
(programmer)f(from)h(the)g(obligation)e(to)300 1591 y(sp)s(ecify)g(t)m
(yp)s(e)i(signatures)f(for)h(functions.)67 b(Th)m(us,)42
b(the)e(term)f(\\C++)h(t)m(yp)s(e)f(inference")h(should)e(not)300
1778 y(b)s(e)30 b(confused)f(with)h(\\t)m(yp)s(e)h(inference")f(as)g
(emplo)m(y)m(ed)h(in)e(functional)g(languages)h(lik)m(e)g(ML)h(or)f
(Hask)m(ell.)300 1966 y(The)25 b(o)m(v)m(erloading)h(is)f(unfortunate)g
(but)g(una)m(v)m(oidable)f(as)i(use)g(of)f(b)s(oth)g(terms)h(is)f
(widespread.)37 b(W)-8 b(e)27 b(will)300 2153 y(alw)m(a)m(ys)k(use)f
(the)h(pre\014x)e(\\C++")h(when)g(w)m(e)g(refer)g(to)i(\\C++)d(t)m(yp)s
(e)i(inference".])441 2340 y(The)46 b(result)f(of)h(our)g(approac)m(h)g
(is)f(a)h(con)m(v)m(enien)m(t)i(and)d(p)s(o)m(w)m(erful)g(parametric)h
(p)s(olymorphism)300 2528 y(sc)m(heme)d(that)f(is)f(w)m(ell)g(in)m
(tegrated)i(in)d(the)j(language:)64 b(with)40 b(the)j(F)m(C++)e
(library)-8 b(,)44 b(C++)c(o\013ers)j(as)300 2715 y(m)m(uc)m(h)29
b(supp)s(ort)e(for)i(higher-order)e(p)s(olymorphic)g(functions)g(as)i
(it)g(do)s(es)f(for)h(nativ)m(e)h(t)m(yp)s(es)f(\(e.g.,)i(in)m(te-)300
2903 y(gers)g(and)e(p)s(oin)m(ters\).)441 3090 y(Apart)i(from)e(the)i
(ab)s(o)m(v)m(e)h(no)m(v)m(elt)m(y)-8 b(,)32 b(F)m(C++)e(also)g
(o\013ers)h(a)g(few)f(more)h(new)e(elemen)m(ts:)436 3377
y Fh(\017)46 b Fm(First,)35 b(w)m(e)f(de\014ne)f(a)h(subt)m(yping)e(p)s
(olicy)g(for)i(functions)e(of)i(F)m(C++,)h(th)m(us)f(supp)s(orting)d
(subt)m(yp)s(e)527 3565 y(p)s(olymorphism.)k(The)22 b(default)f(p)s
(olicy)g(is)g(what)i(one)g(w)m(ould)e(exp)s(ect:)37 b(a)23
b(function)e(A)i(is)e(a)i(subt)m(yp)s(e)527 3752 y(of)k(function)d(B,)j
(i\013)f(A)g(and)f(B)i(ha)m(v)m(e)g(the)g(same)f(n)m(um)m(b)s(er)f(of)i
(argumen)m(ts,)g(all)e(argumen)m(ts)i(of)f(B)h(are)527
3940 y(subt)m(yp)s(es)f(of)i(the)g(corresp)s(onding)d(argumen)m(ts)i
(of)h(A,)g(and)e(the)i(return)e(v)-5 b(alue)27 b(of)g(A)h(is)e(a)i
(subt)m(yp)s(e)527 4127 y(of)39 b(the)h(return)e(v)-5
b(alue)38 b(of)h(B.)h(\(Using)e(OO)h(t)m(yping)f(terminology)-8
b(,)41 b(w)m(e)f(sa)m(y)f(that)h(our)f(p)s(olicy)e(is)527
4314 y(co)m(v)-5 b(arian)m(t)40 b(with)e(resp)s(ect)h(to)h(return)d(t)m
(yp)s(es)i(and)g(con)m(tra)m(v)-5 b(arian)m(t)40 b(with)e(resp)s(ect)h
(to)g(argumen)m(t)527 4502 y(t)m(yp)s(es.\))53 b(Subt)m(yp)s(e)33
b(substitutabilit)m(y)f(is)h(guaran)m(teed;)38 b(a)d(function)e
Fk(Animal*)46 b(->)h(Car*)33 b Fm(can)i(b)s(e)527 4689
y(used)30 b(where)g(a)g(function)g Fk(Dog*)46 b(->)h(Vehicle*)28
b Fm(is)i(exp)s(ected.)436 4951 y Fh(\017)46 b Fm(Second,)34
b(F)m(C++)g(pro)m(vides)e(a)i(n)m(um)m(b)s(er)e(of)h(useful)f(syn)m
(tax)i(sugars.)49 b(A)34 b(set)g(of)g(reusable)e(com)m(bi-)527
5139 y(nators)37 b(supp)s(ort)e(automatic)i(currying;)h(curry)m(able)e
(functions)f(can)i(b)s(e)f(called)f(with)h(a)h(subset)527
5326 y(of)f(the)g(argumen)m(ts)g(they)g(exp)s(ect,)h(binding)c(those)j
(v)-5 b(alues)35 b(and)g(resulting)f(in)g(a)i(new)f(function)2077
5700 y(9)p eop
%%Page: 10 19
10 18 bop 527 91 a Fm(that)42 b(exp)s(ects)g(the)f(remainder)f(of)h
(the)g(argumen)m(ts.)74 b(F)-8 b(unctions)41 b(can)g(b)s(e)g(called)f
(using)g(in\014x)527 279 y(syn)m(tax,)f(similar)34 b(to)k(the)f
Fk(`function`)d Fm(syn)m(tax)j(in)e(Hask)m(ell.)60 b(Anon)m(ymous)36
b(functions)g(can)h(b)s(e)527 466 y(created)c(with)e(a)h(library)d
(that)k(sim)m(ulates)e Fi(lamb)-5 b(da)p Fm(,)34 b(and)d(monads)g(can)i
(b)s(e)e(manipulated)e(using)527 654 y Fi(c)-5 b(ompr)g(ehensions)p
Fm(.)436 916 y Fh(\017)46 b Fm(Third,)h(F)m(C++)f(has)f(a)h(high)e(lev)
m(el)h(of)h(tec)m(hnical)f(maturit)m(y)-8 b(.)86 b(F)-8
b(or)46 b(instance,)k(compared)45 b(to)527 1103 y(L\177)-45
b(aufer's)24 b(approac)m(h,)j(w)m(e)d(ac)m(hiev)m(e)i(an)f(equally)e
(safe)i(but)e(more)i(e\016cien)m(t)g(implemen)m(tation)e(of)i(the)527
1291 y(basic)35 b(framew)m(ork)g(for)g(higher)e(order)i(functions.)53
b(W)-8 b(e)36 b(describ)s(e)e(a)h(n)m(um)m(b)s(er)f(of)h(optimizations)
527 1478 y(w)m(e)30 b(ha)m(v)m(e)g(applied)d(to)j(the)g(library)-8
b(,)27 b(and)i(use)g(exp)s(erimen)m(ts)f(to)i(demonstrate)g(quan)m
(ti\014ably)d(that)527 1665 y(these)k(optimizations)e(increase)h(p)s
(erformance)g(b)m(y)g(almost)h(an)f(order)g(of)h(magnitude.)441
1953 y(Additionally)-8 b(,)28 b(F)m(C++)j(builds)c(signi\014can)m(t)j
(functionalit)m(y)f(on)i(top)f(of)h(the)g(basic)f(framew)m(ork.)42
b(W)-8 b(e)300 2140 y(exp)s(ort)34 b(t)m(w)m(o)h(fairly)e(mature)h
(reference-coun)m(ting)h(\\p)s(oin)m(ter")f(classes)g(to)h(library)d
(users,)i(so)g(that)h(use)300 2327 y(of)g(C++)f(p)s(oin)m(ters)f(can)i
(b)s(e)f(completely)h(eliminated)e(at)i(the)g(user)f(lev)m(el.)53
b(W)-8 b(e)36 b(pro)m(vide)e(facilities)f(for)300 2515
y(lazy)d(ev)-5 b(aluation,)29 b(via)g(b)s(oth)g(a)h(lazy)f(list)f(data)
j(t)m(yp)s(e)e(and)g(a)h(\\b)m(y)g(need")g(monad.)40
b(W)-8 b(e)30 b(de\014ne)f(a)h(w)m(ealth)300 2702 y(of)i(useful)e
(functions)g(\(a)i(large)g(part)f(of)h(the)g(Hask)m(ell)f(Standard)g
(Prelude\))f(to)j(enhance)e(the)h(usabilit)m(y)300 2890
y(of)k(F)m(C++)f(and)g(demonstrate)i(the)e(expressiv)m(eness)g(of)h
(our)f(framew)m(ork.)57 b(It)36 b(should)d(b)s(e)j(noted)f(that)300
3077 y(de\014ning)g(these)j(functions)e(in)g(a)i(con)m(v)m(enien)m(t,)j
(reusable)36 b(form)h(is)g(p)s(ossible)e(exactly)j(b)s(ecause)f(of)h
(the)300 3265 y(supp)s(ort)20 b(for)i(p)s(olymorphic)d(functions)h
(o\013ered)j(b)m(y)e(F)m(C++.)38 b(It)22 b(is)f(no)h(acciden)m(t)g
(that)h(suc)m(h)e(higher-order)300 3452 y(library)30
b(functions)h(are)i(missing)e(from)h(other)h(C++)f(libraries:)42
b(supplying)29 b(explicit)i(t)m(yp)s(es)i(w)m(ould)f(b)s(e)300
3639 y(tedious)e(and)f(w)m(ould)h(render)f(the)h(functions)f(virtually)
f(un)m(usable.)300 3916 y Fj(2.2)140 b(Description)47
b(of)i(b)-7 b(asic)48 b(libr)-7 b(ary)49 b(fe)-7 b(atur)g(es)300
4162 y Fm(In)43 b(this)g(section)g(w)m(e)i(discuss)c(the)j(ma)5
b(jorit)m(y)44 b(of)g(the)g(features)g(of)g(the)g(library)-8
b(,)45 b(in)d(terms)i(of)g(b)s(oth)300 4350 y(in)m(terface)33
b(and)e(implemen)m(tation.)44 b(In)32 b(Section)g(2.3,)i(w)m(e)e(delv)m
(e)g(in)m(to)g(some)h(of)f(the)g(more)g(complicated)300
4537 y(and)e(subtle)f(features)i(of)f(the)h(library)-8
b(.)441 4725 y(W)g(e)44 b(brie\015y)e(de\014ne)g(one)h(term)g(here)g
(at)h(the)f(outset.)80 b(In)42 b(F)m(C++,)k(a)e Fi(functoid)53
b Fm(is)42 b(our)g(c)m(hosen)300 4912 y(represen)m(tation)c(for)g
(function)f(ob)5 b(jects.)65 b(The)37 b(di\013eren)m(t)h(kinds)e(of)i
(functoids)f(will)f(b)s(e)h(describ)s(ed)f(in)300 5099
y(detail)f(shortly)h(\(Sections)g(2.2.2,)i(2.2.3,)h(and)c(2.2.5\);)42
b(un)m(til)34 b(then,)k(it)e(is)f(\014ne)h(to)h(simply)c(equate)38
b(the)300 5287 y(terms)30 b(\\functoid")g(and)g(\\function".)2055
5700 y(10)p eop
%%Page: 11 20
11 19 bop 300 91 a Fl(2.2.1)105 b(Library)35 b(in)m(tro)s(duction)300
337 y Fm(W)-8 b(e)33 b(b)s(egin)e(with)g(a)i(brief)e(o)m(v)m(erview)i
(of)f(ho)m(w)g(the)h(F)m(C++)f(library)e(is)h(used.)46
b(Figure)32 b(1)g(will)e(serv)m(e)j(as)g(a)300 525 y(running)28
b(example)i(to)h(illustrate)d(man)m(y)j(of)f(the)h(main)e(features)i
(of)f(the)h(library)-8 b(.)441 712 y(F)m(C++)35 b(lists)e(supp)s(ort)g
(the)i(usual)e(list)h(in)m(terface;)k Fk(cons\(\))p Fm(,)c
Fk(null\(\))p Fm(,)h Fk(head\(\))p Fm(,)f(and)g Fk(tail\(\))g
Fm(are)300 900 y(among)f(the)f(basic)g(functions)e(that)j(w)m(ork)f(on)
g Fk(List)p Fm(s.)45 b Fk(List)p Fm(s)31 b(are)h(parameterized)h(b)m(y)
f(the)g(data)h(t)m(yp)s(e)300 1087 y(they)38 b(con)m(tain;)j
Fk(List)p Fm(s)c(and)f(the)i(asso)s(ciated)g(functions)e(are)i(p)s
(olymorphic.)59 b(P)m(art)39 b(\(A\))f(of)g(Figure)f(1)300
1275 y(illustrates)28 b(some)j(basic)f(list)f(co)s(de.)441
1462 y(F)m(C++)37 b(has)g(a)g(n)m(um)m(b)s(er)e(of)i(higher-order)f
(functions,)h(lik)m(e)f Fk(compose\(\))p Fm(,)h(whic)m(h)e(can)i(tak)m
(e)i(p)s(oly-)300 1649 y(morphic)24 b(functions)g(as)i(argumen)m(ts.)39
b(P)m(art)27 b(\(B\))f(of)g(Figure)f(1)h(illustrates)e(that)i
Fk(compose\(tail,tail\))300 1837 y Fm(yields)j(a)i(new)e(\(p)s
(olymorphic\))g(function)g(whic)m(h)g(discards)g(the)i(\014rst)e(t)m(w)
m(o)j(elemen)m(ts)f(of)g(a)f(list.)40 b(F)m(C++)300 2024
y(w)m(as)c(the)h(\014rst)e(C++)g(library)e(to)k(enable)f(the)g(user)f
(to)i(generally)e(com)m(bine)h(higher-order)e(functions)300
2212 y(with)g(p)s(olymorphic)f(ones;)39 b(with)34 b(F)m(C++,)j(p)s
(olymorphic)c(functions)h(ma)m(y)j(b)s(e)e(passed)g(as)h(argumen)m(ts)
300 2399 y(to)31 b(other)g(functions)e(and)g(returned)h(as)g(results.)
441 2587 y(F)m(C++)36 b Fk(List)p Fm(s)f(are)h(lazy)-8
b(.)59 b(P)m(art)37 b(\(C\))f(of)h(Figure)e(1)i(demonstrates)f
(in\014nite)e(lists)h(in)g(F)m(C++;)k(the)300 2774 y(elemen)m(ts)31
b(of)f(the)h(list)e(are)i(pro)s(duced)d(only)i(as)g(they)h(are)g
(needed.)441 2961 y(F)m(C++)j(functoids)f(supp)s(ort)g(currying.)51
b(F)-8 b(or)35 b(example,)h(in)d(P)m(art)i(\(D\))h(of)e(Figure)g(1,)i
Fk(plus\(\))d Fm(is)h(a)300 3149 y(t)m(w)m(o-argumen)m(t)k(function,)e
(but)f(it)h(can)g(b)s(e)f(called)g(with)f(just)i(one)g(argumen)m(t,)h
(yielding)d(a)i(new)f(one-)300 3336 y(argumen)m(t)k(function)e(as)i(a)g
(result.)64 b(In)37 b(the)i(example,)h Fk(map\(\))d Fm(applies)g(this)g
(new)h(function)g(to)h(eac)m(h)300 3524 y(elemen)m(t)30
b(of)f(the)h(list,)e(yielding)f(a)i(new)g(lists)f(where)h(all)f(of)h
(the)h(v)-5 b(alues)28 b(ha)m(v)m(e)j(b)s(een)d(incremen)m(ted)h(b)m(y)
g(1.)300 3711 y(As)34 b(seen)g(in)f(the)h(example,)h
Fk(map\(\))d Fm(is)h(also)h(curry)m(able.)51 b(T)-8 b(o)34
b(bind)e(v)-5 b(alues)33 b(to)i(argumen)m(ts)f(other)g(than)300
3899 y(the)25 b(initial)e(argumen)m(ts,)k(an)e(underscore)f(can)i(b)s
(e)e(used)h(as)g(a)h(placeholder)e(for)h(argumen)m(ts)g(that)h(should)
300 4086 y(b)s(e)k(curried.)441 4274 y(The)35 b(F)m(C++)g(library)e
(con)m(tains)j(more)f(than)h(50)g(useful)d(functions)h(from)h(the)h
(Hask)m(ell)f(Standard)300 4461 y(Prelude)44 b([40)q(].)85
b(The)45 b(prior)f(examples)h(ha)m(v)m(e)h(already)f(used)f(familiar)f
(functions)h(lik)m(e)h Fk(map\(\))f Fm(and)300 4648 y
Fk(filter\(\))p Fm(;)27 b(F)m(C++)g(include)f(dozens)i(of)f(suc)m(h)h
(general)g(functions,)f(including)d Fk(take\(\))p Fm(,)j(whic)m(h)f
(selects)300 4836 y(the)h(\014rst)g(N)g(elemen)m(ts)h(of)f(a)h(list,)f
(and)f Fk(foldl1\(\))f Fm(whic)m(h)h(left-accum)m(ulates)i(all)e(of)i
(the)f(v)-5 b(alues)27 b(in)f(a)h(list)300 5023 y(using)i(a)i(giv)m(en)
f(function.)441 5211 y(F)m(C++)e(has)f(\\indirect)g(functoids",)h
(run-time)e(v)-5 b(ariables)27 b(whic)m(h)f(can)i(b)s(e)g(b)s(ound)d
(to)k(an)m(y)f(function)300 5398 y(with)k(a)h(giv)m(en)g(monomorphic)f
(signature.)48 b(P)m(art)34 b(\(F\))g(of)f(Figure)f(1)i(illustrates)d
(an)i(indirect)e(functoid)2055 5700 y(11)p eop
%%Page: 12 21
12 20 bop 443 595 a Fk(int)47 b(x=1,)g(y=2,)f(z=3;)443
708 y(string)g(s="foo",)g(t="bar";)443 934 y(//)h(\(A\))g(List)g
(basics)443 1047 y(List<int>)e(li)j(=)f(cons\(x,cons\(y,cons\(z,NIL\))o
(\)\);)443 1160 y(List<string>)e(ls)i(=)g(cons\(s,cons\(t,NIL\)\);)443
1273 y(assert\()f(head\(ls\))g(==)h("foo")f(\);)443 1386
y(assert\()g(length\(tail\(li\)\))d(==)48 b(1)f(\);)443
1611 y(//)g(\(B\))g(Higher-order)e(polymorphic)f(compose\(\))443
1724 y(li)j(=)h(compose\()d(tail,)i(tail)f(\)\(li\);)443
1837 y(assert\()g(head\(li\))g(==)h(3)g(\);)443 2063
y(//)g(\(C\))g(Laziness)f(\(infinite)f(lists\))443 2176
y(li)i(=)h(enumFrom\(1\);)235 b(//)47 b([1,2,3,...])443
2289 y(li)g(=)h(filter\(even,li\);)43 b(//)k([2,4,6,...])443
2515 y(//)g(\(D\))g(Currying)443 2628 y(li)g(=)h(map\()e(plus\(1\),)g
(li)h(\);)443 2741 y(li)g(=)h(map\()e(plus\(1\))g(\)\()h(li)h(\);)443
2853 y(li)f(=)h(map\()e(_,)i(li)f(\)\()g(plus\(1\))f(\);)443
3079 y(//)h(\(E\))g(Haskell)f(Standard)g(Prelude)443
3192 y(li)h(=)h(take\()e(5,)h(enumFrom\(1\))e(\);)443
3305 y(assert\()h(foldr\(plus,3,li\)==18)c(\);)443 3418
y(assert\()k(foldl1\(plus,ls\)=="foobar)o(")c(\);)443
3644 y(//)47 b(\(F\))g(Indirect)f(functoids)443 3757
y(Fun2<int,int,int>)d(f)48 b(=)f(monomorphize1<int,int,int)o(>\()42
b(plus)k(\);)443 3870 y(assert\()g(f\(3,2\))g(==)h(5)h(\);)443
3983 y(f)g(=)f(minus;)94 b(//)47 b(implicit)f(conversion)443
4095 y(assert\()g(f\(3,2\))g(==)h(1)h(\);)443 4321 y(//)f(\(G\))g
(Infix)g(syntax)443 4434 y(assert\()f(\(3)h(^plus^)f(2\))h(==)h(5)f
(\);)443 4547 y(assert\()f(\(plus)g(^foldr^)g(3\)\(li\)==18)f(\);)1110
4843 y Fl(Figure)35 b(1:)46 b Fm(Some)31 b(examples)f(of)g(what)h(F)m
(C++)f(can)g(do)2055 5700 y(12)p eop
%%Page: 13 22
13 21 bop 300 91 a Fm(v)-5 b(ariable)32 b Fk(f)g Fm(of)h(t)m(yp)s(e)g
Fk(Fun2<int,int,int>)p Fm(|a)c(t)m(w)m(o-argumen)m(t)35
b(function)c(whic)m(h)h(tak)m(es)i(t)m(w)m(o)h(in)m(teger)300
279 y(argumen)m(ts)c(and)e(returns)h(an)g(in)m(teger)h(result.)39
b(This)29 b(v)-5 b(ariable)29 b(can)h(b)s(e)g(b)s(ound)e(to)k
(di\013eren)m(t)d(functions)300 466 y(with)i(the)i(righ)m(t)f
(signature,)h(for)f(instance,)h Fk(plus\(\))e Fm(or)i
Fk(minus\(\))p Fm(.)45 b(Since)31 b Fk(plus\(\))g Fm(is)h(a)h(p)s
(olymorphic)300 654 y(function,)38 b(a)f(monomorphic)f(instance)g(m)m
(ust)h(b)s(e)g(selected)g(to)h(b)s(e)e(b)s(ound)f(to)j(the)f(indirect)e
(functoid)300 841 y(v)-5 b(ariable.)40 b(This)28 b(monomorphizing)g
(con)m(v)m(ersion)j(ma)m(y)g(b)s(e)f(done)g(either)g(explicitly)e(or)i
(implicitly)-8 b(.)441 1028 y(F)m(C++)29 b(functoids)e(of)i(t)m(w)m(o)h
(or)f(more)g(argumen)m(ts)g(can)g(b)s(e)f(called)g(using)f(a)i(sp)s
(ecial)e(\\in\014x)h(syn)m(tax".)300 1216 y(P)m(art)34
b(\(G\))g(of)f(Figure)f(1)i(sho)m(ws)e(ho)m(w)h(functoids)f(can)h(b)s
(e)g(used)f(lik)m(e)g(in\014x)f(op)s(erators)i(b)m(y)g(surrounding)300
1403 y(their)40 b(names)h(in)e(carets.)73 b(When)41 b(functoids)e(of)i
(more)g(than)f(t)m(w)m(o)j(argumen)m(ts)e(are)g(used)f(in\014x,)i(the)
300 1591 y(remaining)28 b(argumen)m(ts)j(are)g(curried.)441
1778 y(The)37 b(example)g(in)f(this)g(subsection)g(giv)m(es)i(an)f(o)m
(v)m(erview)h(of)g(the)f(main)f(features)i(of)f(the)h(library)-8
b(.)300 1966 y(Tw)m(o)35 b(notable)g(features)g(whic)m(h)f(are)h(not)h
(demonstrated)f(in)e(this)h(example)h(are)g(F)m(C++'s)g(\\lam)m(b)s
(da")300 2153 y(\(a)40 b(sub-library)d(for)j(creating)g(anon)m(ymous)f
(functions)g(on-the-\015y\),)k(and)c(the)h(F)m(C++)f(facilities)f(for)
300 2340 y(monads)k(\(including)d(syn)m(tax)k(sugars)f(lik)m(e)f
(monadic)h(comprehensions\).)75 b(These)42 b(features)h(will)d(b)s(e)
300 2528 y(describ)s(ed)28 b(later,)j(in)e(Section)h(2.3.)300
2761 y Fl(2.2.2)105 b(Direct)36 b(functoids)300 3007
y Fm(F)m(C++)27 b(represen)m(ts)g(p)s(olymorphic)e(functions)h(with)g
(\\direct)h(functoids".)39 b(W)-8 b(e)28 b(will)d(b)s(egin)h(b)m(y)h
(describ-)300 3195 y(ing)i(the)h(sp)s(ecial)e(case)j(of)f(monomorphic)e
(direct)i(functoids,)e(b)s(ecause)i(they)g(are)g(simple)e(and)h(serv)m
(e)i(as)300 3382 y(a)g(go)s(o)s(d)f(in)m(tro)s(duction)f(for)h(readers)
g(not)h(in)m(timately)e(familiar)g(with)g(C++.)40 b(Then)29
b(w)m(e)i(shall)e(mo)m(v)m(e)j(on)300 3570 y(to)g(describ)s(e)e(p)s
(olymorphic)f(direct)i(functoids.)44 b(Later,)32 b(in)f(Section)g
(2.2.4,)j(w)m(e)f(illustrate)c(ho)m(w)j(F)m(C++)300 3757
y(simpli\014es)27 b(the)k(use)f(of)g(p)s(olymorphic)e(functions)h(in)g
(C++)g(as)i(compared)f(to)h(other)g(approac)m(hes.)450
3990 y Fi(2.2.2.1)94 b(Monomorphic)35 b(dir)-5 b(e)g(ct)34
b(functoids)300 4237 y Fm(C++)41 b(is)g(a)i(class-based)f(ob)5
b(ject-orien)m(ted)43 b(language.)77 b(Classes)41 b(are)h(de\014ned)f
(statically)h(using)f(the)300 4424 y(k)m(eyw)m(ords)e
Fk(struct)e Fm(or)i Fk(class)p Fm(.)65 b(C++)38 b(pro)m(vides)g(a)h(w)m
(a)m(y)h(to)g(o)m(v)m(erload)g(the)f(function)e(call)i(op)s(erator)300
4611 y(\(written)g(as)i(a)f(matc)m(hing)g(pair)f(of)i(paren)m(theses:)
60 b(\\\(\)"\))42 b(for)e(classes.)70 b(This)38 b(enables)h(the)i
(creation)300 4799 y(of)34 b(ob)5 b(jects)34 b(whic)m(h)e(lo)s(ok)h
(and)f(b)s(eha)m(v)m(e)i(lik)m(e)f(functions)f(\(function)g(ob)5
b(jects\).)51 b(F)-8 b(or)34 b(instance,)g(w)m(e)g(sho)m(w)300
4986 y(b)s(elo)m(w)c(the)g(creation)h(and)f(use)g(of)g(function)f(ob)5
b(jects)31 b(that)g(\(resp)s(ectiv)m(ely\))f(double)f(and)h(add)g(one)g
(to)i(a)300 5174 y(n)m(um)m(b)s(er:)443 5400 y Fk(struct)46
b(TwoTimes)g({)2055 5700 y Fm(13)p eop
%%Page: 14 23
14 22 bop 539 91 a Fk(int)47 b(operator\(\)\()d(int)j(x)h(\))f({)h
(return)e(2*x;)g(})443 279 y(})i(twoTimes;)443 654 y(struct)e(Inc)h({)
539 841 y(int)g(operator\(\)\()d(int)j(x)h(\))f({)h(return)e(x+1;)g(})
443 1028 y(})i(inc;)443 1403 y(twoTimes\(5\))d(//)i(returns)f(10)443
1591 y(inc\(5\))285 b(//)47 b(returns)f(6)441 1853 y
Fm(The)20 b(problem)g(with)f(function)g(ob)5 b(jects)22
b(is)e(that)h(their)f(C++)g(t)m(yp)s(es)g(do)h(not)g(re\015ect)h(their)
d(\\function")300 2040 y(t)m(yp)s(es.)46 b(F)-8 b(or)33
b(example,)f(b)s(oth)f Fk(twoTimes)f Fm(and)i Fk(inc)f
Fm(represen)m(t)h(functions)f(from)g(in)m(tegers)i(to)f(in)m(tegers.)
300 2228 y(T)-8 b(o)31 b(distinguish)26 b(from)k(the)h(C++)e(language)i
(t)m(yp)s(e,)g(w)m(e)g(sa)m(y)g(that)g(the)f Fi(signatur)-5
b(e)38 b Fm(of)31 b(these)g(ob)5 b(jects)31 b(is)443
2490 y Fk(int)47 b(->)g(int)300 2752 y Fm(\(the)21 b(usual)e
(functional)g(notation)h(is)g(used)f(to)j(represen)m(t)e(signatures\).)
37 b(As)20 b(far)g(as)h(the)g(C++)e(language)i(is)300
2940 y(concerned,)27 b(ho)m(w)m(ev)m(er,)h(the)d Fi(typ)-5
b(es)34 b Fm(of)25 b(these)h(ob)5 b(jects)26 b(are)g
Fk(TwoTimes)d Fm(and)i Fk(Inc.)f Fm(\(Note)j(our)e(con)m(v)m(en)m(tion)
300 3127 y(of)37 b(using)e(an)i(upp)s(er-case)f(\014rst)g(letter)h(for)
f(class)h(names,)h(and)e(a)h(lo)m(w)m(er-case)i(\014rst)d(letter)h(for)
f(ob)5 b(ject)300 3314 y(names.\))60 b(Kno)m(wing)36
b(the)h(signature)f(of)h(a)g(function)f(ob)5 b(ject)37
b(is)f(v)-5 b(aluable)36 b(for)g(further)g(manipulation)300
3502 y(\(e.g.,)31 b(for)d(enabling)e(parametric)i(p)s(olymorphism,)e
(as)i(will)e(b)s(e)h(discussed)g(in)g(Section)h(2.2.2.2\).)43
b(Th)m(us,)300 3689 y(w)m(e)33 b(w)m(ould)f(lik)m(e)g(to)h(encapsulate)
g(some)g(represen)m(tation)g(of)g(the)g(t)m(yp)s(e)g(signature)f(of)h
Fk(TwoTimes)d Fm(in)i(its)300 3877 y(de\014nition.)38
b(The)30 b(details)g(of)g(this)f(represen)m(tation)i(will)c(b)s(e)j
(\014lled)e(in)h(Section)h(2.2.2.2,)j(but)d(for)g(no)m(w)g(it)300
4064 y(su\016ces)24 b(to)g(sa)m(y)h(that)f(eac)m(h)h(direct)e(functoid)
g(has)g(a)i(mem)m(b)s(er)e(called)g Fk(Sig)g Fm(\(e.g.,)k
Fk(TwoTimes::Sig)p Fm(\))20 b(that)300 4252 y(represen)m(ts)32
b(its)f(t)m(yp)s(e)h(signature.)44 b Fk(Sig)31 b Fm(is)g(not)h
(de\014ned)e(explicitly)f(b)m(y)j(the)g(authors)f(of)h(monomorphic)300
4439 y(direct)37 b(functoids|instead)f(it)i(is)f(inherited)e(from)j
(classes)g(that)g(hide)f(all)f(the)j(details)e(of)h(the)g(t)m(yp)s(e)
300 4626 y(represen)m(tation.)j(F)-8 b(or)31 b(instance,)f
Fk(TwoTimes)e Fm(w)m(ould)h(b)s(e)h(de\014ned)f(as:)443
4889 y Fk(struct)46 b(TwoTimes)g(:)h(public)f(CFunType<int,)f(int>)h({)
539 5076 y(int)h(operator\(\)\()d(int)j(x)h(\))f({)h(return)e(2*x;)g(})
443 5263 y(})i(twoTimes;)2055 5700 y Fm(14)p eop
%%Page: 15 24
15 23 bop 300 91 a Fm(That)41 b(is,)h Fk(CFunType)d Fm(is)g(a)j(C++)d
(class)i(template)g(whose)f(only)g(purp)s(ose)f(is)h(to)i(de\014ne)d
(signatures.)300 279 y(A)31 b(class)g(inheriting)d(from)i
Fk(CFunType<A,B>)e Fm(is)i(a)h(1-argumen)m(t)i(monomorphic)c(direct)i
(functoid)e(that)300 466 y(enco)s(des)23 b(a)g(function)e(from)i(t)m
(yp)s(e)g Fk(A)f Fm(to)i(t)m(yp)s(e)f Fk(B.)f Fm(In)g(general,)j(the)e
(template)g Fk(CFunType<A1,...,AN,R>)300 654 y Fm(is)29
b(used)h(to)h(de\014ne)f(signatures)f(for)h(monomorphic)f(direct)h
(functoids)f(of)i Fk(N)f Fm(argumen)m(ts.)441 841 y(Note)d(that)e(in)f
(the)h(ab)s(o)m(v)m(e)i(de\014nition)22 b(of)k Fk(TwoTimes)d
Fm(w)m(e)i(redundan)m(tly)e(sp)s(ecify)h(the)h(t)m(yp)s(e)h(signature)
300 1028 y(information)39 b(\()p Fk(int)47 b(->)h(int)p
Fm(\):)61 b(once)42 b(in)d(the)i(de\014nition)e(of)i
Fk(operator\(\))d Fm(\(for)j(compiler)f(use\))h(and)300
1216 y(once)46 b(in)d Fk(CFunType<int,int>)e Fm(\(for)k(use)g(b)m(y)g
(F)m(C++\).)85 b(There)44 b(seems)h(to)h(b)s(e)f(no)g(w)m(a)m(y)h(to)f
(a)m(v)m(oid)300 1403 y(this)d(duplication)e(with)i(standard)g(C++,)j
(but)d(non-standard)g(extensions,)k(lik)m(e)c(the)h(GNU)h(C++)300
1591 y(compiler's)29 b Fk(typeof)g Fm(op)s(erator,)i(address)e(this)g
(issue.)441 1778 y(Monomorphic)22 b(direct)h(functoids)e(ha)m(v)m(e)j
(a)g(n)m(um)m(b)s(er)d(of)i(adv)-5 b(an)m(tages)25 b(o)m(v)m(er)f
(normal)e(C++)g(functions:)300 1966 y(they)f(can)h(b)s(e)e(passed)h(as)
h(parameters)f(and)g(returned)f(as)h(results,)h(they)g(can)f(capture)g
(state,)k(etc.)39 b(Nativ)m(e)300 2153 y(C++)i(functions)g(can)i(b)s(e)
f(con)m(v)m(erted)i(in)m(to)e(monomorphic)f(direct)h(functoids)f(using)
g(the)i(op)s(erator)300 2340 y Fk(ptr_to_fun)25 b Fm(of)j(F)m(C++.)40
b(It)28 b(is)e(w)m(orth)i(noting)g(that)g(the)g(C++)f(Standard)f(T)-8
b(emplate)28 b(Library)e(\(STL\))300 2528 y(also)41 b(represen)m(ts)g
(functions)f(using)f(classes)i(with)f(an)h Fk(operator\(\))p
Fm(.)70 b(F)m(C++)41 b(pro)m(vides)f(con)m(v)m(ersion)300
2715 y(op)s(erations)30 b(to)h(promote)g(STL)e(function)g(ob)5
b(jects)31 b(in)m(to)f(monomorphic)f(direct)h(functoids.)450
2955 y Fi(2.2.2.2)94 b(Polymorphic)35 b(dir)-5 b(e)g(ct)34
b(functoids)300 3202 y Fm(P)m(olymorphic)21 b(direct)i(functoids)e
(supp)s(ort)g(parametric)i(p)s(olymorphism.)35 b(Consider)21
b(the)i(Hask)m(ell)g(func-)300 3389 y(tion)29 b Fk(tail)p
Fm(,)g(whic)m(h)f(discards)g(the)i(\014rst)f(elemen)m(t)h(of)g(a)g
(list.)39 b(Its)29 b(t)m(yp)s(e)h(w)m(ould)e(b)s(e)h(describ)s(ed)f(in)
g(Hask)m(ell)300 3576 y(as)443 3839 y Fk(tail)47 b(::)g([a])g(->)g([a])
300 4101 y Fm(Here)34 b(\\)p Fk(a)p Fm(")g(denotes)f(an)m(y)h(t)m(yp)s
(e;)h Fk(tail)d Fm(applied)f(to)j(a)g(list)e(of)h(in)m(tegers)h
(returns)e(a)h(list)f(of)i(in)m(tegers,)g(for)300 4288
y(example.)441 4476 y(One)c(w)m(a)m(y)h(to)h(represen)m(t)e(a)h
(similar)c(function)i(in)h(C++)f(is)g(through)h(mem)m(b)s(er)g
(templates:)443 4738 y Fk(struct)46 b(Tail)h({)539 4925
y(template)e(<class)h(T>)539 5113 y(List<T>)f(operator\(\)\()g(const)i
(List<T>&)e(l)j(\);)443 5300 y(})g(tail;)2055 5700 y
Fm(15)p eop
%%Page: 16 25
16 24 bop 300 91 a Fm(Note)39 b(that)f(w)m(e)f(still)f(ha)m(v)m(e)i(an)
f Fk(operator\(\))e Fm(but)i(it)f(is)h(no)m(w)g(a)h(mem)m(b)s(er)f
(function)f(template.)62 b(This)300 279 y(means)36 b(that)g(there)g
(are)g(m)m(ultiple)e(suc)m(h)h(op)s(erators|one)h(for)g(eac)m(h)h(t)m
(yp)s(e.)57 b(C++)35 b(t)m(yp)s(e)h(inference)f(is)300
466 y(used)f(to)i(pro)s(duce)d(concrete)j(instances)f(of)g
Fk(operator\(\))d Fm(for)i(ev)m(ery)i(t)m(yp)s(e)f(inferred)d(b)m(y)j
(a)g(use)g(of)g(the)300 654 y Fk(Tail)29 b Fm(functoid.)39
b(Recall)30 b(that)h(C++)e(t)m(yp)s(e)h(inference)f(is)g(a)i
(uni\014cation)d(pro)s(cess)h(matc)m(hing)i(the)f(t)m(yp)s(es)300
841 y(of)42 b(actual)h(argumen)m(ts)g(of)f(a)h(function)e(template)h
(to)h(the)g(declared)f(p)s(olymorphic)d(t)m(yp)s(es.)76
b(In)42 b(this)300 1028 y(example,)35 b(the)g(t)m(yp)s(e)f
Fk(List<T>)f Fm(con)m(tains)h(t)m(yp)s(e)h(v)-5 b(ariable)33
b Fk(T)p Fm(,)h(whose)g(t)m(yp)s(e)h(v)-5 b(alue)34 b(is)f(determined)g
(as)i(a)300 1216 y(result)24 b(of)h(the)g(C++)f(t)m(yp)s(e)h(inference)
f(pro)s(cess.)38 b(F)-8 b(or)26 b(instance,)g(w)m(e)f(can)g(refer)f(to)
i Fk(tail)e Fm(for)g(b)s(oth)g(lists)g(of)300 1403 y(in)m(tegers)32
b(and)f(lists)g(of)g(strings,)h(instead)f(of)h(explicitly)d(referring)h
(to)j Fk(tail<int>)c Fm(or)j Fk(tail<string>)p Fm(.)300
1591 y(F)-8 b(or)35 b(eac)m(h)h(use)e(of)h Fk(tail)p
Fm(,)f(the)h(language)g(will)d(infer)h(the)h(t)m(yp)s(e)h(of)g(elemen)m
(t)f(stored)h(in)e(the)i(list,)f(based)300 1778 y(on)c
Fk(tail)p Fm('s)g(op)s(erand.)441 1966 y(As)d(discussed)d(earlier,)j(a)
g(ma)5 b(jor)26 b(problem)f(with)h(the)h(ab)s(o)m(v)m(e)g(idiom)e(is)h
(that)h(the)g(C++)e(t)m(yp)s(e)i(of)g(the)300 2153 y(function)32
b(represen)m(tation)i(do)s(es)f(not)h(re\015ect)g(the)g(function)e(t)m
(yp)s(e)i(signature.)49 b(F)-8 b(or)34 b(instance,)h(w)m(e)f(will)300
2340 y(write)c(the)g(t)m(yp)s(e)h(signature)e(of)i(the)f(tail)g
(function)f(as:)443 2603 y Fk(List<T>)46 b(->)h(List<T>)300
2865 y Fm(but)30 b(the)g(C++)g(t)m(yp)s(e)g(of)h(v)-5
b(ariable)29 b Fk(tail)g Fm(is)g(just)h Fk(Tail.)441
3052 y Fm(The)23 b(solution)g(is)f(to)j(de\014ne)e(a)h(mem)m(b)s(er,)h
(whic)m(h)d(w)m(e)i(call)f Fk(Sig)p Fm(,)i(that)f(represen)m(ts)g(the)g
(t)m(yp)s(e)g(signature)300 3240 y(of)35 b(the)g(p)s(olymorphic)e
(function.)53 b(That)35 b(is,)h Fk(Sig)e Fm(is)g(our)g(w)m(a)m(y)i(of)g
(represen)m(ting)e(\\arro)m(w")i(t)m(yp)s(es.)55 b Fk(Sig)300
3427 y Fm(is)30 b(a)h(template)h(class)f(parameterized)g(b)m(y)g(the)g
(argumen)m(t)g(t)m(yp)s(es)g(of)g(the)h(p)s(olymorphic)c(function.)41
b(F)-8 b(or)300 3615 y(example,)30 b(the)h(actual)g(de\014nition)d(of)i
Fk(Tail)f Fm(is:)443 3877 y Fk(struct)46 b(Tail)h({)539
4064 y(template)e(<class)h(L>)539 4252 y(struct)g(Sig)h(:)g(public)f
(FunType<L,L>)f({};)539 4626 y(template)g(<class)h(T>)539
4814 y(List<T>)f(operator\(\)\(const)f(List<T>&)h(l\))j(const)539
5001 y({)f(return)f(l.tail\(\);)f(})443 5189 y(})j(tail;)2055
5700 y Fm(16)p eop
%%Page: 17 26
17 25 bop 300 91 a Fm(where)26 b Fk(FunType)f Fm(is)g(used)h(for)g(con)
m(v)m(enience,)j(as)e(a)g(reusable)e(mec)m(hanism)h(for)g(naming)g
(argumen)m(ts)h(and)300 279 y(results.)441 466 y(In)i(realit)m(y)-8
b(,)30 b(the)g Fk(Sig)e Fm(mem)m(b)s(er)h(of)h Fk(Tail)p
Fm(,)f(ab)s(o)m(v)m(e,)i(do)s(es)e(not)h(ha)m(v)m(e)h(to)f(represen)m
(t)g(the)f(most)h(sp)s(eci\014c)300 654 y(t)m(yp)s(e)24
b(signature)g(of)g(function)f Fk(tail)p Fm(.)38 b(Instead)24
b(it)g(is)f(used)h(as)g(a)h(compile-time)e(function)g(that)i(computes)
300 841 y(the)34 b(return)f(t)m(yp)s(e)h(of)g(function)f(tail,)h(giv)m
(en)g(its)f(argumen)m(t)i(t)m(yp)s(e.)51 b(This)32 b(is)h(easy)i(to)g
(see:)48 b(the)34 b Fk(Sig)f Fm(for)300 1028 y Fk(Tail)g
Fm(just)g(sp)s(eci\014es)g(that)h(if)f Fk(L)47 b(is)34
b Fm(the)g(argumen)m(t)g(t)m(yp)s(e)g(of)g Fk(Tail)p
Fm(,)g(then)g(the)g(return)f(t)m(yp)s(e)h(will)d(also)300
1216 y(b)s(e)h Fk(L)p Fm(.)h(The)f(requiremen)m(t)g(that)i
Fk(L)e Fm(b)s(e)g(an)h(instance)g(of)g(the)g Fk(List)e
Fm(template)i(do)s(es)g(not)g(app)s(ear)f(in)g(the)300
1403 y(de\014nition)c(of)j Fk(Sig)e Fm(\(although)h(it)g(could\).)441
1591 y(The)25 b(ab)s(o)m(v)m(e)i(de\014nition)c(of)j
Fk(Tail)e Fm(is)h(an)g(example)h(of)f(a)h(p)s(olymorphic)d(direct)i
(functoid.)38 b(In)25 b(general,)300 1778 y(a)43 b(direct)e(functoid)g
(is)h(a)g(class)g(with)f(a)i(mem)m(b)s(er)f Fk(operator\(\))d
Fm(\(p)s(ossibly)h(a)i(template)h(op)s(erator\),)300
1966 y(and)f(a)g(template)h(mem)m(b)s(er)e(class)h Fk(Sig)g
Fm(that)g(can)h(b)s(e)f(used)f(to)i(compute)f(the)h(return)e(t)m(yp)s
(e)h(of)h(the)300 2153 y(functoid)25 b(giv)m(en)h(its)f(argumen)m(t)i
(t)m(yp)s(es.)39 b(Th)m(us)25 b(the)i(con)m(v)m(en)m(tion)g(is)e(that)i
(the)f Fk(Sig)f Fm(class)h(template)g(tak)m(es)300 2340
y(the)39 b(t)m(yp)s(es)f(of)h(the)g(argumen)m(ts)g(of)g(the)g
Fk(operator\(\))c Fm(as)k(template)g(parameters.)66 b(As)39
b(describ)s(ed)d(in)300 2528 y(Section)g(2.2.2.1,)41
b(for)36 b(monomorphic)f(direct)h(functoids,)g(the)h(mem)m(b)s(er)e
(class)h Fk(Sig)g Fm(is)f(hidden)f(inside)300 2715 y(the)24
b Fk(CFunType)e Fm(classes,)j(but)f(in)e(essence)j(it)e(is)g(just)h(a)g
(template)g(computing)f(a)i(constan)m(t)g(compile-time)300
2903 y(function)k(\(i.e.,)i(returning)e(the)h(same)h(result)e(for)h
(eac)m(h)i(instan)m(tiation\).)441 3090 y(The)h(presence)h(of)g
Fk(Sig)e Fm(in)h(direct)g(functoids)f(is)g(essen)m(tial)i(for)f(an)m(y)
h(sophisticated)f(manipulation)300 3278 y(of)f(function)f(ob)5
b(jects)33 b(\(e.g.,)i(most)d(higher-order)f(functoids)f(need)i(it\).)
46 b(F)-8 b(or)33 b(example,)g(in)e(Hask)m(ell)g(w)m(e)300
3465 y(can)g(comp)s(ose)f(functions)f(using)g(\\.":)443
3727 y Fk(\(tail)47 b(.)g(tail\))f([1,2,3])g(--)h(evaluates)f(to)h([3])
300 3989 y Fm(In)31 b(C++)f(w)m(e)i(can)g(similarly)c(de\014ne)i(the)i
(direct)f(functoid)f Fk(compose)f Fm(to)k(act)f(lik)m(e)f(\\.",)i
(enabling)c(us)i(to)300 4177 y(write)f(expressions)f(lik)m(e)443
4439 y Fk(compose\(tail,tail\).)441 4701 y Fm(The)d(de\014nition)f(of)i
Fk(compose)d Fm(uses)j(t)m(yp)s(e)f(information)g(from)g
Fk(tail)f Fm(as)i(captured)g(in)e(its)h Fk(Sig)g Fm(struc-)300
4889 y(ture.)38 b(Using)23 b(this)f(information,)h(the)h(t)m(yp)s(e)f
(of)h Fk(compose\(tail,tail\))18 b Fm(is)23 b(inferred)e(and)i(do)s(es)
g(not)g(need)300 5076 y(to)34 b(b)s(e)f(sp)s(eci\014ed)f(explicitly)-8
b(.)48 b(More)35 b(sp)s(eci\014cally)-8 b(,)32 b(the)i(result)f(of)g(a)
h(comp)s(osition)f(of)g(t)m(w)m(o)i(functoids)d Fk(F)2055
5700 y Fm(17)p eop
%%Page: 18 27
18 26 bop 300 91 a Fm(and)30 b Fk(G)g Fm(is)f(a)i(functoid)e(that)i
(tak)m(es)h(an)e(argumen)m(t)h(of)f(t)m(yp)s(e)h Fk(T)f
Fm(and)g(returns)f(a)i(v)-5 b(alue)30 b(of)g(t)m(yp)s(e)3506
58 y Fg(1)443 330 y Fk(F::Sig<G::Sig<T>::ResultT)o(ype>)o(::R)o(esul)o
(tTyp)o(e)300 570 y Fm(that)35 b(is,)f(the)g(t)m(yp)s(e)g(that)h
Fk(F)f Fm(w)m(ould)f(yield)f(if)h(its)g(argumen)m(t)i(had)e(the)i(t)m
(yp)s(e)f(that)h Fk(G)e Fm(w)m(ould)g(yield)g(if)g(its)300
757 y(argumen)m(t)h(had)f(t)m(yp)s(e)h Fk(T)p Fm(.)g(This)e(example)i
(is)e(t)m(ypical)i(of)g(the)g(kind)e(of)i(t)m(yp)s(e)g(computation)f(p)
s(erformed)300 944 y(at)e(compile-time)f(using)e(the)j
Fk(Sig)e Fm(mem)m(b)s(ers)h(of)h(direct)e(functoids.)441
1132 y(In)40 b(essence,)k(F)m(C++)d(de\014nes)e(its)h(o)m(wn)h(t)m(yp)s
(e)g(system)g(that)g(is)e(quite)h(indep)s(enden)m(t)f(from)h(C++)300
1319 y(t)m(yp)s(es.)69 b(The)39 b Fk(Sig)g Fm(mem)m(b)s(er)g(of)h(a)h
(direct)e(functoid)f(de\014nes)h(a)h(compile-time)f(function)g
(computing)300 1507 y(the)k(functoid's)e(return)g(t)m(yp)s(e)i(from)f
(giv)m(en)h(argumen)m(t)g(t)m(yp)s(es.)77 b(The)42 b(compile-time)f
(computations)300 1694 y(de\014ned)d(b)m(y)h(the)g Fk(Sig)g
Fm(mem)m(b)s(ers)f(of)h(direct)g(functoids)f(allo)m(w)g(us)h(to)h(p)s
(erform)e(t)m(yp)s(e)h(inference)f(with)300 1882 y(fully)30
b(p)s(olymorphic)g(functions)h(without)h(sp)s(ecial)f(compiler)h(supp)s
(ort.)46 b(T)m(yp)s(e)32 b(errors)g(arise)g(when)g(the)300
2069 y Fk(Sig)e Fm(mem)m(b)s(er)g(of)h(a)g(functoid)f(attempts)i(to)f
(p)s(erform)f(an)g(illegal)g(manipulation)e(of)j(the)g
Fk(Sig)f Fm(mem)m(b)s(er)300 2256 y(of)g(another)h(functoid.)39
b(All)29 b(suc)m(h)h(errors)g(will)e(b)s(e)h(detected)j(statically)e
(when)f(the)h(compile-time)g(t)m(yp)s(e)300 2444 y(computation)40
b(tak)m(es)i(place-that)f(is,)h(when)d(the)h(compiler)f(tries)g(to)i
(instan)m(tiate)f(the)h(p)s(olymorphic)300 2631 y Fk(operator\(\))p
Fm(.)441 2819 y(P)m(olymorphic)31 b(direct)h(functoids)f(can)i(b)s(e)f
(con)m(v)m(erted)i(in)m(to)e(monomorphic)f(ones)i(b)m(y)f(sp)s
(ecifying)f(a)300 3006 y(concrete)h(t)m(yp)s(e)e(signature)g(via)g(the)
h(op)s(erator)f Fk(monomorphizeN)p Fm(.)d(F)-8 b(or)31
b(instance:)443 3245 y Fk(monomorphize1<List<int>,)41
b(int>)47 b(\(head\))300 3485 y Fm(pro)s(duces)29 b(a)i(monomorphic)e
(v)m(ersion)h(of)g(the)h Fk(head)e Fm(list)g(op)s(eration)h(for)g(in)m
(teger)h(lists.)441 3672 y(In)j(Section)h(2.2.4)i(w)m(e)f(demonstrate)f
(ho)m(w)g(using)f(direct)g(functoids)g(greatly)h(simpli\014es)d(the)j
(task)300 3859 y(of)i(programming)f(with)f(p)s(olymorphic)f(functions)i
(in)f(C++,)j(b)m(y)f(dra)m(wing)f(a)h(comparison)f(with)g(the)300
4047 y(alternativ)m(es.)41 b(One)30 b(of)g(the)h(alternativ)m(es)g(in)m
(v)m(olv)m(es)f(indirect)f(functoids,)g(so)h(w)m(e)h(discuss)e(them)h
(next.)300 4283 y Fl(2.2.3)105 b(Indirect)35 b(functoids)300
4529 y Fm(Direct)29 b(functoids)e(are)h(not)h(\014rst)f(class)g(en)m
(tities)g(in)f(the)i(C++)e(language.)40 b(Most)30 b(notably)-8
b(,)29 b(one)f(cannot)300 4716 y(de\014ne)k(a)g(\(run-time\))g(v)-5
b(ariable)31 b(ranging)g(o)m(v)m(er)j(all)d(direct)h(functoids)f(with)g
(the)h(same)h(signature.)46 b(W)-8 b(e)p 300 4858 1440
4 v 404 4912 a Ff(1)438 4943 y Fe(In)133 b(actualit)n(y)-6
b(,)160 b(instead)134 b(of)g(just)g Fd(F::Sig<)40 b
(G::Sig<T>::ResultType)k(>::ResultType,)f(a)c(C++)300
5035 y(compiler)i(would)f(force)h(us)e(to)h(write)h(typename)g
(F::template)g(Sig<typename)h(G::template)300 5126 y
(Sig<T>::ResultType>::ResultTy)q(pe.)85 b(The)40 b(keywords)h(typename)
g(and)f(template)h(are)f(necessary)h(for)300 5217 y(the)f(C++)g
(compiler)h(to)f(unambiguously)i(parse)e(nested)h(template)g(typenames)
g(like)f(these.)80 b(Throughout)300 5309 y(this)40 b(chapter)h(we)f
(elide)g(these)g(keywords)h(in)f(our)g(Sigs,)g(as)g(the)g(code)g(is)g
(easier)g(for)g(humans)h(to)f(read)300 5400 y(without)h(them.)2055
5700 y Fm(18)p eop
%%Page: 19 28
19 27 bop 300 91 a Fm(can)29 b(o)m(v)m(ercome)i(this)d(b)m(y)g(using)g
(a)h(C++)e(subt)m(yp)s(e)h(hierarc)m(h)m(y)h(with)e(a)i(common)g(ro)s
(ot)g(for)g(all)e(functoids)300 279 y(with)20 b(the)i(same)g(signature)
e(and)h(declaring)g(the)g(function)f(application)g(op)s(erator,)k
(\\\(\)",)h(to)d(b)s(e)f Fk(virtual)300 466 y Fm(\(i.e.,)28
b(dynamically)d(dispatc)m(hed\).)40 b(In)26 b(this)g(w)m(a)m(y)-8
b(,)29 b(the)f(appropriate)e(co)s(de)h(is)g(called)f(based)h(on)g(the)g
(run-)300 654 y(time)h(t)m(yp)s(e)h(of)g(the)g(functoid)e(to)j(whic)m
(h)d(a)i(v)-5 b(ariable)28 b(refers.)40 b(On)27 b(the)i(other)g(hand,)g
(to)g(enable)f(dynamic)300 841 y(dispatc)m(h,)c(the)f(user)f(needs)h
(to)g(refer)g(to)h(functions)d(indirectly)g(\(through)h(p)s(oin)m
(ters\).)38 b(Because)24 b(memory)300 1028 y(managemen)m(t)42
b(\(allo)s(cation)e(and)g(deallo)s(cation\))g(b)s(ecomes)h(an)g(issue)e
(when)h(p)s(oin)m(ters)f(are)i(used,)h(w)m(e)300 1216
y(encapsulate)i(references)h(to)g(function)e(ob)5 b(jects)45
b(using)e(a)h(reference)h(coun)m(ting)f(mec)m(hanism.)82
b(This)300 1403 y(mec)m(hanism)32 b(is)f(completely)h(transparen)m(t)h
(to)g(users)e(of)i(F)m(C++:)44 b(from)32 b(the)h(p)s(ersp)s(ectiv)m(e)e
(of)i(the)f(user,)300 1591 y(function)e(ob)5 b(jects)32
b(can)g(b)s(e)f(passed)f(around)h(b)m(y)g(v)-5 b(alue.)43
b(It)32 b(is)e(w)m(orth)h(noting)g(that)h(our)f(encapsulation)300
1778 y(of)d(these)h(p)s(oin)m(ters)e(inside)e(indirect)i(functoids)f
(prev)m(en)m(ts)j(the)f(creation)g(of)h(cyclical)e(data)i(structures,)
3861 1745 y Fg(2)300 1966 y Fm(th)m(us)h(a)m(v)m(oiding)g(the)h(usual)e
(pitfalls)f(of)i(reference-coun)m(ting)h(garbage)h(collection.)441
2153 y(Indirect)f(functoids)g(are)i(classes)f(that)h(follo)m(w)e(the)h
(ab)s(o)m(v)m(e)i(design.)45 b(An)32 b(indirect)e(functoid)h(repre-)300
2340 y(sen)m(ting)h(a)h(function)e(with)h(N)g(argumen)m(ts)h(of)g(t)m
(yp)s(es)f(A1,)i(...,)g(AN)f(and)f(return)f(t)m(yp)s(e)i(R,)f(is)g(a)h
(subt)m(yp)s(e)300 2528 y(of)e(class)443 2790 y Fk
(FunN<A1,A2...,AN,R>.)441 3052 y Fm(F)-8 b(or)31 b(instance,)g
(one-argumen)m(t)g(indirect)e(functoids)g(with)g(signature)443
3314 y Fk(A)48 b(->)f(R)300 3577 y Fm(are)e(subt)m(yp)s(es)e(of)h
(class)g Fk(Fun1<A,R>)p Fm(.)80 b(This)43 b(class)h(is)f(the)h
(reference-coun)m(ting)h(wrapp)s(er)e(of)h(class)300
3764 y Fk(Fun1Impl<A,R>)p Fm(.)37 b(Both)31 b(classes)g(are)f(pro)s
(duced)f(b)m(y)h(instan)m(tiating)g(the)g(templates)h(sho)m(wn)f(b)s
(elo)m(w:)443 4026 y Fk(template)46 b(<class)g(Arg1,)g(class)h(Result>)
443 4214 y(class)g(Fun1)f(:)i(public)e(CFunType<Arg1,Result>)c({)539
4401 y(Ref<Fun1Impl<Arg1,Resul)o(t>)g(>)47 b(ref;)539
4588 y(...)443 4776 y(public:)539 4963 y(typedef)e
(Fun1Impl<Arg1,Result>*)d(Impl;)p 300 5102 1440 4 v 404
5156 a Ff(2)438 5188 y Fe(Actually)-6 b(,)38 b(it)d(is)h(p)r(ossible)h
(to)f(create)g(cyclic)g(data)g(structures)f(within)h(indirect)f
(functoids,)k(but)c(not)g(without)h(a)300 5279 y(go)r(o)r(d)d
(understanding)f(of)h(the)f(indirect)g(functoid)h(implemen)n(tation)e
(details)i(that)f(are)h(necessary)g(to)f(circum)n(v)n(en)n(t)e(the)300
5371 y(encapsulation.)35 b(Users)26 b(cannot)g(leak)g(memory)e(\\b)n(y)
h(acciden)n(t".)2055 5700 y Fm(19)p eop
%%Page: 20 29
20 28 bop 539 91 a Fk(Fun1\()46 b(Impl)h(i)g(\))h(:)f(ref\(i\))f({})539
279 y(Result)g(operator\(\)\()e(const)j(Arg1&)f(x)i(\))f(const)f({)634
466 y(return)g(ref->operator\(\)\(x\);)d(})539 654 y(...)443
841 y(};)443 1216 y(template)j(<class)g(Arg1,)g(class)h(Result>)443
1403 y(struct)f(Fun1Impl)g(:)h(public)f(CFunType<Arg1,Result>)c({)539
1591 y(virtual)j(Result)i(operator\(\)\(const)c(Arg1&\))j(const=0;)539
1778 y(virtual)f(~Fun1Impl\(\))g({})443 1966 y(};)441
2203 y Fm(\(Note:)53 b(The)35 b(ellipsis)d(\(...\))57
b(sym)m(b)s(ol)34 b(in)g(the)i(ab)s(o)m(v)m(e)h(co)s(de)e(is)g(used)g
(to)h(denote)g(that)g(parts)f(of)h(the)300 2390 y(implemen)m(tation)e
(ha)m(v)m(e)i(b)s(een)f(omitted)g(for)g(brevit)m(y)-8
b(.)55 b(These)35 b(parts)f(implemen)m(t)g(our)h(subt)m(yp)s(e)f(p)s
(oly-)300 2578 y(morphism)25 b(p)s(olicy)g(and)h(will)f(b)s(e)h
(discussed)f(in)h(Section)g(2.2.8.)42 b(The)26 b Fk(Ref)g
Fm(class)h(template)g(implemen)m(ts)300 2765 y(our)k(reference-coun)m
(ted)i(\\p)s(oin)m(ters")e(and)f(will)f(b)s(e)i(discussed)e(in)h
(Section)i(2.5.2.3.)46 b(F)-8 b(or)32 b(this)e(in)m(ternal)300
2952 y(use,)g(an)m(y)h(simple)d(reference)j(coun)m(ting)f(mec)m(hanism)
g(w)m(ould)f(b)s(e)h(su\016cien)m(t.\))441 3140 y(Concrete)37
b(indirect)d(functoids)g(can)i(b)s(e)f(de\014ned)g(b)m(y)g(sub)s
(classing)f(a)i(class)f Fk(Fun1Impl<A,R>)e Fm(and)300
3327 y(using)28 b(instances)i(of)f(the)h(sub)s(class)e(to)j(construct)f
(instances)f(of)h(class)f Fk(Fun1<A,R>)p Fm(.)38 b(V)-8
b(ariables)30 b(can)g(b)s(e)300 3515 y(de\014ned)f(to)i(range)g(o)m(v)m
(er)h(all)d(functions)g(with)g(signature)443 3752 y Fk(A)48
b(->)f(R.)300 3989 y Fm(F)-8 b(or)28 b(instance,)f(if)f
Fk(Inc)g Fm(is)f(de\014ned)h(as)h(a)g(sub)s(class)e(of)i
Fk(Fun1Impl<int,int>)p Fm(,)c(the)k(follo)m(wing)e(de\014nes)h(an)300
4176 y(indirect)j(functoid)g(v)-5 b(ariable)29 b Fk(f)h
Fm(and)g(initializes)d(it)j(to)h(an)f(instance)g(of)h
Fk(Inc)p Fm(:)443 4413 y Fk(Fun1<int,)45 b(int>)i(f)h(\(new)e(Inc\);)
300 4650 y Fm(In)38 b(practice,)k(ho)m(w)m(ev)m(er,)g(this)c
(de\014nition)f(w)m(ould)g(b)s(e)i(rare)g(b)s(ecause)f(it)h(w)m(ould)f
(require)f(that)j Fk(Inc)e Fm(b)s(e)300 4838 y(de\014ned)30
b(as)h(a)h(monomorphic)d(function.)42 b(As)31 b(w)m(e)h(ha)m(v)m(e)g
(seen)f(in)f(Section)h(2.2.2.2,)j(the)d(most)h(common)300
5025 y(and)e(con)m(v)m(enien)m(t)h(represen)m(tation)g(of)f(functions)f
(is)h(that)h(of)f(p)s(olymorphic)e(direct)h(functoids.)441
5213 y(Monomorphic)21 b(direct)h(functoids)e(can)i(b)s(e)f(explicitly)f
(con)m(v)m(erted)j(to)g(indirect)d(functoids,)i(using)f(the)300
5400 y(op)s(eration)k Fk(makeFunN)d Fm(\(pro)m(vided)j(b)m(y)g(F)m
(C++\).)39 b(F)-8 b(or)26 b(instance,)g(consider)e(direct)g(functoids)g
Fk(TwoTimes)2055 5700 y Fm(20)p eop
%%Page: 21 30
21 29 bop 300 91 a Fm(and)28 b Fk(Inc)g Fm(from)g(Section)g(2.2.2.1)j
(\(the)f(de\014nition)c(of)j Fk(Inc)e Fm(w)m(as)i(not)g(sho)m(wn\).)40
b(The)28 b(follo)m(wing)f(example)300 279 y(is)i(illustrativ)m(e:)443
528 y Fk(Fun1<int,int>)44 b(f)k(=)f(makeFun1\()f(twoTimes)f(\);)443
716 y(f\()i(5)h(\);)954 b(//)47 b(returns)f(10)443 903
y(f)i(=)f(makeFun1\()e(inc)i(\);)443 1090 y(f\()g(5)h(\);)954
b(//)47 b(returns)f(6)300 1340 y Fm(In)29 b(fact,)h(the)g(calls)e(to)i
Fk(makeFunN)e Fm(can)h(b)s(e)g(elided|w)m(e)f(sho)m(w)h(them)h(here)f
(to)h(help)e(explain)f(the)j(trans-)300 1527 y(formation,)k(ho)m(w)m
(ev)m(er)g(a)g(carefully)d(designed)h(implicit)e(con)m(v)m(ersion)k
(function)d(template)j(in)e(the)h Fk(FunN)300 1715 y
Fm(classes)i(mak)m(es)i(the)e(library)e(functoids)h(\\smart")i(enough)f
(to)h(let)g(the)f(transformation)g(happ)s(en)f(im-)300
1902 y(plicitly)-8 b(.)61 b(P)m(olymorphic)36 b(direct)i(functoids)e
(can)i(also)g(b)s(e)f(assigned)h(to)g(indirect)e(functoids,)j(b)m(y)f
(\014rst)300 2090 y(selecting)43 b(a)g(monomorphic)f(instance.)79
b(This)41 b(con)m(v)m(ersion)i(w)m(as)h(illustrated)d(bac)m(k)i(in)f
(Figure)h(1)g(in)300 2277 y(Section)30 b(2.2.1)i(as)443
2527 y Fk(Fun2<int,int,int>)43 b(f)48 b(=)f(monomorphize1<int,int,int)o
(>\()42 b(plus)k(\);)443 2714 y(f)i(=)f(minus;)94 b(//)47
b(implicit)f(conversion)300 2963 y Fm(Note)32 b(that)f(just)e(lik)m(e)h
Fk(makeFunN)p Fm(,)f(the)h(call)g(to)h Fk(monomorphize)c
Fm(can)k(b)s(e)e(elided.)441 3151 y(It)40 b(should)e(b)s(e)i(noted)g
(here)g(that)g(our)g(indirect)e(functoids)g(are)j(v)m(ery)f(similar)d
(to)k(the)f(functoids)300 3338 y(presen)m(ted)32 b(in)f(L\177)-45
b(aufer's)31 b(w)m(ork)h([45)q(])h(and)e(the)h(functors)f(presen)m(ted)
h(in)f(Chapter)g(5)i(of)f(Alexandrescu's)300 3526 y(b)s(o)s(ok)39
b([2)q(].)68 b(Indeed,)42 b(the)e(only)e(di\013erence)h(is)g(in)f(the)i
(wrapp)s(er)e(classes,)k Fk(FunN<A1,A2,...,AN,R>)p Fm(.)300
3713 y(Whereas)32 b(w)m(e)f(use)f(a)i(reference)f(coun)m(ting)g(mec)m
(hanism,)g(b)s(oth)f(L\177)-45 b(aufer's)30 b(and)h(Alexandrescu's)f
(imple-)300 3901 y(men)m(tations)36 b(allo)m(w)m(ed)g(no)g(aliasing:)50
b(di\013eren)m(t)36 b(instances)f(of)h Fk(FunN<A1,A2...,AN,R>)31
b Fm(had)k(to)i(refer)300 4088 y(to)g(di\013eren)m(t)e(instances)h(of)g
Fk(FunNImpl<A1,A2,...,AN,R)o(>)p Fm(.)52 b(T)-8 b(o)36
b(main)m(tain)f(this)g(prop)s(ert)m(y)-8 b(,)37 b(ob)5
b(jects)300 4275 y(had)40 b(to)h(b)s(e)f(copied)g(ev)m(ery)h(time)g
(they)f(w)m(ere)h(ab)s(out)g(to)g(b)s(e)f(aliased.)70
b(This)39 b(cop)m(ying)h(results)g(in)f(an)300 4463 y(implemen)m
(tation)d(that)i(is)e(signi\014can)m(tly)f(slo)m(w)m(er)i(than)g
(ours|in)e([48)r(],)k(w)m(e)e(demonstrated)h(that)f(our)300
4650 y(original)27 b(implemen)m(tation)h(w)m(as)i(four)e(to)i(eigh)m(t)
g(times)f(faster)g(than)g(L\177)-45 b(aufer's.)40 b(\(Our)29
b(most)g(recen)m(t)i(im-)300 4838 y(plemen)m(tation,)h(whic)m(h)e(uses)
h(in)m(trusiv)m(e)g(reference)h(coun)m(ting)f(for)h(indirect)d
(functoids,)i(is)g(ev)m(en)h(faster,)300 5025 y(as)c(w)m(e)g(shall)e
(see)i(in)e(Section)h(2.5.2.\))42 b(Another)28 b(di\013erence)f(from)g
(other)h(implemen)m(tations)e(is)g(that)i(our)300 5213
y(indirect)34 b(functoids)g(will)f(rarely)h(b)s(e)h(de\014ned)g
(explicitly)e(b)m(y)i(clien)m(ts)g(of)h(F)m(C++.)56 b(Instead,)37
b(they)f(will)300 5400 y(commonly)30 b(only)f(b)s(e)h(pro)s(duced)f(b)m
(y)h(\014xing)f(the)i(t)m(yp)s(e)f(signature)g(of)g(a)h(direct)f
(functoid.)2055 5700 y(21)p eop
%%Page: 22 31
22 30 bop 300 91 a Fl(2.2.4)105 b(Use)36 b(of)f(direct)g(functoids)300
337 y Fm(In)29 b(this)g(section)i(w)m(e)f(will)e(demonstrate)j(the)f
(use)g(of)g(F)m(C++)g(direct)g(functoids)e(and)i(try)g(to)h(sho)m(w)f
(ho)m(w)300 525 y(m)m(uc)m(h)k(they)g(simplify)c(programming)j(with)f
(p)s(olymorphic)f(functions.)50 b(The)33 b(comparison)g(will)e(b)s(e)i
(to)300 712 y(the)e(t)m(w)m(o)g(alternativ)m(es:)41 b(templatized)30
b(indirect)f(functoids,)g(and)h(C++)f(function)g(templates.)441
900 y(Consider)i(a)i(p)s(olymorphic)d(function)h Fk(twoTimes)f
Fm(that)j(returns)f(t)m(wice)h(the)f(v)-5 b(alue)32 b(of)h(its)f(n)m
(umeric)300 1087 y(argumen)m(t.)41 b(Its)31 b(t)m(yp)s(e)f(signature)g
(w)m(ould)f(b)s(e)443 1349 y Fk(a)48 b(->)f(a.)300 1611
y Fm(\(In)30 b(Hask)m(ell)g(one)h(w)m(ould)e(sa)m(y)443
1874 y Fk(Num)47 b(a)h(=>)f(a)g(->)g(a.)300 2136 y Fm(It)27
b(is)f(p)s(ossible)e(to)k(sp)s(ecify)d(this)h(t)m(yp)s(e)h(b)s(ound)e
(in)g(C++,)i(alb)s(eit)f(in)f(a)j(roundab)s(out)d(w)m(a)m(y|see)j(the)f
(short)300 2323 y(discussion)h(on)i(t)m(yp)s(e)h(constrain)m(ts)f(in)f
(Section)h(2.5.3)i(for)f(details.\))441 2511 y(Consider)25
b(also)i(the)g(familiar)d(higher-order)h(p)s(olymorphic)f(function)h
Fk(map)p Fm(,)i(whic)m(h)f(applies)f(its)h(\014rst)300
2698 y(argumen)m(t)37 b(\(a)h(unary)d(function\))h(to)i(eac)m(h)g
(elemen)m(t)f(of)g(its)f(second)h(argumen)m(t)g(\(a)g(list\))f(and)g
(returns)300 2886 y(a)i(new)f(list)f(of)h(the)h(results.)61
b(One)37 b(can)h(sp)s(ecify)e(b)s(oth)g Fk(twoTimes)g
Fm(and)g Fk(map)h Fm(as)h(collections)f(of)g(indi-)300
3073 y(rect)j(functoids.)64 b(Doing)39 b(so)h(generically)d(w)m(ould)h
(mean)h(de\014ning)e(a)i(C++)f(template)h(o)m(v)m(er)i(indirect)300
3260 y(functoids.)59 b(This)35 b(is)h(equiv)-5 b(alen)m(t)37
b(to)g(the)h(standard)e(w)m(a)m(y)i(of)f(imitating)e(p)s(olymorphism)f
(in)h(L\177)-45 b(aufer's)300 3448 y(framew)m(ork.)44
b(Figure)31 b(2)h(sho)m(ws)f(the)h(implemen)m(tations)e(of)h
Fk(map)g Fm(and)g Fk(twoTimes)e Fm(using)h(indirect)g(func-)300
3635 y(toids.)441 3823 y(\(F)-8 b(or)28 b(brevit)m(y)-8
b(,)28 b(the)f(implemen)m(tation)f(of)h Fk(operator\(\))d
Fm(in)h Fk(Map)h Fm(is)g(omitted.)40 b(The)26 b(implemen)m(tation)300
4010 y(is)j(similar)f(in)h(all)g(the)i(alternativ)m(es)g(w)m(e)g(will)c
(examine.\))441 4198 y(Alternativ)m(ely)-8 b(,)28 b(one)g(can)f(sp)s
(ecify)f(b)s(oth)h Fk(twoTimes)e Fm(and)h Fk(map)h Fm(using)e(direct)i
(functoids)f(\(Figure)h(3\).)300 4385 y(Direct)39 b(functoids)e(can)j
(b)s(e)e(con)m(v)m(erted)i(to)f(indirect)e(functoids)h(for)g(a)h
(\014xed)f(t)m(yp)s(e)h(signature,)i(hence)300 4572 y(there)31
b(is)e(no)h(loss)g(of)h(expressiv)m(eness.)441 4760 y(The)44
b(direct)g(functoid)f(implemen)m(tation)g(is)h(only)g(a)h(little)e
(more)i(complex)f(than)g(the)h(indirect)300 4947 y(functoid)31
b(implemen)m(tation.)44 b(The)31 b(complexit)m(y)h(is)f(due)g(to)i(the)
f(de\014nition)e(of)i Fk(Sig)p Fm(.)45 b Fk(Sig)31 b
Fm(enco)s(des)h(the)300 5135 y(t)m(yp)s(e)27 b(signature)g(of)g(the)g
(direct)g(functoid)e(in)h(a)i(form)e(that)i(can)f(b)s(e)g(utilized)d(b)
m(y)j(all)f(other)i(higher)d(order)300 5322 y(functions)30
b(in)h(our)g(framew)m(ork.)46 b(According)31 b(to)i(the)f(con)m(v)m(en)
m(tion)h(of)f(our)g(framew)m(ork,)g Fk(Sig)f Fm(has)h(to)h(b)s(e)2055
5700 y(22)p eop
%%Page: 23 32
23 31 bop 300 446 a Fk(//)47 b(N:)g(Number)f(type)300
559 y(template)g(<class)g(N>)300 672 y(struct)g(TwoTimes)g(:)h(public)f
(FunImpl<N,)f(N>)i({)395 785 y(N)h(operator\(\)\(const)43
b(N)48 b(&n\))f(const)f({)h(return)g(2*n;)f(})300 898
y(};)300 1124 y(//)h(E:)g(element)f(type)h(in)g(original)f(list)300
1237 y(//)h(R:)g(element)f(type)h(in)g(returned)f(list)300
1349 y(template)g(<class)g(E,)h(class)f(R>)300 1462 y(struct)g(Map)h(:)
g(public)g(FunImpl<Fun1<E,R>,)42 b(List<E>,)k(List<R>)g(>)h({)395
1575 y(List<R>)f(operator\(\)\(Fun1<E,R>)d(f,)k(List<E>)f(l\))h(const)f
({...})300 1688 y(};)701 1984 y Fl(Figure)35 b(2:)46
b Fm(P)m(olymorphic)29 b(functions)g(as)i(templates)f(o)m(v)m(er)i
(indirect)d(functoids)300 2897 y Fk(struct)46 b(TwoTimes)g({)395
3010 y(template)g(<class)g(N>)h(struct)f(Sig)h(:)h(public)e
(Fun1Type<N,N>)e({};)395 3123 y(template)i(<class)g(N>)395
3236 y(N)i(operator\(\)\(const)43 b(N)48 b(&n\))f(const)f({)h(return)g
(2*n;)f(})300 3349 y(})h(twoTimes;)300 3575 y(//)g(F:)g(function)f
(type)300 3688 y(//)h(L:)g(list)g(type)300 3800 y(struct)f(Map)h({)395
3913 y(template)f(<class)g(F,)h(class)g(L>)395 4026 y(struct)g(Sig)f(:)
i(public)e(Fun2Type<F,L,)539 4139 y(List<F::Sig<L::EleType>)o(::Re)o
(sul)o(tTyp)o(e>)c(>)47 b({};)395 4365 y(template)f(<class)g(F,)h
(class)g(L>)395 4478 y(typename)f(Sig<F,L>::ResultType)395
4591 y(operator\(\)\(F)f(f,)i(L)h(l\))f(const)f({...})300
4704 y(})h(map;)1043 4999 y Fl(Figure)35 b(3:)47 b Fm(P)m(olymorphic)29
b(functions)g(as)h(direct)g(functoids)2055 5700 y(23)p
eop
%%Page: 24 33
24 32 bop 300 91 a Fm(a)30 b(class)g(template)g(o)m(v)m(er)h(the)f(t)m
(yp)s(es)g(of)g(the)g(argumen)m(ts)g(of)g Fk(Map)p Fm(.)40
b(Recall)29 b(also)h(that)h Fk(FunType)c Fm(is)i(just)h(a)300
279 y(simple)e(template)j(for)f(creating)h(function)e(signatures.)441
466 y(T)-8 b(o)43 b(express)f(the)h(\(p)s(olymorphic\))d(t)m(yp)s(e)j
(signature)f(of)g Fk(Map)p Fm(,)j(w)m(e)e(need)f(to)i(reco)m(v)m(er)g
(t)m(yp)s(es)e(from)300 654 y(the)35 b Fk(Sig)e Fm(structures)h(of)h
(its)f(function)f(argumen)m(t)i(and)f(its)g(list)f(argumen)m(t.)53
b(The)34 b(t)m(yp)s(e)h(computation)300 841 y Fk
(F::Sig<L::EleType>::Resu)o(ltTy)o(pe)30 b Fm(means)36
b(\\result)g(t)m(yp)s(e)g(of)h(function)d Fk(F)p Fm(,)j(when)e(its)g
(argumen)m(t)300 1028 y(t)m(yp)s(e)c(is)e(the)i(elemen)m(t)f(t)m(yp)s
(e)h(of)f(list)f Fk(L)p Fm(".)441 1216 y(In)e(essence,)j(using)c
Fk(Sig)h Fm(w)m(e)i(exp)s(ort)e(t)m(yp)s(e)h(information)f(from)g(a)h
(functoid)f(so)h(that)h(it)e(can)h(b)s(e)g(used)300 1403
y(b)m(y)c(other)h(functoids.)37 b(Recall)24 b(that)h(the)f
Fk(Sig)f Fm(mem)m(b)s(ers)h(are)g(really)g(compile-time)f(functions:)36
b(they)25 b(are)300 1591 y(used)h(as)g(t)m(yp)s(e)h(computers)f(b)m(y)g
(the)h(F)m(C++)f(t)m(yp)s(e)h(system.)40 b(The)25 b(computation)i(p)s
(erformed)e(at)i(compile)300 1778 y(time)f(using)f(all)g(the)i
Fk(Sig)f Fm(mem)m(b)s(ers)f(of)i(direct)f(functoids)f(is)g(essen)m
(tially)h(the)h(same)f(t)m(yp)s(e)h(computation)300 1966
y(that)32 b(a)g(con)m(v)m(en)m(tional)h(t)m(yp)s(e)f(inference)e(mec)m
(hanism)h(in)g(a)h(functional)e(language)i(w)m(ould)e(p)s(erform.)44
b(Of)300 2153 y(course,)31 b(there)f(is)g(p)s(oten)m(tial)g(for)g(an)g
(incorrect)g(signature)g(sp)s(eci\014cation)f(of)i(a)g(p)s(olymorphic)c
(function)300 2340 y(but)j(the)g(same)h(is)e(true)i(in)e(the)h
(indirect)f(functoid)g(solution.)441 2528 y(T)-8 b(o)35
b(see)f(wh)m(y)g(the)g(direct)g(functoid)e(sp)s(eci\014cation)h(is)g(b)
s(ene\014cial,)g(consider)g(the)i(uses)e(of)h Fk(map)g
Fm(and)300 2715 y Fk(twoTimes)p Fm(.)k(In)30 b(Hask)m(ell,)h(w)m(e)f
(can)h(sa)m(y)443 2975 y Fk(map)47 b(twoTimes)f([1..])300
3235 y Fm(to)31 b(pro)s(duce)e(a)i(list)e(of)i(ev)m(en)g(n)m(um)m(b)s
(ers.)39 b(With)30 b(direct)g(functoids)f(\(Figure)h(3\))h(w)m(e)g(can)
f(similarly)d(sa)m(y)443 3495 y Fk(map\()47 b(twoTimes,)e
(enumFrom\(1\))g(\).)300 3755 y Fm(This)32 b(succinctness)h(is)f(a)i
(direct)f(consequence)h(of)g(using)e(C++)h(t)m(yp)s(e)g(inference.)50
b(With)33 b(the)h(indirect)300 3943 y(functoid)21 b(solution)g
(\(Figure)i(2\))g(the)g(co)s(de)g(w)m(ould)e(b)s(e)h(m)m(uc)m(h)g(more)
h(complex,)h(b)s(ecause)f(all)e(in)m(termediate)300 4130
y(v)-5 b(alues)30 b(w)m(ould)f(need)h(to)h(b)s(e)f(explicitly)e(t)m(yp)
s(ed)i(as)g(in)443 4390 y Fk(Map<int,int>\(\)\()44 b(Fun1<int,int>\()g
(new)j(TwoTimes<int>\(\))c(\),)1207 4578 y(enumFrom\(1\))i(\).)441
4838 y Fm(Clearly)33 b(this)g(alternativ)m(e)h(w)m(ould)f(ha)m(v)m(e)i
(made)g(ev)m(ery)f(expression)f(terribly)f(burdensome,)i(in)m(tro-)300
5025 y(ducing)e(m)m(uc)m(h)h(redundancy)e(\()p Fk(int)i
Fm(app)s(ears)f(5)h(times)g(in)e(the)j(previous)d(example,)j(when)e(it)
g(could)h(b)s(e)300 5213 y(inferred)d(ev)m(erywhere)j(from)f(the)g(v)-5
b(alue)32 b Fk(1)p Fm(\).)46 b(Note)34 b(that)f(this)e(expression)g
(has)h(a)h(single)e(function)g(ap-)300 5400 y(plication.)58
b(Using)35 b(more)i(complex)f(expressions)g(or)g(higher-order)f
(functions)g(mak)m(es)j(matters)f(ev)m(en)2055 5700 y(24)p
eop
%%Page: 25 34
25 33 bop 300 91 a Fm(w)m(orse.)39 b(F)-8 b(or)26 b(instance,)h(using)c
(the)j Fk(compose)d Fm(functoid)h(men)m(tioned)h(in)f(Section)h
(2.2.2.2,)k(w)m(e)d(can)f(create)300 279 y(a)31 b(list)e(of)h(m)m
(ultiples)e(of)j(four)e(b)m(y)i(writing)443 539 y Fk
(map\(compose\(twoTimes,)42 b(twoTimes\),)j(enumFrom\(1\)\).)300
799 y Fm(The)30 b(same)h(using)e(indirect)f(functoids)h(w)m(ould)g(b)s
(e)h(written)f(as)443 1059 y Fk(Fun1<int,int>)44 b(twoTimes\()i(new)h
(TwoTimes<int>\(\))c(\);)443 1246 y(Map<int,int>\(\)\()h
(Compose<int,int,int>\(\)\(t)o(woT)o(imes)o(,)e(twoTimes\),)1207
1434 y(enumFrom\(1\))j(\))300 1694 y Fm(W)-8 b(e)43 b(ha)m(v)m(e)g
(found)e(ev)m(en)i(the)f(simplest)e(realistic)h(examples)g(to)i(b)s(e)e
(v)m(ery)h(tedious)g(to)g(enco)s(de)g(using)300 1881
y(templates)31 b(o)m(v)m(er)g(indirect)e(functoids)g(\(or,)i(equiv)-5
b(alen)m(tly)d(,)30 b(L\177)-45 b(aufer's)30 b(framew)m(ork)g([45)q
(]\).)441 2069 y(In)39 b(short,)j(direct)d(functoids)f(allo)m(w)h(us)f
(to)j(simplify)36 b(the)j Fi(use)46 b Fm(of)40 b(p)s(olymorphic)d
(functions)h(sub-)300 2256 y(stan)m(tially)-8 b(,)35
b(with)d(only)h(little)g(extra)h(complexit)m(y)g(in)e(the)i(functoid)f
Fi(de\014nition)p Fm(.)52 b(The)33 b(idiom)f(of)i(using)300
2443 y(template)26 b(mem)m(b)s(er)g(functions)e(co)s(ordinated)h(with)g
(the)h(nested)g(template)g(class)g Fk(Sig)f Fm(to)i(main)m(tain)d(our)
300 2631 y(o)m(wn)f(t)m(yp)s(e)g(system)g(is)e(the)i(linc)m(hpin)d(in)h
(our)h(framew)m(ork)h(for)g(supp)s(orting)d(higher-order)h
(parametrically)300 2818 y(p)s(olymorphic)28 b(functions.)441
3006 y(Finally)-8 b(,)27 b(note)g(that)h Fk(twoTimes)d
Fm(could)h(ha)m(v)m(e)i(b)s(een)f(implemen)m(ted)e(as)j(a)f(C++)f
(function)g(template:)443 3266 y Fk(template)46 b(<class)g(N>)95
b(N)47 b(twoTimes)f(\(const)g(N)h(&n\))443 3453 y({)h(return)e(2*n;)g
(})300 3713 y Fm(This)38 b(is)g(the)i(most)g(widespread)e(C++)g(idiom)g
(for)i(appro)m(ximating)e(p)s(olymorphic)f(functions)h(\(e.g.,)300
3901 y([52)q(][59)r(]\).)69 b(C++)39 b(t)m(yp)s(e)h(inference)f(is)f
(still)g(used)h(in)f(this)h(case.)70 b(Unfortunately)-8
b(,)42 b(as)e(noted)g(earlier,)300 4088 y(C++)f(function)f(templates)j
(cannot)f(b)s(e)f(passed)h(as)g(argumen)m(ts)g(to)h(other)f(functions)e
(\(or)i(function)300 4275 y(templates\).)46 b(That)31
b(is,)h(function)e(templates)i(can)g(b)s(e)g(used)f(to)h(express)f(p)s
(olymorphic)e(functions)i(but)300 4463 y(these)26 b(cannot)g(tak)m(e)g
(other)g(function)e(templates)i(as)f(argumen)m(ts.)39
b(Th)m(us,)26 b(this)e(idiom)f(is)i(not)g(expressiv)m(e)300
4650 y(enough.)39 b(F)-8 b(or)28 b(instance,)g(our)f(example)g(where)f
Fk(twoTimes)f Fm(is)i(passed)f(as)i(an)f(argumen)m(t)h(to)g(map)e(is)h
(not)300 4838 y(realizable)i(if)h Fk(twoTimes)e Fm(is)h(implemen)m(ted)
g(as)i(a)f(function)f(template.)441 5025 y(The)40 b(closest)g(appro)m
(ximation)f(of)h(suc)m(h)f(functionalit)m(y)g(b)s(efore)g(F)m(C++)h(w)m
(as)g(with)f(the)h(use)f(of)i(a)300 5213 y(h)m(ybrid)30
b(of)i(class)f(templates,)i(lik)m(e)e(in)g(Figure)g(2,)i(and)e
(function)g(templates[59)q(].)46 b(In)31 b(the)h(h)m(ybrid)e(case,)300
5400 y(eac)m(h)g(function)d(has)h(t)m(w)m(o)i(represen)m(tations:)40
b(one)28 b(using)f(a)i(template)g(class)g(\(so)g(that)g(the)f(function)
g(can)2055 5700 y(25)p eop
%%Page: 26 35
26 34 bop 300 91 a Fm(b)s(e)22 b(passed)g(to)h(other)g(functions\))e
(and)h(one)h(using)e(a)i(function)e(template)i(\(so)g(that)h(C++)d(t)m
(yp)s(e)i(inference)300 279 y(can)31 b(b)s(e)e(used)h(when)f(argumen)m
(ts)i(are)g(passed)e(to)i(the)g(function\).)40 b(The)30
b(C++)f(Standard)g(Library)g([59)q(])300 466 y(uses)35
b(this)f(h)m(ybrid)e(approac)m(h)k(for)e(some)i(p)s(olymorphic,)d
(higher-order)h(functions.)53 b(This)34 b(alternativ)m(e)300
654 y(is)42 b(quite)g(incon)m(v)m(enien)m(t)g(b)s(ecause)h(class)f
(templates)h(still)e(need)h(to)h(b)s(e)f(turned)g(in)m(to)g
(monomorphic)300 841 y(function)f(instances)g(explicitly)f(\(e.g.,)46
b(one)d(w)m(ould)d(write)i Fk(TwoTimes<int>)c Fm(instead)j(of)h
Fk(twoTimes)300 1028 y Fm(in)34 b(the)i(examples)f(ab)s(o)m(v)m(e\),)k
(and)c(b)s(ecause)g(t)m(w)m(o)i(separate)g(represen)m(tations)e(need)h
(to)g(b)s(e)f(main)m(tained)300 1216 y(for)g(eac)m(h)i(function.)55
b(The)35 b(user)f(will)f(ha)m(v)m(e)k(to)f(remem)m(b)s(er)f(whic)m(h)f
(represen)m(tation)i(to)g(use)f(when)g(the)300 1403 y(function)29
b(is)g(called)h(and)g(whic)m(h)f(to)i(use)f(when)f(the)i(function)e(is)
h(passed)f(as)i(an)f(argumen)m(t.)441 1591 y(What)45
b(all)e(of)h(the)h(ab)s(o)m(v)m(e)g(alternativ)m(es)f(to)h(direct)f
(functoids)f(lac)m(k)h(is)g(the)g(abilit)m(y)e(to)j(express)300
1778 y(p)s(olymorphic)32 b(functions)i(that)h(can)h(accept)g(other)g(p)
s(olymorphic)c(functions)i(as)h(argumen)m(ts.)55 b(As)35
b(an)300 1966 y(example,)30 b(consider)g(a)g(function)f
Fk(foo\(f,x,y\))f Fm(whose)i(b)s(o)s(dy)f(is)g(just)443
2218 y Fk(return)46 b(makePair\()g(f\(x\),)g(f\(y\))h(\);)300
2471 y Fm(\()p Fk(makePair)42 b Fm(is)i(the)g(function)f(to)i(create)h
(a)f(2-tuple)f(of)h(v)-5 b(alues\).)82 b(With)44 b Fk(twoTimes)e
Fm(de\014ned)h(as)i(a)300 2658 y(p)s(olymorphic)28 b(direct)h
(functoid,)h(w)m(e)g(can)h(write)f(the)g(expression)443
2911 y Fk(foo\()47 b(twoTimes,)e(2,)i(3.1)g(\))300 3163
y Fm(whic)m(h)26 b(will)f(resolv)m(e)i(to)h(a)g(v)-5
b(alue)27 b(of)g(t)m(yp)s(e)h Fk(pair<int,double>)p Fm(.)35
b(This)26 b(is)g(rank-2)i(p)s(olymorphism)23 b([41)q(];)300
3351 y(inside)28 b(the)i(call)f(to)i Fk(foo\(\))p Fm(,)e
Fk(f)g Fm(is)g(used)h(p)s(olymorphically)-8 b(.)37 b(Neither)29
b(of)i(the)f(other)g(approac)m(hes)g(enable)300 3538
y(functions)37 b(lik)m(e)h Fk(foo\(\))g Fm(to)h(b)s(e)f(de\014ned.)65
b(That)39 b(is,)h(F)m(C++)e(w)m(as)h(the)g(\014rst)f(C++)g(library)f
(with)g(this)300 3726 y(rank-2)31 b(p)s(olymorphism)26
b(capabilit)m(y)-8 b(.)300 3964 y Fl(2.2.5)105 b(F)-9
b(ull)36 b(functoids)300 4210 y Fm(The)e(de\014nitions)e(of)j(direct)f
(functoids)f(giv)m(en)h(in)f(the)i(previous)e(subsections)g(are)i
(actually)f(what)g(w)m(e)300 4398 y(call)h(\\basic)g(direct)g
(functoids")g(in)f(F)m(C++.)57 b(Ho)m(w)m(ev)m(er,)39
b(a)d(n)m(um)m(b)s(er)e(of)i(features)g(of)g(functoids)e(\(suc)m(h)300
4585 y(as)e(currying)e(and)h(in\014x)f(syn)m(tax,)j(whic)m(h)d(w)m(e)i
(sa)m(w)g(in)f(Section)g(2.2.1,)j(and)e(lam)m(b)s(da-a)m(w)m(areness,)g
(whic)m(h)300 4773 y(will)c(shall)g(describ)s(e)h(in)g(Section)h
(2.3.1\))j(only)c(w)m(ork)i(on)f(so-called)g(\\full)f(functoids".)441
4960 y(T)-8 b(ransforming)29 b(a)i(normal)e(functoid)g(in)m(to)i(a)f
(full)f(functoid)g(is)g(easy)-8 b(.)42 b(F)-8 b(or)32
b(example,)e(to)h(de\014ne)f Fk(map)300 5147 y Fm(as)h(a)f(full)e
(functoid,)i(w)m(e)h(c)m(hange)g(the)g(de\014nition)d(from)443
5400 y Fk(struct)46 b(Map)h({)h(/*)f(...)g(*/)g(})g(map;)2055
5700 y Fm(26)p eop
%%Page: 27 36
27 35 bop 300 91 a Fm(\(as)31 b(w)m(e)g(sa)m(w)g(in)e(Figure)g(3\))j
(to)443 353 y Fk(struct)46 b(XMap)h({)g(/*)h(...)e(*/)i(};)443
541 y(typedef)e(Full2<XMap>)f(Map;)443 728 y(Map)i(map;)300
990 y Fm(That)41 b(is,)h Fk(FullN<F>)d Fm(is)h(the)h(t)m(yp)s(e)g(of)g
(the)g(full)d(functoid)i(created)i(out)f(of)g(the)g(basic)f
Fi(N)15 b Fm(-argumen)m(t)300 1178 y(functoid)34 b Fk(F)p
Fm(.)i(The)f Fk(FullN)f Fm(template)i(classes)f(serv)m(e)h(as)g(a)g
(wrapp)s(er)d(around)i(basic)g(functoids.)54 b(They)300
1365 y(add)31 b(all)f(of)h(the)g(F)m(C++)g(features)g(w)m(e)h(are)g
(accustomed)g(to)g(\(suc)m(h)f(as)g(currying)e(and)i(in\014x)e(syn)m
(tax\))j(to)300 1553 y(the)f(basic)e(functoid.)441 1740
y(An)m(y)39 b(basic)e(functoid)g(can)i(b)s(e)f(promoted)g(in)m(to)g(a)h
(full)d(functoid)h(either)h(b)m(y)g(making)g(the)g(minor)300
1928 y(mo)s(di\014cation)28 b(to)j(the)e(de\014nition)f(describ)s(ed)f
(ab)s(o)m(v)m(e,)32 b(or)d(within)f(an)h(expression)g(b)m(y)g(calling)g
(the)h(func-)300 2115 y(toid)g Fk(makeFullN\(\))p Fm(,)e(whic)m(h)i
(tak)m(es)i(an)f Fi(N)15 b Fm(-argumen)m(t)31 b(basic)f(functoid)f(as)i
(an)g(argumen)m(t)g(and)f(returns)300 2303 y(the)k(corresp)s(onding)e
(full)f(functoid)i(as)h(a)g(result.)50 b(Expressing)32
b(\\fullness")g(as)i(a)g(general)g(com)m(binator)300
2490 y(mak)m(es)28 b(it)e(trivial)f(to)j(add)e(a)i(large)f(set)g(of)g
(common)g(useful)f(features)h(to)g(ev)m(ery)h(functoid.)38
b(W)-8 b(e)29 b(describ)s(e)300 2677 y(t)m(w)m(o)34 b(of)g(those)f(sp)s
(eci\014c)f(features)i(\(in\014x)d(syn)m(tax)j(and)e(currying\))g
(next.)49 b(Later,)35 b(in)d(Section)h(2.3.1,)i(w)m(e)300
2865 y(describ)s(e)29 b(ho)m(w)h(full)e(functoids)h(in)m(teract)i(with)
e(F)m(C++'s)i(lam)m(b)s(da.)300 3105 y Fl(2.2.6)105 b(In\014x)35
b(syn)m(tax)300 3351 y Fm(The)28 b(\014rst)f(feature)i(pro)m(vided)e(b)
m(y)h(full)e(functoids)h(is)g(in\014x)g(syn)m(tax.)40
b(An)m(y)29 b(full)d(functoid)h(of)h(at)h(least)g(t)m(w)m(o)300
3538 y(argumen)m(ts)i(can)f(b)s(e)g(e\013ectiv)m(ely)h(used)f(as)h(an)f
(in\014x)e(op)s(erator:)443 3801 y Fk(x)48 b(^f^)f(y)381
b(//)47 b(Same)g(as)g(f\(x,y\).)94 b(Example:)45 b(3)j(^plus^)e(2)300
4063 y Fm(F)-8 b(ull)28 b(functoids)f(enable)i(this)e(in\014x)h(syn)m
(tax)h(b)m(y)g(o)m(v)m(erloading)g Fk(operator^)p Fm(.)38
b(The)28 b(details)g(of)h(the)h(imple-)300 4250 y(men)m(tation)h(of)f
(this)g(feature)h(are)f(relativ)m(ely)g(straigh)m(tforw)m(ard,)h(and)e
(are)i(describ)s(ed)e(in)g(Section)h(4.1.3.)300 4438
y(This)f(syn)m(tax)i(w)m(as)f(inspired)e(b)m(y)i(a)h(similar)d(feature)
i(in)f(Hask)m(ell.)41 b(Man)m(y)31 b(function)e(names)i(\(lik)m(e)f
Fk(plus)p Fm(\))300 4625 y(are)h(more)f(readable)g(as)h(in\014x)d(than)
i(as)h(pre\014x.)441 4813 y(There)37 b(is)f(one)i(notable)f(limitation)
e(to)j(this)f(feature.)62 b(Since)36 b(F)m(C++)h(in\014x)f(is)g
(implemen)m(ted)g(b)m(y)300 5000 y(o)m(v)m(erloading)29
b Fk(operator^)p Fm(,)d(w)m(e)j(cannot)g(c)m(hange)g(the)g(precedence)g
(or)f(asso)s(ciativit)m(y)g(of)h(functoids)e(used)300
5187 y(as)42 b(in\014x)d(op)s(erators.)74 b(These)41
b(parsing)f(asp)s(ects)i(are)g(\014xed)e(b)m(y)i(the)f(C++)f(language,)
45 b(and)c(th)m(us)g(an)300 5375 y(expression)29 b(lik)m(e)2055
5700 y(27)p eop
%%Page: 28 37
28 36 bop 443 91 a Fk(3)48 b(^plus^)e(4)h(^multiplies^)e(5)300
329 y Fm(means)443 567 y Fk(multiplies\()g(plus\(3,4\),)g(5)i(\))300
805 y Fm(\(b)s(ecause)37 b Fk(operator^)e Fm(is)h(left-asso)s(ciativ)m
(e)i(and)e(all)g(in\014x)f(functoids)h(ha)m(v)m(e)i(equal)f
(precedence\).)62 b(Of)300 993 y(course,)31 b(the)f(user)g(can)h(alw)m
(a)m(ys)g(o)m(v)m(erride)f(the)h(defaults)e(b)m(y)h(using)f(explicit)g
(paren)m(theses,)i(as)f(in)443 1231 y Fk(3)48 b(^plus^)e(\(4)h
(^multiplies^)d(5\))300 1466 y Fl(2.2.7)105 b(Currying)300
1712 y Fm(F)m(C++)31 b(supp)s(orts)e(currying)g(of)j(functoid)e
(argumen)m(ts.)43 b(Currying)28 b(is)j(another)g(feature)g(implemen)m
(ted)300 1900 y(in)i(the)i Fk(FullN)d Fm(com)m(binators.)53
b(All)33 b(of)h(the)h(functoids)e(exp)s(orted)h(b)m(y)g(the)g(library)e
(are)j(full)d(functoids,)300 2087 y(and)e(th)m(us)g(all)f(are)i(curry)m
(able.)1350 2054 y Fg(3)1429 2087 y Fm(Here)g(is)e(an)i(example:)443
2325 y Fk(struct)46 b(XPlus)h({)g(...)g(})g(xplus;)443
2513 y(Full2<XPlus>)e(plus;)443 2700 y(...)443 2888 y(xplus\(2,3\);)140
b(//)48 b(xplus)e(requires)f(both)i(args,)443 3075 y(plus\(2,3\);)188
b(//)48 b(whereas)d(plus)i(is)g(curryable)443 3263 y(plus\(2\);)284
b(//)48 b(and)e(can)h(be)h(called)e(in)h(any)443 3450
y(plus\(2,_\);)188 b(//)48 b(of)f(these)f(ways.)443 3637
y(plus\(_,3\);)300 3875 y Fm(In)29 b(the)i(example,)f
Fk(xplus)e Fm(is)i(de\014ned)e(as)j(a)f(basic)g(direct)f(functoid,)g
(whereas)h Fk(plus)f Fm(is)g(an)h(ob)5 b(ject)31 b(that)300
4063 y(adds)g(the)g(currying)f(functionalit)m(y)g(to)i(the)g
(underlying)c(functoid.)43 b(The)31 b(underscore)f(\()p
3370 4063 28 4 v 33 w(\))i(is)f(a)g(sp)s(ecial)300 4250
y(v)-5 b(alue)27 b(\(the)h(unique)e(instance)h(of)g(a)h(t)m(yp)s(e)g
(named)f Fk(AutoCurryType)p Fm(\))d(that)k(curry)m(able)f(functoids)f
(kno)m(w)300 4438 y(ab)s(out)k(whic)m(h)f(serv)m(es)i(as)g(a)f
(placeholder)g(meaning)f(\\this)h(argumen)m(t)h(will)c(b)s(e)j
(supplied)d(later".)441 4625 y(The)34 b Fk(FullN)e Fm(classes,)j(whic)m
(h)e(implemen)m(t)g(the)h(currying)e(functionalit)m(y)-8
b(,)34 b(tak)m(e)i(adv)-5 b(an)m(tage)35 b(of)g(t)m(w)m(o)300
4813 y(C++)c(language)i(features:)45 b(o)m(v)m(erloading)32
b(and)g(partial)f(sp)s(ecialization.)45 b(In)31 b(C++,)h(functions)f
(can)i(b)s(e)p 300 4949 1440 4 v 404 5003 a Ff(3)438
5035 y Fe(While)c(all)h(our)f(functoids)g(are)h(curry)p
Fc(able)p Fe(,)f(curry)p Fc(ing)35 b Fe(only)29 b(happ)r(ens)f(when)h
(a)g(subset)f(of)i(a)f(function's)h(argumen)n(ts)300
5126 y(are)c(passed.)35 b(When)24 b(all)i(of)g(the)f(exp)r(ected)g
(argumen)n(ts)g(are)g(passed)h(to)f(a)h(curry)n(able)f(functoid,)h(the)
f Fd(Full)h Fe(wrapp)r(er)g(class)300 5217 y(transparen)n(tly)31
b(\\forw)n(ards")j(the)d(call)h(to)f(its)h(underlying)f(functoid.)51
b(An)31 b(optimizing)g(C++)g(compiler)g(can)h(eliminate)300
5309 y(the)d(o)n(v)n(erhead)g(of)h(the)e(forw)n(arding)j(function,)g
(so)f(there)f(is)g(no)h(p)r(enalt)n(y)e(to)i(adding)f(the)g(currying)g
(capabilit)n(y)g(to)h(ev)n(ery)300 5400 y(functoid.)2055
5700 y Fm(28)p eop
%%Page: 29 38
29 37 bop 300 91 a Fm(o)m(v)m(erloaded)24 b(\(ad)f(ho)s(c\))g(based)g
(on)g(the)g(n)m(um)m(b)s(er)e(and)i(t)m(yp)s(es)g(of)g(their)f(argumen)
m(ts.)38 b(Similarly)-8 b(,)22 b(templates)300 279 y(can)35
b(b)s(e)g(sp)s(ecialized)e(\(ad)j(ho)s(c\))f(for)g(certain)g(argumen)m
(t)h(t)m(yp)s(es.)55 b(So)35 b(class)g Fk(Full2)f Fm(has)h(four)f
(separate)300 466 y Fk(Sig)20 b Fm(sp)s(ecializations)e(\()p
Fk(Sig<X,Y>)p Fm(,)j Fk(Sig<X>)p Fm(,)g Fk(Sig<X,AutoCurryType>)p
Fm(,)d Fk(Sig<AutoCurryType,Y>)p Fm(|)300 654 y(where)29
b Fk(X)h Fm(and)f Fk(Y)h Fm(are)g(template)g(parameters)g(\(free)h(t)m
(yp)s(e)f(v)-5 b(ariables\)\))29 b(and)g(four)g(separate)i(o)m(v)m
(erloaded)300 841 y(implemen)m(tations,)26 b(whic)m(h)e(corresp)s(ond)h
(to)i(the)f(four)g(di\013eren)m(t)f(w)m(a)m(ys)i(a)f(t)m(w)m(o-argumen)
m(t)j(functoid)24 b(ma)m(y)300 1028 y(b)s(e)30 b(called:)443
1291 y Fk(f\(x,y\))443 1478 y(f\(x\))443 1665 y(f\(x,_\))443
1853 y(f\(_,y\))441 2115 y Fm(The)37 b Fk(FullN)g Fm(classes)g(enable)h
(functions)e(to)i(b)s(e)f(curried)f(either)h(implicitly)d(\(b)m(y)k
(only)f(supplying)300 2303 y(some)g(of)g(the)g(leading)f(argumen)m
(ts\))h(or)g(explicitly)d(\(using)i(underscores)g(as)h(placeholders)e
(for)i(argu-)300 2490 y(men)m(ts)28 b(to)g(b)s(e)e(curried\).)39
b(The)27 b(F)m(C++)g(library)e(also)i(con)m(tains)g(more)h(v)m(erb)s
(ose)f(functions)f(for)h(currying,)300 2677 y(named)39
b Fk(bindMofN.)f Fm(F)-8 b(or)40 b(example)g Fk(plus\(_,3\))d
Fm(and)i Fk(bind2of2\(plus,3\))c Fm(are)41 b(equiv)-5
b(alen)m(t:)59 b(b)s(oth)300 2865 y(bind)39 b(the)j(second)g(argumen)m
(t)h(\(of)f Fk(plus)p Fm('s)f(t)m(w)m(o)i(argumen)m(ts\))f(to)h(the)f
(v)-5 b(alue)41 b(3,)k(and)d(return)e(a)i(new)300 3052
y(function)c(of)h(one)g(argumen)m(t.)67 b(These)39 b(explicit)e
(binders)f(ha)m(v)m(e)41 b(an)e(additional)d(capabilitit)m(y:)57
b(if)38 b(one)300 3240 y(binds)c(all)i(of)h(a)g(function's)f(argumen)m
(ts,)j(a)e(zero-argumen)m(t)h(functoid)e(\(a)h(th)m(unk\))g(is)e
(returned.)59 b(F)-8 b(or)300 3427 y(example,)49 b Fk
(bind1and2of2\(plus,2,3\))39 b Fm(returns)44 b(a)i(zero-argumen)m(t)g
(functoid,)i(whic)m(h)c(yields)g(the)300 3615 y(v)-5
b(alue)34 b(5)i(when)e(called.)54 b(The)34 b Fk(thunkN)g
Fm(functions)f(can)j(also)e(b)s(e)h(used)f(to)i(enact)g(the)f(same)h(b)
s(eha)m(vior:)300 3802 y Fk(thunk2\(plus,2,3\))26 b Fm(yields)i(the)j
(same)g(result)e(as)i Fk(bind1and2of2\(plus,2,3\))p Fm(.)441
3989 y(There)f(are)h(t)m(ypically)e(a)i(few)f(di\013eren)m(t)g(w)m(a)m
(ys)h(to)g(express)f(the)h(same)g(\\curried)e(function)g(call")h(ex-)
300 4177 y(pression)24 b(in)f(F)m(C++.)39 b(The)25 b(redundancy)f(is)g
(a)h(historical)f(acciden)m(t;)k(the)d(explicit)f(binders)e(\()p
Fk(bindMofN)p Fm(\))300 4364 y(w)m(ere)27 b(created)g(\014rst,)g
(whereas)f(the)g Fk(thunkN)f Fm(functions)g(and)g Fk(FullN)g
Fm(classes)i(came)g(later)f(\(after)h(w)m(e)g(dis-)300
4552 y(co)m(v)m(ered)32 b(the)e(template)h(sp)s(ecialization)e(tric)m
(ks)h(needed)g(to)h(enable)e(suc)m(h)h(functionalit)m(y\).)40
b(No)m(w)m(ada)m(ys,)300 4739 y(w)m(e)32 b(t)m(ypically)e(prefer)h(to)h
(use)f(the)g(implicit)e(currying)g(of)j(the)f Fk(Full)p
Fm(s)f(to)i(curry)f(an)m(y)g(subset)g(of)h(a)g(func-)300
4927 y(tion's)c(argumen)m(ts,)i(and)e(use)g(the)h Fk(thunkN)e
Fm(functions)g(when)h(w)m(e)h(w)m(an)m(t)h(to)f(bind)d(all)i(of)h(the)g
(argumen)m(ts)300 5114 y(and)34 b(create)j(a)e(th)m(unk.)54
b(The)34 b(explicit)f(binders)g(are)i(retained)f(for)h(compatibilit)m
(y)e(with)h(legacy)h(co)s(de,)300 5301 y(and)30 b(b)s(ecause)g(they)h
(are)f(conceptually)g(easier)h(for)f(no)m(vice)g(users)g(to)h
(understand.)2055 5700 y(29)p eop
%%Page: 30 39
30 38 bop 441 91 a Fm(Currying)33 b(is)i(a)h(useful)e(feature)i(in)f
(functional)f(programming,)i(as)g(it)f(enables)g(programmers)g(to)300
279 y(easily)40 b(sp)s(ecialize)f(and)i(adapt)g(general)g(functions)e
(to)j(\014t)e(sp)s(eci\014c)g(needs,)j(b)m(y)e(\014xing)e(some)j
(subset)300 466 y(of)i(the)g(functions')f(argumen)m(ts.)82
b(Whereas)45 b(some)g(functional)d(languages)i(ha)m(v)m(e)i(built-in)41
b(supp)s(ort)300 654 y(for)d(currying,)g(in)f(C++)g(it)g(m)m(ust)h(b)s
(e)f(supplied)e(via)j(a)g(library)-8 b(.)61 b(F)m(C++)38
b(is)f(the)h(only)f(C++)g(library)300 841 y(that)h(supp)s(orts)d
(implicit)f(currying,)j(b)m(y)g(exploiting)e(the)j(existing)e(features)
h(of)g(the)g(C++)g(language)300 1028 y(to)g(mak)m(e)g(it)f(app)s(ear)f
(to)i(clien)m(ts)f(as)g(though)g(currying)e(is)i(a)g(built-in)d
(language)k(feature)f(that)h(w)m(orks)300 1216 y(automatically)-8
b(.)40 b(Other)27 b(C++)f(libraries)f(ha)m(v)m(e)k(other)e(lev)m(els)g
(of)h(supp)s(ort)e(for)h(currying.)38 b(F)-8 b(or)28
b(example,)300 1403 y(the)k(Bo)s(ost)i(Lam)m(b)s(da)d(Library)g([35)q
(])h(has)g(a)h(mec)m(hanism)f(similar)d(to)k(F)m(C++'s)f(placeholder)f
(currying,)300 1591 y(where)41 b(explicit)g(placeholders)f(can)i(b)s(e)
f(used)h(for)f(curried)f(argumen)m(ts.)76 b(Both)42 b(the)h(STL)d([59)q
(])j(and)300 1778 y(Alexandrescu's)33 b(\\functors")g([2)q(])h(do)f
(supp)s(ort)f(\\binding")f(one)j(of)g(the)g(argumen)m(ts)f(of)h(a)g
(function)e(to)300 1966 y(a)42 b(sp)s(eci\014c)e(v)-5
b(alue,)45 b(ho)m(w)m(ev)m(er)d(in)f(eac)m(h)i(of)e(these)h(libraries,)
g(the)g(binding)d(m)m(ust)i(b)s(e)g(done)g(explicitly)300
2153 y(\(with)32 b(a)h(call)f(to)h(a)g(binding)d(function)h(lik)m(e)h
(F)m(C++'s)g Fk(bindMofN)p Fm(\),)f(and)h(the)h(binding)d(only)h(w)m
(orks)i(on)300 2340 y(monomorphic)c(functions|a)g(sev)m(ere)j
(limitation.)300 2580 y Fl(2.2.8)105 b(Subt)m(yp)s(e)35
b(p)s(olymorphism)300 2826 y Fm(Another)20 b(inno)m(v)-5
b(ation)20 b(of)g(our)g(framew)m(ork)g(is)g(that)h(it)f(implemen)m(ts)e
(a)j(p)s(olicy)e(of)h(subt)m(yp)s(e)g(p)s(olymorphism)300
3013 y(for)43 b(indirect)e(functoids.)76 b(Our)42 b(p)s(olicy)f(is)h
(con)m(tra)m(v)-5 b(arian)m(t)44 b(with)e(resp)s(ect)h(to)g(argumen)m
(t)h(t)m(yp)s(es)f(and)300 3201 y(co)m(v)-5 b(arian)m(t)32
b(with)e(resp)s(ect)h(to)h(result)e(t)m(yp)s(es.)44 b(Subt)m(yp)s(e)29
b(p)s(olymorphism)f(is)i(imp)s(ortan)m(t)g(b)s(ecause)i(it)e(is)h(a)300
3388 y(familiar)i(concept)j(in)e(ob)5 b(ject)36 b(orien)m(tation|it)f
(ensures)g(that)h(indirect)d(functoids)h(can)h(b)s(e)g(used)g(lik)m(e)
300 3575 y(an)m(y)c(other)f(C++)g(ob)5 b(ject)31 b(reference)g(in)e
(real)h(C++)f(programs.)441 3763 y(A)37 b(con)m(triv)m(ed)f(example:)53
b(Supp)s(ose)34 b(w)m(e)j(ha)m(v)m(e)h(t)m(w)m(o)g(t)m(yp)s(e)e
(hierarc)m(hies,)h(where)f(Dog)i(is)d(a)i(subt)m(yp)s(e)300
3950 y(of)k(Animal)e(and)h(Car)g(is)g(a)h(subt)m(yp)s(e)f(of)h(V)-8
b(ehicle.)72 b(This)39 b(means)h(that)i(a)f(Dog)h(is)e(an)g(Animal)f
(\(i.e.,)300 4138 y(a)e(reference)h(to)f(Dog)i(can)e(b)s(e)f(used)g
(where)h(a)g(reference)h(to)f(Animal)f(is)g(exp)s(ected\))h(and)g(a)g
(Car)g(is)f(a)300 4325 y(V)-8 b(ehicle.)46 b(If)31 b(w)m(e)i(de\014ne)e
(a)i(functoid)e(whic)m(h)g(tak)m(es)i(an)f(Animal)f(as)h(a)h(parameter)
f(and)g(returns)f(a)h(Car,)300 4513 y(then)27 b(this)g(functoid)g(is)f
(a)j(subt)m(yp)s(e)d(of)i(one)g(that)h(tak)m(es)g(a)f(Dog)h(and)e
(returns)g(a)h(V)-8 b(ehicle.)39 b(F)-8 b(or)29 b(instance:)443
4769 y Fk(Fun1<Ref<Animal>,)43 b(Ref<Car>)j(>)95 b(fa;)443
4956 y(Fun1<Ref<Dog>,)44 b(Ref<Vehicle>)h(>)i(fb)g(=)h(fa;)539
5144 y(//)f(legal:)f(fa)h(is)g(a)h(subtype)e(of)h(fb)300
5400 y Fm(\(Note)39 b(the)e(use)f(of)h(our)g Fk(Ref)f
Fm(class)h(template)g(whic)m(h)f(implemen)m(ts)f(references|a)j
(general)f(purp)s(ose)2055 5700 y(30)p eop
%%Page: 31 40
31 39 bop 300 91 a Fm(replacemen)m(t)47 b(of)g(C++)e(p)s(oin)m(ters.)88
b(The)46 b(example)g(w)m(ould)g(w)m(ork)g(iden)m(tically)f(with)g
(nativ)m(e)i(C++)300 279 y(p)s(oin)m(ters|e.g.)41 b Fk(Car*)29
b Fm(rather)h(than)g Fk(Ref<Car>)p Fm(.\))441 466 y(That)23
b(is,)h Fk(fa)f Fm(is)g(a)g(subt)m(yp)s(e)g(of)g Fk(fb)g
Fm(since)g(the)g(argumen)m(t)h(of)g Fk(fb)f Fm(is)f(a)i(subt)m(yp)s(e)e
(of)i(the)f(argumen)m(t)h(of)g Fk(fa)300 654 y Fm(\(con)m(tra)m(v)-5
b(ariance\))26 b(and)d(the)h(return)f(t)m(yp)s(e)h(of)g
Fk(fa)f Fm(is)f(a)j(subt)m(yp)s(e)d(of)i(the)g(return)f(t)m(yp)s(e)h
(of)g Fk(fb)f Fm(\(co)m(v)-5 b(ariance\).)300 841 y(W)d(e)32
b(cannot)f(go)g(the)g(other)g(w)m(a)m(y)-8 b(,)32 b(though)f(\(assign)f
Fk(fb)g Fm(to)h Fk(fa)p Fm(\).)42 b(This)28 b(means)j(that)g(w)m(e)g
(can)g(substitute)300 1028 y(a)f(\\sp)s(eci\014c")g(functoid)e(in)g
(the)i(place)g(of)g(a)g(\\general")h(functoid.)39 b(Since)29
b(subt)m(yping)f(only)h(matters)h(for)300 1216 y(v)-5
b(ariables)29 b(ranging)h(o)m(v)m(er)h(functions,)e(it)h(is)g(implemen)
m(ted)f(only)g(for)h(indirect)f(functoids.)441 1403 y(Subt)m(yp)s(e)i
(p)s(olymorphism)d(is)j(implemen)m(ted)f(b)m(y)i(de\014ning)e(an)h
(implicit)e(con)m(v)m(ersion)j(op)s(erator)g(b)s(e-)300
1591 y(t)m(w)m(een)g(functoids)e(that)i(satisfy)f(our)g(subt)m(yping)e
(p)s(olicy)-8 b(.)42 b(This)30 b(a\013ects)i(the)g(implemen)m(tation)e
(of)h(class)300 1778 y(templates)g Fk(FunN)e Fm(of)h(Section)h(2.2.3.)
42 b(F)-8 b(or)31 b(instance,)g(the)f(de\014nition)e(of)j
Fk(Fun1)e Fm(has)h(the)h(form:)443 2040 y Fk(template)46
b(<class)g(Arg1,)g(class)h(Result>)443 2228 y(class)g(Fun1)f(:)i
(public)e(CFunType<Arg1,Result>)c({)539 2415 y(...)47
b(//)g(private)f(members)f(same)i(as)g(before)443 2603
y(public:)539 2790 y(...)g(//)g(same)f(as)i(before)539
2978 y(template)d(<class)h(A1s,class)g(Rs>)539 3165 y(Fun1\()g(const)g
(Fun1<A1s,Rs>&)f(f)i(\))g(:)634 3352 y(ref\(convert1<Arg1,Result>)o
(\(f.)o(ref\))o(\))42 b({})443 3540 y(};)300 3802 y Fm(Without)30
b(getting)h(in)m(to)g(all)e(the)i(details)e(of)i(the)f(implemen)m
(tation,)f(the)i(k)m(ey)g(idea)f(is)g(to)h(de\014ne)e(a)i(tem-)300
3989 y(plate)g(implicit)d(con)m(v)m(ersion)j(op)s(erator)g(from)f
Fk(Fun1<A1s,Rs>)e Fm(to)j Fk(Fun1<Arg1,Result>)p Fm(,)c(if)j(and)g
(only)300 4177 y(if)23 b Fk(A1s)g Fm(is)g(a)i(sup)s(ert)m(yp)s(e)e(of)h
Fk(Arg1)f Fm(and)g Fk(Rs)h Fm(is)f(a)h(subt)m(yp)s(e)f(of)i
Fk(Result)p Fm(.)37 b(The)23 b(latter)i(c)m(hec)m(k)g(is)e(the)i(resp)s
(onsi-)300 4364 y(bilit)m(y)j(of)h(direct)g(functoid)g
Fk(convert1)p Fm(,)e(whic)m(h)i(instan)m(tiates)g(a)h(help)s(er)e
(class)h(called)g Fk(Fun1Converter)p Fm(:)443 4626 y
Fk(template)46 b(<class)g(Arg1,)g(class)h(Result,)e(class)i(A1s,)f
(class)h(Rs>)443 4814 y(class)g(Fun1Converter)d(:)j(public)f
(Fun1Impl<A1d,Rd>)e({)586 5001 y(...)586 5189 y(Ref<Fun1Impl<A1s,Rs>)f
(>)k(f;)586 5376 y(Result)f(operator\(\)\()f(const)i(Arg1&)f(x)h(\))h
(const)e({)2055 5700 y Fm(31)p eop
%%Page: 32 41
32 40 bop 730 91 a Fk(return)46 b(f->operator\(\)\()e(x)j(\);)143
b(//)47 b(this)f(line)h(compiles)f(only)g(if)730 279
y(//)h(Arg1->A1s)e(and)i(Rs->Result)e(are)i(legal)f(implicit)g
(conversions)586 466 y(})443 654 y(};)300 916 y Fm(Note)27
b(that)f Fk(Fun1Converter)c Fm(de\014nes)i(co)s(de)i(that)g(explicitly)
d(tests)k(\(at)f(compile)f(time\))g(to)i(ensure)d(that)300
1103 y(an)33 b Fk(Arg1)e Fm(is)h(a)h(subt)m(yp)s(e)f(of)h
Fk(A1s)f Fm(and)g(that)h Fk(Rs)f Fm(is)g(a)h(subt)m(yp)s(e)f(of)h
Fk(Result)p Fm(.)46 b(In)32 b(this)g(w)m(a)m(y)-8 b(,)35
b(the)e(implicit)300 1291 y(con)m(v)m(ersion)26 b(of)h(functoids)d
(will)g(fail)h(if)g(and)g(only)h(if)f(either)g(of)i(the)f(ab)s(o)m(v)m
(e)h(t)m(w)m(o)h(con)m(v)m(ersions)e(fails.)38 b(Since)300
1478 y(the)31 b(op)s(erator)f(is)g(templatized,)g(it)g(can)g(b)s(e)g
(used)g(for)g(an)m(y)h(t)m(yp)s(es)f Fk(A1s)f Fm(and)h
Fk(Rs)p Fm(.)441 1665 y(W)-8 b(e)23 b(should)c(note)i(that,)j(although)
d(the)g(ab)s(o)m(v)m(e)i(tec)m(hnique)e(is)f(correct)i(and)f
(su\016cien)m(t)f(for)h(the)h(ma)5 b(jor-)300 1853 y(it)m(y)28
b(of)g(con)m(v)m(ersions,)h(there)f(are)g(some)g(sligh)m(t)f(problems.)
39 b(First,)28 b(C++)e(has)i(some)g(unsafe)g(con)m(v)m(ersions)300
2040 y(b)s(et)m(w)m(een)33 b(nativ)m(e)f(t)m(yp)s(es)g(\(e.g.,)j
(implicit)29 b(con)m(v)m(ersions)j(from)f(\015oating)h(p)s(oin)m(t)f(n)
m(um)m(b)s(ers)g(to)i(in)m(tegers)f(or)300 2228 y(c)m(haracters)j(are)f
(legal\).)52 b(There)33 b(is)g(no)g(go)s(o)s(d)h(w)m(a)m(y)h(to)f
(address)f(this)g(problem)f(\(whic)m(h)h(w)m(as)h(inherited)300
2415 y(from)e(C)g(despite)f(the)i(in)m(ten)m(tions)f(of)g(the)h(C++)e
(language)i(designer;)f(see)h([61)r(])f(p.)46 b(710\).)j(Second,)32
b(w)m(e)300 2603 y(cannot)f(o)m(v)m(erload)g(\(or)g(otherwise)f
(extend\))h(the)f(C++)f(op)s(erator)i Fk(dynamic_cast)p
Fm(.)37 b(Instead,)31 b(w)m(e)g(ha)m(v)m(e)300 2790 y(pro)m(vided)26
b(our)g(o)m(wn)h(op)s(eration)f(that)i(imitates)e Fk(dynamic_cast)e
Fm(for)j(indirect)e(functoids.)38 b(The)26 b(incom-)300
2978 y(patibilit)m(y)k(is)i(unfortunate,)h(but)f(should)e(hardly)h
(matter)i(for)g(actual)g(use:)45 b(not)33 b(only)e(do)i(w)m(e)g(pro)m
(vide)300 3165 y(an)g(alternativ)m(e,)i(but)e(also)g(do)m(wn-casting)g
(functoid)f(references)i(do)s(es)f(not)g(seem)h(to)g(b)s(e)f
(meaningful,)300 3352 y(except)e(in)e(truly)g(con)m(triv)m(ed)i
(examples.)300 3592 y Fl(2.2.9)105 b(C++)35 b(in)m(terface)300
3839 y Fm(In)i(this)g(section)h(w)m(e)h(discuss)d(ho)m(w)i(F)m(C++)g
(in)m(terfaces)g(with)f(the)h(rest)h(of)f(the)g(C++)f(language)i(and)
300 4026 y(with)29 b(C++)g(libraries,)f(as)j(w)m(ell)e(as)i(ho)m(w)f(F)
m(C++)g(can)h(capture)g(\\e\013ects".)441 4213 y(F)m(C++)44
b(has)f(in)m(terfaces)h(to)g(normal)f(C++)f(functions)g(and)h(to)h(the)
g(C++)f(Standard)f(Library)-8 b(.)300 4401 y(W)g(e)44
b(ha)m(v)m(e)g(already)e(encoun)m(tered)i Fk(ptr_to_fun\(\))p
Fm(,)e(whic)m(h)g(con)m(v)m(erts)i(a)f(normal)f(function)f(in)m(to)i
(an)300 4588 y(F)m(C++)29 b(functoid.)40 b(The)29 b Fk(ptr_to_fun\(\))d
Fm(op)s(erator)k(w)m(orks)g(on)f(mem)m(b)s(er)g(functions)g(as)h(w)m
(ell,)f(creating)300 4776 y(a)e(functoid)f(whic)m(h)f(tak)m(es)k(a)e(p)
s(oin)m(ter)f(to)h(the)h(receiv)m(er)f(ob)5 b(ject)28
b(as)f(an)f(extra)i(\014rst)e(parameter.)40 b(Figure)27
b(4)300 4963 y(sho)m(ws)e Fk(ptr_to_fun\(\))c Fm(applied)i(to)i(b)s
(oth)g(normal)e(and)i(mem)m(b)s(er)f(functions,)h(and)f(demonstrates)h
(that)300 5151 y(the)34 b(results)e(are)i(functoids)e(b)m(y)i(using)e
(the)i(currying)e(abilit)m(y)g(of)h(F)m(C++)h(functoids.)49
b(Note)35 b(also)e(that)300 5338 y Fk(ptr_to_fun\(\))22
b Fm(ma)m(y)k(b)s(e)f(applied)f(to)i(b)s(oth)f Fk(const)f
Fm(and)h(non-)p Fk(const)f Fm(mem)m(b)s(er)h(functions.)37
b(Creating)26 b(a)2055 5700 y(32)p eop
%%Page: 33 42
33 41 bop 300 91 a Fm(functoid)28 b(from)g(a)h(non-)p
Fk(const)e Fm(mem)m(b)s(er)h(function)g(results)g(in)f(a)i(functoid)f
(whic)m(h)f(can)i(ha)m(v)m(e)h(an)f(e\013ect.)300 279
y(This)36 b(is)h(p)s(ossible)e(since)i(the)h(functoid)e(tak)m(es)j(a)f
Fi(p)-5 b(ointer)49 b Fm(to)39 b(the)f(receiv)m(er)g(ob)5
b(ject.)63 b(Indeed,)39 b(this)e(is)300 466 y(the)h(usual)f(w)m(a)m(y)i
(to)g(capture)g(e\013ects)g(inside)d(functoids:)55 b(whereas)38
b(the)h(parameters)f(and)g(results)f(of)300 654 y(the)g(functoids)e
(are)i Fk(const)e Fm(as)i(a)g(result)e(of)i(the)g(F)m(C++)f(library)e
(design,)k(there)e(is)g(nothing)g(to)h(stop)300 841 y(a)c(clien)m(t)f
(from)h(passing)e(a)i(\()p Fk(const)p Fm(\))f Fi(p)-5
b(ointer)44 b Fm(to)34 b(a)f(non-)p Fk(const)e Fm(ob)5
b(ject)34 b(in)m(to)e(a)i(functoid,)e(whic)m(h)f(ma)m(y)300
1028 y(then)f(manipulate)f(the)h(ob)5 b(ject)32 b(via)e(the)g(p)s(oin)m
(ter.)441 1216 y(The)25 b(F)m(C++)g(library)e(also)j(de\014nes)e(a)i
(few)g(e\013ect)h(com)m(binators.)39 b(An)25 b(e\013ect)i(com)m
(binator)e(com)m(bines)300 1403 y(an)39 b(e\013ect)j(\(represen)m(ted)d
(as)h(a)g(th)m(unk\))f(with)f(another)i(functoid.)67
b(Here)40 b(are)g(some)g(example)f(e\013ect)300 1591
y(com)m(binators:)443 1840 y Fk(//)47 b(before\(thunk,f\)\(args\))90
b(==)95 b({)47 b(thunk\(\);)f(return)g(f\(args\);)g(})443
2028 y(//)h(after\(g,thunk\)\(args\))138 b(==)95 b({)47
b(R)h(r)f(=)h(g\(args\);)d(thunk\(\);)h(return)g(r;)h(})300
2277 y Fm(An)25 b(example:)38 b(supp)s(ose)24 b(y)m(ou'v)m(e)j
(de\014ned)e(a)h(functoid)e Fk(writeLog\(\))f Fm(whic)m(h)h(tak)m(es)j
(a)f(string)f(and)g(writes)300 2465 y(it)30 b(to)h(a)g(log)f(\014le.)40
b(Then)443 2715 y Fk(before\()46 b(thunk1\()g(writeLog,)f("About)h(to)h
(call)g(foo\(\)")f(\),)h(foo)g(\))300 2964 y Fm(results)29
b(in)g(a)h(new)g(functoid)f(with)g(the)h(same)g(b)s(eha)m(vior)g(as)g
Fk(foo\(\))p Fm(,)f(only)g(it)h(writes)f(a)i(message)g(to)g(the)300
3152 y(log)f(\014le)g(b)s(efore)g(calling)f Fk(foo\(\))p
Fm(.)441 3339 y(F)m(C++)j(functoids)e(are)i(designed)e(to)i(w)m(ork)g
(smo)s(othly)f(with)f(the)i(C++)e(Standard)h(T)-8 b(emplate)32
b(Li-)300 3526 y(brary)24 b(\(STL\).)h(Monomorphic)f(F)m(C++)h
(functoids)e(conform)i(to)g(the)h(requiremen)m(ts)d(for)i(what)g(the)g
(STL)300 3714 y(calls)g(\\adaptable)h(functions",)g(whic)m(h)f(enables)
g(F)m(C++)h(functoids)e(to)j(b)s(e)e(passed)h(to)g(STL)f(algorithms)300
3901 y(lik)m(e)33 b Fk(std::transform\(\))d Fm(\(the)35
b(imp)s(erativ)m(e)e(analog)h(of)h Fk(map\(\))p Fm(\).)51
b(\(P)m(olymorphic)32 b(functoids)h(can)i(b)s(e)300 4089
y(suitably)27 b(adapted)i(simply)e(b)m(y)i(\014rst)f
Fk(monomorphize\(\))p Fm(ing)c(them.\))41 b(Indeed,)29
b(when)f(using)f(STL)h(algo-)300 4276 y(rithms,)36 b(it)f(is)g(often)h
(easier)g(to)g(use)f(F)m(C++)h(functoids)e(rather)i(than)f(use)h(the)g
(STL's)f(o)m(wn)g(supp)s(ort.)300 4464 y(F)-8 b(or)31
b(example,)f(to)i(add)d Fk(3)h Fm(to)h(eac)m(h)h(elemen)m(t)f(of)f(a)h
Fk(std::vector<int>)26 b Fm(named)k Fk(v)p Fm(,)g(one)h(m)m(ust)f
(write)443 4713 y Fk(std::transform\(v.begin\(\),)o(v.en)o(d\(\))o
(,v.b)o(egin)o(\(\),)634 4901 y(std::bind1st\(std::plus<in)o(t>\()o
(\),3\))41 b(\);)300 5150 y Fm(using)29 b(STL,)g(whereas)i(when)e(F)m
(C++)h(is)g(brough)m(t)g(to)h(b)s(ear,)f(just)443 5400
y Fk(std::transform\(v.begin\(\),)o(v.en)o(d\(\))o(,v.b)o(egin)o(\(\),)
o(fcpp)o(::pl)o(us\()o(3\)\);)2055 5700 y Fm(33)p eop
%%Page: 34 43
34 42 bop 300 63 a Fk(int)47 b(f\()g(int)g(x,)g(int)g(y)h(\))f({)g
(return)g(3*x)f(+)i(y;)f(})300 289 y(class)f(Foo)h({)395
402 y(int)g(m_n;)300 515 y(public:)395 628 y(Foo\()g(int)g(nn)g(\))h(:)
f(m_n\(nn\))f({})395 741 y(int)h(bar\()g(int)g(x,)g(int)g(y)g(\))h
(const)395 854 y({)g(return)e(m_n*x)g(+)i(y;)f(})395
966 y(int)g(n\(\))g(const)g({)g(return)f(m_n;)h(})395
1079 y(void)g(inc_n\()f(int)h(x)h(\))f({)g(m_n)g(+=)h(x;)f(})300
1192 y(};)300 1418 y(void)g(example\(\))e({)395 1531
y(assert\()h(ptr_to_fun\(&f\)\(3\)\(1\))d(==)k(10)g(\);)395
1757 y(Foo)g(foo\(3\);)395 1870 y(assert\(ptr_to_fun\(&Foo::ba)o
(r\)\(&)o(foo)o(,3\)\()o(1\))42 b(==)47 b(10\);)395 2096
y(ptr_to_fun\(&Foo::inc_n\)\(&f)o(oo,1)o(\);)41 b(//)48
b(effect)395 2208 y(assert\()e(foo.n\(\))g(==)h(4)h(\);)f(//)g(updated)
f(value)300 2321 y(})1199 2617 y Fl(Figure)35 b(4:)47
b Fm(F)m(C++)30 b(and)g(nativ)m(e)h(C++)e(functions)300
2892 y(is)34 b(su\016cien)m(t.)54 b(On)35 b(the)g(other)g(side)f(of)h
(the)h(coin,)g(F)m(C++)f(pro)m(vides)f(com)m(binators)h(to)g(promote)h
(STL)300 3079 y(\\adaptable)j(functions")f(in)m(to)h(\(monomorphic\))f
(F)m(C++)h(functoids)f(so)h(that)g(functions)f(from)g(from)300
3267 y(STL)h(can)i(b)s(e)e(used)h(inside)e(F)m(C++.)70
b(Finally)-8 b(,)41 b(F)m(C++)g Fk(List)p Fm(s)d(are)j(designed)e(to)i
(\014t)f(in)m(to)h(the)f(STL)300 3454 y(framew)m(ork)28
b(for)g(data)g(structures.)39 b(Figure)28 b(5)g(sho)m(ws)g(that)g(the)g
Fk(List)f Fm(class)h(supp)s(orts)e(iterators)i(of)g(the)300
3642 y(STL)g(st)m(yle.)41 b(This)28 b(mak)m(es)i(con)m(v)m(erting)h(b)s
(oth)e(to)h(and)f(from)g(STL)f(data)j(structures)e(easy)-8
b(,)31 b(and)e(enables)300 3829 y Fk(List)p Fm(s)g(to)i(b)s(e)f(passed)
g(to)h(\(non-m)m(utating\))g(STL)e(algorithms.)441 4017
y(Another)h(in)m(terface)h(that)g(is)e(somewhat)i(common)g(in)e(legacy)
i(C/C++)e(co)s(de)i(is)e(the)h(use)g(of)h(t)m(yp)s(es)395
4268 y Fk(List<int>)46 b(l)h(=)h(take\()e(5,)h(enumFrom\(1\))e(\);)395
4381 y(//)j(Make)e(a)i(vector)e(from)g(a)i(List)395 4494
y(std::vector<int>)c(v\()j(l.begin\(\),)e(l.end\(\))h(\);)395
4607 y(std::reverse\()f(v.begin\(\),)g(v.end\(\))g(\);)395
4720 y(//)j(Make)e(a)i(List)e(from)h(a)g(vector)395 4833
y(List<int>)f(r\()h(v.begin\(\),)e(v.end\(\))h(\);)395
4946 y(assert\()g(r)i(==)f(list_with\(5,4,3,2,1\))42
b(\);)1549 5241 y Fl(Figure)35 b(5:)46 b Fm(F)m(C++)31
b(and)e(STL)2055 5700 y(34)p eop
%%Page: 35 44
35 43 bop 300 91 a Fm(lik)m(e)38 b Fk(void)47 b(\(*\)\(void*\))1230
58 y Fg(4)1309 91 y Fm(as)39 b(a)h(sort)f(of)g(generic)g(in)m(terface)h
(for)f(\\callbac)m(k)g(functions".)66 b(It)40 b(is)e(not)300
279 y(p)s(ossible)d(to)i(automatically)g(con)m(v)m(ert)i(an)e(F)m(C++)g
(functoid)f(in)m(to)h(suc)m(h)g(a)g(function)f(p)s(oin)m(ter,)i(but)e
(it)300 466 y(is)i(straigh)m(tforw)m(ard)g(to)i(hand-co)s(de)e(an)h
(adapter)g(function:)56 b(just)38 b(write)g(a)i(normal)d(C++)h
(function)300 654 y(with)32 b(the)i(prop)s(er)e(signature)g(that)i
(forw)m(ards)f(the)h(call)f(to)h(the)f(appropriate)g(functoid.)48
b(In)33 b(this)f(w)m(a)m(y)-8 b(,)300 841 y(functoids)22
b(can)i(b)s(e)f(used)g(with)g(suc)m(h)g(legacy)i(libraries.)36
b(\(On)23 b(the)h(other)g(hand,)g(if)f(callbac)m(ks)g(are)h(desired)300
1028 y(but)29 b(there)g(is)g(no)g(need)g(to)h(in)m(terface)g(with)e(a)i
(legacy)h(callbac)m(k)e(library)-8 b(,)28 b(then)h(F)m(C++)g(itself)g
(can)g(serv)m(e)300 1216 y(as)42 b(a)g(complete)h(callbac)m(k)f
(library)-8 b(,)43 b(with)d(indirect)h(functoids)f(serving)h(as)h(t)m
(yp)s(e-safe)h(in)m(terfaces)f(to)300 1403 y(arbitarary)35
b(functions.)56 b(See)37 b(Section)f(2.4.1)h(as)g(w)m(ell)e(as)h
(examples)f(on)h(our)g(w)m(eb)g(site)g([21)q(])g(for)g(more)300
1591 y(ab)s(out)30 b(using)f(F)m(C++)h(as)h(a)g(callbac)m(k)f(library)
-8 b(.\))441 1778 y(The)40 b(smo)s(othness)h(of)f(the)h(in)m(terfaces)g
(b)s(et)m(w)m(een)h(F)m(C++)e(and)g(STL)g(and)g(also)h(b)s(et)m(w)m
(een)g(F)m(C++)300 1966 y(and)26 b(the)i(ob)5 b(ject-orien)m(ted)28
b(p)s(ortions)d(of)j(C++)e(demonstrate)h(an)g(imp)s(ortan)m(t)f(p)s
(oin)m(t.)39 b(F)m(C++)27 b(do)s(es)g(not)300 2153 y(merely)f(inject)g
(in)m(to)h(C++)e(a)i(purely)e(functional)g(sublanguage)h(that)h(should)
e(b)s(e)h(used)f(exclusiv)m(e)h(from)300 2340 y(the)35
b(rest)g(of)f(the)h(language.)54 b(Rather,)36 b(F)m(C++)f(em)m(b)s(eds)
f(this)f(functionalit)m(y)g(inside)f(the)j(language)g(in)300
2528 y(a)h(w)m(a)m(y)h(that)f(mak)m(es)h(it)f(straigh)m(tforw)m(ard)f
(to)i(utilize)d(the)i(extra)h(functional)d(supp)s(ort)g(on)i(top)g(of)g
(the)300 2715 y(existing)26 b(imp)s(erativ)m(e/ob)5 b(ject-orien)m(ted)
27 b(programming)f(platform)g(that)h(C++)f(pro)m(vides.)38
b(Section)27 b(2.4)300 2903 y(illustrates)43 b(the)j(v)-5
b(alue)45 b(of)g(com)m(bining)f(the)i(paradigms)e(within)f(programs)i
(b)m(y)g(sho)m(wing)f(ho)m(w)i(the)300 3090 y(implemen)m(tations)29
b(of)h(common)h(OO)f(design)f(patterns)h(are)h(impro)m(v)m(ed)f(b)m(y)g
(adding)f(F)m(C++.)300 3367 y Fj(2.3)140 b(Description)47
b(of)i(advanc)-7 b(e)g(d)47 b(libr)-7 b(ary)49 b(fe)-7
b(atur)g(es)300 3613 y Fm(In)24 b(this)g(section)i(w)m(e)f(discuss)f(F)
m(C++)h(features)g(that)h(require)e(more)h(adv)-5 b(anced)25
b(implemen)m(tation)f(strat-)300 3800 y(gies)35 b(in)e(C++:)49
b(lam)m(b)s(da,)35 b(monads,)h(and)e(static)i(analyses.)54
b(W)-8 b(e)36 b(also)f(discuss)e(the)i(subtleties)e(of)i(our)300
3988 y(implemen)m(tation)29 b(of)i(lists.)300 4228 y
Fl(2.3.1)105 b(Lam)m(b)s(da)300 4474 y Fm(Lam)m(b)s(da)43
b(is)g(no)g(stranger)h(to)g(C++.)79 b(There)43 b(are)h(a)g(n)m(um)m(b)s
(er)f(of)g(existing)g(C++)g(libraries)d(whic)m(h)300
4662 y(enable)29 b(clien)m(ts)g(to)i(create)g(new,)e(anon)m(ymous)h
(functions)e(on-the-\015y)-8 b(.)41 b(As)30 b(with)e(F)m(C++,)i
(libraries)d(lik)m(e)300 4849 y(the)k(Bo)s(ost)h(Lam)m(b)s(da)e
(Library[35])h(and)f(F)-10 b(A)m(CT![60)r(])31 b(enable)f(the)h
(creation)h(of)f(arbitrary)e(lam)m(b)s(das)h(b)m(y)300
5036 y(using)f Fi(expr)-5 b(ession)34 b(templates)p Fm(.)p
300 5173 1440 4 v 404 5227 a Ff(4)438 5259 y Fe(That)26
b(is,)h(a)f(p)r(oin)n(ter)f(to)h(a)g(function)g(whic)n(h)g(tak)n(es)g
(as)g(an)f(argumen)n(t)g(a)h(p)r(oin)n(ter)g(to)g(an)f(arbitrary)h
(data)g(structure.)2055 5700 y Fm(35)p eop
%%Page: 36 45
36 44 bop 441 91 a Fm(An)28 b(expression)f(template)h(is)f(a)i(C++)e
(expression)f(whic)m(h)h(ev)-5 b(aluates)29 b(to)g(a)f(function)f
(represen)m(ting)300 279 y(the)37 b(expression,)g(rather)g(than)f(to)i
(a)f(normal)f(v)-5 b(alue.)59 b(This)35 b(is)h(done)g(b)m(y)h(using)e
(sp)s(ecial)g(placeholder)300 466 y(v)-5 b(ariables)26
b(and)i(b)m(y)f(o)m(v)m(erloading)h(C++)f(op)s(erators)h(for)g(those)g
(placeholder)f(datat)m(yp)s(es.)40 b(F)-8 b(or)29 b(example,)300
654 y(in)g(the)i(expression)443 916 y Fk(x)48 b(+)f(3)300
1178 y Fm(if)33 b Fk(x)h Fm(is)f(an)h Fk(int)g Fm(then)g(the)g
(expression)f(clearly)h(ev)-5 b(aluates)34 b(to)h(that)g(v)-5
b(alue)34 b(plus)e(three.)53 b(But)34 b(if)f Fk(x)h Fm(is)g(a)300
1365 y(placeholder)g(v)-5 b(ariable)34 b(from)h(an)h
(expression-template)f(lam)m(b)s(da)f(library)f(\(and)j(the)f
Fk(+)g Fm(op)s(erator)h(has)300 1553 y(b)s(een)26 b(suitably)e(o)m(v)m
(erloaded\),)29 b(then)d(the)g(expression)g(will)d(ev)-5
b(aluate)27 b(to)g(a)g(function)e(with)g(the)i(b)s(eha)m(vior)443
1815 y Fk(lambda\(x\))45 b({)j(x)f(+)h(3)f(})300 2077
y Fm(\(using)25 b(a)h(pseudo-C++)f(notation\).)40 b(Expression)24
b(templates)i(ha)m(v)m(e)h(b)s(een)f(used)f(in)g(a)h(n)m(um)m(b)s(er)f
(of)h(C++)300 2265 y(libraries;)i(reference)j([66)q(])f(is)g(an)g
(excellen)m(t)h(in)m(tro)s(duction)d(to)j(the)g(topic.)450
2505 y Fi(2.3.1.1)94 b(Motivation)300 2751 y Fm(W)-8
b(e)41 b(w)m(ere)e(motiv)-5 b(ated)40 b(to)g(implemen)m(t)e(lam)m(b)s
(da)g(b)m(y)i(our)f(in)m(terest)g(in)f(programming)g(with)g(monads.)300
2938 y(Exp)s(erience)h(with)g(previous)g(v)m(ersions)h(of)h(F)m(C++)f
(made)h(it)f(clear)g(that)h(arbitrary)e(lam)m(b)s(das)h(are)h(a)300
3126 y(practical)34 b(necessit)m(y)h(if)f(one)h(w)m(an)m(ts)g(to)h
(program)e(with)g(monads.)53 b(Older)33 b(v)m(ersions)h(of)h(F)m(C++)f
(had)h(a)300 3313 y(n)m(um)m(b)s(er)d(of)h(useful)e(com)m(binators)i
(whic)m(h)f(made)h(it)f(p)s(ossible)f(to)j(express)e(most)h(arbitrary)f
(functions,)300 3500 y(but)g(lam)m(b)s(da)g(mak)m(es)i(it)e(practical)h
(b)m(y)g(making)f(it)h(readable.)48 b(F)-8 b(or)33 b(example,)h(while)d
(implemen)m(ting)g(a)300 3688 y(monad,)26 b(in)f(the)g(middle)e(of)j
(an)g(expression)e(one)i(migh)m(t)f(disco)m(v)m(er)h(that)g(a)g
(function)e(with)g(this)h(meaning)443 3950 y Fk(lambda\(x\))45
b({)j(f\(g\(x\),h\(x\)\))c(})300 4212 y Fm(is)34 b(needed.)55
b(It)36 b(is)e(p)s(ossible)f(to)j(implemen)m(t)e(this)g(function)g
(using)g(com)m(binators)h(\(without)f(lam)m(b)s(da\),)300
4400 y(but)c(the)g(resulting)f(co)s(de)h(is)g(practically)f
(unreadable:)443 4662 y Fk(duplicate\(compose\(flip\(co)o(mpos)o(e\)\()
o(h\),c)o(ompo)o(se\()o(f,g\))o(\)\))300 4924 y Fm(Alternativ)m(ely)-8
b(,)27 b(one)g(can)f(de\014ne)g(the)g(new)g(functoid)f(at)i(the)g(top)f
(lev)m(el,)h(giv)m(e)g(it)f(a)h(name,)g(and)f(then)g(call)300
5111 y(it:)2055 5700 y(36)p eop
%%Page: 37 46
37 45 bop 443 91 a Fk(struct)46 b(XFoo)h({)586 279 y(template)f(<class)
g(X>)h(struct)f(Sig)h(:)h(public)e(FunType<X,)730 466
y(RT<F<RT<G,X>::ResultTyp)o(e,R)o(T<H,)o(X>::)o(Res)o(ultT)o(ype>)o
(::R)o(esul)o(tTyp)o(e>)41 b({};)586 654 y(template)46
b(<class)g(X>)586 841 y(typename)g(Sig<X>::ResultType)d(operator\(\)\()
h(const)j(X&)g(x)g(\))h(const)e({)730 1028 y(return)g
(f\(g\(x\),h\(x\)\);)586 1216 y(})443 1403 y(};)443 1591
y(typedef)g(Full1<XFoo>)f(Foo;)443 1778 y(Foo)i(foo;)443
1966 y(//)g(later)g(use)g("foo")300 2228 y Fm(but)35
b(clearly)f(this)g(is)h(w)m(a)m(y)h(to)s(o)g(m)m(uc)m(h)f(w)m(ork,)i
(esp)s(ecially)c(when)i(the)g(function)f(in)g(question)g(is)h(a)g(one-)
300 2415 y(time-use)f(\(\\thro)m(w)m(a)m(w)m(a)m(y"\))k(function.)50
b(Lam)m(b)s(da)33 b(is)g(the)h(only)f(reasonable)h(solution)e(when)h(y)
m(ou)h(need)300 2603 y(to)d(de\014ne)f(short,)g(readable,)g(arbitrary)f
(functions)g(on-the-\015y)-8 b(.)450 2843 y Fi(2.3.1.2)94
b(Pr)-5 b(oblematic)34 b(issues)f(with)g(expr)-5 b(ession-template)36
b(lamb)-5 b(da)34 b(libr)-5 b(aries)300 3089 y Fm(Despite)28
b(the)g(adv)-5 b(an)m(tages)29 b(to)f(lam)m(b)s(da,)g(w)m(e)g(ha)m(v)m
(e)g(alw)m(a)m(ys)h(main)m(tained)d(a)i(degree)g(of)g(w)m(ariness)f
(when)f(it)300 3276 y(comes)j(to)g(C++)e(lam)m(b)s(da)f(libraries)f
(\(or)k(an)m(y)f(expression)f(template)h(library\),)f(o)m(wing)h(to)g
(the)h(in)m(trinsic)300 3464 y(limitations)h(and)i(ca)m(v)m(eats)j(of)e
(using)e(expression)g(templates)h(in)g(C++.)45 b(The)32
b(w)m(orrisome)g(issues)f(with)300 3651 y(expression)40
b(template)j(libraries)38 b(in)j(general)g(\(or)i(lam)m(b)s(da)d
(libraries)f(in)h(particular\))h(fall)f(in)m(to)i(four)300
3839 y(ma)5 b(jor)30 b(categories:)436 4101 y Fh(\017)46
b Fl(Acciden)m(tal/early)36 b(ev)-6 b(aluation.)41 b
Fm(The)30 b(biggest)g(problem)f(with)g(expression)g(template)527
4288 y(lam)m(b)s(da)36 b(libraries)e(comes)k(from)e(acciden)m(tal)h(ev)
-5 b(aluation)37 b(of)g(C++)f(expressions.)58 b(Consider)36
b(a)527 4476 y(short)30 b(example)g(using)f(the)i(Bo)s(ost)g(Lam)m(b)s
(da)f(Library:)670 4775 y Fk(int)47 b(a[])g(=)h({)f(5,)g(3,)h(8,)f(4)g
(};)670 4963 y(for_each\()f(a,)h(a+4,)g(cout)f(<<)h(_1)h(<<)f("\\n")f
(\);)527 5262 y Fm(Note)32 b(the)f(third)d(argumen)m(t)j(to)g
Fk(for_each\(\))p Fm(,)d(the)i(expression)2055 5700 y(37)p
eop
%%Page: 38 47
38 46 bop 670 91 a Fk(cout)47 b(<<)g(_1)g(<<)h("\\n")527
391 y Fm(This)30 b(expression)h(creates)i(an)f(anon)m(ymous)g(function)
e(to)j(prin)m(t)e(a)h(v)-5 b(alue.)45 b(The)31 b(placeholder)g
Fk(_1)527 578 y Fm(serv)m(es)g(as)g(a)g(lam)m(b)s(da)e(v)-5
b(ariable;)29 b(th)m(us)h(the)h(expression)e(e\013ectiv)m(ely)i(means)
670 878 y Fk(//)48 b(pseudo-C++)670 1065 y(lambda\(x\))e({)h(return)f
(cout)h(<<)g(x)h(<<)f("\\n";)f(})527 1365 y Fm(As)37
b(a)g(result,)g(the)f Fk(for_each\(\))e Fm(call)i(prin)m(ts)f(eac)m(h)j
(elemen)m(t)f(of)f(the)h(arra)m(y)g(\(one)g(elemen)m(t)g(p)s(er)527
1552 y(line\).)j(The)30 b(output)g(is)f(what)h(w)m(e)h(w)m(ould)e(exp)s
(ect:)670 1852 y Fk(5)670 2039 y(3)670 2227 y(8)670 2414
y(4)527 2713 y Fm(If)k(w)m(e)g(w)m(an)m(t)g(to)h(add)e(some)h(leading)f
(text)h(to)h(eac)m(h)g(line)d(of)i(output,)g(it)f(is)g(tempting)g(to)i
(c)m(hange)527 2901 y(the)d(co)s(de)f(lik)m(e)g(this:)670
3200 y Fk(int)47 b(a[])g(=)h({)f(5,)g(3,)h(8,)f(4)g(};)670
3388 y(for_each\()f(a,)h(a+4,)g(cout)f(<<)h("Value:)f(")i(<<)f(_1)g(<<)
g("\\n")g(\);)527 3687 y Fm(But)34 b(\(surprise!\),)g(the)g(new)f
(program)g(prin)m(ts)g(the)h(added)f(text)h(only)f(once)i(\(rather)f
(than)f(once)527 3875 y(p)s(er)d(line\):)670 4174 y Fk(Value:)47
b(5)670 4362 y(3)670 4549 y(8)670 4737 y(4)527 5036 y
Fm(This)37 b(is)h(b)s(ecause)h(\\)p Fk(cout)47 b(<<)g("Value:)f(")p
Fm(")39 b(is)f(a)h(normal)f(C++)g(expression)f(that)j(the)f(C++)527
5224 y(compiler)22 b(ev)-5 b(aluates)24 b(immediately)-8
b(.)38 b(Only)22 b(expressions)g(in)m(v)m(olving)g(placeholder)g(v)-5
b(ariables)22 b(\(lik)m(e)2055 5700 y(38)p eop
%%Page: 39 48
39 47 bop 527 91 a Fk(_1)p Fm(\))658 58 y Fg(5)728 91
y Fm(get)32 b(\\dela)m(y)m(ed")g(from)e(ev)-5 b(aluation)31
b(b)m(y)f(the)h(expression)f(templates.)42 b(These)30
b(acciden)m(ts)i(are)527 279 y(easy)f(to)g(mak)m(e,)h(and)e(hard)f(to)i
(see)g(at)g(a)g(glance.)436 541 y Fh(\017)46 b Fl(Capture)f(seman)m
(tics)g(\(lam)m(b)s(da-sp)s(eci\014c\).)68 b Fm(Since)39
b(C++)g(is)g(an)g(e\013ect-ful)i(language,)h(it)527 728
y(matters)48 b(whether)e(free)h(v)-5 b(ariables)45 b(captured)i(b)m(y)f
(lam)m(b)s(da)g(are)h(captured)f(b)m(y-v)-5 b(alue)47
b(or)g(b)m(y-)527 916 y(reference.)67 b(The)38 b(library)f(m)m(ust)h(c)
m(ho)s(ose)i(one)f(w)m(a)m(y)h(or)f(the)g(other,)j(or)c(pro)m(vide)g(a)
i(mec)m(hanism)527 1103 y(b)m(y)31 b(whic)m(h)e(users)g(can)i(c)m(ho)s
(ose)g(explicitly)-8 b(.)436 1365 y Fh(\017)46 b Fl(Compiler)24
b(error)g(messages.)37 b Fm(C++)20 b(compilers)g(are)h(notoriously)f(v)
m(erb)s(ose)h(when)g(it)f(comes)i(to)527 1553 y(rep)s(orting)h(errors)i
(in)e(template)i(libraries.)36 b(Things)23 b(are)i(ev)m(en)g(w)m(orse)g
(with)e(expression)h(template)527 1740 y(libraries,)d(b)s(oth)h(b)s
(ecause)g(there)g(tend)g(to)h(b)s(e)e(more)i(lev)m(els)e(of)i(depth)e
(of)h(template)h(instan)m(tiations,)527 1928 y(and)j(b)s(ecause)g(the)g
(expression)f(templates)h(t)m(ypically)f(exp)s(ose)h(clien)m(ts)g(to)h
(some)f(new/unfamiliar)527 2115 y(syn)m(tax,)e(whic)m(h)c(mak)m(es)i
(it)f(more)g(lik)m(ely)e(for)i(clien)m(ts)g(to)h(mak)m(e)g(acciden)m
(tal)f(errors.)37 b(Indecipherable)527 2303 y(error)f(messages)g(ma)m
(y)h(mak)m(e)f(an)g(otherwise)f(useful)f(library)g(b)s(e)h(to)s(o)h
(anno)m(ying)f(for)h(clien)m(ts)f(to)527 2490 y(use.)436
2752 y Fh(\017)46 b Fl(P)m(erformance.)72 b Fm(Expression)39
b(template)i(libraries)d(sometimes)j(tak)m(e)i(orders)d(of)h(magnitude)
527 2940 y(longer)k(to)h(compile)e(than)h(comparably-sized)f(C++)g
(programs)g(without)g(expression)g(tem-)527 3127 y(plates.)66
b(Also,)42 b(the)d(generated)h(binary)d(executables)i(are)h(often)f(m)m
(uc)m(h)g(larger)g(for)f(programs)527 3314 y(with)29
b(expression)g(templates.)300 3577 y(F)-8 b(or)29 b(the)f(most)g(part,)
h(these)f(problems)e(are)j(in)m(trinsic)c(to)k(all)e(expression)g
(template)h(libraries)d(in)i(C++.)300 3764 y(As)k(a)h(result,)f(when)f
(w)m(e)i(set)f(out)h(to)g(design)e(a)i(lam)m(b)s(da)e(library)f(for)i
(F)m(C++,)h(w)m(e)f(k)m(ept)h(in)e(mind)f(these)300 3951
y(issues,)g(and)h(tried)f(to)j(design)d(so)h(as)h(to)g(minimize)d
(their)i(impact.)450 4192 y Fi(2.3.1.3)94 b(Designing)32
b(for)h(the)g(issues)300 4438 y Fm(Here)g(are)f(the)g(design)f
(decisions)g(w)m(e)h(ha)m(v)m(e)i(made)e(to)h(try)f(to)g(minimize)e
(the)i(issues)f(describ)s(ed)f(in)h(the)300 4625 y(previous)e
(subsection.)436 4887 y Fh(\017)46 b Fl(Acciden)m(tal/early)40
b(ev)-6 b(aluation.)52 b Fm(Since)33 b(the)h(problem)e(itself)h(is)g
(in)m(trinsic)f(to)j(the)f(domain,)527 5075 y(the)i(only)f(w)m(a)m(y)i
(to)f(\\attac)m(k")j(this)c(issue)f(is)h(prev)m(en)m(tion.)57
b(While)34 b(it)i(is)f(imp)s(ossible)d(to)k(prev)m(en)m(t)p
300 5211 1440 4 v 404 5265 a Ff(5)438 5297 y Fe(Additionally)-6
b(,)27 b(one)f(can)h(use)g(other)f(sp)r(ecial)i(constructs)f(de\014ned)
e(b)n(y)h(BLL.)h(In)e(the)i(example)e(ab)r(o)n(v)n(e,)i(w)n(e)g(could)g
(get)300 5388 y(the)e(desired)h(b)r(eha)n(vior)g(b)n(y)f(calling)i(the)
e(BLL)h(function)g Fd(constant\(\))i Fe(on)d(the)h(literal)h(string,)f
(to)g(dela)n(y)g(ev)l(aluation.)2055 5700 y Fm(39)p eop
%%Page: 40 49
40 48 bop 527 91 a Fm(users)24 b(from)g(making)f(an)m(y)i(mistak)m(es,)
h(w)m(e)f(ha)m(v)m(e)h(designed)d(our)h(lam)m(b)s(da)f(to)i(mak)m(e)h
(these)f(mistak)m(es)527 279 y(less)32 b(common)h(and/or)f(more)h
(immediately)d(apparen)m(t.)47 b(T)-8 b(o)33 b(this)e(end,)i(w)m(e)g
(ha)m(v)m(e)h(designed)d(the)527 466 y(lam)m(b)s(da)f(syn)m(tax)g(to)i
(b)s(e)d(minimalist)e(and)j(visually)e(distinct:)630
726 y Fl({)45 b(Minimalism.)62 b Fm(Rather)38 b(than)g(o)m(v)m(erload)h
(a)f(large)g(n)m(um)m(b)s(er)f(of)h(op)s(erators)g(and)f(include)727
913 y(a)f(large)f(n)m(um)m(b)s(er)f(of)h(primitiv)m(es,)g(w)m(e)g(ha)m
(v)m(e)i(c)m(hosen)e(a)h(minimalist)c(approac)m(h.)55
b(Th)m(us)34 b(w)m(e)727 1101 y(ha)m(v)m(e)c(only)e(o)m(v)m(erloaded)i
(four)e(op)s(erators)h(for)f(the)h(lam)m(b)s(da)f(language)h(\(arra)m
(y)h(brac)m(k)m(ets)g(for)727 1288 y(p)s(ost\014x)k(function)f
(application,)h(mo)s(dulus)e(for)j(in\014x)d(function)i(application,)g
(comma)h(for)727 1476 y(function)40 b(argumen)m(t)h(lists,)i(and)d
(equalit)m(y)g(for)h(\\let")h(assignmen)m(ts\).)72 b(Similarly)-8
b(,)41 b(apart)727 1663 y(from)i Fk(lambda)p Fm(,)i(the)e(only)f
(primitiv)m(es)f(w)m(e)i(pro)m(vide)f(are)i(those)f(for)g
Fk(let)p Fm(,)j Fk(letrec)p Fm(,)f(and)727 1851 y(if-then-else)37
b(expressions.)61 b(These)38 b(pro)m(vide)e(a)i(minimal)d(core)j(of)g
(expressiv)m(e)g(p)s(o)m(w)m(er)f(for)727 2038 y(lam)m(b)s(da,)22
b(without)d(o)m(v)m(erburdening)h(the)g(user)g(with)f(a)i(wide)f(in)m
(terface.)38 b(A)20 b(narro)m(w)g(in)m(terface)727 2225
y(seems)31 b(more)f(lik)m(ely)f(to)i(b)s(e)f(remem)m(b)s(ered)g(and)g
(th)m(us)g(less)f(error-prone.)630 2444 y Fl({)45 b(Visual)25
b(distinctiv)m(eness.)39 b Fm(Rather)21 b(than)h(trying)e(to)i(mak)m(e)
h(lam)m(b)s(da)d(expressions)g(\\blend)727 2631 y(in")h(with)f(normal)g
(C++)g(co)s(de,)k(w)m(e)e(ha)m(v)m(e)g(done)f(the)h(opp)s(osite.)37
b(W)-8 b(e)22 b(ha)m(v)m(e)h(c)m(hosen)f(op)s(erators)727
2819 y(whic)m(h)32 b(lo)s(ok)g(big)f(and)h(b)s(o)m(xy)h(to)g(mak)m(e)h
(lam)m(b)s(da)d(expressions)g(\\stand)i(out")g(from)f(normal)727
3006 y(C++)i(co)s(de.)52 b(By)35 b(con)m(v)m(en)m(tion,)i(w)m(e)d(name)
h(lam)m(b)s(da)e(v)-5 b(ariables)33 b(with)g(capital)h(letters.)53
b(By)727 3193 y(making)26 b(lam)m(b)s(da)g(expressions)g(visually)e
(distinct)h(from)i(normal)f(C++)g(co)s(de,)i(w)m(e)f(hop)s(e)f(to)727
3381 y(remind)33 b(the)i(user)f(whic)m(h)g(co)s(de)h(is)f(\\lam)m(b)s
(da")g(and)g(whic)m(h)g(co)s(de)h(is)f(\\normal)g(C++",)i(so)727
3568 y(that)f(the)f(user)g(w)m(on't)h(acciden)m(tally)f(mix)f(the)h(t)m
(w)m(o)i(in)c(w)m(a)m(ys)j(whic)m(h)e(create)j(acciden)m(ts)f(of)727
3756 y(early)30 b(ev)-5 b(aluation.)436 4016 y Fh(\017)46
b Fl(Capture)40 b(seman)m(tics)g(\(lam)m(b)s(da-sp)s(eci\014c\).)54
b Fm(The)35 b(F)m(C++)g(library)d(passes)k(argumen)m(ts)f(b)m(y)527
4203 y Fk(const&)26 b Fm(throughout)h(the)h(library)-8
b(.)38 b(E\013ectiv)m(ely)28 b(this)e(is)h(just)g(another)g(\(p)s
(erhaps)g(e\016cien)m(t\))h(w)m(a)m(y)527 4390 y(of)h(sa)m(ying)g(\\b)m
(y)g(v)-5 b(alue".)40 b(As)29 b(a)g(result,)g(F)m(C++)f(lam)m(b)s(das)g
(capture)h(free)g(v)-5 b(ariables)28 b(b)m(y)g(v)-5 b(alue.)40
b(As)527 4578 y(with)29 b(the)i(rest)g(of)f(the)h(F)m(C++)f(library)-8
b(,)29 b(the)i(user)e(can)i(explicitly)d(c)m(ho)s(ose)k(reference)f
(seman)m(tics)527 4765 y(b)m(y)g(capturing)e Fi(p)-5
b(ointers)39 b Fm(to)32 b(ob)5 b(jects,)31 b(rather)f(than)g(capturing)
g(the)g(ob)5 b(jects)31 b(themselv)m(es.)436 5025 y Fh(\017)46
b Fl(Compiler)e(error)h(messages.)66 b Fm(Meta-programming)39
b(can)g(b)s(e)f(used)h(to)g(detect)h(some)g(user)527
5213 y(errors)27 b(and)f(diagnose)h(them)g(\\within)d(the)k(library")d
(b)m(y)h(injecting)g Fi(custom)k(err)-5 b(or)31 b(messages)7
b Fm([50)s(,)527 5400 y(57)q(])36 b(in)m(to)g(the)g(compiler)f(output.)
56 b(Though)35 b(man)m(y)h(kinds)e(of)i(errors)g(cannot)g(b)s(e)f
(caugh)m(t)i(early)2055 5700 y(40)p eop
%%Page: 41 50
41 49 bop 527 91 a Fm(b)m(y)28 b(the)g(library)e(\(lam)m(b)s(das)h(and)
g(functoids)g(can)h(often)g(b)s(e)g(passed)f(around)g(in)g(p)s(oten)m
(tially)f(legal)527 279 y(con)m(texts,)h(but)22 b(then)h(\014nally)e
(used)h(deep)h(within)e(some)i(template)h(in)e(the)h(wrong)g(con)m
(text\),)k(there)527 466 y(are)32 b(a)h(n)m(um)m(b)s(er)d(of)i(common)g
(t)m(yp)s(es)g(of)g(errors)f(that)i(can)f(b)s(e)f(nipp)s(ed)e(in)h(the)
i(bud.)44 b(The)31 b(F)m(C++)527 654 y(lam)m(b)s(da)f(library)f(catc)m
(hes)k(a)e(n)m(um)m(b)s(er)f(of)h(these)g(t)m(yp)s(es)g(of)h(errors)e
(and)h(generates)h(custom)f(error)527 841 y(messages)h(for)e(them.)40
b(Section)31 b(2.3.3)h(discusses)d(this)g(in)g(more)h(detail.)436
1103 y Fh(\017)46 b Fl(P)m(erformance.)67 b Fm(There)38
b(seems)i(to)f(b)s(e)g(little)e(that)j(w)m(e)f(\(as)h(library)d
(authors\))i(can)g(do)g(here.)527 1291 y(As)30 b(expression)f(template)
h(libraries)d(con)m(tin)m(ue)j(to)g(b)s(ecome)g(more)g(p)s(opular,)e(w)
m(e)j(can)f(only)f(hop)s(e)527 1478 y(that)j(compilers)e(will)f(b)s
(ecome)i(more)h(adept)f(at)h(compiling)d(them)j(quic)m(kly)-8
b(.)42 b(In)31 b(the)g(mean)m(time,)527 1665 y(clien)m(ts)38
b(of)h(expression)e(template)i(libraries)c(m)m(ust)j(put)g(up)f(with)g
(longer)h(compile)g(times)g(and)527 1853 y(larger)30
b(executables.)300 2115 y(Th)m(us,)45 b(giv)m(en)e(the)g(in)m(trinsic)d
(problems/limitations)f(of)k(expression)f(template)h(libraries,)g(w)m
(e)h(ha)m(v)m(e)300 2303 y(designed)29 b(our)h(library)e(to)j(try)f(to)
h(minimize)d(those)j(issues)e(whenev)m(er)i(p)s(ossible.)450
2543 y Fi(2.3.1.4)94 b(L)-5 b(amb)g(da)35 b(in)e(F)n(C++)300
2789 y Fm(W)-8 b(e)30 b(no)m(w)f(describ)s(e)e(what)i(it)f(lo)s(oks)g
(lik)m(e)g(to)i(do)e(lam)m(b)s(da)g(in)f(F)m(C++.)40
b(Figure)29 b(6)g(sho)m(ws)f(some)h(examples)300 2976
y(of)i(lam)m(b)s(da.)39 b(There)30 b(are)h(a)g(few)f(p)s(oin)m(ts)f
(that)i(deserv)m(e)g(further)e(atten)m(tion.)441 3164
y(Inside)24 b(lam)m(b)s(da,)h(one)g(uses)g(square)g(brac)m(k)m(ets)i
(instead)d(of)i(round)d(ones)j(for)f(p)s(ost\014x)f(functional)f(call.)
300 3351 y(\(This)29 b(w)m(orks)h(thanks)g(to)h(the)f(lam)m(b)s(da-a)m
(w)m(areness)h(of)f(full)e(functoids,)h(men)m(tioned)h(in)f(Section)h
(2.2.5.\))300 3538 y(Similarly)-8 b(,)24 b(the)j(p)s(ercen)m(t)g(sign)e
(is)h(used)g(instead)g(of)g(the)h(caret)h(for)e(in\014x)f(function)g
(call.)39 b(These)26 b(sym)m(b)s(ols)300 3726 y(mak)m(e)41
b(lam)m(b)s(da)d(co)s(de)i(visually)e(distinct)g(so)i(that)g(the)g(app)
s(earance)g(of)g(normal-lo)s(oking)e(\(and)h(th)m(us)300
3913 y(p)s(oten)m(tially)34 b(erroneous\))h(co)s(de)h(inside)c(a)k(lam)
m(b)s(da)e(will)e(stand)j(out.)56 b(Since)34 b Fk(operator[])e
Fm(tak)m(es)37 b(only)300 4101 y(one)f(argumen)m(t)f(in)f(C++,)i(w)m(e)
g(o)m(v)m(erload)g(the)f(comma)h(op)s(erator)g(to)g(sim)m(ulate)e(m)m
(ultiple)f(argumen)m(ts.)300 4288 y(Occassionally)c(this)g(can)i(cause)
g(an)f(early)g(ev)-5 b(aluation)30 b(problem,)f(as)i(seen)f(in)f(the)i
(co)s(de)f(here:)443 4550 y Fk(//)47 b(assume)f(f)i(takes)e(3)i
(integer)e(arguments)443 4738 y(lambda\(X\)[)f(f[1,2,X])h(])190
b(//)48 b(oops!)e(comma)g(expression)f("1,2,X")h(means)g("2,X")443
4925 y(lambda\(X\)[)f(f[1][2][X])g(])95 b(//)48 b(ok;)e(use)h(currying)
f(to)h(avoid)f(the)h(issue)2055 5700 y Fm(41)p eop
%%Page: 42 51
42 50 bop 443 1220 a Fk(//)47 b(declaring)f(lambda)g(variables)443
1333 y(LambdaVar<1>)f(X;)443 1446 y(LambdaVar<2>)g(Y;)443
1559 y(LambdaVar<3>)g(F;)443 1785 y(//)i(basic)g(examples)443
1897 y(lambda\(X,Y\)[)e(minus[Y,X])g(])333 b(//)48 b(flip\(minus\))443
2010 y(lambda\(X\)[)d(minus[X,3])g(])429 b(//)48 b(minus\(_,3\))443
2236 y(//)f(infix)g(syntax)443 2349 y(lambda\(X,Y\)[)e(negate[)g(3)j
(\045multiplies\045)c(X)k(])f(\045plus\045)f(Y)i(])443
2575 y(//)f(let)443 2688 y(lambda\(X\)[)e(let[)i(Y)g(==)g(X)h
(\045plus\045)e(3,)1207 2801 y(F)h(==)g(minus[2])968
2914 y(].in[)g(F[Y])f(])i(])443 3139 y(//)f(if-then-else)443
3252 y(lambda\(X\)[)e(if0[)i(X)g(\045less\045)f(10,)h(X,)g(10)h(])f(])
95 b(//)47 b(also)g(if1/if2)f(\(see)h(text\))443 3478
y(//)g(letrec)443 3591 y(lambda\(X\)[)e(letrec[)h(F)h(==)h
(lambda\(Y\)[)d(if1[)h(Y)i(\045equal\045)e(0,)2352 3704
y(1,)2352 3817 y(Y)i(\045multiplies\045)c(F[Y\045minus\0451])h(])968
3930 y(].in[)i(F[X])f(])i(])190 b(//)47 b(factorial)1508
4225 y Fl(Figure)35 b(6:)47 b Fm(Lam)m(b)s(da)30 b(in)f(F)m(C++)2055
5700 y(42)p eop
%%Page: 43 52
43 51 bop 300 91 a Fm(Unfortunately)-8 b(,)42 b(C++)d(sees)h(the)g
(expression)f(\\)p Fk(1,2)p Fm(")g(and)h(ev)-5 b(aluates)40
b(it)f(eagerly)i(as)f(a)g(comma)g(ex-)300 279 y(pression)c(on)h(in)m
(tegers.)1121 246 y Fg(6)1223 279 y Fm(F)-8 b(ortunately)g(,)41
b(there)d(is)e(a)i(simple)e(solution:)54 b(since)37 b(all)f(full)f
(functoids)i(are)300 466 y(curry)m(able,)27 b(w)m(e)h(can)f(use)g
(currying)f(to)i(a)m(v)m(oid)g(comma.)40 b(There)27 b(is)f(another)h
(problem,)g(though:)39 b(ho)m(w)27 b(do)300 654 y(w)m(e)34
b(call)e(a)i(zero-argumen)m(t)h(function)d(inside)f(lam)m(b)s(da?)48
b(W)-8 b(e)35 b(found)d(no)h(prett)m(y)h(solution,)f(and)g(ended)300
841 y(up)c(in)m(v)m(en)m(ting)h(this)g(syn)m(tax:)443
1087 y Fk(//)47 b(assume)f(g)i(takes)e(no)h(arguments)f(and)h(returns)e
(an)j(int)443 1274 y(//)f(lambda\(X\)[)e(X)j(\045plus\045)e(g[])h(])143
b(//)47 b(illegal:)e(g[])i(doesn't)f(parse)443 1462 y(lambda\(X\)[)f(X)
j(\045plus\045)e(g[_*_])g(])143 b(//)47 b(_*_)g(means)f("no)h(argument)
f(here")300 1708 y Fm(It's)31 b(b)s(etter)f(to)h(ha)m(v)m(e)h(an)e
(ugly)g(solution)e(than)j(none)f(at)h(all.)441 1895 y(The)j
(if-then-else)g(construct)i(deserv)m(es)f(discussion,)e(as)i(w)m(e)h
(pro)m(vide)d(three)i(v)m(ersions:)49 b Fk(if0)p Fm(,)36
b Fk(if1)p Fm(,)300 2083 y(and)31 b Fk(if2)p Fm(.)45
b Fk(if0)31 b Fm(is)g(the)h(t)m(ypical)g(v)m(ersion,)g(and)g(can)g(b)s
(e)f(used)g(in)g(most)i(instances.)45 b(It)32 b(c)m(hec)m(ks)h(to)g
(mak)m(e)300 2270 y(sure)i(that)i(its)e(second)h(and)g(third)e(argumen)
m(ts)i(\(the)h(\\then")f(branc)m(h)g(and)f(the)h(\\else")h(branc)m(h\))
f(will)300 2457 y(ha)m(v)m(e)44 b(the)f(same)g(t)m(yp)s(e)f(when)g(ev)
-5 b(aluated)43 b(\(and)f(issues)g(a)h(helpful)c(custom)k(error)f
(message)i(if)e(they)300 2645 y(w)m(on't\).)62 b(The)36
b(other)h(t)m(w)m(o)i(\\if)7 b("s)36 b(are)i(used)e(for)h(di\016cult)e
(t)m(yp)s(e-inferencing)g(issues)h(that)h(come)h(from)300
2832 y Fk(letrec)p Fm(.)44 b(In)32 b(the)g(factorial)g(example)g(at)h
(the)f(end)g(of)g(Figure)g(6,)h(for)f(example,)g(the)g(\\else")h(branc)
m(h)f(is)300 3020 y(to)s(o)g(di\016cult)d(for)h(F)m(C++)h(to)h(predict)
e(the)h(t)m(yp)s(e)g(of,)g(o)m(wing)g(to)h(the)f(recursiv)m(e)f(call)g
(to)i Fk(F)p Fm(.)f(This)e(results)300 3207 y(in)k Fk(if0)h
Fm(generating)h(an)f(error.)53 b(Th)m(us)33 b(w)m(e)i(ha)m(v)m(e)h
Fk(if1)d Fm(and)h Fk(if2)g Fm(to)h(deal)f(with)f(situations)g(lik)m(e)h
(these:)300 3395 y Fk(if1)d Fm(w)m(orks)g(lik)m(e)g Fk(if0)p
Fm(,)g(but)g(just)g(assumes)g(the)h(expression's)e(t)m(yp)s(e)i(will)d
(b)s(e)i(the)h(same)g(as)f(the)h(t)m(yp)s(e)g(of)300
3582 y(the)i(\\then")f(part,)i(whereas)e Fk(if2)f Fm(assumes)h(the)h(t)
m(yp)s(e)f(is)f(that)i(of)g(the)f(\\else")h(part.)50
b(In)32 b(the)i(factorial)300 3769 y(example,)c Fk(if1)f
Fm(is)g(used,)g(and)g(th)m(us)g(the)h(\\then")h(branc)m(h)e(\(the)h
Fk(int)f Fm(v)-5 b(alue)29 b Fk(1)p Fm(\))h(is)f(used)g(to)i(predict)d
(that)300 3957 y(the)j(t)m(yp)s(e)f(of)h(the)f(whole)g
Fk(if1)f Fm(expression)g(will)f(b)s(e)i Fk(int)p Fm(.)441
4144 y(Ha)m(ving)j(three)g(di\013eren)m(t)g(\\if)7 b("s)32
b(mak)m(es)i(the)f(lam)m(b)s(da)f(in)m(terface)h(a)h(little)d(more)i
(complicated,)h(but)300 4332 y(the)40 b(alternativ)m(es)h(seemed)f(to)h
(b)s(e)f(either)f(\(1\))i(to)g(disp)s(ose)e(of)h(custom)g(error)g
(messages)h(diagnosing)300 4519 y(if-then-elses)27 b(whose)g(branc)m
(hes)h(had)f(di\013eren)m(t)g(t)m(yp)s(es,)i(or)e(\(2\))i(to)g(write)e
(meta-programs)h(to)h(solv)m(e)f(the)300 4707 y(recursiv)m(e)e(t)m(yp)s
(e)h(equations)f(created)i(b)m(y)e Fk(letrec)f Fm(to)i(\014gure)f(out)h
(its)f(t)m(yp)s(e)h(within)d(the)j(library)-8 b(.)37
b(Option)300 4894 y(\(1\))29 b(is)e(unattractiv)m(e)i(b)s(ecause)f(the)
g(compiler-generated)g(errors)g(from)f(non-parallel)f(if-then-elses)i
(are)300 5081 y(hideous,)h(and)g(option)g(\(2\))i(w)m(ould)e(greatly)h
(complicate)h(the)f(metaprogramming)f(in)g(the)h(library)e(and)p
300 5223 1440 4 v 404 5277 a Ff(6)438 5309 y Fe(Some)34
b(C++)g(compilers,)i(lik)n(e)f(g++,)h(will)g(pro)n(vide)d(a)i(useful)f
(w)n(arning)h(diagnostic)h(\(\\left-hand-side)e(of)h(comma)300
5400 y(expression)26 b(has)g(no)g(e\013ect"\),)g(alerting)h(the)e(user)
h(to)g(the)f(problem.)2055 5700 y Fm(43)p eop
%%Page: 44 53
44 52 bop 300 91 a Fm(slo)m(w)24 b(do)m(wn)g(compile-times)f(ev)m(en)i
(more.)39 b(Th)m(us)23 b(w)m(e)i(think)e(our)h(design)f(c)m(hoice)i(is)
f(justi\014ed.)37 b(Of)24 b(course,)300 279 y(in)i(the)i(v)-5
b(ast)28 b(ma)5 b(jorit)m(y)27 b(of)h(cases,)h Fk(if0)e
Fm(is)f(su\016cien)m(t)h(and)g(this)f(whole)h(issue)f(is)h(mo)s(ot;)i
(only)e(co)s(de)g(whic)m(h)300 466 y(uses)j Fk(letrec)f
Fm(ma)m(y)i(need)f Fk(if1)f Fm(or)i Fk(if2)p Fm(.)450
705 y Fi(2.3.1.5)94 b(Naming)33 b(the)g(C++)f(typ)-5
b(es)34 b(of)f(lamb)-5 b(da)34 b(expr)-5 b(essions)300
951 y Fm(Expression)24 b(templates)h(often)h(yield)e(ob)5
b(jects)26 b(with)f(complex)g(t)m(yp)s(e)g(names,)i(and)e(F)m(C++)g
(lam)m(b)s(das)g(are)300 1138 y(no)30 b(di\013eren)m(t.)40
b(F)-8 b(or)32 b(example,)e(the)g(C++)g(t)m(yp)s(e)g(of)443
1391 y Fk(//)47 b(assume:)94 b(LambdaVar<1>)44 b(X;)95
b(LambdaVar<2>)45 b(Y;)443 1578 y(lambda\(X,Y\)[)g(\(3)i
(\045multiplies\045)d(X\))j(\045plus\045)g(Y)g(])300
1831 y Fm(is)443 2083 y Fk(fcpp::Full2<fcpp::fcpp_la)o(mbda)o(::L)o
(ambd)o(a2<f)o(cpp)o(::fc)o(pp_l)o(amb)o(da::)o(exp:)o(:)443
2271 y(Call<fcpp::fcpp_lambda::e)o(xp::)o(Cal)o(l<fc)o(pp::)o(fcp)o
(p_la)o(mbda)o(::e)o(xp::)o(Valu)o(e<)443 2458 y
(fcpp::Full2<fcpp::impl::X)o(Plus)o(>)42 b(>,fcpp::fcpp_lambda::ex)o
(p::C)o(ONS<)443 2646 y(fcpp::fcpp_lambda::exp::C)o(all<)o(fcp)o(p::f)o
(cpp_)o(lam)o(bda:)o(:exp)o(::C)o(all<)o(fcpp)o(::)443
2833 y(fcpp_lambda::exp::Value<f)o(cpp:)o(:Fu)o(ll2<)o(fcpp)o(::i)o
(mpl:)o(:XMu)o(lti)o(plie)o(s>)g(>,)443 3020 y
(fcpp::fcpp_lambda::exp::C)o(ONS<)o(fcp)o(p::f)o(cpp_)o(lam)o(bda:)o
(:exp)o(::V)o(alue)o(<int)o(>,)443 3208 y(fcpp::fcpp_lambda::exp::N)o
(IL>)f(>,fcpp::fcpp_lambda::exp:)o(:CON)o(S<fc)o(pp)443
3395 y(::fcpp_lambda::exp::Lambd)o(aVar)o(<1>)o(,fcp)o(p::f)o(cpp)o
(_lam)o(bda:)o(:ex)o(p::N)o(IL>)g(>,)443 3583 y
(fcpp::fcpp_lambda::exp::N)o(IL>)g(>,fcpp::fcpp_lambda::exp:)o(:CON)o
(S<fc)o(pp)443 3770 y(::fcpp_lambda::exp::Lambd)o(aVar)o(<2>)o(,fcp)o
(p::f)o(cpp)o(_lam)o(bda:)o(:ex)o(p::N)o(IL>)g(>,1,2>)46
b(>)441 4023 y Fm(In)30 b(the)g(v)-5 b(ast)30 b(ma)5
b(jorit)m(y)31 b(of)f(cases,)h(the)f(user)g(nev)m(er)g(needs)g(to)h
(name)f(the)g(t)m(yp)s(e)h(of)f(a)g(lam)m(b)s(da,)g(since)300
4210 y(usually)38 b(the)j(lam)m(b)s(da)f(is)g(just)g(b)s(eing)f(passed)
h(o\013)h(to)h(another)f(template)g(function.)70 b(Occasionally)-8
b(,)300 4398 y(ho)m(w)m(ev)m(er,)33 b(y)m(ou)e(w)m(an)m(t)h(to)f(store)
h(a)f(lam)m(b)s(da)f(in)g(a)h(temp)s(orary)f(v)-5 b(ariable)30
b(or)h(return)f(it)g(from)h(a)g(function,)300 4585 y(and)38
b(in)g(these)h(cases,)j(y)m(ou'll)c(need)h(to)h(name)f(its)f(t)m(yp)s
(e.)66 b(F)-8 b(or)40 b(those)f(cases,)k(w)m(e)c(ha)m(v)m(e)h(designed)
e(the)300 4773 y Fk(LEType)h Fm(t)m(yp)s(e)i(computer,)i(whic)m(h)c
(pro)m(vides)h(a)g(w)m(a)m(y)i(to)f(name)g(the)f(t)m(yp)s(e)h(of)g(a)g
(lam)m(b)s(da)e(expression)300 4960 y(\(LE\).)31 b(In)f(the)g(example)g
(ab)s(o)m(v)m(e,)i(the)f(t)m(yp)s(e)f(of)443 5213 y Fk(lambda\(X,Y\)[)
45 b(\(3)i(\045multiplies\045)d(X\))j(\045plus\045)g(Y)g(])443
5400 y(//)g(desugared:)e(lambda\(X,Y\)[)g(plus[)h(multiplies[3][X])e
(][Y])i(])2055 5700 y Fm(44)p eop
%%Page: 45 54
45 53 bop 300 91 a Fm(is)443 352 y Fk(LEType<)46 b(LAM<)h(LV<1>,)f
(LV<2>,)443 539 y(CALL<CALL<Plus,CALL<CALL<)o(Mult)o(ipl)o(ies,)o(int>)
o(,LV)o(<1>)41 b(>)48 b(>,LV<2>)e(>)h(>)h(>::Type)441
800 y Fm(The)30 b(general)g(idea)g(is)g(that)443 1060
y Fk(LEType<)46 b(Translated_LambdaExp)c(>::Type)300
1321 y Fm(names)e(the)g(t)m(yp)s(e)g(of)g Fk(LambdaExp)p
Fm(.)66 b(Eac)m(h)41 b(of)e(our)h(primitiv)m(e)d(constructs)j(in)f(lam)
m(b)s(da)f(has)i(a)g(corre-)300 1508 y(sp)s(onding)28
b(translated)i(v)m(ersion)g(understo)s(o)s(d)e(b)m(y)j
Fk(LEType)p Fm(:)443 1769 y Fk(CALL)572 b([])47 b(\(function)e(call\))
443 1956 y(LV)668 b(LambdaVar)443 2144 y(IF0,IF1,IF2)236
b(if0[],if1[],if2[])443 2331 y(LAM)620 b(lambda\(\)[])443
2519 y(LET)g(let[].in[])443 2706 y(LETREC)476 b(letrec[].in[])443
2894 y(BIND)572 b(LambdaVar)45 b(==)i(value)300 3154
y Fm(With)41 b Fk(LEType)p Fm(,)j(the)e(task)g(of)g(naming)f(the)h(t)m
(yp)s(e)g(of)g(a)h(lam)m(b)s(da)d(expression)h(is)g(still)f(onerous,)45
b(but)300 3341 y Fk(LEType)28 b Fm(at)i(least)f(mak)m(es)i(it)e(p)s
(ossible.)38 b(Without)29 b(the)g Fk(LEType)f Fm(t)m(yp)s(e)i
(computer,)f(the)h(t)m(yp)s(e)g(of)f(lam)m(b)s(da)300
3529 y(expressions)42 b(could)h(only)g(b)s(e)g(named)h(b)m(y)f
(examining)g(the)g(library)f(implemen)m(tation,)k(whic)m(h)c(ma)m(y)300
3716 y(c)m(hange)c(from)f(v)m(ersion)g(to)g(v)m(ersion.)61
b Fk(LEType)35 b Fm(guaran)m(tees)k(a)f(consisten)m(t)f(in)m(terface)h
(for)f(naming)f(the)300 3904 y(t)m(yp)s(es)30 b(of)h(lam)m(b)s(da)e
(expressions.)441 4091 y(Finally)-8 b(,)31 b(it)h(should)e(b)s(e)h
(noted)i(that)f(if)f(the)h(lam)m(b)s(da)f(only)h(needs)f(to)i(b)s(e)e
(used)h(monomorphically)-8 b(,)300 4279 y(it)30 b(is)f(far)h(simpler)e
(\(though)j(p)s(oten)m(tially)e(less)h(e\016cien)m(t\))h(to)g(just)f
(use)g(an)g(indirect)f(functoid:)443 4539 y Fk(//)47
b(Can)g(name)g(the)g(monomorphic)e("\(int,int\)->int")e(functoid)i
(type)i(easily:)443 4727 y(Fun2<int,int,int>)c(f)48 b(=)f
(lambda\(X,Y\)[)e(\(3)i(\045multiplies\045)d(X\))j(\045plus\045)g(Y)g
(];)300 4966 y Fl(2.3.2)105 b(Monads)300 5213 y Fm(Monads)34
b(pro)m(vide)g(a)g(useful)f(w)m(a)m(y)i(to)g(structure)f(programs)g(in)
f(a)h(pure)f(functional)g(language.)53 b(Using)300 5400
y(monads,)38 b(it)e(is)f(relativ)m(ely)h(straigh)m(tforw)m(ard)h(to)g
(implemen)m(t)e(things)g(lik)m(e)h(global)g(state,)k(exceptions,)2055
5700 y(45)p eop
%%Page: 46 55
46 54 bop 300 91 a Fm(I/O,)28 b(and)f(other)i(concepts)f(common)h(to)f
(impure)e(languages)j(that)f(are)h(otherwise)e(di\016cult)f(to)j
(imple-)300 279 y(men)m(t)i(in)e(pure)g(functional)g(languages[39)q(,)i
(69)q(].)441 466 y(Supp)s(orting)d(monads)h(in)h(F)m(C++)g(is)f(an)h
(in)m(teresting)g(task)h(for)f(a)h(n)m(um)m(b)s(er)e(of)i(reasons:)436
716 y Fh(\017)46 b Fm(Man)m(y)40 b(in)m(teresting)e(functional)g
(programs)g(and)h(libraries)d(use)i(monads;)43 b(monad)c(supp)s(ort)e
(in)527 903 y(F)m(C++)30 b(mak)m(es)i(it)e(easier)g(to)h(p)s(ort)f
(these)h(libraries)c(to)k(C++.)436 1161 y Fh(\017)46
b Fm(Monads)30 b(in)f(Hask)m(ell)h(tak)m(e)h(adv)-5 b(an)m(tage)32
b(of)e(some)h(of)f(that)g(language's)h(most)f(expressiv)m(ely)f(p)s(o)m
(w-)527 1348 y(erful)g(syn)m(tax)h(and)g(constructs,)g(including)d
Fi(typ)-5 b(e)33 b(classes)p Fm(,)e Fi(do-notation)p
Fm(,)i(and)d Fi(c)-5 b(ompr)g(ehensions)p Fm(.)527 1535
y(Mo)s(delling)42 b(these)i(in)f(C++)f(helps)h(us)g(b)s(etter)g
(understand)f(the)i(relationship)d(b)s(et)m(w)m(een)k(the)527
1723 y(expressiv)m(e)30 b(p)s(o)m(w)m(er)h(of)f(these)h(languages.)436
1980 y Fh(\017)46 b Fm(Monads)23 b(pro)m(vide)e(a)i(w)m(a)m(y)h(to)f
(factor)g(out)g(some)g(cross-cutting)f(concerns,)j(so)d(that)h(lo)s
(cal)f(program)527 2167 y(c)m(hanges)k(can)e(ha)m(v)m(e)i(global)e
(e\013ects.)40 b(\(W)-8 b(e)26 b(discuss)c(a)j(few)f(example)g
(applications)f(that)i(illustrate)527 2355 y(this.\))441
2605 y(In)e(the)h(next)g(subsection,)g(w)m(e)h(giv)m(e)f(a)g(short)g
(in)m(tro)s(duction)d(to)k(monadic)e(programming)f(in)h(Hask)m(ell.)300
2792 y(Next)42 b(w)m(e)g(discuss)d(the)j(relationship)c(b)s(et)m(w)m
(een)k Fi(typ)-5 b(e)44 b(classes)49 b Fm(in)40 b(Hask)m(ell)h(and)g
Fi(c)-5 b(onc)g(epts)50 b Fm(in)40 b(C++;)300 2979 y(understanding)33
b(this)h(relationship)e(facilitates)k(the)f(discussion)e(in)h(the)h
(rest)h(of)f(this)f(section.)56 b(Then)300 3167 y(w)m(e)42
b(discuss)e(ho)m(w)i(w)m(e)g(ha)m(v)m(e)h(implemen)m(ted)e(monads)g(in)
f(F)m(C++.)75 b(Then)41 b(w)m(e)h(sho)m(w)g(some)g(example)300
3354 y(applications)26 b(of)i(monads)f(in)g(C++.)38 b(W)-8
b(e)29 b(\014nish)d(with)g(a)i(short)g(summary)e(of)i(monadic)f
(programming)300 3542 y(in)i(F)m(C++.)450 3780 y Fi(2.3.2.1)94
b(Intr)-5 b(o)g(duction)36 b(to)d(monads)h(in)f(Haskel)5
b(l)300 4026 y Fm(Monads)36 b(ha)m(v)m(e)h(b)s(een)f(p)s(opularized)d
(in)i(part)h(b)m(y)g(their)f(inclusion)e(in)h(the)j(Hask)m(ell)e
(standard)h(library)-8 b(.)300 4213 y(The)25 b(Hask)m(ell)h(language)h
(has)e(a)i(feature)f(called)f(\\t)m(yp)s(e)i(classes")g(whic)m(h)d(pro)
m(vide)h(b)s(ounded)f(parametric)300 4401 y(p)s(olymorphism.)36
b(This)24 b(feature)i(is)g(essen)m(tial)f(to)i(the)g(de\014nition)c(of)
k(monads)e(in)g(Hask)m(ell,)i(so)f(w)m(e)h(review)300
4588 y(it)j(brie\015y)e(to)k(b)s(egin)d(our)g(discussion.)441
4775 y(F)-8 b(ree)32 b(\(un)m(b)s(ound\))c(t)m(yp)s(e)j(v)-5
b(ariables)29 b(can)i(b)s(e)f(b)s(ounded)e(b)m(y)i(\\t)m(yp)s(e)h
(classes".)42 b(F)-8 b(or)31 b(example,)g(a)g(func-)300
4963 y(tion)38 b(to)g(sort)h(a)f(list)f(requires)g(that)h(the)h(t)m(yp)
s(e)f(of)g(elemen)m(ts)h(in)e(the)h(list)f(are)h(comparable)g(with)f
(the)300 5150 y(less-than)30 b(op)s(erator.)41 b(In)29
b(Hask)m(ell)i(w)m(e)f(w)m(ould)g(sa)m(y:)443 5400 y
Fk(sort)47 b(::)g(\(Ord)g(a\))g(=>)g([a])g(->)g([a])2055
5700 y Fm(46)p eop
%%Page: 47 56
47 55 bop 300 91 a Fm(That)35 b(is,)h Fk(sort)e Fm(is)g(a)h(function)f
(whic)m(h)g(tak)m(es)j(a)e(list)f(of)h Fk(a)g Fm(ob)5
b(jects)36 b(and)f(returns)e(a)j(list)e(of)h Fk(a)g Fm(ob)5
b(jects,)300 279 y(sub)g(ject)28 b(to)h(the)f(constrain)m(t)g(that)g
(the)h(t)m(yp)s(e)f Fk(a)f Fm(is)h(a)g(mem)m(b)s(er)f(of)h(the)h
Fk(Ord)e Fm(t)m(yp)s(e)h(class.)40 b(T)m(yp)s(e)27 b(class)h
Fk(Ord)300 466 y Fm(in)h(Hask)m(ell)h(represen)m(ts)h(those)f(t)m(yp)s
(es)h(whic)m(h)e(supp)s(ort)g(ordering)g(op)s(erators)h(lik)m(e)443
728 y Fk(class)47 b(Ord)f(a)i(where)586 916 y(==)95 b(::)47
b(a)h(->)f(a)h(->)f(Bool)586 1103 y(<)143 b(::)47 b(a)h(->)f(a)h(->)f
(Bool)586 1291 y(<=)95 b(::)47 b(a)h(->)f(a)h(->)f(Bool)730
1478 y(--)g(etc.)441 1740 y Fm(W)-8 b(e)33 b(sa)m(y)f(that)g(an)f(en)m
(tit)m(y)i Fk(T)e Fm(is)f(an)i Fi(instanc)-5 b(e)39 b
Fm(of)32 b(t)m(yp)s(e)f(class)g Fk(C)h Fm(when)e Fk(T)h
Fm(supp)s(orts)f(the)h(metho)s(ds)g(in)300 1928 y(the)g(t)m(yp)s(e)f
(class.)41 b(F)-8 b(or)31 b(example,)f(it)g(is)f(true)i(that)443
2190 y Fk(instance)46 b(Ord)h(Int)237 b(--)48 b(Int)f(is)g(an)g
(instance)e(of)j(Ord)300 2452 y Fm(b)s(ecause)30 b(the)h(t)m(yp)s(e)f
Fk(Int)g Fm(supp)s(orts)e(all)i(the)g(metho)s(ds)g(in)f(the)i
Fk(Ord)e Fm(t)m(yp)s(e)i(class.)441 2639 y(A)g Fi(monad)41
b Fm(is)30 b(a)g(t)m(yp)s(e)h(class)f(with)f(t)m(w)m(o)j(op)s
(erations:)443 2902 y Fk(class)47 b(Monad)f(m)h(where)586
3089 y(bind)g(::)g(m)h(a)f(->)g(\()h(a)f(->)g(m)h(b)f(\))h(->)f(m)g(b)
586 3276 y(unit)g(::)g(a)h(->)f(m)g(a)300 3539 y Fm(In)35
b(this)g(case,)k(instances)c(of)i(monads)e(are)i(not)f(t)m(yp)s(es,)i
(but)d(rather)h(they)g(are)g(\\t)m(yp)s(e)h(constructors".)300
3726 y(These)32 b(are)h(lik)m(e)e(template)i(classes)f(in)f(C++;)h(an)g
(example)g(is)f(a)i(list.)45 b(In)31 b(C++)g Fk(std::list)f
Fm(is)h(not)i(a)300 3913 y(t)m(yp)s(e,)g(but)f Fk(std::list<int>)d
Fm(is.)46 b(The)31 b(same)i(holds)e(for)h(Hask)m(ell;)i
Fk([])e Fm(is)f(not)i(a)g(t)m(yp)s(e,)g(but)f Fk([Int])f
Fm(is.)300 4101 y(In)f(the)g(co)s(de)h(describing)d(the)i(monad)g(t)m
(yp)s(e)h(class)f(ab)s(o)m(v)m(e,)i Fk(m)e Fm(is)f(a)i(t)m(yp)s(e)g
(constructor.)441 4288 y(It)g(turns)e(out)h(that)h Fi(lists)39
b Fm(are)31 b(instances)e(of)i(monads:)443 4550 y Fk(instance)93
b(Monad)47 b([])95 b(where)46 b(...)586 4738 y(--)i(bind)e(::)h([a])g
(->)g(\()h(a)f(->)h([b])e(\))i(->)f([b])586 4925 y(--)h(unit)e(::)h(a)h
(->)f([a])300 5187 y Fm(As)31 b(another)g(example,)g(consider)e(the)i
Fk(Maybe)f Fm(t)m(yp)s(e)h(constructor.)42 b(The)30 b(t)m(yp)s(e)h(\\)p
Fk(Maybe)47 b(a)p Fm(")31 b(represen)m(ts)300 5375 y(a)g(v)-5
b(alue)30 b(whic)m(h)f(is)g(either)h(just)g(an)g Fk(a)g
Fm(ob)5 b(ject,)32 b(or)e(else)g(nothing.)40 b(In)29
b(Hask)m(ell)i(w)m(e)f(w)m(ould)g(sa)m(y:)2055 5700 y(47)p
eop
%%Page: 48 57
48 56 bop 443 91 a Fk(data)95 b(Maybe)46 b(a)95 b(=)g(Nothing)46
b(|)i(Just)e(a)443 466 y(--)h(Examples)f(of)h(variables)443
654 y(x)95 b(::)48 b(Maybe)e(Int)443 841 y(x)95 b(=)h(Just)46
b(3)443 1216 y(y)95 b(::)48 b(Maybe)e(Int)443 1403 y(y)95
b(=)h(Nothing)300 1640 y(Maybe)29 b Fm(also)h(forms)g(a)h(monad)f(with)
f(this)g(de\014nition:)443 1877 y Fk(instance)93 b(Monad)47
b(Maybe)94 b(where)634 2065 y(bind)47 b(\(Just)f(x\))h(k)143
b(=)95 b(k)48 b(x)634 2252 y(bind)f(Nothing)93 b(k)143
b(=)95 b(Nothing)634 2440 y(unit)47 b(x)572 b(=)95 b(Just)47
b(x)443 2627 y(--)g(in)h(the)e(Maybe)h(monad)443 2815
y(--)g(bind)g(::)g(Maybe)g(a)g(->)g(\()h(a)f(->)g(Maybe)g(b)g(\))h(->)f
(Maybe)f(b)443 3002 y(--)h(unit)g(::)g(a)h(->)f(Maybe)f(a)300
3239 y Fm(\(W)-8 b(e)36 b(sho)m(w)e(the)h(de\014nitions)d(for)i(the)h
(functions)e Fk(bind)g Fm(and)h Fk(unit)g Fm(so)g(that)h(they)g(ma)m(y)
g(b)s(e)f(compared)300 3426 y(with)29 b(the)i(corresp)s(onding)d(F)m
(C++)i(co)s(de)h(in)e(Section)h(2.3.2.3.\))441 3614 y(A)h(re\014nemen)m
(t)f(of)g(the)h Fk(Monad)e Fm(t)m(yp)s(e)h(class)h(is)e
Fk(MonadWithZero)p Fm(:)443 3851 y Fk(class)47 b(\(Monad)f(m\))h(=>)g
(MonadWithZero)d(m)k(where)586 4038 y(zero)f(::)g(m)h(a)300
4275 y Fm(The)38 b Fk(zero)f Fm(elemen)m(t)i(of)g(a)g(monad)f(is)g(a)h
(v)-5 b(alue)38 b(whic)m(h)f(is)h(in)f(the)i(monad)f(regardless)g(of)g
(what)h(t)m(yp)s(e)300 4463 y(w)m(as)33 b(passed)g(to)h(the)f(monad)g
(t)m(yp)s(e)g(constructor.)49 b(F)-8 b(or)34 b(lists,)e(the)h(empt)m(y)
h(list)d(\()p Fk([])p Fm(\))i(is)f(the)i Fk(zero)p Fm(.)47
b(F)-8 b(or)300 4650 y Fk(Maybe)p Fm(,)32 b(the)h Fk(zero)e
Fm(is)h Fk(Nothing)p Fm(.)45 b(Not)34 b(all)d(monads)h(ha)m(v)m(e)i
(zero)s(es,)g(whic)m(h)d(is)h(wh)m(y)g Fk(MonadWithZero)d
Fm(is)300 4838 y(a)i(separate)g(t)m(yp)s(e)g(class.)441
5025 y(Monads)d(with)f(zero)s(es)i(can)g(b)s(e)e(used)h(in)f
Fi(c)-5 b(ompr)g(ehensions)39 b Fm(with)27 b Fi(guar)-5
b(ds)p Fm(.)41 b(Comprehensions)26 b(are)j(a)300 5213
y(sp)s(ecial)d(notation)h(for)g(expressing)f(computations)h(in)f(a)i
(monad.)39 b(Hask)m(ell)27 b(supp)s(orts)f(comprehensions)300
5400 y(for)k(the)h(list)e(monad;)h(an)g(example)g(is)2055
5700 y(48)p eop
%%Page: 49 58
49 57 bop 443 91 a Fk([)48 b(x+y)f(|)g(x)g(<-)h([1,2,3],)d(y)j(<-)f
([2,3],)f(x<y)h(])443 279 y(--)g(results)f(in)h([3,4,5])300
531 y Fm(This)29 b(list)h(comprehension)g(could)g(b)s(e)h(in)m
(terpreted)f(as)i(\\the)f(list)f(of)i(v)-5 b(alues)30
b(x)h(plus)e(y)-8 b(,)32 b(for)f(all)f(x)h(and)g(y)300
719 y(where)g(x)h(is)f(selected)h(from)f(the)h(list)f([1,2,3])j(and)d
(y)h(is)f(selected)h(from)f(the)h(list)f([2,3],)j(and)d(where)g(x)h(is)
300 906 y(less)e(than)g(y".)41 b(The)30 b(desugared)g(v)m(ersion)g(of)g
(the)h(Hask)m(ell)f(co)s(de)g(is:)443 1159 y Fk([1,2,3])46
b(`bind`)g(\(\\x)h(->)586 1346 y([2,3])142 b(`bind`)46
b(\(\\y)h(->)730 1534 y(if)g(not)g(\(x<y\))f(then)h(zero)1350
1721 y(else)g(unit)f(\(x+y\))h(\)\))300 1974 y Fm(The)e(translation)f
(from)g(the)h(comprehension)f(notation)h(to)h(the)f(desugared)g(co)s
(de)g(is)g(straigh)m(tfor-)300 2161 y(w)m(ard.)62 b(Starting)36
b(from)h(the)h(v)m(ertical)f(bar)g(and)g(going)h(to)g(the)g(righ)m(t,)h
(the)e(expressions)f(of)i(the)f(form)300 2349 y(\\)p
Fk(var)47 b(<-)h(exp)p Fm(")36 b(turn)g(in)m(to)h(calls)g(to)h
Fk(bind)e Fm(and)g(lam)m(b)s(das,)i(and)f(guards)f(\(b)s(o)s(olean)h
(conditions\))f(are)300 2536 y(transformed)26 b(in)m(to)h(if-then-else)
f(expressions)f(whic)m(h)h(return)g(the)h(monad)f Fk(zero)g
Fm(if)g(the)h(condition)e(fails)300 2723 y(to)34 b(hold.)47
b(After)33 b(all)f(expressions)g(to)i(the)f(righ)m(t)f(of)h(the)h(v)m
(ertical)f(bar)f(ha)m(v)m(e)i(b)s(een)f(pro)s(cessed,)g(the)g(ex-)300
2911 y(pression)26 b(to)j(the)f(left)g(of)g(the)g(v)m(ertical)h(bar)e
(gets)i Fk(unit)e Fm(called)g(on)h(it)f(to)i(lift)e(the)h(\014nal)f
(computed)g(v)-5 b(alue)300 3098 y(bac)m(k)31 b(in)m(to)f(the)h(monad.)
450 3337 y Fi(2.3.2.2)94 b(Haskel)5 b(l's)33 b(typ)-5
b(e)33 b(classes)h(and)f(C++)f(template)i(c)-5 b(onc)g(epts)300
3583 y Fm(In)38 b(the)g(C++)f(literature,)j(w)m(e)f(sometimes)f(sp)s
(eak)g(of)g(template)h Fi(c)-5 b(onc)g(epts)p Fm(.)66
b(A)38 b(concept)i(in)d(C++)g(is)300 3770 y(a)j(set)g(of)f(constrain)m
(ts)g(that)h(a)g(t)m(yp)s(e)g(is)e(required)g(to)i(meet)g(in)e(order)h
(to)h(b)s(e)e(used)h(to)h(instan)m(tiate)g(a)300 3958
y(template.)g(F)-8 b(or)26 b(example,)g(in)f(the)g(implemen)m(tation)f
(of)i(the)g(template)g(function)e Fk(std::find\(\))p
Fm(,)g(there)300 4145 y(will)k(undoubtedly)f(b)s(e)j(some)h(co)s(de)g
(along)f(the)h(lines)d(of)443 4398 y Fk(...)47 b(if\()g(cur_element)e
(==)i(target)f(\))h(...)300 4650 y Fm(whic)m(h)c(compares)i(t)m(w)m(o)h
(elemen)m(ts)e(for)h(equalit)m(y)f(using)f(the)h(equalit)m(y)g(op)s
(erator.)83 b(Th)m(us,)47 b(in)c(order)300 4838 y(to)c(call)f
Fk(std::find\(\))e Fm(to)j(\014nd)e(a)i(particular)d(v)-5
b(alue)38 b(in)g(a)h(con)m(tainer,)i(the)d(elemen)m(t)h(t)m(yp)s(e)g(m)
m(ust)g(b)s(e)300 5025 y(an)44 b Fk(EqualityComparable)38
b Fm(t)m(yp)s(e|that)45 b(is,)h(it)d(m)m(ust)h(supp)s(ort)e(the)i
(equalit)m(y)f(op)s(erator)h(with)f(the)300 5213 y(righ)m(t)35
b(seman)m(tics.)55 b(W)-8 b(e)36 b(call)e Fk(EqualityComparable)c
Fm(a)36 b Fi(c)-5 b(onc)g(ept)p Fm(,)37 b(and)e(w)m(e)g(sa)m(y)h(that)g
(t)m(yp)s(es)f(\(suc)m(h)g(as)300 5400 y Fk(int)p Fm(\))e(whic)m(h)f
(meet)j(the)f(constrain)m(ts)f Fi(mo)-5 b(del)45 b Fm(the)34
b(concept.)51 b(Concepts)34 b(exist)f(only)g(implicitly)c(in)k(the)2055
5700 y(49)p eop
%%Page: 50 59
50 58 bop 300 91 a Fm(C++)41 b(co)s(de)i(\(e.g.)78 b(o)m(wing)43
b(to)g(the)f(call)g(to)h Fk(operator==\(\))c Fm(in)i(the)i(implemen)m
(tation\),)i(and)d(often)300 279 y(exist)29 b(explicitly)f(in)g(do)s
(cumen)m(tation)i(of)g(the)f(library)-8 b(.)39 b(Some)30
b(C++)e(libraries[50)o(,)i(57)q(])f(are)h(dev)m(oted)h(to)300
466 y(\\concept)25 b(c)m(hec)m(king";)j(these)c(libraries)d(c)m(hec)m
(k)k(to)g(see)f(that)g(the)g(t)m(yp)s(es)g(used)f(to)h(instan)m(tiate)g
(a)h(template)300 654 y(do)30 b(indeed)f(mo)s(del)g(the)i(required)d
(concepts)k(\(and)e(issue)f(a)i(useful)d(error)i(message)i(if)d(not\).)
441 841 y(Hask)m(ell)24 b(t)m(yp)s(e)g(classes)g(are)g(analogous)g(to)h
(C++)e(concepts.)39 b(Ho)m(w)m(ev)m(er)26 b(in)d(Hask)m(ell)h(t)m(yp)s
(e)g(classes)g(are)300 1028 y(rei\014ed;)31 b(there)h(are)g(language)g
(constructs)f(to)i(de\014ne)e(t)m(yp)s(e)g(classes)h(and)f(to)h
(declare)g(whic)m(h)e(t)m(yp)s(es)i(are)300 1216 y(instances)d(of)h
(those)h(t)m(yp)s(e)f(classes.)40 b(In)29 b(C++,)h(when)e(a)j(certain)e
(t)m(yp)s(e)h(mo)s(dels)f(a)h(certain)g(concept)h(\(b)m(y)300
1403 y(meeting)37 b(all)g(of)g(the)h(appropriate)e(constrain)m(ts\),)k
(it)c(is)h(merely)f(happ)s(enstance)h(\(structural)f(confor-)300
1591 y(mance\);)28 b(in)c(Hask)m(ell,)j(ho)m(w)m(ev)m(er,)h(in)c
(addition)g(to)i(meeting)g(the)f(constrain)m(ts)h(of)f(a)h(t)m(yp)s(e)g
(class)f(in)m(terface,)300 1778 y(a)39 b(t)m(yp)s(e)h(m)m(ust)f(b)s(e)f
(declared)h(to)g(b)s(e)g(an)g(instance)f(of)i(the)f(concept)h(\(named)f
(conformance\).)68 b(\\Con-)300 1966 y(cept)33 b(c)m(hec)m(king")h(in)d
(Hask)m(ell)h(is)g(built)e(in)m(to)j(the)g(language:)45
b(t)m(yp)s(e)33 b(classes)f(de\014ne)g(concepts,)i(instance)300
2153 y(declarations)40 b(sa)m(y)i(whic)m(h)e(t)m(yp)s(es)h(mo)s(del)f
(whic)m(h)f(concepts,)45 b(and)40 b(t)m(yp)s(e)i(b)s(ounds)c(mak)m(e)k
(explicit)e(the)300 2340 y(constrain)m(ts)28 b(on)g(an)m(y)h
(particular)d(p)s(olymorphic)f(function.)39 b(\(F)-8
b(or)29 b(more)g(on)f(the)g(relationship)d(b)s(et)m(w)m(een)300
2528 y(C++)k(concepts)j(and)d(Hask)m(ell)h(t)m(yp)s(e)h(classes,)g(see)
g([24)q(].\))441 2715 y(Understanding)22 b(this)g(analogy)i(will)d(mak)
m(e)j(the)g(F)m(C++)f(implemen)m(tation)g(of)g(monads)g(more)h(trans-)
300 2903 y(paren)m(t.)62 b(As)37 b(w)m(e)h(shall)e(see,)k(in)c(the)h(F)
m(C++)h(library)-8 b(,)37 b(w)m(e)h(sp)s(ell)d(out)j(the)f(concept)i
(requiremen)m(ts)d(on)300 3090 y(monads,)e(in)e(order)h(to)h(mak)m(e)h
(it)e(easier)g(for)g(clien)m(ts)g(who)g(write)g(monads)g(to)h(ensure)f
(that)h(they)g(ha)m(v)m(e)300 3278 y(pro)m(vided)29 b(all)g(of)i(the)f
(necessary)h(functionalit)m(y)e(in)g(the)i(templates.)450
3518 y Fi(2.3.2.3)94 b(Comp)-5 b(aring)35 b(monads)g(in)d(F)n(C++)g(to)
h(those)h(in)f(Haskel)5 b(l)300 3764 y Fm(Let)23 b(us)e(no)m(w)h
(illustrate)f(monad)g(de\014nitions)f(in)h(F)m(C++.)38
b(As)22 b(a)g(\014rst)g(example,)h(w)m(e)g(shall)d(lo)s(ok)i(at)h
Fk(Maybe)p Fm(.)300 3951 y(The)j Fk(Maybe)g Fm(template)h(class)f(and)h
(its)f(asso)s(ciated)h(en)m(tities)g(are)g(de\014ned)e(in)h(Figure)g
(7.)40 b Fk(NOTHING)25 b Fm(is)h(the)300 4139 y(constan)m(t)j(whic)m(h)
d(represen)m(ts)h(an)h(\\empt)m(y")h Fk(Maybe)p Fm(,)e(and)g
Fk(just\(\))e Fm(is)i(a)h(functoid)e(whic)m(h)g(turns)h(a)g(v)-5
b(alue)300 4326 y(of)34 b(t)m(yp)s(e)g Fk(T)g Fm(in)m(to)g(a)h(\\full")
d Fk(Maybe<T>)p Fm(.)50 b(\()p Fk(Maybe)33 b Fm(is)g(implemen)m(ted)f
(using)h(a)h Fk(List)f Fm(whic)m(h)g(holds)f(either)300
4514 y(one)f(or)f(zero)h(elemen)m(ts.\))441 4701 y(Next)j(w)m(e)g
(consider)e(ho)m(w)h(to)h(mak)m(e)g Fk(Maybe)e Fm(a)h(monad.)49
b(Figure)33 b(8)g(describ)s(es)f(the)h(general)g(monad)300
4888 y(concepts)27 b(as)f(sp)s(eci\014ed)f(in)g(the)h(F)m(C++)g(do)s
(cumen)m(tation.)40 b(A)26 b(monad)g(class)g(m)m(ust)g(de\014ne)f(the)i
(metho)s(ds)300 5076 y Fk(unit)h Fm(and)g Fk(bind)g Fm(\(with)g(the)h
(appropriate)e(signatures\);)j(a)f(class)g(represen)m(ting)f(a)h(monad)
f(with)g(a)h(zero)300 5263 y(m)m(ust)h(meet)h(the)g(ab)s(o)m(v)m(e)h
(requiremen)m(ts)d(as)i(w)m(ell)e(as)i(de\014ning)d(a)j
Fk(zero)e Fm(elemen)m(t.)2055 5700 y(50)p eop
%%Page: 51 60
51 59 bop 443 1049 a Fk(struct)46 b(AUniqueTypeForNothing)c({};)443
1162 y(AUniqueTypeForNothing)g(NOTHING;)443 1388 y(template)k(<class)g
(T>)443 1501 y(class)h(Maybe)f({)586 1614 y(List<T>)g(rep;)443
1727 y(public:)586 1840 y(typedef)g(T)i(ElementType;)586
2066 y(Maybe\()e(AUniqueTypeForNothing)c(\))48 b({})586
2179 y(Maybe\(\))e({})1670 b(//)47 b(Nothing)f(constructor)586
2291 y(Maybe\()g(const)h(T&)g(x)g(\))h(:)f(rep\()g(cons\(x,NIL\))e(\))i
({})95 b(//)47 b(Just)g(constructor)586 2517 y(bool)g(is_nothing\(\))d
(const)j({)g(return)f(null\(rep\);)f(})586 2630 y(T)j(value\(\))e
(const)g({)h(return)g(head\(rep\);)e(})443 2743 y(};)443
2969 y(struct)h(XJust)h({)586 3082 y(template)f(<class)g(T>)h(struct)f
(Sig)h(:)h(public)e(FunType<T,Maybe<T>)d(>)k({};)586
3308 y(template)f(<class)g(T>)586 3421 y(typename)g(Sig<T>::ResultType)
586 3533 y(operator\(\)\()f(const)h(T&)i(x)f(\))h(const)e({)730
3646 y(return)g(Maybe<T>\()f(x)i(\);)586 3759 y(})443
3872 y(};)443 3985 y(typedef)f(Full1<XJust>)e(Just;)443
4098 y(Just)j(just;)1267 4394 y Fl(Figure)35 b(7:)47
b Fm(The)30 b Fk(Maybe)f Fm(datat)m(yp)s(e)i(in)e(F)m(C++)2055
5700 y(51)p eop
%%Page: 52 61
52 60 bop 300 219 a Fk(/*)443 332 y(concept)46 b(Monad)g({)586
445 y(//)i(full)e(functoid)g(with)g(Sig)143 b(unit)46
b(::)i(a)f(->)g(m)h(a)586 558 y(typedef)e(Unit;)586 671
y(static)g(Unit)h(unit;)586 784 y(//)h(full)e(functoid)g(with)g(Sig)143
b(bind)46 b(::)i(m)f(a)g(->)h(\()f(a)h(->)f(m)g(b)h(\))f(->)g(m)h(b)586
897 y(typedef)e(Bind;)586 1009 y(static)g(Bind)h(bind;)443
1122 y(})443 1235 y(concept)f(MonadWithZero)e(models)i(Monad)h({)586
1348 y(//)h(zero)e(::)h(m)h(a)586 1461 y(typedef)e(Zero;)524
b(//)47 b(a)g(value)g(type)586 1574 y(static)f(Zero)h(zero;)443
1687 y(})300 1800 y(*/)649 2095 y Fl(Figure)35 b(8:)47
b Fm(Do)s(cumen)m(tation)31 b(of)g(the)f(monad)g(concept)h(requiremen)m
(ts)f(in)f(F)m(C++)443 2555 y Fk(struct)46 b(MaybeM)g({)586
2668 y(typedef)g(Just)h(Unit;)586 2780 y(static)f(Unit)h(unit;)586
3006 y(struct)f(XBind)h({)730 3119 y(template)e(<class)h(M,)h(class)g
(K>)g(struct)f(Sig)h(:)g(public)f(FunType<M,K,)873 3232
y(RT<K,M::ElementType>::R)o(esul)o(tTyp)o(e>)41 b({};)730
3345 y(template)k(<class)h(M,)h(class)g(K>)730 3458 y(typename)e
(Sig<M,K>::ResultType)730 3571 y(operator\(\)\()f(const)j(M&)g(m,)g
(const)f(K&)i(k)f(\))g(const)g({)873 3684 y(if\()g(m.is_nothing\(\))d
(\))1016 3797 y(return)i(NOTHING;)873 3910 y(else)1016
4022 y(return)g(k\()h(m.value\(\))e(\);)730 4135 y(})586
4248 y(};)586 4361 y(typedef)h(Full2<XBind>)f(Bind;)586
4474 y(static)h(Bind)h(bind;)586 4700 y(typedef)f
(AUniqueTypeForNothing)c(Zero;)586 4813 y(static)k(Zero)h(zero;)443
4926 y(};)1067 5221 y Fl(Figure)35 b(9:)47 b Fm(De\014nition)29
b(of)h(the)h Fk(Maybe)e Fm(monad)h(\()p Fk(MaybeM)p Fm(\))2055
5700 y(52)p eop
%%Page: 53 62
53 61 bop 441 91 a Fm(Figure)35 b(9)h(sho)m(ws)f(ho)m(w)g(w)m(e)h
(de\014ne)f(the)g Fk(Maybe)f Fm(monad)h(in)f(F)m(C++.)56
b(Nested)36 b(in)e Fk(struct)g(MaybeM)300 279 y Fm(w)m(e)29
b(de\014ne)e Fk(unit)p Fm(,)h Fk(bind)p Fm(,)g(and)g
Fk(zero)p Fm(,)g(as)g(w)m(ell)f(as)i Fk(typedef)p Fm(s)d(for)i(their)g
(t)m(yp)s(es.)40 b(This)26 b(F)m(C++)i(de\014nition)300
466 y(e\013ectiv)m(ely)j(corresp)s(onds)e(to)i(the)g(de\014nitions)443
708 y Fk(instance)46 b(Monad)g(Maybe)g(--)i(...)443 895
y(instance)e(MonadWithZero)e(Maybe)i(--)h(...)300 1137
y Fm(in)29 b(Hask)m(ell.)441 1325 y(It)36 b(should)e(b)s(e)h(noted)h
(here)f(that)h(the)g(one)g(ma)5 b(jor)36 b(di\013erence)f(b)s(et)m(w)m
(een)h(monads)g(in)e(F)m(C++)i(and)300 1512 y(monads)f(in)f(Hask)m(ell)
h(is)g(that,)i(in)d(F)m(C++,)j(there)f(is)e(a)i(distinction)d(b)s(et)m
(w)m(een)j(the)g(monad)f(t)m(yp)s(e)g(con-)300 1700 y(structor)27
b(\(e.g.)41 b Fk(Maybe)p Fm(\))26 b(and)g(the)h(monad)g(itself)e
(\(e.g.)41 b Fk(MaybeM)p Fm(\).)26 b(W)-8 b(e)28 b(c)m(hose)g(to)g(mak)
m(e)g(this)d(distinction)300 1887 y(for)30 b(reasons)h(discussed)d
(next.)441 2075 y(One)36 b(adv)-5 b(an)m(tage)38 b(to)e(separating)g
(the)g(t)m(yp)s(e)g(constructor)h(\()p Fk(Maybe)p Fm(\))e(from)h(the)g
(monad)f(de\014nition)300 2262 y(\()p Fk(MaybeM)p Fm(\))d(is)f(that,)k
(since)d(the)g(monad)h(de\014nition)d(is)i(itself)f(a)i(data)h(t)m(yp)s
(e,)g(it)e(can)h(b)s(e)f(used)g(as)h(a)g(t)m(yp)s(e)300
2449 y(parameter)g(to)f(template)h(functions.)44 b(As)32
b(a)h(result,)f(rather)g(than)f(supp)s(orting)f(just)h(list)g
(comprehen-)300 2637 y(sions)h(\(lik)m(e)g(Hask)m(ell)h(do)s(es\),)h
(in)d(F)m(C++)i(w)m(e)g(supp)s(ort)e Fi(c)-5 b(ompr)g(ehensions)38
b(in)d(an)g(arbitr)-5 b(ary)38 b(monad)p Fm(,)d(b)m(y)300
2824 y(passing)22 b(the)i(monad)g(as)f(a)h(template)h(parameter)f(to)g
(the)g(comprehension.)37 b(F)-8 b(or)24 b(example,)h(the)f(Hask)m(ell)
300 3012 y(list)29 b(comprehension)443 3254 y Fk([)48
b(x+y)f(|)g(x)g(<-)h([1,2,3],)d(y)j(<-)f([2,3],)f(x<y)h(])300
3495 y Fm(is)29 b(written)h(in)f(F)m(C++)h(as)443 3737
y Fk(compM<ListM>\(\)[)44 b(X)j(\045plus\045)f(Y)i(|)586
3925 y(X)g(<=)f(list_with\(1,2,3\),)c(Y)48 b(<=)f(list_with\(2,3\),)c
(guard[)j(X)i(\045less\045)e(Y)h(])h(])300 4167 y Fm(Note)33
b(ho)m(w)f Fk(ListM)f Fm(is)g(passed)g(as)h(an)g(explicit)e(template)i
(parameter)h(to)f(the)h Fk(compM)d Fm(function,)h(whic)m(h)300
4354 y(returns)e(a)i(comprehension)e(for)h(that)h(monad.)40
b(As)31 b(a)f(result,)g(w)m(e)h(can)f(write)443 4596
y Fk(compM<MaybeM>\(\)[)44 b(X)j(\045plus\045)f(Y)i(|)f(X)g(<=)h
(just\(2\),)d(Y)j(<=)f(just\(3\))f(])300 4838 y Fm(and)23
b(p)s(erform)e(a)j(comprehension)e(in)g(the)h Fk(Maybe)f
Fm(monad.)38 b(Ha)m(ving)23 b(a)h(name)f(apart)h(from)e(the)i(data)g(t)
m(yp)s(e)300 5025 y(constructor)34 b(to)h(serv)m(e)f(as)g(a)h(handle)d
(for)i(the)g(monad)f(de\014nition)f(\(e.g.)52 b Fk(ListM)p
Fm(,)33 b Fk(MaybeM)p Fm(\))f(giv)m(es)i(us)g(a)300 5213
y(con)m(v)m(enien)m(t)24 b(w)m(a)m(y)h(to)f(parameterize)f(monad)g(op)s
(erations.)38 b(\(The)23 b(idea)g(of)g(generalizing)f(comprehension)300
5400 y(syn)m(tax)31 b(to)g(arbitrary)e(monads)h(w)m(as)h(originally)c
(discussed)i(b)m(y)h(W)-8 b(adler[70)q(].\))2055 5700
y(53)p eop
%%Page: 54 63
54 62 bop 441 91 a Fm(There)20 b(is)f(another)i(adv)-5
b(an)m(tage)22 b(to)f(separating)g(the)f(t)m(yp)s(e)h(constructor)g
(from)e(the)i(monad)f(de\014nition.)300 279 y(Hask)m(ell)j(t)m(yp)s(e)g
(classes)g(require)f(algebraic)h(data)g(t)m(yp)s(e)g(constructors)h
(\(not)f(t)m(yp)s(e)h(aliases\))e(to)i(w)m(ork.)39 b(As)23
b(a)300 466 y(result,)k(w)m(e)h(cannot)g(express)f(the)h(iden)m(tit)m
(y)f(monad)g(\(a)h(monad)f(where)g Fk(m)47 b(a)h(=)f(a)p
Fm(\))28 b(directly)e(in)g(Hask)m(ell.)300 654 y(Instead)43
b(w)m(e)h(ha)m(v)m(e)h(to)f(fak)m(e)h(it)e(b)m(y)g(de\014ning)f(a)h
(new)g(data)i(t)m(yp)s(e)e(\(whic)m(h)g(w)m(e)h(ha)m(v)m(e)g(c)m(hosen)
g(to)h(call)300 841 y Fk(Identity)p Fm(\):)443 1103 y
Fk(data)i(Identity)e(a)j(=)f(Ident)g(a)443 1478 y(instance)f(Monad)g
(Identity)g(where)189 b(--)95 b(m)48 b(a)f(=)g(Identity)f(a)586
1665 y(unit)h(x)525 b(=)47 b(Ident)g(x)586 1853 y(bind)g(\(Ident)f(m\))
h(k)h(=)f(k)h(m)300 2115 y Fm(where)30 b(v)-5 b(alues)30
b(of)h(t)m(yp)s(e)g Fk(a)g Fm(are)g(wrapp)s(ed/un)m(wrapp)s(ed)c(with)j
(the)h(v)-5 b(alue)30 b(constructor)h Fk(Ident)e Fm(to)j(mak)m(e)300
2303 y(them)42 b(mem)m(b)s(ers)f(of)h(the)h(t)m(yp)s(e)f
Fk(Identity)k(a)p Fm(.)75 b(In)41 b(F)m(C++,)k(ho)m(w)m(ev)m(er,)i(w)m
(e)42 b(can)h(de\014ne)e(the)h(monad)300 2490 y(without)29
b(also)i(ha)m(ving)f(to)h(de\014ne)e(a)i(new)f(data)h(t)m(yp)s(e)f(to)h
(represen)m(t)g(iden)m(tities,)e(as)i(seen)f(in)f(Figure)h(10.)300
2677 y(The)c(reason)i(for)e(the)h(distinction)e(is)h(p)s(erhaps)f(ob)m
(vious.)39 b(Hask)m(ell)27 b(uses)f(t)m(yp)s(e)h(inference,)g(whic)m(h)
f(means)300 2865 y(it)40 b(m)m(ust)h(unam)m(biguously)e(b)s(e)h(able)g
(to)i(\014gure)e(out)i(whic)m(h)d(monad)i(a)g(particular)e(data)j(t)m
(yp)s(e)f(is)f(in.)300 3052 y(This)30 b(t)m(yp)s(e)i(inference)f(is)g
(not)h(p)s(ossible)e(unless)g(there)i(is)f(a)h(one-to-one)i(mapping)d
(b)s(et)m(w)m(een)h(algebraic)300 3240 y(datat)m(yp)s(e)24
b(constructors)f(and)f(monads.)38 b(In)22 b(F)m(C++,)i(on)f(the)g
(other)g(hand,)g(the)h(user)e(passes)g(the)h(monad)300
3427 y(explicitly)30 b(as)k(a)f(template)g(parameter)h(to)f(constructs)
h(lik)m(e)e Fk(compM)p Fm(.)g(By)h(requiring)d(the)j(user)g(to)g(b)s(e)
g(a)300 3615 y(little)c(more)h(explicit)f(ab)s(out)h(the)g(t)m(yp)s
(es,)g(w)m(e)h(gain)f(a)g(bit)g(of)g(expressiv)m(e)g(freedom)g(\(e.g.)
42 b(b)s(eing)28 b(able)i(to)300 3802 y(do)g(comprehensions)f(in)g
(arbitrary)g(monads\).)450 4042 y Fi(2.3.2.4)94 b(Monads)34
b(in)f(F)n(C++)300 4288 y Fm(Whereas)40 b(the)f(previous)f(subsection)g
(in)m(tro)s(duced)g(F)m(C++)h(monads,)i(here)e(the)g(details)f(are)i
(\015eshed)300 4476 y(out.)f(F)m(C++)23 b(pro)m(vides)g(functoids)f
(for)h(the)h(main)f(monad)g(op)s(erations.)38 b(Sp)s(eci\014cally)-8
b(,)23 b(for)g(eac)m(h)i(monad,)300 4663 y(F)m(C++)30
b(supp)s(orts)f(these)h(functions:)443 4925 y Fk(unitM<SomeMonad>\(\))
282 b(bindM<SomeMonad>\(\))300 5187 y Fm(whic)m(h)39
b(just)g(forw)m(ard)g(the)i(call)e(to)h(the)h(corresp)s(onding)c
(\(user-de\014ned\))i(function)g(for)h(that)g(monad)300
5375 y(\(e.g.)i Fk(MaybeM::unit)p Fm(\).)c(F)m(C++)30
b(also)g(de\014nes)g(these)h(common)f(monad)g(op)s(erations:)2055
5700 y(54)p eop
%%Page: 55 64
55 63 bop 443 63 a Fk(//)47 b(Nothing)f(corresponding)e(to)k(Identity)d
(data)i(type)f(needed)g(by)i(Haskell)443 176 y(struct)e(IdentityM)g({)
190 b(//)47 b(M)h(a)f(=)h(a)586 289 y(typedef)e(Id)h(Unit;)142
b(//)47 b("Id")g(is)g(the)g(identity)f(functoid)f(in)i(FC++)586
402 y(static)f(Unit)h(unit;)586 628 y(struct)f(XBind)h({)730
741 y(template)e(<class)h(M,)h(class)g(K>)g(struct)f(Sig)h(:)g(public)f
(FunType<M,K,)873 854 y(RT<K,M>::ResultType>)c({};)730
966 y(template)j(<class)h(M,)h(class)g(K>)730 1079 y(typename)e
(Sig<M,K>::ResultType)730 1192 y(operator\(\)\()f(const)j(M&)g(m,)g
(const)f(K&)i(k)f(\))g(const)g({)873 1305 y(return)f(k\(m\);)730
1418 y(})586 1531 y(};)586 1644 y(typedef)g(Full2<XBind>)f(Bind;)586
1757 y(static)h(Bind)h(bind;)443 1870 y(};)1139 2165
y Fl(Figure)35 b(10:)47 b Fm(De\014nition)29 b(of)i(the)f
Fk(IdentityM)e Fm(monad)443 2435 y Fk(bindM_<SomeMonad>\(\))234
b(mapM<SomeMonad>\(\))443 2622 y(joinM<SomeMonad>\(\))282
b(liftM<SomeMonad>\(\))443 2810 y(liftM2<SomeMonad>\(\))234
b(liftM3<SomeMonad>\(\))300 3062 y Fm(whic)m(h)33 b(are)h(de\014ned)e
(in)h(terms)h(of)g Fk(unitM)e Fm(and)h Fk(bindM)g Fm(\(and)g(th)m(us)h
(are)g(a)m(v)-5 b(ailable)33 b(for)h(ev)m(ery)h(monad\).)300
3249 y(Finally)-8 b(,)29 b(for)h(monads)g(whic)m(h)f(supp)s(ort)g(a)h
Fi(zer)-5 b(o)38 b Fm(or)30 b(a)h Fi(plus)p Fm(,)g(F)m(C++)f(pro)m
(vides)443 3501 y Fk(zeroM<SomeMonad>\(\))282 b(plusM<SomeMonad>\(\))
300 3753 y Fm(whic)m(h,)29 b(lik)m(e)h Fk(unitM)f Fm(and)h
Fk(bindM)p Fm(,)f(just)h(call)f(the)i(corresp)s(onding)d(functions)h
(from)h(the)h(monad.)441 3940 y(F)m(C++)f(supp)s(orts)f(comprehensions)
g(in)g(arbitrary)g(monads,)h(using)f(the)h(general)h(syn)m(tax:)443
4192 y Fk(compM<SomeMonad>\(\)[)43 b(lambdaExp)i(|)i(thing,)g(thing,)f
(...)h(thing)f(])300 4444 y Fm(where)30 b Fk(thing)f
Fm(is)g(one)i(of)436 4696 y Fh(\017)46 b Fm(a)31 b(gets)g(expression)f
(of)g(the)h(form)f(\\)p Fk(LV)47 b(<=)g(lambdaExp)p Fm(")29
b(\(T)-8 b(ranslates)30 b(in)m(to)g(a)h(call)f(to)h Fk(bindM)p
Fm(\))436 4954 y Fh(\017)46 b Fm(a)31 b(lam)m(b)s(da)e(expression)g
(\(T)-8 b(ranslates)31 b(in)m(to)f(a)h(call)f(to)h Fk(bindM_)p
Fm(\))436 5213 y Fh(\017)46 b Fm(a)29 b(guard)e(expression)g(of)h(the)g
(form)f(\\)p Fk(guard[boolLambdaExp])p Fm(")d(\(T)-8
b(ranslates)28 b(in)m(to)g(an)g(if-then-)527 5400 y(else)i(with)g
Fk(zeroM)f Fm(if)g(the)h(test)i(fails\))2055 5700 y(55)p
eop
%%Page: 56 65
56 64 bop 300 91 a Fm(This)28 b(is)i(similar)d(to)k(the)g(syn)m(tax)f
(used)g(b)m(y)g(Hask)m(ell's)g(list)f(comprehensions.)39
b(F)m(C++)30 b(also)g(supp)s(orts)f(a)300 279 y(construct)i(similar)c
(to)32 b(Hask)m(ell's)e Fi(do-notation)7 b Fm(:)443 541
y Fk(doM[)47 b(thing,)f(thing,)g(...)h(thing)f(])300
803 y Fm(where)35 b(eac)m(h)i Fk(thing)d Fm(is)g(as)i(b)s(efore,)g
(only)f Fk(guard)p Fm(s)f(are)i(no)f(longer)g(allo)m(w)m(ed.)56
b(\(The)35 b(lac)m(k)h(of)g(a)f(monad)300 990 y(parameter)c(to)g
Fk(doM)e Fm(is)h(discussed)e(in)h(a)i(momen)m(t.\))441
1178 y(Clien)m(ts)44 b(can)h(de\014ne)f(monads)h(b)m(y)g(creating)g
(monad)g(classes)g(whic)m(h)f(mo)s(del)f(the)j(monad)e(con-)300
1365 y(cepts)i(describ)s(ed)d(in)g(the)j(previous)d(subsection)h(\()p
Fk(Monad)g Fm(and)h Fk(MonadWithZero)p Fm(\).)81 b(There)45
b(is)f(also)300 1553 y(a)c Fk(MonadWithPlus)d Fm(concept)k(for)e
(monads)h(that)g(supp)s(ort)e Fk(plus)p Fm(.)69 b(Additionally)37
b(there)j(is)f(another)300 1740 y(concept)28 b(called)e
Fk(InferrableMonad)p Fm(,)e(whic)m(h)i(ma)m(y)i(b)s(e)e(mo)s(delled)f
(when)h(there)h(is)g(a)g(one-to-one)i(corre-)300 1928
y(sp)s(ondence)24 b(b)s(et)m(w)m(een)h(a)g(datat)m(yp)s(e)g(and)f(a)h
(monad.)38 b(In)24 b(the)h(case)h(of)e Fk(InferrableMonad)p
Fm(s,)e(F)m(C++)i(\(lik)m(e)300 2115 y(Hask)m(ell\))31
b(can)g(automatically)f(infer)f(the)i(monad)f(based)g(on)g(the)h(datat)
m(yp)s(e;)h(th)m(us)e(the)h Fk(doM)f Fm(construct)300
2303 y(do)s(es)g(not)h(need)f(to)h(ha)m(v)m(e)g(a)g(monad)f(passed)g
(as)h(an)f(explicit)f(parameter.)441 2490 y(The)f(monad)g(syn)m(tax)h
(is)e(part)i(of)f(F)m(C++'s)g(lam)m(b)s(da)g(sublanguage.)39
b(As)28 b(with)f Fk(lambda)p Fm(,)h(w)m(e)h(striv)m(ed)300
2677 y(for)20 b(minimalism)c(when)k(implemen)m(ting)e(monads.)37
b(The)19 b(only)h(new)f(op)s(erator)i(o)m(v)m(erloads)g(are)g
Fk(operator|)300 2865 y Fm(and)32 b Fk(operator<=)p Fm(,)e(and)i(the)g
(only)g(new)f(syn)m(tax)i(primitiv)m(es)d(are)j Fk(compM)p
Fm(,)e Fk(guard)p Fm(,)h(and)f Fk(doM)p Fm(.)h(As)g(with)300
3052 y(the)c(rest)h(of)f Fk(lambda)p Fm(,)f(w)m(e)i(pro)m(vide)e
Fk(LEType)g Fm(translations)g(so)h(that)h(clien)m(ts)f(can)g(name)g
(the)h(result)e(t)m(yp)s(e)300 3240 y(of)k(lam)m(b)s(da)e(expressions)g
(whic)m(h)g(use)h(monads:)443 3502 y Fk(DOM)620 b(doM[])443
3689 y(GETS)572 b(LambdaVar)45 b(<=)i(value)443 3877
y(GUARD)524 b(guard[])443 4064 y(COMP)572 b(compM<SomeMonad>\(\)[])300
4326 y Fm(As)42 b(with)e(the)i(other)g(p)s(ortions)e(of)i
Fk(lambda)p Fm(,)h(F)m(C++)e(pro)m(vides)g(some)h(custom)g(error)f
(messages)i(for)300 4514 y(common)28 b(abuses)g(of)g(the)g(monad)g
(constructs.)40 b(W)-8 b(e)29 b(follo)m(w)m(ed)f(the)g(same)g(design)f
(principles)e(discussed)300 4701 y(in)k(Section)h(2.3.1)i(when)e
(implemen)m(ting)e(monads)i(in)f(F)m(C++.)450 4941 y
Fi(2.3.2.5)94 b(Monad)34 b(examples)300 5187 y Fm(There)27
b(are)i(man)m(y)f(example)f(applications)f(whic)m(h)h(use)h(monads;)g
(here)g(w)m(e)g(discuss)e(a)j(small)d(sample)h(to)300
5375 y(giv)m(e)k(a)g(feel)f(for)g(what)g(monads)g(are)h(useful)d(for.)
2055 5700 y(56)p eop
%%Page: 57 66
57 65 bop 441 91 a Fl(Using)36 b(Ma)m(yb)s(eM)f(for)g(exceptions)441
279 y Fm(One)c(classic)g(example)g(of)g(the)g(utilit)m(y)f(of)h(monads)
g(comes)h(from)f(the)g(domain)f(of)i(exception)f(han-)300
466 y(dling.)49 b(Supp)s(ose)32 b(w)m(e)j(ha)m(v)m(e)g(written)e(some)h
(co)s(de)g(whic)m(h)f(computes)h(some)g(v)-5 b(alues)34
b(using)e(some)j(func-)300 654 y(tions:)443 903 y Fk(x)48
b(=)f(f\(3\);)443 1090 y(y)h(=)f(g\(x\);)443 1278 y(z)h(=)f(h\(x,y\);)
443 1465 y(return)f(z;)300 1715 y Fm(\(F)-8 b(or)32 b(the)f(sak)m(e)g
(of)g(argumen)m(t,)g(let's)g(sa)m(y)g(that)h(the)e(functions)g
Fk(f)p Fm(,)g Fk(g)p Fm(,)h(and)f Fk(h)g Fm(tak)m(e)i(p)s(ositiv)m(e)e
(in)m(tegers)h(as)300 1902 y(argumen)m(ts)f(and)e(return)g(p)s(ositiv)m
(e)g(in)m(tegers)i(as)f(results.\))40 b(No)m(w)30 b(supp)s(ose)d(that)j
(eac)m(h)h(of)e(the)g(functions)300 2090 y(ab)s(o)m(v)m(e)j(ma)m(y)g
(fail)e(for)h(some)h(reason.)43 b(In)31 b(a)g(language)h(with)e
(exceptions,)i(w)m(e)f(could)g(thro)m(w)g(exceptions)300
2277 y(in)j(the)h(case)h(of)g(failure.)53 b(Ho)m(w)m(ev)m(er)37
b(in)d(a)h(language)h(without)e(an)h(exception)g(mec)m(hanism)f(\(lik)m
(e)h(C)g(or)300 2465 y(Hask)m(ell\),)k(w)m(e)e(w)m(ould)f(t)m(ypically)
g(b)s(e)g(forced)h(to)h(represen)m(t)f(failure)e(using)g(some)j(sen)m
(tinel)e(v)-5 b(alue)36 b(\()p Fk(-1)p Fm(,)300 2652
y(sa)m(y\),)c(and)d(then)i(c)m(hange)g(the)g(clien)m(t)f(co)s(de)g(to)
443 2901 y Fk(x)48 b(=)f(f\(3\);)443 3089 y(if\()g(x)h(==)f(-1)g(\))g
({)586 3276 y(return)f(-1;)443 3464 y(})i(else)e({)586
3651 y(y)i(=)f(g\(x\);)586 3839 y(if\()g(y)h(==)f(-1)g(\))h({)730
4026 y(return)e(-1;)586 4213 y(})i(else)e({)730 4401
y(z)h(=)g(h\(x,y\);)730 4588 y(return)f(z;)586 4776 y(})443
4963 y(})300 5213 y Fm(This)27 b(is)h(painful)e(b)s(ecause)j(the)g
(\\exception)h(handling")d(part)i(of)g(the)g(co)s(de)g(clutters)g(up)f
(the)h(main)f(line)300 5400 y(co)s(de.)52 b(Ho)m(w)m(ev)m(er,)37
b(w)m(e)d(can)g(solv)m(e)g(the)h(problem)d(m)m(uc)m(h)i(more)g(simply)d
(b)m(y)j(using)e(the)j(Ma)m(yb)s(e)f(monad.)2055 5700
y(57)p eop
%%Page: 58 67
58 66 bop 300 91 a Fm(Let)26 b(the)g(functions)e(return)g(v)-5
b(alues)25 b(of)h(t)m(yp)s(e)f Fk(Maybe<int>)p Fm(,)f(and)h(let)h
Fk(NOTHING)d Fm(represen)m(t)j(failure.)37 b(No)m(w)300
279 y(the)31 b(clien)m(t)f(co)s(de)g(can)h(b)s(e)f(written)f(as)i(just)
443 541 y Fk(compM<MaybeM>\(\)[)44 b(Z)j(|)g(X)h(<=)f(f[3],)1445
728 y(Y)h(<=)f(g[X],)1445 916 y(Z)h(<=)f(h[X,Y])f(])300
1178 y Fm(The)30 b(de\014nitions)d(of)j Fk(unit)f Fm(and)h
Fk(bind)f Fm(in)f(the)j Fk(MaybeM)d Fm(monad)i(mak)m(e)h(the)f(problem)
e(trivial;)h Fk(NOTHING)300 1365 y Fm(v)-5 b(alues)32
b(immediately)g(propagate)i(up)e(through)h(the)g(end)f(of)i(the)f
(comprehension,)g(whereas)g(in)m(tegers)300 1553 y(con)m(tin)m(ue)e(on)
f(through)g(the)g(computation)g(as)h(desired.)441 1740
y Fl(Using)36 b(ListM)f(for)g(non-determinism)441 1928
y Fm(No)m(w)e(imagine)e(c)m(hanging)h(the)g(problem)e(ab)s(o)m(v)m(e)j
(sligh)m(tly;)f(instead)f(of)h(the)g(functions)e Fk(f)p
Fm(,)j Fk(g)p Fm(,)f(and)f Fk(h)300 2115 y Fm(ha)m(ving)h(the)g(p)s
(ossibilit)m(y)d(of)k(failure,)e(supp)s(ose)g(instead)g(that)i(they)g
(are)f(non-deterministic.)44 b(That)33 b(is,)300 2303
y(supp)s(ose)g(eac)m(h)i(function)e(returns)g(not)h(a)g(single)f(in)m
(teger,)j(but)d(rather)h(a)h(list)e(of)h(all)f(p)s(ossible)f(in)m
(teger)300 2490 y(results.)64 b(Changing)38 b(the)h(original)e(clien)m
(t)h(co)s(de)h(to)g(deal)g(with)e(this)h(c)m(hange)h(w)m(ould)f(lik)m
(ely)f(b)s(e)h(ev)m(en)300 2677 y(uglier)26 b(than)i(the)f(original)f
(c)m(hange)j(\(whic)m(h)e(required)f(all)g(the)i(tests)h(for)e
Fk(-1)p Fm(\).)40 b(Ho)m(w)m(ev)m(er)29 b(the)f(c)m(hange)h(to)300
2865 y(the)i(monadic)e(v)m(ersion)h(is)f(trivial:)443
3127 y Fk(compM<ListM>\(\)[)44 b(Z)j(|)h(X)f(<=)g(f[3],)190
b(--)47 b(Note)g(ListM)f(instead)g(of)h(MaybeM)1398 3314
y(Y)g(<=)g(g[X],)1398 3502 y(Z)g(<=)g(h[X,Y])f(])300
3764 y Fm(The)30 b(result)f(is)h(a)g(list)f(of)i(all)e(the)i(p)s
(ossible)d(in)m(teger)i(v)-5 b(alues)30 b(for)g Fk(Z)g
Fm(whic)m(h)f(satistfy)i(the)f(form)m(ulae.)441 3951
y Fl(A)35 b(monadic)g(ev)-6 b(aluator)441 4139 y Fm(W)e(adler)32
b([70)q(])f(demonstrates)h(the)g(utilit)m(y)e(of)h(monads)g(in)f(the)i
(con)m(text)h(of)e(writing)f(an)h(expression)300 4326
y(ev)-5 b(aluator.)56 b(W)-8 b(adler)36 b(giv)m(es)f(an)h(example)f(of)
g(an)g(in)m(terpreter)g(for)g(a)h(tin)m(y)f(expression)f(language,)k
(and)300 4514 y(sho)m(ws)20 b(ho)m(w)h(adding)f(v)-5
b(arious)19 b(kinds)g(of)i(functionalit)m(y)-8 b(,)22
b(suc)m(h)e(as)h(error)f(handling,)h(coun)m(ting)f(the)h(n)m(um)m(b)s
(er)300 4701 y(of)j(reduction)g(op)s(erations)f(p)s(erformed,)i(k)m
(eeping)f(an)g(execution)h(trace,)h(etc.)40 b(tak)m(es)26
b(a)f(bit)e(of)i(w)m(ork.)38 b(The)300 4889 y(ev)-5 b(aluator)36
b(is)f(then)g(rewritten)g(using)f(monads,)j(and)e(the)g(v)-5
b(arious)35 b(additions)f(are)i(revisited.)55 b(In)35
b(the)300 5076 y(monadic)k(v)m(ersion,)i(the)e(c)m(hanges)i(necessary)e
(to)i(e\013ect)f(eac)m(h)h(of)e(the)h(additions)d(are)j(m)m(uc)m(h)f
(smaller)300 5263 y(and)g(more)i(lo)s(cal)e(than)h(the)g(c)m(hanges)h
(to)g(the)f(original)f(\(non-monadic\))g(program.)70
b(This)38 b(example)2055 5700 y(58)p eop
%%Page: 59 68
59 67 bop 300 91 a Fm(demonstrates)44 b(the)g(v)-5 b(alue)43
b(of)h(using)e(monads)i(to)g(structure)f(programs)h(in)e(order)h(to)i
(lo)s(calize)e(the)300 279 y(c)m(hanges)31 b(necessary)g(to)g(mak)m(e)h
(a)e(wide)g(v)-5 b(ariet)m(y)30 b(of)h(additions)d(throughout)i(a)h
(program.)441 466 y Fl(Monadic)36 b(parser)f(com)m(binators)441
654 y Fm(P)m(arsing)22 b(is)f(a)i(domain)e(whic)m(h)g(is)h(esp)s
(ecially)e(w)m(ell-suited)h(to)i(monads.)37 b(In)22 b(the)g(Hask)m(ell)
g(comm)m(unit)m(y)-8 b(,)300 841 y(\\monadic)22 b(parser)g(com)m
(binators")i(are)f(b)s(ecoming)e(the)i(standard)f(w)m(a)m(y)i(to)f
(structure)f(parsing)g(libraries.)300 1028 y(As)35 b(it)g(turns)g(out,)
i(parsers)d(can)i(b)s(e)f(expressed)g(as)g(a)h(monad:)51
b(a)35 b(go)s(o)s(d)h(in)m(tro)s(ductory)e(pap)s(er)g(on)i(the)300
1216 y(topic)28 b(of)h(monadic)e(parser)h(com)m(binators)g(in)f(Hask)m
(ell)i(is)e([33)q(].)40 b(W)-8 b(e)30 b(implemen)m(t)d(the)h(examples)g
(in)f(that)300 1403 y(pap)s(er)35 b(in)f(one)i(of)g(the)g(example)f
(\014les)g(that)h(come)h(with)d(the)i(F)m(C++)g(library)-8
b(.)55 b(Here)36 b(w)m(e)g(just)f(giv)m(e)i(a)300 1591
y(brief)29 b(o)m(v)m(erview)i(of)f(ho)m(w)h(monadic)e(parsing)g(w)m
(orks.)441 1778 y(A)i(t)m(ypical)f(represen)m(tation)g(t)m(yp)s(e)h
(for)f(parser)f(monads)h(is)443 2040 y Fk(Parser)46 b(a)i(=)f(String)f
(->)h(Maybe)g(\()g(a,)g(String)g(\))142 b(--)48 b(the)f(monad)f
("Parser")300 2303 y Fm(That)30 b(is,)g(a)h(parser)e(is)h(a)h(function)
e(whic)m(h)g(tak)m(es)j(a)e Fk(String)f Fm(and)h(returns)436
2565 y Fh(\017)46 b Fm(\(if)25 b(the)h(parse)g(succeeds\))h(a)f(pair)e
(con)m(taining)i(the)g(result)f(of)h(the)g(parse)f(and)g(the)h
(remaining)e(\(y)m(et)527 2752 y(unparsed\))29 b Fk(String)p
Fm(,)g(or)436 3014 y Fh(\017)46 b Fm(\(if)30 b(the)h(parse)f(fails\))f
Fk(Nothing)p Fm(.)300 3276 y(Monadic)44 b(parser)f Fi(c)-5
b(ombinators)54 b Fm(are)44 b(functions)e(whic)m(h)h(com)m(bine)g
(parsers)g(to)i(yield)d(new)h(parsers,)300 3464 y(t)m(ypically)33
b(in)f(w)m(a)m(ys)j(commonly)e(found)f(in)h(the)h(domain)e(of)i
(parsing)f(and)g(grammars.)50 b(F)-8 b(or)35 b(example,)300
3651 y(the)c(parser)e(com)m(binator)i Fk(many)p Fm(:)443
3913 y Fk(many)47 b(::)g(Parser)f(a)i(->)f(Parser)f([a])300
4176 y Fm(implemen)m(ts)c(Kleene)i(star|for)g(example,)j(giv)m(en)d(a)g
(parser)g(whic)m(h)e(parses)i(a)g(single)f(digit)g(called)300
4363 y(\\)p Fk(digit)p Fm(",)25 b(the)e(parser)g(\\)p
Fk(many)47 b(digit)p Fm(")23 b(parses)g(an)m(y)h(n)m(um)m(b)s(er)e(of)i
(digits.)37 b(Monadic)23 b(parser)g(com)m(binator)300
4550 y(libraries)f(t)m(ypically)h(pro)m(vide)h(a)h(n)m(um)m(b)s(er)e
(of)i(basic)f(parsers)g(\(e.g.)40 b Fk(charP)p Fm(,)24
b(whic)m(h)f(parses)h(an)m(y)h(c)m(haracter)300 4738
y(and)41 b(returns)g(that)i(c)m(haracter\))h(and)d(com)m(binators)h
(\(e.g.)77 b Fk(plusP)p Fm(,)41 b(whic)m(h)g(tak)m(es)i(t)m(w)m(o)g
(parsers)f(and)300 4925 y(returns)25 b(a)i(new)f(parser)f(whic)m(h)g
(tries)h(to)h(parse)f(a)h(string)e(with)g(the)h(\014rst)g(parser,)h
(but)e(if)h(that)g(fails,)g(uses)300 5113 y(the)k(second\))g(to)h
(clien)m(ts.)40 b(The)29 b(b)s(eaut)m(y)h(of)g(the)g(monadic)g(parser)f
(com)m(binator)h(approac)m(h)g(is)f(that)h(it)g(is)300
5300 y(easy)h(for)f(clien)m(ts)g(to)h(de\014ne)f(their)f(o)m(wn)i
(parsers)e(and)h(com)m(binators)g(for)g(their)g(sp)s(eci\014c)f(needs.)
2055 5700 y(59)p eop
%%Page: 60 69
60 68 bop 441 91 a Fm(As)30 b(w)m(e)h(ha)m(v)m(e)g(seen)f(in)f(the)h
(previous)f(examples,)g(using)g(monads)g(often)i(mak)m(es)g(it)e(easy)i
(to)g(c)m(hange)300 279 y(some)44 b(fundamen)m(tal)e(asp)s(ect)h(of)h
(the)f(b)s(eha)m(vior)f(of)h(the)h(program.)79 b(F)-8
b(or)44 b(example,)i(if)c(w)m(e)i(ha)m(v)m(e)g(an)300
466 y(am)m(biguous)39 b(grammar)i(\(one)f(for)g(whic)m(h)f(some)i
(strings)e(admit)g(m)m(ultiple)f(parses\),)43 b(w)m(e)e(can)f(simply)
300 654 y(c)m(hange)32 b(the)e(represen)m(tation)h(t)m(yp)s(e)f(for)g
(the)h(parser)f(lik)m(e)f(so:)443 903 y Fk(Parser)46
b(a)i(=)f(String)f(->)h([)h(\()f(a,)h(String)e(\))h(])95
b(--)47 b(uses)g(List)g(instead)f(of)h(Maybe)300 1153
y Fm(th)m(us)31 b(rede\014ning)f(the)h(monad)g(op)s(erations)g(\()p
Fk(unit)p Fm(,)g Fk(bind)p Fm(,)g Fk(zero)p Fm(,)g(and)g
Fk(plus)p Fm(\),)g(and)g(then)g(parsers)g(will)300 1340
y(return)h(a)h(list)f(of)h(ev)m(ery)h(p)s(ossible)d(parse)i(of)g(the)g
(string.)48 b(This)31 b(is)h(all)g(p)s(ossible)f(without)h(making)h(an)
m(y)300 1528 y(c)m(hanges)e(to)g(existing)f(clien)m(t)g(co)s(de.)441
1715 y(One)c(alternativ)m(e)g(approac)m(h)g(to)g(writing)e(parsing)h
(libraries)e(in)h(C++)h(is)g(that)h(tak)m(en)h(b)m(y)f(the)g(Bo)s(ost)
300 1903 y(Spirit)20 b(Library[29)o(].)38 b(Spirit)20
b(uses)i(expression)f(templates)i(to)g(turn)f(C++)f(in)m(to)h(a)h
Fk(yacc)p Fm(-lik)m(e)e(to)s(ol,)j(where)300 2090 y(parsers)h(can)h(b)s
(e)f(expressed)g(using)f(syn)m(tax)i(similar)d(to)j(the)g(language)g
(grammar.)39 b(F)-8 b(or)26 b(example,)h(giv)m(en)300
2277 y(the)k(expression)e(language)443 2527 y Fk(factor)285
b(::=)47 b(integer)f(|)h(group)715 b(//)47 b(BNF)443
2715 y(term)381 b(::=)47 b(factor)f(\(mulOp)g(factor\)*)443
2902 y(expression)93 b(::=)47 b(term)f(\(addOp)h(term\)*)443
3089 y(group)333 b(::=)47 b('\(')g(expression)e('\)')300
3339 y Fm(one)31 b(can)f(write)g(a)h(parser)e(using)g(Spirit)f(as)443
3589 y Fk(factor)285 b(=)47 b(integer)f(|)i(group;)762
b(//)47 b(Spirit)f(\(C++\))443 3776 y(term)381 b(=)47
b(factor)f(>>)i(*\(mulOp)d(>>)j(factor\);)443 3964 y(expression)93
b(=)47 b(term)g(>>)g(*\(addOp)f(>>)h(term\);)443 4151
y(group)333 b(=)47 b('\(')g(>>)g(expression)e(>>)j('\)';)300
4401 y Fm(whic)m(h)30 b(is)h(almost)h(just)f(as)h(readable)f(as)h(the)g
(grammar.)45 b(Lik)m(e)31 b Fk(yacc)p Fm(,)g(Spirit)e(has)j(a)g(w)m(a)m
(y)h(to)f(asso)s(ciate)300 4588 y(seman)m(tic)f(actions)f(with)f(eac)m
(h)j(rule.)441 4775 y(The)40 b(results)f(are)i(similar)d(with)h
(monadic)g(parser)h(com)m(binators.)71 b(Using)39 b(an)h(F)m(C++)h
(monadic)300 4963 y(parser)30 b(com)m(binator)g(library)-8
b(,)29 b(w)m(e)i(can)f(write)443 5213 y Fk(factor)237
b(=)48 b(lambda\(S\)[)d(\(integer)g(\045plusP\045)h
(dereference[&group]\)[S])41 b(];)443 5400 y(term)333
b(=)48 b(factor)e(^chainl1^)f(mulOp;)2055 5700 y Fm(60)p
eop
%%Page: 61 70
61 69 bop 443 91 a Fk(expression)45 b(=)j(term)e(^chainl1^)g(addOp;)443
279 y(group)285 b(=)48 b(bracket\()d(charP\('\('\),)g(expression,)g
(charP\('\)'\))g(\);)300 541 y Fm(to)31 b(express)f(the)g(same)h
(parser.)40 b(The)30 b(ab)s(o)m(v)m(e)i(F)m(C++)e(co)s(de)g(creates)i
(parser)e(functoids)f(b)m(y)h(using)f(more)300 728 y(primitiv)m(e)k
(parsers)h(and)g(com)m(bining)f(them)i(with)f(appropriate)f(parser)i
(com)m(binators)g(lik)m(e)f Fk(chainl1)p Fm(.)300 916
y(\(Note)42 b(that,)i(whereas)d(Spirit's)d(parser)h(rules)h(are)g
(e\013ectiv)m(ely)i(\\b)m(y)f(reference",)j(F)m(C++)c(functoids)300
1103 y(are)29 b(\\b)m(y)h(v)-5 b(alue",)29 b(whic)m(h)f(means)h(w)m(e)g
(need)g(to)h(explicitly)d(create)j(indirection)d(to)i(break)g(the)g
(recursion)300 1291 y(among)c(these)h(functoids.)37 b(Hence)26
b(the)f(use)f(of)h Fk(lambda)p Fm(,)g Fk(dereference)p
Fm(,)e(and)h(the)h(address-of)g(op)s(erator)300 1478
y(in)40 b(the)h(de\014nition)d(of)j Fk(factor)p Fm(.\))71
b(This)40 b(F)m(C++)g(parser)h(not)g(only)f(parses)g(the)i(string,)g
(but)f(it)f(also)300 1665 y(ev)-5 b(aluates)36 b(the)f(arithmetic)g
(expression)f(parsed.)55 b(The)35 b(seman)m(tics)h(are)f(built)f(in)m
(to)h(the)g(user-de\014ned)300 1853 y(com)m(binators)30
b(lik)m(e)g Fk(addOp)f Fm(and)h Fk(chainl1)p Fm(.)38
b(F)-8 b(or)32 b(example,)443 2115 y Fk(addOp)47 b(::)g(Parser)f(\(Int)
g(->)i(Int)f(->)g(Int\))300 2377 y Fm(parses)30 b(a)h(sym)m(b)s(ol)e
(lik)m(e)h Fk('-')f Fm(and)h(returns)f(the)h(corresp)s(onding)f
(functoid)g(\()p Fk(minus)p Fm(\).)40 b(Then,)443 2639
y Fk(chainl1)46 b(::)h(Parser)f(a)i(->)f(Parser)f(\(a)h(->)g(a)h(->)f
(a)g(\))h(->)f(Parser)f(a)443 2827 y(--)h(e.g.)142 b(p)48
b(`chainl1`)d(op)300 3089 y Fm(parses)20 b(rep)s(eated)h(applications)e
(of)i(parser)f Fk(p)g Fm(,)j(separated)e(b)m(y)g(applications)e(of)i
(parser)f Fk(op)g Fm(\(whose)h(result)300 3276 y(is)27
b(a)h(left-asso)s(cativ)m(e)h(function,)e(whic)m(h)g(is)g(used)g(to)h
(com)m(bine)g(the)f(results)g(from)g(the)h Fk(p)g Fm(parsers\).)39
b(Th)m(us)300 3464 y(monadic)34 b(parser)g(com)m(binator)g(libraries)e
(allo)m(w)i(one)h(to)g(express)f(parsers)g(at)h(a)g(lev)m(el)f(of)h
(abstraction)300 3651 y(comparable)d(to)h(to)s(ols)f(lik)m(e)g
Fk(yacc)f Fm(or)i(the)f(Spirit)e(library)-8 b(,)31 b(but)h(in)f(a)i(w)m
(a)m(y)g(in)e(whic)m(h)g(users)h(can)h(de\014ne)300 3839
y(their)28 b(o)m(wn)g(abstractions)h(\(lik)m(e)f Fk(chainl1)p
Fm(\))f(for)i(parsing)e(and)h(seman)m(tics,)i(rather)e(than)g(just)h
(using)e(the)300 4026 y(builtin)g(ones)j(\(lik)m(e)g(Kleene)g(star\))h
(supplied)c(b)m(y)k(the)f(to)s(ol/library)-8 b(.)441
4214 y Fl(Lazy)35 b(ev)-6 b(aluation)441 4401 y Fm(Early)28
b(v)m(ersions)g(of)h(F)m(C++)f(supp)s(orted)f(lazy)i(ev)-5
b(aluation)28 b(in)g(t)m(w)m(o)i(main)d(w)m(a)m(ys:)41
b(\014rst,)29 b(via)f(the)h(lazy)300 4588 y Fk(List)40
b Fm(class)i(and)f(the)g(functions)g(\(lik)m(e)g Fk(map)p
Fm(\))g(that)h(use)f Fk(List)p Fm(s,)i(and)e(second,)k(via)c(\\th)m
(unks")h(\(zero)300 4776 y(argumen)m(t)f(functoids,)g(lik)m(e)e
Fk(Fun0<T>)p Fm(\).)69 b(Monads)40 b(pro)m(vide)f(a)i(new,)h(more)f
(general)f(mec)m(hanism)f(to)300 4963 y(lazify)c(computations.)56
b(The)35 b(datat)m(yp)s(e)i Fk(ByNeed<T>)c Fm(and)i(its)g(asso)s
(ciated)i(monad)e Fk(ByNeedM)f Fm(can)i(b)s(e)300 5151
y(used)e(to)j(mak)m(e)f(a)f(computation)h(lazy)-8 b(.)56
b(Additionally)-8 b(,)34 b(the)h(functoid)f Fk(bLift)g
Fm(lazi\014es)g(a)i(functoid)e(b)m(y)300 5338 y(lifting)28
b(its)i(result)f(in)m(to)i(the)f(ByNeedM)i(monad.)40
b(F)-8 b(or)31 b(example,)f(w)m(e)h(can)g(lazify)2055
5700 y(61)p eop
%%Page: 62 71
62 70 bop 443 91 a Fk(x)48 b(=)f(f\(3\);)443 279 y(y)h(=)f(g\(x\);)443
466 y(z)h(=)f(h\(x,y\);)300 728 y Fm(b)m(y)30 b(writing)443
990 y Fk(compM<ByNeedM>\(\)[)43 b(Z)48 b(|)f(X)h(<=)f(bLift[f])e([3],)
1493 1178 y(Y)j(<=)f(bLift[g])e([X],)1493 1365 y(Z)j(<=)f(bLift[h])e
([X,Y])i(])300 1627 y Fm(The)d(result)g(is)g(a)i Fk(ByNeed<int>)41
b Fm(v)-5 b(alue,)49 b(whic)m(h)43 b(is)h(a)i(computation)f(that)g
(will)d(result)i(in)g(an)h Fk(int)300 1815 y Fm(when)38
b(\\forced")h(b)m(y)g(calling)e Fk(bForce)p Fm(.)64 b(\(Con)m(v)m
(ersely)-8 b(,)42 b(a)d(constan)m(t)h(can)f(b)s(e)g(turned)e(in)m(to)i
(a)g(b)m(y-need)300 2002 y(computation)32 b(b)m(y)f(calling)f
Fk(bDelay)p Fm(.\))44 b(Using)31 b(v)-5 b(alues)31 b(of)g(t)m(yp)s(e)h
Fk(ByNeed<T>)d Fm(in)i(lieu)f(of)i(t)m(yp)s(e)g Fk(T)f
Fm(ensures)300 2190 y(that)j(lazy)f(ev)-5 b(aluation)33
b(o)s(ccurs:)46 b(a)33 b(computation)h(is)e(not)h(p)s(erformed)f(un)m
(til)f(the)j(v)-5 b(alue)32 b(is)h(demanded,)300 2377
y(and)24 b(once)i(a)g(computation)f(has)f(b)s(een)h(run)e(to)j(pro)s
(duce)e(a)h(v)-5 b(alue,)26 b(the)g(v)-5 b(alue)24 b(is)g(cac)m(hed)i
(so)g(that)f(further)300 2565 y(applications)k(of)h Fk(bForce)f
Fm(get)i(the)g(cac)m(hed)g(v)-5 b(alue)30 b(rather)g(than)g(re-running)
e(the)j(computation.)441 2752 y(In)37 b(short,)i(the)f(datat)m(yp)s(e)g
Fk(ByNeed<T>)d Fm(com)m(bines)j(\\th)m(unks")f(with)f(cac)m(hing,)k
(and)d(the)h Fk(ByNeedM)300 2940 y Fm(monad)31 b(mak)m(es)i(syn)m(tax)g
(sugar)e(lik)m(e)g(comprehensions)g(a)m(v)-5 b(ailable)31
b(so)h(that)h(clien)m(t)e(co)s(de)h(w)m(orking)f(with)300
3127 y Fk(ByNeed<T>)22 b Fm(ob)5 b(jects)25 b(need)f(not)g(b)s(e)g
(concerned)g(with)f(all)g(the)h(\\forcing")h(and)f(\\dela)m(ying")g(in)
f(the)h(midst)300 3314 y(of)31 b(the)f(computation)g(\(the)h(monad)f
(plum)m(bing)e(handles)h(this\).)450 3554 y Fi(2.3.2.6)94
b(Monad)34 b(summary)300 3801 y Fm(Monads)42 b(in)e(F)m(C++)i(are)g
(similar)e(to)i(monads)g(in)e(Hask)m(ell.)75 b(Both)43
b(rely)e(on)g(b)s(ounded)f(parametric)300 3988 y(p)s(olymorphism;)23
b(this)g(is)h(done)g(explicitly)e(via)j(t)m(yp)s(e)f(classes)h(in)e
(Hask)m(ell,)j(and)e(implicitly)c(via)25 b(template)300
4176 y(concepts)30 b(in)e(C++.)39 b(In)29 b(b)s(oth)f(Hask)m(ell)h(and)
g(F)m(C++,)g(there)h(is)e(syn)m(tactic)i(sugar)f(for)g(do-notation)h
(and)300 4363 y(comprehensions.)44 b(The)31 b(ma)5 b(jor)32
b(di\013erence)g(is)f(that)h(in)f(F)m(C++,)i(monads)e(do)h(not)g(rely)f
(on)h(datat)m(yp)s(es)300 4550 y(with)39 b(unique)f(algebraic)i(datat)m
(yp)s(e)h(constructors.)70 b(As)40 b(a)h(result,)h(F)m(C++)e
(comprehension)e(syn)m(tax)300 4738 y(generalizes)23
b(to)h(arbitrary)e(monads)h(via)g(a)h(trade-o\013:)38
b(the)24 b(user)e(m)m(ust)h(pro)m(vide)g(an)g(explicit)f(annotation)300
4925 y(on)30 b(the)h(comprehension)e(to)i(denote)g(\\whic)m(h)e
(monad".)441 5113 y(Monads)c(are)f(often)h(seen)f(merely)g(as)h(a)f(w)m
(a)m(y)i(to)f(pro)m(vide)e(\\impure")h(features)g(\(lik)m(e)g(state)i
(and)e(I/O\))300 5300 y(to)38 b(pure)d(functional)h(languages.)60
b(F)m(C++)37 b(demonstrates)g(that)g(monads)g(ha)m(v)m(e)h(useful)d
(applications)2055 5700 y(62)p eop
%%Page: 63 72
63 71 bop 300 91 a Fm(in)40 b(impure)f(languages)j(as)f(w)m(ell.)73
b(The)40 b(parser)h(example)g(sho)m(ws)g(ho)m(w)g(monads)g(pro)m(vide)f
(a)i(w)m(a)m(y)g(to)300 279 y(structure)29 b(programs)g(so)g(that)h
(some)g(cross-cutting)f(concerns)g(can)h(b)s(e)f(easily)f(factored)i
(out,)g(and)f(the)300 466 y(F)m(C++)37 b Fk(ByNeed)e
Fm(monad)i(is)f(a)h(con)m(v)m(enien)m(t)h(reusable)e(w)m(a)m(y)i(to)g
(incorp)s(orate)e(lazy)h(ev)-5 b(aluation)37 b(in)m(to)g(a)300
654 y(C++)29 b(program.)300 894 y Fl(2.3.3)105 b(Static)35
b(analysis)g(and)g(error)g(c)m(hec)m(king)300 1140 y
Fm(In)41 b(F)m(C++,)46 b(lam)m(b)s(da)41 b(and)g(monads)h(e\013ectiv)m
(ely)h(\\em)m(b)s(ed)f(a)g(sublanguage")g(in)m(to)g(C++.)75
b(Our)41 b(use)300 1327 y(of)i(expression)e(templates,)47
b Fk(LambdaVar)p Fm(s,)c(and)f(op)s(erator)h(o)m(v)m(erloading)g(pro)m
(vides)f(sp)s(ecial-purp)s(ose)300 1515 y(syn)m(tactic)34
b(constructs)f(whic)m(h)f(lo)s(ok)g(almost)h(as)h(though)e(they)h(w)m
(ere)h(a)f(part)g(of)g(the)g(language.)49 b(Since)300
1702 y(this)27 b(is)h(all)f(done)h(as)h(a)f(library)-8
b(,)27 b(though,)i(there)f(are)h(c)m(hallenges)f(with)f(regards)i(to)g
(static)g(analysis)e(and)300 1890 y(error)j(c)m(hec)m(king.)441
2077 y(T)-8 b(o)31 b(b)s(egin,)e(consider)g(this)h(example)g(of)g(an)h
(F)m(C++)f(lam)m(b)s(da)f(expression:)443 2339 y Fk(lambda\(X,X\)[)45
b(X)i(]\(1,2\))300 2601 y Fm(If)e(the)g(lam)m(b)s(da)f(expression)g
(here)h(w)m(ere)h(written)e(in)g(a)i(functional)d(language,)50
b(w)m(e)45 b(w)m(ould)f(exp)s(ect)300 2789 y(the)37 b(language)h
(compiler/in)m(terpreter)d(to)j(detect)g(the)f(rep)s(eated)g(v)-5
b(ariable)36 b Fk(X)h Fm(in)e(the)i(list)f(of)h(lam)m(b)s(da)300
2976 y(argumen)m(ts)25 b(and)f(issue)g(an)g(error)g(message.)40
b(Of)24 b(course,)j(the)e(C++)e(compiler)g(is)h(not)h(automatically)g
(so)300 3164 y(kind|as)k(far)i(as)g(it)f(is)g(concerned,)h
Fk(lambda\(\))e Fm(is)h(just)g(another)h(function)f(call,)g(and)g(th)m
(us)h(no)f(sp)s(ecial)300 3351 y(analysis)25 b(is)h(merited.)39
b(As)27 b(a)g(result,)g(in)e(the)i(F)m(C++)g(library)-8
b(,)26 b(w)m(e)h(write)f(small)g(meta-programs)h(within)300
3538 y(the)37 b(C++)f(t)m(yp)s(e)i(system)f(\(whic)m(h)f(is)g(T)-8
b(uring-complete\))37 b(to)g(p)s(erform)f(v)-5 b(arious)36
b(static)i(analyses)f(and)300 3726 y(issue)31 b(v)-5
b(arious)31 b(kinds)g(of)h(error)g(messages)i(that)f(are)f(related)g
(to)i(the)e(new)g(\\sublanguages")g(pro)m(vided)300 3913
y(b)m(y)e(the)h(libraries.)441 4101 y(Consider)e(again)h(this)f
(expression:)443 4363 y Fk(lambda\(X,X\)[)45 b(X)i(]\(1,2\))300
4625 y Fm(T)-8 b(o)38 b(detect)g(duplicated)e(lam)m(b)s(da)g(v)-5
b(ariables)36 b(in)g(the)h(argumen)m(t)h(list)e(to)i(lam)m(b)s(da,)g(w)
m(e)g(write)e(a)i(meta-)300 4813 y(program)31 b(whic)m(h)e(is)h(in)m(v)
m(ok)m(ed)h(when)f(trying)g(to)h(compute)h(the)f(result)e(t)m(yp)s(e)i
(of)g(the)g(call)f(to)i Fk(lambda\(\))p Fm(.)300 5000
y(Recall)e(that)h(lam)m(b)s(da)e(v)-5 b(ariables)29 b(in)g(F)m(C++)h
(are)h(declared)f(lik)m(e)g(so,)443 5262 y Fk(LambdaVar<1>)45
b(X;)142 b(LambdaVar<2>)45 b(Y;)2055 5700 y Fm(63)p eop
%%Page: 64 73
64 72 bop 300 91 a Fm(with)29 b(v)-5 b(ariables)29 b(declared)i(as)f
(instances)g(of)h(the)g Fk(LambdaVar)d Fm(template)j(class,)g(eac)m(h)g
(with)f(a)g(di\013eren)m(t)300 279 y(in)m(teger)41 b(template)h
(parameter.)73 b(This)40 b(enables)g(the)h(C++)f(t)m(yp)s(e)i(system)f
(to)h(distinguinsh)36 b(among)300 466 y(lam)m(b)s(da)e(v)-5
b(ariables,)35 b(as)g(eac)m(h)i(lam)m(b)s(da)d(v)-5 b(ariable)34
b(has)g(a)i(di\013eren)m(t)e(t)m(yp)s(e.)56 b(Th)m(us)34
b(w)m(e)h(write)f(the)i(meta-)300 654 y(program)22 b(\(enco)s(ded)f(in)
g(the)h(t)m(yp)s(e)g(of)g Fk(lambda\(\))p Fm(\))e(to)i(w)m(alk)g(the)g
(list)e(of)i(argumen)m(ts)g(passed)g(to)g Fk(lambda\(\))300
841 y Fm(and)30 b(insp)s(ect)g(the)h(t)m(yp)s(es)f(for)h(duplicates.)40
b(If)31 b(an)m(y)g(duplicates)e(are)i(found,)f(w)m(e)h(issue)f(a)h
(\\custom)g(error)300 1028 y(message")f(describing)c(the)j(error.)40
b(The)28 b(C++)g(language/compiler)g(pro)m(vide)g(no)g(sp)s(ecial)f
(supp)s(ort)g(for)300 1216 y(customing)34 b(error)g(messages,)i(but)e
(w)m(e)h(can)f(sim)m(ulate)g(them)g(reasonably)g(w)m(ell)f(b)m(y)h
(referring)f(to)i(non-)300 1403 y(existen)m(t)27 b(v)-5
b(ariables)25 b(or)h(functions)f(with)f(long)i(iden)m(ti\014ers)e(that)
j(describ)s(e)e(the)h(problem.)38 b(F)-8 b(or)27 b(instance,)300
1591 y(in)i(the)i(case)g(of)443 1853 y Fk(lambda\(X,X\)[)45
b(X)i(]\(1,2\))94 b(//)47 b(on)g(line)g(94)g(of)g(example.cpp)300
2115 y Fm(the)31 b(g++)f(compiler)f(emits)h(a)g(\(somewhat)h(long\))g
(error)f(message)h(whic)m(h)e(ends)h(with)443 2377 y
Fk(example.cpp:94:)139 b(instantiated)45 b(from)h(here)443
2565 y(./FC++/lambda.hpp:1137:)c(no)47 b(method)f(`)586
2752 y(YouCannotPassTheSameLambda)o(Var)o(To_l)o(ambd)o(a_M)o(oreT)o
(hanO)o(nce)o(<tru)o(e>::)o(go')300 3014 y Fm(This)32
b(message)i(is)e(not)i(ideal,)f(but)g(it)g(do)s(es)g(con)m(tain)g(b)s
(oth)g(of)g(the)h(essen)m(tial)f(elemen)m(ts:)47 b(the)33
b(lo)s(cation)300 3202 y(where)d(the)g(error)g(o)s(ccurred)g(\()p
Fk(example.cpp)p Fm(,)e(line)g(94\),)k(and)e(the)g(nature)g(of)g(the)h
(error)f(\(describ)s(ed)e(in)300 3389 y(the)j(long)f(iden)m(ti\014er)e
Fk(YouCannotPass)p Fm(...\).)441 3577 y(W)-8 b(e)40 b(can)g(use)f(this)
f(same)h(strategy)h(to)g(detect)h(a)e(wide)f(v)-5 b(ariet)m(y)39
b(of)h(errors.)66 b(Here)40 b(are)f(a)g(couple)300 3764
y(more)29 b(examples)f(of)h(common)g(errors)f(that)i(clien)m(ts)e(of)h
(the)g(library)d(migh)m(t)i(mak)m(e,)j(and)d(the)h(iden)m(ti\014ers)300
3951 y(displa)m(y)m(ed)g(in)g(the)i(error)f(messages)h(issued)e(b)m(y)h
(the)g(library's)f(in)m(ternal)g(meta-programs:)443 4214
y Fk(lambda\(X\)[)45 b(Y)j(]\(1\))443 4401 y(//)f(issues)f(an)i(error)e
(containing)443 4588 y(//)191 b(YouCannotInvokeALambdaC)o(ont)o(aini)o
(ngFr)o(eeV)o(ars)443 4963 y(lambda\(X,F\)[)45 b(if0[F[X,0],0,plus])d
(]\(1,equal\))443 5151 y(//)47 b(issues)f(an)i(error)e(containing)443
5338 y(//)191 b(TrueAndFalseBranchOfIfM)o(ust)o(Have)o(Same)o(Typ)o(e)
2055 5700 y Fm(64)p eop
%%Page: 65 74
65 73 bop 300 91 a Fm(Unfortunately)-8 b(,)24 b(these)e(useful)f(iden)m
(ti\014ers)f(can)i(only)g(b)s(e)f(injected)h(in)m(to)g(the)g
(compiler's)f(error)h(messages)300 279 y(as)35 b(part)h(of)f(the)g
(compiler's)f(normal)h(templates)g(for)g(displa)m(ying)e(errors)h
(\(e.g.)57 b(\\no)36 b(metho)s(d)e(named)300 466 y Fk(Foo)p
Fm(")c(or)g(\\no)h(matc)m(h)g(for)f(call)g(to)h Fk(Foo\(Bar\))p
Fm("\),)e(whic)m(h)g(often)i(hinders)d(their)i(visibilit)m(y)-8
b(.)441 654 y(F)g(urthermore,)23 b(man)m(y)f(compilers)e(will)e(dump)i
(the)i(en)m(tire)f(\\template)h(instan)m(tiation)f(stac)m(k")i(\(whic)m
(h)300 841 y(e\013ectiv)m(ely)29 b(represen)m(ts)g(the)g(en)m(tire)f
(state)i(of)f(the)f(metaprogram\))i(as)f(part)f(of)h(the)g(error)f
(message.)41 b(As)300 1028 y(a)36 b(result,)h(a)f(single)e(error)i
(message)h(ma)m(y)f(b)s(e)g(literally)d Fi(mil)5 b(lions)44
b Fm(of)37 b(c)m(haracters)g(long.)57 b(F)-8 b(ortunately)g(,)300
1216 y(the)33 b(\\useful")g(p)s(ortion)e(of)j(the)f(message)h(\(the)g
(injected)e(iden)m(ti\014er\))g(alw)m(a)m(ys)i(app)s(ears)e(righ)m(t)h
(near)g(the)300 1403 y(b)s(eginning)j(or)j(righ)m(t)f(at)i(the)f(end)f
(of)h(the)g(error)g(message)h(\(dep)s(ending)d(on)h(the)i(particular)d
(t)m(yp)s(e)i(of)300 1591 y(error)33 b(and)g(on)h(whic)m(h)e(compiler)g
(is)g(used\).)50 b(As)34 b(a)g(result,)f(h)m(uge)h(compiler)e
(diagnostic)h(messages)i(can)300 1778 y(b)s(e)30 b(managed)h(with)e
(only)g(minor)g(sleuthing)f(w)m(ork)j(b)m(y)f(the)h(user.)441
1966 y(Ov)m(erall,)f(the)g(sp)s(ecial)f(static)i(analyses)f(and)g
(error)g(rep)s(orting)f(done)h(b)m(y)g(the)h(library)d(is)h(not)i
(ideal,)300 2153 y(but)22 b(it)h(is)f(adequate.)39 b(Man)m(y)23
b(t)m(yp)s(es)g(of)g(errors)g(are)g(automatically)g(detected)h(and)e
(rep)s(orted.)38 b(Though)21 b(it)300 2340 y(ma)m(y)k(tak)m(e)i(users)c
(a)i(little)f(extra)h(e\013ort)h(to)f(\014nd)e(and)h(in)m(terpret)g
(these)i(messages)f(within)d(the)j(con)m(text)i(of)300
2528 y(a)h(sup)s(er-v)m(erb)s(ose)f(compiler)g(diagnostic,)h(this)f(is)
g(far)h(preferable)f(to)i(the)f(alternativ)m(e:)40 b(a)29
b(non-w)m(orking)300 2715 y(program)h(with)f(no)h(information)f(ab)s
(out)h(either)g(the)h(lo)s(cation)f(or)g(the)h(nature)f(of)g(the)h
(error.)300 2955 y Fl(2.3.4)105 b(Lazy)36 b(lists:)46
b(ev)m(en)35 b(and)g(o)s(dd)300 3202 y Fm(In)g(this)f(section)h(w)m(e)h
(discuss)e(F)m(C++)h(lazy)g(lists)f(in)g(more)h(depth.)55
b(W)-8 b(e)37 b(fo)s(cus)d(on)h(the)h(un)m(usual)d(dual)300
3389 y(represen)m(tation)f(w)m(e)h(ha)m(v)m(e)g(for)f(lists|one)f(that)
h(exploits)f(C++)g(implicit)e(con)m(v)m(ersions)k(to)f(allo)m(w)g(lazy)
300 3576 y(lists)d(that)i(are)g(b)s(oth)e(e\016cien)m(t)i(and)f(easy)h
(to)g(use.)441 3764 y(As)f(w)m(e)h(sa)m(w)g(in)e(Section)h(2.2.1,)j(F)m
(C++)d(lazy)g(lists)f(can)i(b)s(e)f Fk(cons\(\))p Fm(ed)e(up)h(in)h
(the)g(usual)f(w)m(a)m(y:)443 4026 y Fk(List<int>)45
b(l)j(=)f(cons\(1,cons\(2,NIL\)\);)300 4288 y Fm(Ho)m(w)m(ev)m(er,)33
b(w)m(e)f(could)e(also)g(create)j(\\in\014nite")c(lists)h(with)f
(functions)h(lik)m(e)g Fk(enumFrom\(\))p Fm(;)e(for)j(example,)300
4476 y Fk(enumFrom\(1\))k Fm(returns)i(the)h(list)f(of)h(in)m(tegers)g
(1,)j(2,)f(3,)h(....)64 b(The)38 b(implemen)m(tation)f(of)h
Fk(enumFrom\(\))300 4663 y Fm(rev)m(eals)31 b(ho)m(w)f(this)f(is)h
(done:)443 4925 y Fk(struct)46 b(EnumFrom:public)e
(CFunType<int,List<int>)e(>)47 b({)586 5113 y(List<int>)f
(operator\(\)\()e(int)j(x)h(\))f(const)g({)730 5300 y(return)f
(cons\(x,)f(thunk1\()h(EnumFrom\(\),)f(x+1)i(\)\);)2055
5700 y Fm(65)p eop
%%Page: 66 75
66 74 bop 586 91 a Fk(})443 279 y(})48 b(enumFrom;)300
541 y Fm(Though)27 b(short,)h(the)g(function)f(b)s(o)s(dy)f(nev)m
(ertheless)i(requires)e(explanation)h(b)s(ecause)h(of)g(the)g(apparen)m
(t)300 728 y(inconsistency)i(in)g(the)i(use)f(of)g Fk(cons\(\))p
Fm(:)41 b(do)s(es)32 b Fk(cons\(\))d Fm(accept)k(as)f(its)f(second)g
(argumen)m(t)h(a)g(list,)e(or)i(a)300 916 y(th)m(unk)e(\(lik)m(e)g(the)
g(ab)s(o)m(v)m(e)i Fk(thunk1)c Fm(expression\))i(returning)e(a)j(list?)
441 1103 y(The)h(answ)m(er)f(is)g(that)i Fk(cons\(\))d
Fm(is)h(o)m(v)m(erloaded)i(to)g(accept)g(either)e(a)i(list)d(or)i(a)g
(list)f(th)m(unk.)45 b(As)32 b(will)300 1291 y(b)s(e)27
b(describ)s(ed)f(in)g(Section)i(2.5.2.2,)i(a)f Fk(List)d
Fm(is)h(represen)m(ted)g(as)h(a)g(kind)e(of)i(v)-5 b(arian)m(t)28
b(record,)g(whose)g(tail)300 1478 y(p)s(ortion)e(ma)m(y)i(either)f(b)s
(e)g(a)h(reference)g(to)g(the)f(rest)h(of)g(the)f(list,)g(or)h(an)f
(unev)-5 b(aluated)27 b(th)m(unk)f(whic)m(h)h(will)300
1665 y(pro)s(duce)i(the)i(remainder)e(list)g(on)h(demand.)441
1853 y(In)25 b(reference)i([68)q(],)g(it)f(is)e(p)s(oin)m(ted)h(out)h
(that)h(there)f(are)g(di\013eren)m(t)g(\\degrees)h(of)f(laziness".)38
b(Dep)s(end-)300 2040 y(ing)f(up)s(on)g(implemen)m(tation)g(c)m
(hoices,)k(w)m(e)e(ma)m(y)g(consider)e(a)i(lazy)f(stream)h(of)f(v)-5
b(alues)38 b(to)h(b)s(e)e(\\ev)m(en")300 2228 y(or)30
b(\\o)s(dd",)h(where)e(ev)m(en)i(streams)g(are)g(completely)f(lazy)-8
b(,)31 b(whereas)f(o)s(dd)f(streams)h(sometimes)h(exhibit)300
2415 y(a)39 b(little)f(to)s(o)i(m)m(uc)m(h)f(eagerness.)68
b(F)-8 b(or)40 b(example,)h(in)d(this)g(co)s(de)h(\(adapted)h(from)e
(the)i(main)e(running)300 2603 y(example)30 b(in)f([68)q(]\):)443
2865 y Fk(List<double>)45 b(l)i(=)h(cons\(1.0,cons\(0.0,cons\()o(-1.)o
(0,NI)o(L\)\)\))o(;)443 3052 y(l)g(=)f(take\()f(2,)i(map\()e(sqrt,)h(l)
g(\))h(\);)300 3314 y Fm(w)m(e)41 b(w)m(ould)f(exp)s(ect)i
Fk(l)e Fm(to)i(ha)m(v)m(e)g(the)f(\014nal)f(v)-5 b(alue)40
b Fk([1.0,0.0])p Fm(.)70 b(Ho)m(w)m(ev)m(er)43 b(this)d(will)e(only)i
(w)m(ork)h(for)300 3502 y(\\ev)m(en")31 b(lists;)e(an)g(\\o)s(dd")g
(list)g(will)e(ev)-5 b(aluate)30 b(one)g(elemen)m(t)g(to)s(o)g(far,)f
(and)g(end)g(up)g(trying)f(to)j(compute)300 3689 y Fk(sqrt\(-1.0\))j
Fm(and)j(fail.)59 b(The)37 b(details)f(of)h(the)h(di\013erences)e(b)s
(et)m(w)m(een)i(the)f(ev)m(en)h(and)e(o)s(dd)g(st)m(yles)i(are)300
3877 y(explicated)27 b(in)g(reference)h([68)r(].)40 b(\(As)28
b(w)m(e)g(shall)f(see,)i(F)m(C++)f(co)s(de)g(do)s(es)f(not)i(fail)d(in)
h(this)g(example;)h(our)300 4064 y(lists)h(are)i(not)f(o)m(v)m
(er-eager.\))441 4252 y(F)m(C++'s)f(lazy)h(lists)e(are)h(neither)g(ev)m
(en)h(nor)f(o)s(dd.)39 b(W)-8 b(e)31 b(ha)m(v)m(e)f(instead)f(c)m
(hosen)h(a)g(h)m(ybrid)d(approac)m(h)300 4439 y(that)i(w)m(orks)g(w)m
(ell)f(in)g(C++.)39 b(There)28 b(are)i(t)m(w)m(o)g(kinds)d(of)i(lists)e
(exp)s(osed)i(to)g(users)f(in)g(F)m(C++:)40 b Fk(List)28
b Fm(and)300 4626 y Fk(OddList)p Fm(.)42 b(The)31 b(former)g(is)f(\\ev)
m(en",)k(whereas)d(the)h(latter)g(is)e(\\o)s(dd".)44
b(An)31 b(imp)s(ortan)m(t)g(feature)h(is)e(that)300 4814
y Fi(the)k(two)i(kinds)e(of)g(lists)h(ar)-5 b(e)35 b(implicitly)g(c)-5
b(onvertible)35 b(to)f(one)h(another)p Fm(.)47 b(That)32
b(is,)g(an)g(o)s(dd)f(list)f(can)j(b)s(e)300 5001 y(used)28
b(where)h(an)f(ev)m(en)i(list)e(is)g(exp)s(ected)h(\(it)g(will)d(b)s(e)
i(automatically)h(wrapp)s(ed)e(in)m(to)i(a)g(th)m(unk\))g(and)f(an)300
5189 y(ev)m(en)j(list)e(can)i(b)s(e)e(used)h(where)g(an)g(o)s(dd)g
(list)f(is)g(exp)s(ected)i(\(it)f(will)e(b)s(e)h(automatically)i(un)m
(wrapp)s(ed\).)441 5376 y(The)42 b(t)m(w)m(o)i(list)e(t)m(yp)s(es)g(ha)
m(v)m(e)i(exactly)g(the)f(same)g(in)m(terface;)50 b(the)42
b(only)g(di\013erence)g(b)s(et)m(w)m(een)i(the)2055 5700
y(66)p eop
%%Page: 67 76
67 75 bop 300 91 a Fm(t)m(w)m(o)36 b(is)e(that)h Fk(OddList)p
Fm(s)d(are)j(alw)m(a)m(ys)h(eager)f(in)f(their)f(\014rst)h(elemen)m(t,)
j(whereas)d Fk(List)p Fm(s)f(are)i(not.)54 b(It)35 b(is)300
279 y(notew)m(orth)m(y)30 b(that)f(the)f(eagerness)h(of)g
Fk(OddList)p Fm(s)d(is)i(e\013ectiv)m(ely)h(limited)d(to)j(the)g
(\014rst)e(elemen)m(t;)j(taking)300 466 y(the)35 b Fk(tail\(\))e
Fm(of)i(an)g Fk(OddList)e Fm(returns)g(an)i(\(ev)m(en\))h
Fk(List)e Fm(as)h(a)g(result.)53 b(Most)36 b(functions)d(other)i(than)
300 654 y Fk(tail\(\))40 b Fm(that)j(pro)s(duce)d(list)h(v)-5
b(alues)41 b(\(e.g.)77 b Fk(cons\(\))p Fm(,)43 b Fk(enumFrom\(\))p
Fm(,)f(and)g Fk(map\(\))p Fm(\))f(actually)g(return)300
841 y Fk(OddList)p Fm(s,)29 b(and)g(not)i Fk(List)p Fm(s.)441
1028 y(This)25 b(ma)m(y)j(seem)f(an)g(a)m(wkw)m(ard)g(state)i(of)e
(a\013airs,)g(at)h(\014rst.)39 b(Ho)m(w)m(ev)m(er,)30
b(this)c(p)s(eculiar)f(implemen)m(ta-)300 1216 y(tion)32
b(o\013ers)h(an)g(in)m(teresting)f(b)s(ene\014t:)45 b(b)m(y)32
b(exp)s(osing)g(the)h(fact)g(that)h(some)f(list)e(elemen)m(ts)i(are)g
(already)300 1403 y(ev)-5 b(aluated)24 b(\()p Fk(OddList)p
Fm(s\))f(to)i(the)g(t)m(yp)s(e)f(system,)i(w)m(e)e(can)h(o)m(v)m
(erload)g(certain)f(core)h(functions)e(lik)m(e)h Fk(head\(\))300
1591 y Fm(to)35 b(tak)m(e)h(adv)-5 b(an)m(tage)36 b(of)f(this)e
(information|to)h(tak)m(e)h(the)g Fk(head\(\))e Fm(of)h(a)h
Fk(List)p Fm(,)f(w)m(e)h(m)m(ust)f(ev)-5 b(aluate)36
b(a)300 1778 y(th)m(unk)h(to)h(pro)s(duce)f(a)h(v)-5
b(alue)37 b(\()p Fi(after)48 b Fm(c)m(hec)m(king)38 b(to)h(see)f(if)e
(the)i(v)-5 b(alue)37 b(has)g(previously)f(b)s(een)h(cac)m(hed,)300
1966 y(as)32 b(discussed)d(in)h(Section)h(2.5.2.1\),)k(whereas)c(to)h
(tak)m(e)h(the)e Fk(head\(\))f Fm(of)h(an)g Fk(OddList)p
Fm(,)f(w)m(e)i(can)f(simply)300 2153 y(access)36 b(a)g(stored)f(v)-5
b(alue)35 b(directly)-8 b(,)36 b(whic)m(h)e(is)g(m)m(uc)m(h)h(more)g
(e\016cien)m(t.)56 b(Hence)36 b(the)f(separation)g(of)g(lists)300
2340 y(in)m(to)30 b(t)m(w)m(o)i(data)f(t)m(yp)s(es)g(can)f(impro)m(v)m
(e)g(the)h(run-time)e(p)s(erformance)h(of)g(list)f(co)s(de.)441
2528 y(This)h(p)s(erformance)h(b)s(ene\014t)f(comes)j(with)d(t)m(w)m(o)
j(p)s(oten)m(tial)d(costs.)45 b(First,)32 b(the)f(o)m(v)m(erall)h
(complexit)m(y)300 2715 y(of)f(the)g(F)m(C++)f(library)f(is)g
(increased)h(b)m(y)h(ha)m(ving)f(t)m(w)m(o)i(list)e(t)m(yp)s(es.)41
b(Second,)31 b(since)f Fk(OddList)p Fm(s)f(are)i(not)300
2903 y(completely)38 b(lazy)-8 b(,)42 b(there)c(is)g(danger)h(of)f(o)m
(v)m(er-eager)k(computation.)65 b(W)-8 b(e)40 b(address)e(eac)m(h)h
(concern)g(in)300 3090 y(turn:)436 3352 y Fh(\017)46
b Fi(Complexity)p Fm(.)69 b(While)38 b(the)h(in)m(ternal)f(complexit)m
(y)h(of)h(the)f(library)e(is)h(undoubtedly)f(increased)527
3540 y(due)h(to)g(the)h(list)d(dualit)m(y)-8 b(,)40 b(this)d(extra)h
(complexit)m(y)g(need)g(not)g(b)s(e)g(exp)s(osed)f(to)i(library)d
(users.)527 3727 y(Clien)m(ts)g(of)i(the)f(F)m(C++)g(library)e(can)i(b)
s(e)g(oblivious)d(of)k(the)f(existence)h(of)f Fk(OddList)p
Fm(s)e(and)i(get)527 3915 y(along)c(just)f(\014ne.)46
b(The)32 b(o)m(v)m(erloading)h(and)e(implicit)f(con)m(v)m(ersions)i
(with)g Fk(List)p Fm(s)f(enable)h(users)f(to)527 4102
y(write)i(w)m(orking)g(co)s(de)h(that)h(app)s(ears)e(to)h(deal)g
(solely)e(in)h Fk(List)p Fm(s.)50 b Fk(List)p Fm(s)32
b(e\013ectiv)m(ely)j(pro)m(vide)e(a)527 4290 y(facade)25
b(that)f(shields)d(casual)j(users)e(from)i(the)f(extra)i(complexit)m(y)
-8 b(.)38 b(Nev)m(ertheless,)26 b(for)e(users)e(who)527
4477 y(understand)33 b(the)j(details)e(of)h Fk(OddList)p
Fm(s,)g(the)g(datat)m(yp)s(e)h(is)e(there,)j(ready)e(to)g(b)s(e)g
(exploited)f(b)m(y)527 4664 y(clien)m(ts)20 b(who)g(w)m(an)m(t)h(to)g
(hand-tune)f(some)h(of)f(their)g(co)s(de)g(to)h(impro)m(v)m(e)g(the)f
(run-time)f(p)s(erformance.)436 4927 y Fh(\017)46 b Fi(Eagerness)p
Fm(.)40 b(Allo)m(wing)23 b(implicit)f(con)m(v)m(ersions)k(b)s(et)m(w)m
(een)f Fk(OddList)p Fm(s)e(and)i Fk(List)p Fm(s)f(sacri\014ces)h(some)
527 5114 y(of)33 b(the)h(safet)m(y)g(of)f(ev)m(en)h(lists.)47
b(Nev)m(ertheless,)35 b(while)c(the)i(danger)g(of)g(o)m(v)m
(er-eagerness)j(exists,)d(it)527 5301 y(liv)m(es)d(only)f(in)g(\\edge)j
(cases".)42 b(The)30 b(examples)g(from)g([68)q(],)h(lik)m(e)2055
5700 y(67)p eop
%%Page: 68 77
68 76 bop 670 91 a Fk(List<double>)45 b(l)i(=)h
(cons\(1.0,cons\(0.0,cons\(-)o(1.0)o(,NIL)o(\)\)\);)670
279 y(l)g(=)f(take\()g(2,)g(map\()g(sqrt,)f(l)h(\))h(\);)527
555 y Fm(w)m(ork)d(as)g(exp)s(ected,)j(ev)m(en)e(though)e
Fk(map)f Fm(returns)h(an)g Fk(OddList)p Fm(.)81 b(The)44
b(reason)h(is)e(that)i(our)527 743 y Fk(OddList)p Fm(s)29
b(ha)m(v)m(e)k(\\ev)m(en")g(tails)d(and)h Fk(tail)f Fm(is)g(the)h(only)
g(w)m(a)m(y)h(to)g(deconstruct)f(a)h(list)e(in)g(F)m(C++.)527
930 y(Only)f(direct)h(calls)f(on)i(b)s(oundary)d(cases)j(lik)m(e)670
1206 y Fk(List<double>)45 b(l)i(=)h(cons\(-1.0,NIL\);)670
1394 y(l)g(=)f(take\()g(0,)g(map\()g(sqrt,)f(l)h(\))h(\);)527
1670 y Fm(will)32 b(cause)j(a)f(failure)f(\()p Fk(map\(\))g
Fm(tries)g(to)i(tak)m(e)h(the)f(square)f(ro)s(ot)g(of)h(-1)f(b)s(efore)
g Fk(take\(\))f Fm(has)h(the)527 1858 y(opp)s(ortunit)m(y)i(to)j(men)m
(tion)e(that)i(it)e(is)g(not)h(in)m(terested)f(in)g(ev)-5
b(aluating)37 b(an)m(y)h(elemen)m(ts\).)64 b(Note)527
2045 y(that)36 b(it)f(is)f(only)h(when)f(the)i Fi(original)i(c)-5
b(al)5 b(l)38 b(in)f(the)h(client)44 b Fm(b)s(egins)33
b(with)h(the)i(\\edge)g(case")h(that)527 2233 y(the)i(problem)d(o)s
(ccurs|in)h(the)h(\014rst)g(of)g(the)h(t)m(w)m(o)g(previous)e
(examples,)j(the)e(same)h(b)s(oundary)527 2420 y(case)30
b(\(whic)m(h)d(fails)g(in)g(the)h(second)h(example\))f(is)g(reac)m(hed)
h(after)f(t)m(w)m(o)i(recursiv)m(e)e(calls,)g(but)g(since)527
2607 y(w)m(e)34 b(ha)m(v)m(e)g(already)e(mo)m(v)m(ed)i(past)f(the)g
(\014rst)f(elemen)m(t)h(of)g(the)g(list,)f(w)m(e)h(are)g(safely)g(in)e
(the)i(\\ev)m(en")527 2795 y(domain.)38 b(As)26 b(a)h(result,)e(the)i
(edge)f(cases)h(are)f(unlik)m(ely)e(to)i(o)s(ccur)g(in)f(practice.)39
b(When)26 b(necessary)-8 b(,)527 2982 y(the)35 b(clien)m(t)g(can)g(alw)
m(a)m(ys)g(resort)g(to)h(explicitly)c(forcing)i(the)h(\014rst)f(elemen)
m(t)i(to)f(b)s(e)f(lazy:)50 b(rather)527 3170 y(than)30
b(ev)-5 b(aluating)670 3446 y Fk(map\()47 b(sqrt,)f(l)i(\))527
3723 y Fm(\(the)38 b(o\013ending)f(expression)g(in)f(the)i(b)s(oundary)
d(case\),)41 b(whic)m(h)c(has)g(t)m(yp)s(e)h Fk(OddList)p
Fm(,)g(the)g(user)527 3910 y(can)31 b(ev)-5 b(aluate)670
4186 y Fk(thunk2\()46 b(map,)h(sqrt,)f(l)i(\))527 4463
y Fm(The)23 b(latter)g(expression)e(ev)-5 b(aluates)24
b(to)f(a)h(th)m(unk)e(that)h(returns)f(an)h Fk(OddList)p
Fm(,)f(whic)m(h)g(is)g(implicitly)527 4650 y(con)m(v)m(ertible)45
b(to)g(an)f(\(ev)m(en\))i Fk(List)p Fm(.)81 b(Indeed,)47
b(this)c(strategy)j(seems)f(w)m(ell)e(within)f(the)i(spirit)527
4838 y(of)h(C++;)51 b(C++)44 b(is)f(an)i(eager)g(language,)k(and)44
b(calling)f(a)i(function)f(is)f(an)i(eager)h(language)527
5025 y(mec)m(hanism,)30 b(whic)m(h)g(t)m(ypically)f(pro)s(duces)h(a)g
(v)-5 b(alue)31 b(\(or)f(an)h(e\013ect\).)43 b(In)30
b(those)h(cases)h(where)e(the)527 5213 y(programmer)20
b(desires)g(extra)h(laziness,)g(she)f(co)s(des)h(it)f(explicitly)e
(using)h Fk(thunkN\(\))p Fm(.)35 b(This)19 b(is,)i(after)527
5400 y(all,)30 b(ho)m(w)g(lazy)h(functions)d(lik)m(e)i
Fk(enumFrom\(\))e Fm(are)j(implemen)m(ted)d(\(with)i(calls)f(to)i
Fk(thunkN\(\))p Fm(\).)2055 5700 y(68)p eop
%%Page: 69 78
69 77 bop 441 91 a Fm(T)-8 b(o)42 b(summarize,)h(the)e(list)f(implemen)
m(tation)g(in)f(F)m(C++)i(uses)g(a)g(no)m(v)m(el)h(\\h)m(ybrid")e
(approac)m(h)h(to)300 279 y(laziness.)61 b(While)36 b(w)m(e)i(consider)
e(the)i(details)e(of)i(this)e(approac)m(h)i(to)g(b)s(e)f(in)m
(teresting)g(and)g(imp)s(ortan)m(t)300 466 y(from)21
b(an)g(implemen)m(tation)f(p)s(ersp)s(ectiv)m(e,)j(w)m(e)f(emphasize)f
(that)h(these)f(details)g(are)h(almost)f(nev)m(er)h(forced)300
654 y(up)s(on)k(clien)m(ts.)39 b(W)-8 b(e)28 b(ha)m(v)m(e)g(dozens)f
(of)h(example)e(programs)h(that)h(use)f(F)m(C++)g(lists)e(with)h(no)h
(kno)m(wledge)300 841 y(of)e(an)m(y)h(of)g(the)f(details)f(of)i
Fk(OddList)p Fm(s)d(or)i(edge)h(cases.)40 b(The)25 b(goal)h(of)g(this)e
(section)h(is)g(simply)d(to)27 b(describ)s(e)300 1028
y(our)i(implemen)m(tation)f(as)i(an)f(in)m(teresting)g(alternativ)m(e)g
(to)i(the)e(p)s(ossibilities)c(considered)j(in)g(reference)300
1216 y([68)q(].)300 1455 y Fl(2.3.5)105 b(Strict)35 b(lists)g(and)g(a)g
(generalized)g(list)g(in)m(terface)300 1701 y Fm(In)i(addition)f(to)j
(supp)s(orting)c(lazy)j(lists,)g(F)m(C++)g(also)g(supp)s(orts)e(eager)j
(lists)d(via)i(the)g Fk(StrictList)300 1888 y Fm(data)32
b(structure.)43 b(Both)31 b(strict)g(lists)f(and)h(lazy)g(lists)f(ha)m
(v)m(e)i(a)g(common)f(in)m(terface,)h(whic)m(h)e(means)h(that)300
2076 y(it)c(is)f(p)s(ossible)e(to)k(write)e(F)m(C++)h(functoids)e(whic)
m(h)h(are)h(p)s(olymorphic)e(with)g(resp)s(ect)i(to)h(the)f(eagerness)
300 2263 y(of)k(the)f(lists)f(they)i(manipulate.)441
2451 y(As)23 b(an)h(example,)g(consider)e(the)i(functoid)e
Fk(Map)p Fm(.)37 b(In)23 b(F)m(C++,)i(when)d Fk(map\(\))g
Fm(is)g(applied)f(to)j(a)g(lazy)f(list)300 2638 y(\()p
Fk(List)p Fm(\),)j(the)g(result)f(is)f(a)i(lazy)g(list,)f(whereas)h
(when)e(map\(\))i(is)f(applied)e(to)j(a)g(strict)g(list)e(\()p
Fk(StrictList)p Fm(\),)300 2826 y(the)31 b(result)e(is)g(a)i(strict)f
(list.)40 b(Here)30 b(is)g(the)g(co)s(de)h(for)f(the)h(b)s(o)s(dy)e(of)
h(the)h Fk(Map)e Fm(functoid:)443 3082 y Fk(template)46
b(<class)g(F,)h(class)f(L>)443 3269 y(typename)g(Sig<F,L>::result_type)
443 3457 y(operator\(\)\()f(const)h(F&)h(f,)h(const)e(L&)h(l)h(\))f
(const)f({)586 3644 y(if\()h(null\(l\))f(\))730 3832
y(return)g(NIL;)586 4019 y(else)730 4207 y(return)g(cons\()g
(f\(head\(l\)\),)f(thunk2\()h(Map\(\),)g(f,)h(tail\(l\))f(\))h(\);)443
4394 y(})300 4650 y Fm(Note)26 b(that)f(the)g(second)g(parameter)g(to)h
Fk(operator\(\))21 b Fm(is)j(just)g(a)h(template)h(argumen)m(t)f(\()p
Fk(L)p Fm(\).)g(As)g(a)g(result,)300 4838 y(an)m(y)j(data)h(t)m(yp)s(e)
f(whic)m(h)e(supp)s(orts)g(the)i(functions)e(used)h(in)g(the)h(b)s(o)s
(dy)e(of)i Fk(Map)f Fm(\()p Fk(null\(\))p Fm(,)g Fk(head\(\))p
Fm(,)g(etc.\))300 5025 y(can)k(b)s(e)e(passed)h(as)h(the)f(second)h
(argumen)m(t)g(to)g Fk(Map)p Fm(.)441 5213 y(All)38 b(list)h(data)h(t)m
(yp)s(es)f(need)h(to)g(supp)s(ort)e(a)i(common)g(set)g(of)g(op)s
(erations;)j(w)m(e)d(call)f(this)g(set)h(the)300 5400
y Fk(ListLike)31 b Fm(in)m(terface.)49 b(An)m(y)33 b(datat)m(yp)s(e)h
(whic)m(h)e(supp)s(orts)f(the)j Fk(ListLike)d Fm(in)m(terface)i(\(that)
h(is,)f(a)h(t)m(yp)s(e)2055 5700 y(69)p eop
%%Page: 70 79
70 78 bop 300 91 a Fm(that)37 b Fi(mo)-5 b(dels)45 b
Fm(the)36 b Fk(ListLike)e Fi(c)-5 b(onc)g(ept)p Fm(,)39
b(using)c(the)h(terminology)g(of)g(Section)g(2.3.2.2\))j(can)d(b)s(e)g
(used)300 279 y(with)28 b(F)m(C++)i(list)e(functoids)g(lik)m(e)h
Fk(Map)p Fm(,)g(whic)m(h)f(are)i(written)e(so)i(as)g(to)g(b)s(e)f(p)s
(olymorphic)e(with)h(resp)s(ect)300 466 y(to)i(an)m(y)g
Fk(ListLike)d Fm(data)k(t)m(yp)s(e.)40 b(F)m(C++)30 b(pro)m(vides)e
(three)i(data)g(t)m(yp)s(es)f(whic)m(h)g(supp)s(ort)e(the)j
Fk(ListLike)300 654 y Fm(in)m(terface:)61 b Fk(List)39
b Fm(and)g Fk(OddList)f Fm(\(the)j(ev)m(en)g(and)e(o)s(dd)g(v)m
(ersions)g(of)i(lazy)f(lists\),)h(and)f Fk(StrictList)300
841 y Fm(\(eager)31 b(lists\).)40 b(\(Section)29 b(4.1.4)j(describ)s
(es)27 b(some)j(of)g(the)g(details)f(of)g(the)h Fk(ListLike)d
Fm(in)m(terface)k(in)d(more)300 1028 y(detail.\))441
1216 y(Though)i(these)h(three)g(data)g(t)m(yp)s(es)g(ha)m(v)m(e)h(the)f
(same)g(in)m(terface,)g(they)g(ha)m(v)m(e)h(sligh)m(tly)d(di\013eren)m
(t)h(b)s(e-)300 1403 y(ha)m(viors)c(for)f(eac)m(h)j(op)s(eration.)38
b(F)-8 b(or)27 b(example,)g(taking)f(the)g Fk(head\(\))f
Fm(of)h(an)g Fk(OddList)e Fm(or)i(a)h Fk(StrictList)300
1591 y Fm(just)c(fetc)m(hes)i(a)g(\014eld)d(from)i(an)g(already-ev)-5
b(aluated)24 b(data)g(structure,)h(whereas)f(taking)g(the)g
Fk(head\(\))e Fm(of)j(a)300 1778 y Fk(List)i Fm(requires)f(\014rst)i
(ev)-5 b(aluating)27 b(a)i(th)m(unk.)39 b(As)28 b(a)g(more)g(in)m
(teresting)g(example)f(of)i(di\013ering)d(b)s(eha)m(vior,)300
1966 y(consider)j(the)i(last)f(line)f(of)h(the)h Fk(Map)e
Fm(functoid:)443 2228 y Fk(return)46 b(cons\()h(f\(head\(l\)\),)d
(thunk2\()i(Map\(\),)g(f,)h(tail\(l\))f(\))i(\);)300
2490 y Fm(When)22 b(the)h(t)m(w)m(o)g(argumen)m(ts)g(to)g
Fk(cons\(\))d Fm(are)j(a)g(v)-5 b(alue)21 b(and)h(a)h(th)m(unk,)g(and)f
Fk(cons\(\))f Fm(is)g(used)g(in)g(a)i(lazy)f(list)300
2677 y(con)m(text)30 b(\(that)g(is,)e Fk(l)g Fm(is)g(a)h
Fk(List)e Fm(or)i(and)f Fk(OddList)p Fm(\),)f(the)i(th)m(unk)f(gets)h
(stored)g(as)f(the)h(y)m(et-unev)-5 b(aluated)300 2865
y(\\tail")32 b(p)s(ortion)f(of)h(the)h(list)e(\(as)h(describ)s(ed)f(in)
f(Section)i(2.3.4\).)49 b(But)32 b(when)f(this)g(same)i(expression)e
(is)300 3052 y(ev)-5 b(aluated)26 b(in)e(a)i(strict)f(list)f(con)m
(text)j(\()p Fk(l)f Fm(is)e(a)i Fk(StrictList)p Fm(\),)e
Fk(cons\(\))g Fm(b)s(eha)m(v)m(es)i(di\013eren)m(tly)-8
b(,)25 b(ev)-5 b(aluating)300 3240 y(the)31 b(th)m(unk)e(immediately)-8
b(.)40 b(As)30 b(a)h(result,)e(the)i(co)s(de)443 3502
y Fk(map\()47 b(some_func,)e(some_strict_list)e(\))300
3764 y Fm(results)30 b(in)g(a)i(new)f Fk(StrictList)e
Fm(where)i Fk(some_func)e Fm(has)i(b)s(een)g(\(eagerly\))h(applied)e
(to)i(eac)m(h)g(elemen)m(t)300 3951 y(of)f Fk(some_strict_list)p
Fm(.)441 4139 y(T)-8 b(o)32 b(sum)f(up:)43 b(F)m(C++)31
b(con)m(tains)h(data)h(t)m(yp)s(es)f(for)f(b)s(oth)g(lazy)h(lists)e
(and)h(strict)h(lists.)43 b(These)32 b(t)m(yp)s(es)300
4326 y(supp)s(ort)26 b(a)h(common)h Fk(ListLike)d Fm(in)m(terface,)k
(so)e(that)h(list-manipulating)c(functions)h(\(lik)m(e)i
Fk(map\(\))p Fm(\))g(can)300 4514 y(b)s(e)j(written)g(so)i(they)f(are)g
(p)s(olymorphic)d(with)i(resp)s(ect)h(to)h(the)f(eagerness)h(of)f(the)g
(list.)42 b(Th)m(us,)30 b(F)m(C++)300 4701 y(list)38
b(functoids)f(can)i(b)s(eha)m(v)m(e)h(either)e(lazily)f(of)j(eagerly)-8
b(,)42 b(dep)s(ending)36 b(on)j(the)g(data)h(t)m(yp)s(e)f(argumen)m(ts)
300 4889 y(they)31 b(are)h(passed.)43 b(As)31 b(a)h(result,)f(clien)m
(ts)g(of)g(the)h(F)m(C++)f(library)e(ma)m(y)i(c)m(ho)s(ose)i(to)f(use)f
(either)g(lazy)g(or)300 5076 y(eager)h(ev)-5 b(aluation,)30
b(dep)s(ending)e(on)i(their)f(particular)g(needs.)2055
5700 y(70)p eop
%%Page: 71 80
71 79 bop 300 91 a Fj(2.4)140 b(Applic)-7 b(ations)300
337 y Fm(In)38 b(this)g(section)g(w)m(e)i(describ)s(e)d(a)i(n)m(um)m(b)
s(er)e(of)i(useful)e(applications)g(of)i(F)m(C++.)65
b(First)38 b(w)m(e)i(describ)s(e)300 525 y(ho)m(w)32
b(higher-order)e(functions)g(can)h(b)s(e)g(applied)f(to)i(a)g(n)m(um)m
(b)s(er)e(of)i(ob)5 b(ject-orien)m(ted)32 b(design)f(patterns.)300
712 y(Next)j(w)m(e)f(discuss)f(ho)m(w)h(parametric)f(p)s(olymorphism)e
(a\013ects)k(a)g(n)m(um)m(b)s(er)d(of)i(other)h(design)e(patterns.)300
900 y(Finally)25 b(w)m(e)j(men)m(tion)g(examples)f(of)g(the)h(utilit)m
(y)e(of)h(the)h(library)d(b)s(oth)i(\\in)g(the)g(small")g(\(where)g(F)m
(C++)300 1087 y(simpli\014es)40 b(expressions)h(of)j(just)e(one)i(or)f
(t)m(w)m(o)h(lines)e(of)h(co)s(de\))h(and)e(\\in)g(the)i(large")f
(\(other)h(en)m(tire)300 1275 y(libraries)27 b(built)i(atop)i(the)f(F)m
(C++)g(infrastructure\).)300 1515 y Fl(2.4.1)105 b(Higher-order)36
b(functions)f(and)g(design)h(patterns)300 1761 y Fm(F)-8
b(unctional)41 b(programming)f(promotes)h(iden)m(tifying)e(pieces)i(of)
h(functionalit)m(y)d(as)j(just)e(\\functions")300 1948
y(and)i(manipulating)e(them)j(using)e(higher-order)h(op)s(erations)g
(on)g(functions.)77 b(These)42 b(higher-order)300 2136
y(functions)34 b(ma)m(y)i(b)s(e)f(sp)s(eci\014c)f(to)i(the)g(domain)e
(of)i(the)f(application)f(or)h(they)h(ma)m(y)g(b)s(e)f(quite)g
(general,)300 2323 y(lik)m(e)41 b(the)i(currying)d(and)h(function)g
(comp)s(osition)g(op)s(erations)g(are.)76 b(Sev)m(eral)43
b(design)e(patterns)h([23)q(])300 2511 y(follo)m(w)25
b(a)i(similar)c(approac)m(h)k(through)e(the)i(use)f(of)g
Fi(subtyp)-5 b(e)29 b(p)-5 b(olymorphism)p Fm(.)44 b(Subt)m(yp)s(e)25
b(p)s(olymorphism)300 2698 y(allo)m(ws)i(co)s(de)i(that)g(op)s(erates)f
(on)g(a)h(certain)f(class)g(or)g(in)m(terface)g(to)h(also)f(w)m(ork)h
(with)e(sp)s(ecializations)f(of)300 2885 y(the)32 b(class)g(or)h(in)m
(terface.)47 b(This)30 b(is)i(analogous)g(to)h(higher-order)e
(functions:)43 b(the)33 b(holder)d(of)j(an)f(ob)5 b(ject)300
3073 y(reference)38 b(ma)m(y)g(express)f(a)h(generic)g(algorithm)e
(whic)m(h)h(is)f(sp)s(ecialized)g(dynamically)f(based)i(on)h(the)300
3260 y(v)-5 b(alue)35 b(of)g(the)h(reference.)56 b(Encapsulating)33
b(functionalit)m(y)h(and)g(data)i(as)g(an)f(ob)5 b(ject)36
b(is)f(analogous)g(to)300 3448 y(direct)e(function)g(manipulation.)48
b(Other)33 b(co)s(de)h(can)g(op)s(erate)h(abstractly)f(on)g(the)g(ob)5
b(ject's)34 b(in)m(terface)300 3635 y(\(e.g.,)e(to)f(adapt)g(it)f(b)m
(y)g(creating)h(a)g(wrapp)s(er)d(ob)5 b(ject\).)441 3823
y(It)26 b(has)g(long)f(b)s(een)h(iden)m(ti\014ed)e(that)i(functional)e
(tec)m(hniques)i(can)g(b)s(e)f(used)h(in)e(the)i(implemen)m(tation)300
4010 y(of)32 b(design)f(patterns.)46 b(F)-8 b(or)33 b(instance,)g(the)f
(Visitor)f(pattern)h(is)f(often)i(considered)e(a)h(w)m(a)m(y)h(to)g
(program)300 4197 y(functionally)39 b(in)i(OO)g(languages.)76
b(\(The)41 b(in)m(terested)h(reader)g(should)e(see)i(Reference)h([43)q
(])f(and)g(its)300 4385 y(references)33 b(for)f(a)g(discussion)e(of)i
(Visitor.\))46 b(The)32 b(Smalltalk)e(class)i Fk(MessageSend)d
Fm(\(and)j(its)g(v)-5 b(arian)m(ts,)300 4572 y(see)36
b(Reference)g([3)q(],)h(p.254\),)h(the)d(C++)g(Standard)f(Library)f
(functors,)j(Alexandrescu's)f(framew)m(ork)300 4760 y(\(Reference)i([2)
q(],)h(Ch.)57 b(5\),)39 b(etc.,)g(are)d(all)f(trying)h(to)h(capture)f
(the)g(generic)g(concept)h(of)g(a)f(\\function")300 4947
y(and)j(use)g(it)g(in)f(the)i(implemen)m(tation)e(of)h(the)h(Command)e
(or)i(Observ)m(er)f(pattern.)68 b(In)38 b(this)h(section)300
5135 y(w)m(e)29 b(will)d(brie\015y)h(review)h(some)h(of)g(these)h(w)m
(ell-kno)m(wn)d(tec)m(hniques,)i(from)f(the)h(F)m(C++)g(standp)s(oin)m
(t,)f(b)m(y)300 5322 y(using)d(indirect)f(functoids.)38
b(In)25 b(Section)h(2.4.2)h(w)m(e)g(will)c(consider)i(ho)m(w)h(the)h
(unique)d(features)i(of)g(F)m(C++)2055 5700 y(71)p eop
%%Page: 72 81
72 80 bop 300 91 a Fm(enable)30 b(some)h(no)m(v)m(el)f(implemen)m
(tations)f(of)i(other)f(patterns.)441 279 y Fl(Command.)55
b Fm(The)35 b(Command)g(pattern)h(turns)f(requests)g(in)m(to)h(ob)5
b(jects,)38 b(so)f(that)f(the)g(requests)300 466 y(can)e(b)s(e)f
(passed,)i(stored,)g(queued,)f(and)f(pro)s(cessed)g(b)m(y)h(an)g(ob)5
b(ject)35 b(whic)m(h)d(kno)m(ws)i(nothing)e(of)i(either)300
654 y(the)g(action)g(or)g(the)g(receiv)m(er)g(of)g(the)g(action.)51
b(An)33 b(example)h(application)e(of)i(the)g(pattern)f(is)g(a)h(men)m
(u)300 841 y(widget.)51 b(A)35 b(pull-do)m(wn)c(men)m(u,)k(for)f
(instance,)h(m)m(ust)f(\\do)g(something")g(when)f(an)h(option)f(is)h
(clic)m(k)m(ed;)300 1028 y Fi(Command)41 b Fm(em)m(b)s(o)s(dies)27
b(the)j(\\something".)40 b(Command)29 b(ob)5 b(jects)29
b(supp)s(ort)f(a)h(single)f(metho)s(d,)h(usually)300
1216 y(called)37 b Fk(execute)p Fm(.)62 b(An)m(y)39 b(state)g(on)f
(whic)m(h)f(the)h(metho)s(d)g(op)s(erates)h(needs)e(to)i(b)s(e)f
(captured)g(inside)e(a)300 1403 y(command)30 b(ob)5 b(ject.)441
1591 y(The)32 b(motiv)-5 b(ation)31 b(for)h(using)e(the)j(Command)e
(pattern)h(is)f(t)m(w)m(ofold.)46 b(First,)32 b(holders)e(of)i(command)
300 1778 y(ob)5 b(jects)32 b(\(e.g.,)i(men)m(u)d(widgets\))h(are)g
(oblivious)d(to)j(the)g(exact)h(functionalit)m(y)d(of)i(these)g(ob)5
b(jects.)45 b(This)300 1966 y(decoupling)20 b(mak)m(es)i(the)g(widgets)
f(reusable)g(and)g(con\014gurable)f(dynamically)g(\(e.g.,)25
b(to)e(create)g(con)m(text-)300 2153 y(sensitiv)m(e)44
b(graphical)g(men)m(us\).)84 b(Second,)48 b(the)d(commands)f(themselv)m
(es)h(are)h(decoupled)d(from)i(the)300 2340 y(application)26
b(in)m(terface)j(and)e(can)h(b)s(e)f(reused)h(in)e(di\013eren)m(t)i
(situations)e(\(e.g.,)31 b(the)d(same)g(command)g(can)300
2528 y(b)s(e)i(executed)h(from)f(b)s(oth)g(a)g(pull-do)m(wn)e(men)m(u)i
(and)g(a)g(to)s(olbar\).)441 2715 y(Here)i(is)e(a)h(brief)f(example)g
(whic)m(h)g(illustrates)f(ho)m(w)i(Command)f(migh)m(t)h(b)s(e)g(emplo)m
(y)m(ed)g(in)f(a)h(w)m(ord-)300 2903 y(pro)s(cessing)e(application:)443
3151 y Fk(class)47 b(Command)e({)443 3338 y(public:)586
3526 y(virtual)h(void)h(execute\(\)=0;)443 3713 y(};)443
4088 y(class)g(CutCommand)e(:)i(public)f(Command)g({)586
4275 y(Document*)g(d;)443 4463 y(public:)586 4650 y
(CutCommand\(Document*)d(dd\))k(:)g(d\(dd\))f({})586
4838 y(void)h(execute\(\))e({)j(d->cut\(\);)d(})443 5025
y(};)443 5400 y(class)i(PasteCommand)d(:)j(public)g(Command)e({)2055
5700 y Fm(72)p eop
%%Page: 73 82
73 81 bop 586 91 a Fk(Document*)46 b(d;)443 279 y(public:)586
466 y(PasteCommand\(Document*)c(dd\))47 b(:)g(d\(dd\))g({})586
654 y(void)g(execute\(\))e({)j(d->paste\(\);)c(})443
841 y(};)443 1216 y(Document)i(d;)443 1403 y(...)443
1591 y(Command*)g(menu_actions[])e(=)j({)586 1778 y(new)g
(CutCommand\(&d\),)586 1966 y(new)g(PasteCommand\(&d\),)586
2153 y(...)443 2340 y(};)443 2528 y(...)443 2715 y
(menu_actions[choice]->exe)o(cute)o(\(\);)300 2978 y
Fm(The)42 b(abstract)h Fk(Command)d Fm(class)i(exists)f(only)h(to)g
(de\014ne)g(the)g(in)m(terface)h(for)f(executing)g(commands.)300
3165 y(F)-8 b(urthermore,)32 b(the)f Fk(execute\(\))e
Fm(in)m(terface)j(is)e(just)h(a)h(call)e(with)g(no)i(argumen)m(ts)f(or)
h(results.)42 b(In)31 b(other)300 3352 y(w)m(ords,)23
b(the)e(whole)g(command)g(pattern)g(simply)e(represen)m(ts)i(a)h
(\\function)e(ob)5 b(ject".)39 b(F)-8 b(rom)22 b(a)g(functional)300
3540 y(programmer's)29 b(p)s(ersp)s(ectiv)m(e,)g Fk(Command)f
Fm(is)h(just)g(a)h(class)f(wrapp)s(er)f(for)h(a)h(\\lam)m(b)s(da")f(or)
h(\\th)m(unk"|an)300 3727 y(ob)5 b(ject-orien)m(ted)39
b(coun)m(terpart)g(of)f(a)g(functional)e(idiom.)62 b(Indirect)37
b(functoids)f(in)h(F)m(C++)h(represen)m(t)300 3915 y(suc)m(h)26
b(function-ob)5 b(jects)26 b(naturally:)36 b(a)27 b Fk(Fun0<void>)c
Fm(can)j(b)s(e)g(used)f(to)i(ob)m(viate)g(the)f(need)g(for)f(b)s(oth)h
(the)300 4102 y(abstract)31 b Fk(Command)e Fm(class)h(and)g(its)f
(concrete)j(sub)s(classes:)443 4364 y Fk(Document)46
b(d;)443 4552 y(...)443 4739 y(Fun0<void>)f(menu_actions[])f(=)k({)586
4927 y(thunk1\(ptr_to_fun\(&Documen)o(t::)o(cut\))o(,)42
b(&d\),)586 5114 y(thunk1\(ptr_to_fun\(&Documen)o(t::)o(past)o(e\),)f
(&d\),)586 5301 y(...)2055 5700 y Fm(73)p eop
%%Page: 74 83
74 82 bop 443 91 a Fk(};)443 279 y(...)443 466 y
(menu_actions[choice]\(\);)300 728 y Fm(In)41 b(this)f(last)i(co)s(de)f
(fragmen)m(t,)k(all)c(of)h(the)f(classes)h(that)g(comprised)e(the)i
(original)d(design)i(pattern)300 916 y(implemen)m(tation)33
b(ha)m(v)m(e)k(disapp)s(eared!)52 b Fk(Fun0<void>)32
b Fm(de\014nes)i(a)h(natural)f(in)m(terface)h(for)g(commands,)300
1103 y(and)i(the)g(concrete)i(instances)e(can)g(b)s(e)g(created)h
(on-the-\015y)g(b)m(y)f(making)g(indirect)e(functoids)h(out)i(of)300
1291 y(the)31 b(appropriate)e(functionalit)m(y)-8 b(,)29
b(currying)g(argumen)m(ts)i(when)e(necessary)-8 b(.)441
1478 y(The)23 b(previous)f(example)h(tak)m(es)i(adv)-5
b(an)m(tage)25 b(of)e(the)h(fact)g(that)g Fk(ptr_to_fun)c
Fm(can)k(b)s(e)f(used)f(to)i(create)300 1665 y(functoids)42
b(out)h(of)h(all)e(kinds)f(of)j(function-lik)m(e)d(C++)h(en)m(tities.)
80 b(This)41 b(includes)g(C++)h(functions,)300 1853 y(instance)31
b(metho)s(ds)h(\(whic)m(h)e(are)j(transformed)e(in)m(to)g(normal)g
(functions)f(that)j(tak)m(e)g(a)f(p)s(oin)m(ter)f(to)i(the)300
2040 y(receiv)m(er)23 b(ob)5 b(ject)870 2007 y Fg(7)933
2040 y Fm(as)23 b(an)f(extra)i(\014rst)d(argumen)m(t|as)j(in)d(the)i
(example\),)h(class)e(\(static\))i(metho)s(ds,)g(C++)300
2228 y(Standard)29 b(Library)f Fk(<functional>)f Fm(ob)5
b(jects,)31 b(etc.)42 b(This)28 b(is)i(an)g(example)f(of)i(design)e
(inspired)e(b)m(y)j(the)300 2415 y(functional)j(paradigm:)47
b(m)m(ultiple)32 b(distinct)h(en)m(tities)h(are)g(uni\014ed)e(as)j
(functions.)51 b(The)34 b(adv)-5 b(an)m(tage)36 b(of)300
2603 y(the)28 b(uni\014cation)e(is)h(that)h(all)f(suc)m(h)h(en)m
(tities)f(can)i(b)s(e)e(manipulated)f(using)g(the)i(same)g(tec)m
(hniques,)h(b)s(oth)300 2790 y(application-sp)s(eci\014c)f(and)i
(generic.)441 2978 y Fl(Observ)m(er.)73 b Fm(The)41 b(Observ)m(er)g
(pattern)g(is)g(used)f(to)i(register)f(related)h(ob)5
b(jects)42 b(dynamically)d(so)300 3165 y(that)e(they)f(can)h(b)s(e)e
(noti\014ed)g(when)h(another)g(ob)5 b(ject's)37 b(state)h(c)m(hanges.)
59 b(The)36 b(main)f(participan)m(ts)g(of)300 3352 y(the)g(pattern)g
(are)g(a)h Fi(Subje)-5 b(ct)43 b Fm(and)34 b(m)m(ultiple)f
Fi(Observers)p Fm(.)54 b(Observ)m(ers)34 b(register)h(with)e(the)i(sub)
5 b(ject)35 b(b)m(y)300 3540 y(calling)f(one)h(of)g(its)f(metho)s(ds)h
(\(with)f(the)h(con)m(v)m(en)m(tional)h(name)f Fk(attach)p
Fm(\))f(and)g(un-register)g(similarly)300 3727 y(\(via)e
Fk(detach)p Fm(\).)44 b(The)32 b(sub)5 b(ject)31 b(noti\014es)g(observ)
m(ers)i(of)f(c)m(hanges)h(in)d(its)i(state,)i(b)m(y)d(calling)g(an)h
(observ)m(er)300 3915 y(metho)s(d)e(\()p Fk(update)p
Fm(\).)441 4102 y(The)35 b(implemen)m(tation)e(of)i(the)h(observ)m(er)f
(pattern)g(con)m(tains)g(an)g(abstract)h Fk(Observer)d
Fm(class)h(that)300 4290 y(all)h(concrete)i(observ)m(er)f(classes)g
(inherit.)56 b(This)34 b(in)m(terface)i(has)g(only)f(the)h
Fk(update)f Fm(metho)s(d,)i(making)300 4477 y(it)d(similar)e(to)j(just)
f(a)h(single)e(function,)i(used)f(as)g(a)h(callbac)m(k.)54
b(In)33 b(fact,)k(the)e(implemen)m(tation)e(of)i(the)300
4664 y(Observ)m(er)j(pattern)h(can)f(b)s(e)g(view)m(ed)g(as)h(a)g(sp)s
(ecial)e(case)i(of)g(the)g(Command)e(pattern.)65 b(Calling)37
b(the)300 4852 y Fk(execute)31 b Fm(metho)s(d)i(of)h(the)f(command)g
(ob)5 b(ject)35 b(is)d(analogous)i(to)g(calling)e(the)h
Fk(update)f Fm(metho)s(d)h(of)g(an)300 5039 y(observ)m(er)e(ob)5
b(ject.)p 300 5176 1440 4 v 404 5230 a Ff(7)438 5261
y Fe(Or)24 b(a)g(p)r(oin)n(ter)g(to)g(a)g Fd(const)h
Fe(receiv)n(er)f(ob)t(ject,)h(if)g(the)e(metho)r(d)g(itself)i(w)n(as)f
Fd(const)p Fe(.)35 b(The)24 b(F)n(C++)g(library)g(striv)n(es)g(to)g(b)r
(e)300 5353 y Fd(const)p Fe(-correct.)2055 5700 y Fm(74)p
eop
%%Page: 75 84
75 83 bop 441 91 a Fm(The)34 b(F)m(C++)g(solution)f(strategy)i(for)f
(the)h(Observ)m(er)f(pattern)g(is)f(exactly)i(the)g(same)f(as)h(in)e
(Com-)300 279 y(mand.)51 b(The)34 b(Sub)5 b(ject)33 b(no)h(longer)g
(cares)h(ab)s(out)e(the)i(t)m(yp)s(e)f(of)g(its)g(receiv)m(ers)g
(\(i.e.,)i(whether)d(they)i(are)300 466 y(subt)m(yp)s(es)c(of)h(an)f
(abstract)i Fk(Observer)d Fm(class\).)45 b(Instead,)32
b(the)g(in)m(teresting)f(asp)s(ect)i(of)f(the)g(receiv)m(ers|)300
654 y(their)e(abilit)m(y)f(to)i(receiv)m(e)g(up)s(dates|is)e
(encapsulated)h(as)h(a)g Fk(Fun0<void>)p Fm(.)39 b(The)30
b(abstract)h Fk(Observer)300 841 y Fm(class)i(disapp)s(ears.)49
b(The)33 b(concrete)i(observ)m(ers)f(simply)d(register)j(themselv)m(es)
g(with)e(the)i(sub)5 b(ject.)51 b(W)-8 b(e)300 1028 y(will)23
b(not)j(sho)m(w)g(the)g(complete)h(co)s(de)f(sk)m(eletons)g(for)g(the)g
(Observ)m(er)f(pattern,)i(as)f(they)g(are)h(just)e(sp)s(ecial-)300
1216 y(izations)f(of)g(the)g(co)s(de)g(for)g(Command.)38
b(Nev)m(ertheless,)26 b(one)e(asp)s(ect)h(is)e(w)m(orth)h(emphasizing.)
37 b(Consider)300 1403 y(the)31 b(co)s(de)f(b)s(elo)m(w)g(for)g(a)h
(concrete)g(observ)m(er:)443 1665 y Fk(class)47 b(ConcreteObserver)c({)
586 1853 y(ConcreteSubject&)h(subject;)443 2040 y(public:)586
2228 y(ConcreteObserver\()f(ConcreteSubject&)h(s)j(\))h(:)f
(subject\(s\))e({)730 2415 y(s.attach\()873 2603 y
(thunk1\(ptr_to_fun\(&Conc)o(rete)o(Obse)o(rve)o(r::b)o(e_no)o(tif)o
(ied\))o(,thi)o(s\))c(\);)586 2790 y(})586 2978 y(void)47
b(be_notified\(\))d({)730 3165 y(cout)i(<<)h("new)g(state)f(is")h(<<)g
(subject.get_state\(\))c(<<)k(endl;)586 3352 y(})443
3540 y(};)300 3802 y Fm(Note)32 b(again)e(ho)m(w)h Fk(ptr_to_fun)d
Fm(is)h(used)h(to)h(create)h(a)f(direct)f(functoid)f(out)i(of)g(an)f
(instance)g(metho)s(d.)300 3989 y(The)g(resulting)e(functoid)h(tak)m
(es)j(the)f(receiv)m(er)g(as)f(its)g(\014rst)g(parameter.)41
b Fk(curry)29 b Fm(is)g(then)i(used)e(to)i(bind)300 4177
y(this)41 b(parameter.)75 b(This)40 b(approac)m(h)j(frees)e(observ)m
(ers)h(from)g(needing)e(to)j(conform)f(to)g(a)h(particular)300
4364 y(in)m(terface.)65 b(F)-8 b(or)39 b(instance,)h(the)e(ab)s(o)m(v)m
(e)i(concrete)f(observ)m(er)g(implemen)m(ts)d Fk(be_notified)f
Fm(instead)j(of)300 4552 y(the)d(standard)g Fk(update)e
Fm(metho)s(d,)k(but)d(it)h(still)e(w)m(orks.)56 b(Indeed,)35
b(w)m(e)h(can)g(turn)e(an)h(arbitrary)f(ob)5 b(ject)300
4739 y(in)m(to)37 b(an)g(observ)m(er)h(simply)c(b)m(y)k(making)e(a)i
(functoid)e(out)h(of)g(one)h(of)f(its)g(metho)s(d)g(calls|the)f(ob)5
b(ject)300 4927 y(need)31 b(not)g(ev)m(en)g(b)s(e)f(a)m(w)m(are)i(that)
g(it)e(is)g(participating)f(in)g(the)i(pattern.)42 b(This)29
b(decoupling)g(is)h(ac)m(hiev)m(ed)300 5114 y(b)m(y)g(capturing)g(the)g
(natural)g(abstraction)g(of)h(the)f(domain:)40 b(the)30
b(function)f(ob)5 b(ject.)441 5301 y(Summarizing,)52
b(the)d(reason)h(that)g Fk(Fun0<void>)c Fm(can)k(replace)f(the)g
(abstract)i Fk(Observer)c Fm(and)2055 5700 y(75)p eop
%%Page: 76 85
76 84 bop 300 91 a Fk(Command)33 b Fm(classes)i(is)f(b)s(ecause)g
(these)i(classes)f(serv)m(e)g(no)g(purp)s(ose)e(other)i(than)g(to)g
(create)h(a)g(common)300 279 y(in)m(teface)29 b(to)g(a)g(function)e
(call.)39 b(In)27 b Fk(Command)p Fm(,)g(the)i(metho)s(d)e(is)g(named)h
Fk(execute\(\))p Fm(,)e(and)i(in)f Fk(Observer)p Fm(,)300
466 y(it)36 b(is)f(called)g Fk(update\(\))p Fm(,)g(but)g(the)i(names)e
(of)i(the)f(metho)s(ds)f(and)g(classes)h(are)h(really)e(immaterial)f
(to)300 654 y(the)g(pattern.)49 b(Indirect)33 b(functoids)f(in)g(F)m
(C++)h(remo)m(v)m(e)i(the)e(need)g(for)h(these)f(classes,)i(metho)s
(ds,)f(and)300 841 y(names,)42 b(b)m(y)e(instead)f(represen)m(ting)g
(the)h(core)g(of)g(the)g(in)m(terface:)60 b(a)40 b(function)e(call)h
(whic)m(h)g(tak)m(es)i(no)300 1028 y(argumen)m(t)31 b(and)f(returns)f
(nothing.)441 1216 y(C++'s)j(parameterization)g(mec)m(hanism)g(lets)g
(us)f(extend)i(this)e(notion)g(to)i(functions)e(whic)m(h)g(tak)m(e)300
1403 y(argumen)m(ts)37 b(and)e(return)h(v)-5 b(alues.)58
b(F)-8 b(or)37 b(example,)h(consider)d(an)i(observ)m(er-lik)m(e)f
(scenario,)i(where)e(the)300 1591 y(noti\014er)h(passes)h(a)h(v)-5
b(alue)38 b(\(for)g(instance,)i(a)f(string\))f(to)h(the)f(observ)m
(er's)h Fk(update)d Fm(metho)s(d,)k(and)e(the)300 1778
y Fk(update)e Fm(returns)g(a)i(v)-5 b(alue)37 b(\(sa)m(y)-8
b(,)41 b(an)d(in)m(teger\).)63 b(This)36 b(can)i(b)s(e)e(solv)m(ed)i
(using)e(the)i(same)g(strategy)h(as)300 1966 y(b)s(efore,)h(but)e
(using)e(a)j Fk(Fun1<string,int>)34 b Fm(instead)j(of)i(a)g
Fk(Fun0<void>)p Fm(.)61 b(Again,)41 b(the)d(k)m(ey)h(is)e(that)300
2153 y(the)29 b(in)m(terface)h(b)s(et)m(w)m(een)f(the)h(participan)m
(ts)e(in)f(the)j(patterns)f(is)f(adequately)h(represen)m(ted)g(b)m(y)g
(a)g(single)300 2340 y(function)22 b(signature)1014 2308
y Fg(8)1053 2340 y Fm(;)k(extra)f(classes)e(and)g(metho)s(ds)g(\(with)g
(\014xed)g(names\))h(are)g(unnecessary)f(to)h(realize)300
2528 y(a)31 b(solution.)441 2715 y Fl(Virtual)j(Pro)m(xy)-9
b(.)42 b Fm(The)29 b(Virtual)f(Pro)m(xy)i(pattern)g(seeks)g(to)h(put)e
(o\013)h(exp)s(ensiv)m(e)f(op)s(erations)g(un)m(til)300
2903 y(they)44 b(are)h(actually)f(needed.)82 b(F)-8 b(or)45
b(example,)i(a)e(w)m(ord-pro)s(cessor)f(ma)m(y)h(load)f(a)g(do)s(cumen)
m(t)g(whic)m(h)300 3090 y(con)m(tains)h(a)g(n)m(um)m(b)s(er)f(of)h
(images.)84 b(Since)44 b(man)m(y)h(of)g(these)g(images)g(will)d(reside)
i(on)g(pages)i(of)f(the)300 3278 y(do)s(cumen)m(t)27
b(that)h(are)g(o\013-screen,)h(it)e(is)f(not)i(necessary)f(to)h
(actually)f(load)g(the)h(en)m(tire)f(image)h(from)e(disk)300
3465 y(and)35 b(render)g(it)g(unless)f(the)i(user)f(of)h(the)f
(application)f(actually)i(scrolls)e(to)i(one)g(of)g(those)g(pages.)58
b(In)300 3653 y([23)q(],)29 b(an)f Fk(ImageProxy)d Fm(class)j(supp)s
(orts)e(the)i(same)g(in)m(terface)h(as)f(an)g Fk(Image)e
Fm(class,)j(but)e(p)s(ostp)s(ones)g(the)300 3840 y(w)m(ork)j(of)h
(loading)e(the)i(image)f(data)h(un)m(til)e(someone)i(actually)f
(requests)g(it.)441 4027 y(In)i(man)m(y)h(functional)e(programming)h
(languages,)i(the)f(Virtual)e(Pro)m(xy)i(pattern)g(is)f(unnecessary)-8
b(.)300 4215 y(This)27 b(is)h(b)s(ecause)i(man)m(y)f(functional)e
(languages)j(emplo)m(y)f Fi(lazy)j(evaluation)p Fm(.)42
b(This)27 b(means)i(that)h(v)-5 b(alues)300 4402 y(are)39
b(nev)m(er)g(computed)f(un)m(til)f(they)h(are)h(actually)f(used.)65
b(This)36 b(is)i(in)f(con)m(trast)j(to)f Fi(strict)48
b Fm(languages)300 4590 y(\(lik)m(e)34 b(all)e(mainstream)i(OO)f
(languages\),)i(where)f(v)-5 b(alues)33 b(are)h(automatically)g
(computed)g(when)f(they)300 4777 y(are)e(created,)g(regardless)f(of)h
(whether)e(or)i(not)f(they)h(are)g(used.)441 4965 y(Since)d(C++)f(is)h
(strict,)h(F)m(C++)f(is)g(also)h(strict)f(b)m(y)h(default.)39
b(Nev)m(ertheless,)30 b(a)f(v)-5 b(alue)28 b(of)h(t)m(yp)s(e)f
Fk(T)h Fm(can)p 300 5101 1440 4 v 404 5155 a Ff(8)438
5187 y Fe(A)47 b(tuple)g(of)h(indirect)g(functoids)f(can)h(b)r(e)f
(used)g(if)h(m)n(ultiple)f(function)g(signatures)i(are)f(de\014ned)e
(in)h(an)g(in-)300 5278 y(terface;)69 b(the)52 b(example)h(in)g([23)q
(])h(of)g(Command)e(used)h(for)h(do/undo)f(could)g(b)r(e)g(realized)i
(in)e(F)n(C++)g(with)h(a)300 5369 y Fd(std::pair<Fun0<void>,Fun0<voi)q
(d>>)p Fe(,)32 b(for)27 b(instance.)2055 5700 y Fm(76)p
eop
%%Page: 77 86
77 85 bop 300 91 a Fm(b)s(e)30 b(made)h(lazy)g(b)m(y)f(wrapping)f(the)i
(computation)g(of)g(that)g(v)-5 b(alue)30 b(in)g(a)h
Fk(Fun0<T>)p Fm(.)40 b(This)29 b(is)h(a)h(common)300
279 y(tec)m(hnique)j(in)e(strict)i(functional)e(languages.)52
b(It)34 b(encapsulates)f(a)i(computation)f(as)g(a)g(function)f(and)300
466 y(causes)i(the)g(computation)g(to)g(o)s(ccur)g(only)f(when)g(the)h
(function)e(is)h(actually)g(called)g(\(i.e.,)j(when)d(the)300
654 y(result)39 b(is)g(needed\).)70 b(F)-8 b(or)41 b(instance,)h(in)d
(F)m(C++)h(a)h(call)e Fk(foo\(a,b\))f Fm(can)i(b)s(e)g(dela)m(y)m(ed)g
(b)m(y)g(writing)e(it)300 841 y(as)j Fk(thunk2\(foo,a,b\))p
Fm(.)67 b(The)40 b(latter)g(expression)g(will)d(return)j(a)h(0-argumen)
m(t)g(functoid)f(that)h(will)300 1028 y(p)s(erform)33
b(the)h(original)e(computation,)k(but)d(only)g(when)h(it)f(is)h
(called.)51 b(Th)m(us,)34 b(passing)f(this)g(functoid)300
1216 y(around)c(enables)h(the)h(comp)s(osition)e(to)i(b)s(e)f(ev)-5
b(aluated)30 b(lazily)-8 b(.)441 1403 y(W)g(e)38 b(should)c(reiterate)j
(that)g(F)m(C++)f(de\014nes)f(sp)s(eci\014c)g(to)s(ols)h(for)g(con)m(v)
m(enien)m(tly)h(expressing)e(lazy)300 1591 y(computations.)40
b(First,)27 b(the)h Fk(ByNeed)d Fm(monad)i(describ)s(ed)f(in)g(Section)
h(2.3.2.5)j(can)d(b)s(e)g(used)g(to)h(pro)m(vide)300
1778 y(a)37 b(simple)d(implemen)m(tation)h(of)h(the)h
Fk(ImageProxy)c Fm(men)m(tioned)j(earlier.)58 b(Second,)37
b(F)m(C++'s)g Fi(lazy)i(list)300 1966 y Fm(data)26 b(structure)f
(enables)f(in)m(teresting)h(solutions)e(to)j(some)g(problems.)37
b(F)-8 b(or)26 b(example,)g(to)g(compute)g(the)300 2153
y(\014rst)35 b Fi(N)49 b Fm(prime)34 b(n)m(um)m(b)s(ers,)i(w)m(e)f
(migh)m(t)h(create)g(an)g(in\014nite)d(\(lazy\))j(list)e(of)h(all)g
(the)g(primes,)g(and)g(then)300 2340 y(select)c(just)f(the)g(\014rst)g
Fi(N)45 b Fm(elemen)m(ts)30 b(of)h(that)g(list.)300 2581
y Fl(2.4.2)105 b(P)m(arametric)35 b(p)s(olymorphism)f(and)h(design)g
(patterns)300 2827 y Fm(In)21 b(the)h(previous)e(section,)j(w)m(e)f(sa)
m(w)g(ho)m(w)g(sev)m(eral)g(common)g(design)e(patterns)i(are)g(related)
f(to)i(functional)300 3014 y(programming)j(patterns.)39
b(All)25 b(of)i(our)g(examples)f(relied)f(on)i(the)g(use)f(of)h(higher)
f(order)g(functions.)38 b(An-)300 3202 y(other)27 b(trait)g(of)g(mo)s
(dern)f(functional)f(languages)i(\(e.g.,)j(ML)d(and)f(Hask)m(ell\))h
(is)f(supp)s(ort)f(for)i(parametric)300 3389 y(p)s(olymorphism)g(with)i
(t)m(yp)s(e)i(inference.)40 b(T)m(yp)s(e)30 b(inference)g(w)m(as)h
(discussed)e(in)g(Section)h(2.2.2:)43 b(it)30 b(is)g(the)300
3576 y(pro)s(cess)e(of)h(deducing)e(the)h(return)g(t)m(yp)s(e)g(of)h(a)
g(function,)e(giv)m(en)i(sp)s(eci\014c)e(argumen)m(ts.)40
b(In)28 b(this)g(section,)300 3764 y(w)m(e)h(will)d(examine)i(ho)m(w)h
(some)g(design)e(pattern)i(implemen)m(tations)e(can)i(b)s(e)f(impro)m
(v)m(ed)g(if)f(they)i(emplo)m(y)300 3951 y(parametric)36
b(p)s(olymorphism)c(with)i(t)m(yp)s(e)i(inference)f(and)g(ho)m(w)h
(they)g(can)g(further)f(b)s(ene\014t)f(from)i(the)300
4139 y(en)m(tire)29 b(arsenal)g(of)g(F)m(C++)h(tec)m(hniques)e(for)h
(manipulating)e(these)j(p)s(olymorphic)c(functions.\(The)i(dis-)300
4326 y(cussion)k(of)h(this)f(section)h(is)f(only)g(relev)-5
b(an)m(t)33 b(for)g(statically)g(t)m(yp)s(ed)f(OO)h(languages,)h(lik)m
(e)e(Ja)m(v)-5 b(a,)35 b(Ei\013el,)300 4514 y(or)f(C++.)49
b(The)33 b(no)m(v)m(elties)h(of)g(F)m(C++)g(are)g(in)e(its)h(t)m(yp)s
(e)h(system|it)f(has)h(nothing)e(new)i(to)g(o\013er)g(to)h(a)300
4701 y(dynamically)28 b(t)m(yp)s(ed)i(language,)h(lik)m(e)f
(Smalltalk.\))441 4888 y Fl(P)m(arametric)43 b(vs.)73
b(Subt)m(yp)s(e)44 b(P)m(olymorphism.)63 b Fm(Design)38
b(patterns)g(are)g(based)g(on)g(subt)m(yp)s(e)300 5076
y(p)s(olymorphism|the)d(cornerstone)k(of)g(OO)f(programming.)65
b(P)m(arametric)39 b(p)s(olymorphism,)e(on)i(the)300
5263 y(other)30 b(hand,)f(is)f(not)i(y)m(et)g(commonly)f(a)m(v)-5
b(ailable)29 b(in)f(OO)h(languages,)h(and)f(ev)m(en)i(when)d(it)h(is,)g
(its)g(p)s(o)m(w)m(er)2055 5700 y(77)p eop
%%Page: 78 87
78 86 bop 300 91 a Fm(is)31 b(t)m(ypically)f(limited|e.g.,)i(there)g
(is)f(no)g(t)m(yp)s(e)h(inference)f(capabilit)m(y)-8
b(.)45 b(F)m(C++)31 b(adds)g(this)g(capabilit)m(y)300
279 y(to)37 b(C++.)58 b(It)37 b(is)e(in)m(teresting)h(to)i(ask)e(when)g
(parametric)g(p)s(olymorphism)d(can)k(b)s(e)e(used)h(in)f(place)i(of)
300 466 y(subt)m(yp)s(e)g(p)s(olymorphism)d(and)j(what)h(the)f(b)s
(ene\014ts)g(will)e(b)s(e,)k(esp)s(ecially)d(in)h(the)h(con)m(text)h
(of)f(design)300 654 y(pattern)30 b(implemen)m(tations.)441
841 y(P)m(arametric)h(p)s(olymorphism)26 b(is)j(a)i(static)f(concept:)
42 b(it)30 b(o)s(ccurs)f(en)m(tirely)h(at)g(compile)f(time.)41
b(Th)m(us,)300 1028 y(to)28 b(use)f(a)h(parametrically)e(p)s
(olymorphic)f(op)s(eration,)j(w)m(e)g(need)f(to)h(kno)m(w)g(the)g(t)m
(yp)s(es)f(of)h(its)f(argumen)m(ts)300 1216 y(at)40 b(eac)m(h)h(in)m(v)
m(o)s(cation)f(site)g(of)f(the)h(op)s(eration)g(\(although)f(the)h
(same)g(op)s(eration)f(can)h(b)s(e)f(used)g(with)300
1403 y(man)m(y)30 b(di\013eren)m(t)g(t)m(yp)s(es)g(of)h(argumen)m
(ts\).)41 b(In)30 b(con)m(trast,)i(subt)m(yp)s(e)d(p)s(olymorphism)e
(supp)s(orts)h(dynamic)300 1591 y(dispatc)m(h:)42 b(the)31
b(exact)i(v)m(ersion)d(of)i(the)f(executed)h(op)s(eration)f(dep)s(ends)
e(on)i(the)g(run-time)f(t)m(yp)s(e)h(of)h(the)300 1778
y(ob)5 b(ject,)32 b(whic)m(h)d(can)h(b)s(e)g(a)h(subt)m(yp)s(e)e(of)i
(its)e(statically)h(kno)m(wn)g(t)m(yp)s(e.)441 1966 y(Therefore)e(a)g
(necessary)g(condition)f(for)g(emplo)m(ying)g(parametric)h(p)s
(olymorphism)c(is)j(to)h(statically)300 2153 y(kno)m(w)39
b(the)g(t)m(yp)s(e)g(of)g(op)s(erands)e(of)i(the)g(p)s(olymorphic)d(op)
s(eration)i(at)i(eac)m(h)g(in)m(v)m(o)s(cation)e(site.)66
b(When)300 2340 y(com)m(bined)39 b(with)g(t)m(yp)s(e)h(inference,)i
(parametric)d(p)s(olymorphism)e(can)j(b)s(e)f(as)h(con)m(v)m(enien)m(t)
h(to)g(use)f(as)300 2528 y(subt)m(yp)s(e)29 b(p)s(olymorphism)e(and)j
(can)h(b)s(e)e(adv)-5 b(an)m(tageous)32 b(for)f(the)f(follo)m(wing)f
(reasons:)436 2790 y Fh(\017)46 b Fi(No)27 b(c)-5 b(ommon)28
b(sup)-5 b(ertyp)g(e)29 b(is)d(r)-5 b(e)g(quir)g(e)g(d)p
Fm(.)40 b(The)24 b(issue)e(of)i(ha)m(ving)g(an)g(actual)g(common)g(sup)
s(erclass)e(or)527 2978 y(just)j(supp)s(orting)f(the)h(righ)m(t)h
(metho)s(d)f(signature)g(is)g(similar)e(to)j(the)g(named/structural)f
(subt)m(yp-)527 3165 y(ing)f(dilemma.)37 b(All)23 b(mainstream)h(OO)g
(languages)h(except)h(Smalltalk)d(use)h(named)g(subt)m(yping:)37
b(a)527 3352 y(t)m(yp)s(e)28 b(A)f(needs)g(to)h(declare)f(that)h(it)f
(is)f(a)i(subt)m(yp)s(e)e(of)h(B.)h(In)f(con)m(trast,)i(in)d
(structural)g(subt)m(yping,)527 3540 y(a)37 b(t)m(yp)s(e)g(A)g(can)g(b)
s(e)f(a)h(subt)m(yp)s(e)f(of)g(t)m(yp)s(e)h(B)g(if)f(it)g(just)g
(implemen)m(ts)f(the)i(righ)m(t)f(metho)s(d)g(signa-)527
3727 y(tures.)i(The)22 b(adv)-5 b(an)m(tage)25 b(of)e(requiring)e(a)i
(common)g(sup)s(erclass)e(is)h(that)h(acciden)m(tal)g(conformance)527
3915 y(is)36 b(a)m(v)m(oided.)61 b(The)36 b(disadv)-5
b(an)m(tage)37 b(is)f(that)h(sometimes)g(it)g(is)e(not)i(easy)h(\(or)f
(ev)m(en)g(p)s(ossible\))e(to)527 4102 y(c)m(hange)25
b(the)f(source)g(co)s(de)g(of)g(a)g(class)g(to)g(mak)m(e)h(it)e
(declare)h(that)g(it)g(is)f(a)h(subt)m(yp)s(e)e(of)i(another.)39
b(F)-8 b(or)527 4290 y(instance,)33 b(it)f(ma)m(y)h(b)s(e)f(imp)s
(ossible)d(to)k(mo)s(dify)d(pre-compiled)h(co)s(de,)i(or)g(it)f(ma)m(y)
h(b)s(e)f(tedious)f(to)527 4477 y(manipulate)h(existing)g(inheritance)f
(hierarc)m(hies,)i(or)f(the)i(commonalities)e(cannot)h(b)s(e)f
(isolated)527 4664 y(due)h(to)i(language)f(restrictions)f(\(e.g.,)j(no)
e(m)m(ultiple)e(inheritance,)h(no)h(common)g(in)m(terface)g(sig-)527
4852 y(nature\).)39 b(Ev)m(en)26 b(in)e(languages)h(lik)m(e)g(Ja)m(v)-5
b(a)26 b(where)f(a)g(sup)s(ert)m(yp)s(e)f(of)i(all)e(t)m(yp)s(es)h
(exists)g(\(the)h Fk(Object)527 5039 y Fm(t)m(yp)s(e\),)36
b(problems)c(arise)h(with)g(higher-order)f(p)s(olymorphic)g(functions,)
h(lik)m(e)g(our)h Fk(curry)e Fm(op)s(er-)527 5227 y(ator.)53
b(The)33 b(problem)g(is)g(that)h(an)g Fk(Object)e Fm(reference)j(ma)m
(y)f(b)s(e)g(used)f(to)i(p)s(oin)m(t)e(to)h(an)m(y)h(ob)5
b(ject,)2055 5700 y(78)p eop
%%Page: 79 88
79 87 bop 527 91 a Fm(but)33 b(it)h(cannot)g(b)s(e)f(passed)h(to)g(a)g
(function)f(that)h(exp)s(ects)g(a)g(reference)h(of)f(a)g(sp)s(eci\014c)
e(\(but)i(un-)527 279 y(kno)m(wn\))d(t)m(yp)s(e.)44 b(Th)m(us,)31
b(implemen)m(ting)e(a)i(fully)e(generic)j Fk(curry)d
Fm(with)h(subt)m(yp)s(e)h(p)s(olymorphism)527 466 y(is)f(imp)s
(ossible.)436 728 y Fh(\017)46 b Fi(T)-7 b(yp)i(e)38
b(che)-5 b(cking)36 b(is)h(static)p Fm(.)55 b(With)34
b(subt)m(yp)s(e)g(p)s(olymorphism,)e(errors)j(can)g(remain)f
(undetected)527 916 y(un)m(til)23 b(run-time.)37 b(Suc)m(h)23
b(errors)h(arise)f(when)g(an)h(ob)5 b(ject)25 b(is)e(assumed)g(to)i(b)s
(e)f(of)g(a)g(certain)g(dynamic)527 1103 y(t)m(yp)s(e)38
b(but)f(is)g(not.)63 b(Since)37 b(the)h(compiler)f(can)h(only)f(c)m
(hec)m(k)i(the)f(static)g(t)m(yp)s(es)g(of)g(ob)5 b(jects,)41
b(the)527 1291 y(error)f(cannot)h(b)s(e)f(detected)h(at)g
(compile-time.)70 b(In)39 b(fact,)44 b(for)c(man)m(y)h(of)f(the)h(most)
f(p)s(o)m(w)m(erful)527 1478 y(and)27 b(general)h(p)s(olymorphic)c(op)s
(erations,)k(subt)m(yp)s(e)e(p)s(olymorphism)e(is)j(imp)s(ossible)d(to)
k(use)f(with)527 1665 y(an)m(y)37 b(kind)e(of)h(t)m(yp)s(e)h
(information.)57 b(F)-8 b(or)37 b(instance,)h(it)e(w)m(ould)f(b)s(e)h
(imp)s(ossible)c(to)38 b(implemen)m(t)d(a)527 1853 y(generic)29
b Fk(compose)f Fm(op)s(erator)h(with)f(subt)m(yp)s(e)g(p)s
(olymorphism,)e(unless)h(all)h(functions)g(comp)s(osed)527
2040 y(are)36 b(v)m(ery)g(w)m(eakly)f(t)m(yp)s(ed)g(\(e.g.,)k
(functions)34 b(from)h Fk(Object)p Fm(s)e(to)k Fk(Object)p
Fm(s\).)54 b(The)35 b(same)h(is)e(true)527 2228 y(with)27
b(most)i(other)f(higher-order)f(p)s(olymorphic)e(op)s(erations)j
(\(i.e.,)h(functions)e(that)i(manipulate)527 2415 y(other)i
(functions\).)436 2677 y Fh(\017)46 b Fi(Metho)-5 b(d)28
b(disp)-5 b(atch)28 b(is)e(static)p Fm(.)39 b(Despite)24
b(the)g(man)m(y)f(tec)m(hniques)g(dev)m(elop)s(ed)g(for)g(making)g
(dynamic)527 2865 y(dispatc)m(h)j(more)h(e\016cien)m(t,)h(there)f(is)e
(commonly)i(a)g(run-time)e(p)s(erformance)h(cost,)i(esp)s(ecially)d
(for)527 3052 y(hard-to-analyze)30 b(languages)g(lik)m(e)e(C++.)39
b(Apart)29 b(from)g(the)g(direct)g(cost)h(of)f(dynamic)f(dispatc)m(h)
527 3240 y(itself,)40 b(there)f(is)e(also)i(an)f(indirect)f(cost)i(due)
f(to)h(lost)g(optimization)e(opp)s(ortunities)f(\(suc)m(h)j(as)527
3427 y(inlining\).)e(Therefore,)30 b(when)e(parametric)h(p)s
(olymorphism)d(can)k(b)s(e)f(used)g(in)f(place)h(of)h(subt)m(yp)s(e)527
3615 y(p)s(olymorphism,)d(the)k(implemen)m(tation)e(t)m(ypically)g(b)s
(ecomes)i(more)f(e\016cien)m(t.)300 3877 y(The)37 b(examples)h(that)g
(follo)m(w)f(illustrate)f(the)i(adv)-5 b(an)m(tages)39
b(of)f(using)f(parametric)g(p)s(olymorphism)d(in)300
4064 y(the)d(implemen)m(tations)d(of)j(some)g(design)e(patterns.)441
4252 y Fl(Adapter.)48 b Fm(The)33 b(Adapter)g(pattern)g(con)m(v)m(erts)
h(the)f(in)m(terface)h(of)f(one)g(class)g(to)h(that)f(of)g(another.)300
4439 y(The)27 b(pattern)g(is)g(often)h(useful)d(when)i(t)m(w)m(o)i
(separately)e(dev)m(elop)s(ed)g(class)g(hierarc)m(hies)f(follo)m(w)h
(the)h(same)300 4626 y(design,)c(but)f(use)h(di\013eren)m(t)f(names)h
(for)f(metho)s(ds.)38 b(F)-8 b(or)25 b(example,)g(one)f(windo)m(w)e(to)
s(olkit)h(migh)m(t)h(displa)m(y)300 4814 y(ob)5 b(jects)34
b(b)m(y)f(calling)f Fk(paint\(\))p Fm(,)h(while)e(another)i(calls)g
Fk(draw\(\))p Fm(.)48 b(Adapter)33 b(pro)m(vides)g(a)g(w)m(a)m(y)i(to)f
(adapt)300 5001 y(the)d(in)m(terface)g(of)f(one)h(to)g(meet)g(the)g
(constrain)m(ts)f(of)h(the)f(other.)441 5189 y(Adaptation)24
b(is)f(remark)-5 b(ably)23 b(simple)g(when)g(a)h(functional)f(design)g
(is)g(follo)m(w)m(ed.)38 b(Most)26 b(useful)c(kinds)2055
5700 y(79)p eop
%%Page: 80 89
80 88 bop 300 91 a Fm(of)27 b(metho)s(d)f(adaptation)h(can)f(b)s(e)g
(implemen)m(ted)f(using)h(the)g(currying)f(and)h(functoid)f(comp)s
(osition)h(op-)300 279 y(erators)j(of)g(F)m(C++,)g(without)e(needing)g
(an)m(y)i(sp)s(ecial)e(adapter)i(classes.)40 b(These)28
b(adaptation)h(op)s(erators)300 466 y(are)i(v)m(ery)g(general)f(and)g
(reusable.)441 654 y(Consider)g(the)h(Command)g(or)g(Observ)m(er)g
(pattern.)44 b(As)31 b(w)m(e)h(sa)m(w,)h(in)d(an)h(F)m(C++)g(implemen)m
(tation)300 841 y(there)d(is)f(no)i(need)e(for)h(abstract)h
Fk(Observer)d Fm(or)i Fk(Command)e Fm(classes.)40 b(More)29
b(in)m(terestingly)-8 b(,)28 b(the)g(concrete)300 1028
y(observ)m(er)42 b(or)f(commands)g(do)g(not)h(ev)m(en)g(need)f(to)h
(supp)s(ort)e(a)h(common)h(in)m(terface|their)f(existing)300
1216 y(metho)s(ds)j(can)h(b)s(e)f(con)m(v)m(erted)j(in)m(to)e
(functoids.)82 b(Nev)m(ertheless,)49 b(this)44 b(requires)g(that)h(the)
g(existing)300 1403 y(metho)s(ds)34 b(ha)m(v)m(e)i(the)f(righ)m(t)f(t)m
(yp)s(e)h(signature.)53 b(F)-8 b(or)35 b(instance,)h(in)e(our)g
Fk(ConcreteObserver)c Fm(example,)300 1591 y(ab)s(o)m(v)m(e,)36
b(the)d Fk(be_notified)d Fm(metho)s(d)j(w)m(as)h(used)e(in)g(place)i
(of)f(a)h(con)m(v)m(en)m(tional)g Fk(update)e Fm(metho)s(d,)i(but)300
1778 y(b)s(oth)21 b(metho)s(ds)h(ha)m(v)m(e)h(the)f(same)h(signature:)
36 b(they)22 b(tak)m(e)i(no)e(argumen)m(ts)g(and)g(return)f(no)h
(results.)36 b(What)300 1966 y(if)28 b(an)g(existing)g(metho)s(d)g(has)
g Fi(almost)39 b Fm(the)29 b(righ)m(t)f(signature,)h(or)f(if)g(metho)s
(ds)g(need)g(to)h(b)s(e)f(com)m(bined)g(to)300 2153 y(pro)s(duce)h(the)
i(righ)m(t)f(signature?)441 2340 y(F)-8 b(or)25 b(an)f(example,)i
(consider)d(a)h(class,)i Fk(AnObserver)p Fm(,)d(that)i(de\014nes)e(a)i
(more)f(general)g(in)m(terface)h(than)300 2528 y(what)30
b(is)g(exp)s(ected.)41 b Fk(AnObserver)27 b Fm(ma)m(y)k(de\014ne)f(a)h
(metho)s(d:)443 2757 y Fk(void)47 b(update\(Time)e(timestamp\))g({)i
(...)g(})300 2985 y Fm(W)-8 b(e)29 b(w)m(ould)e(lik)m(e)g(to)i(use)e
(this)g(metho)s(d)h(to)g(subscrib)s(e)d(to)k(some)f(other)h(ob)5
b(ject's)29 b(service)e(that)i(will)c(issue)300 3173
y(p)s(erio)s(dic)g(up)s(dates.)39 b(As)28 b(sho)m(wn)f(in)g(the)h
(Observ)m(er)f(pattern)h(implemen)m(tation,)f(the)h(publisher)d(exp)s
(ects)300 3360 y(a)j(functoid)e(ob)5 b(ject)28 b(that)g(tak)m(es)h(no)e
(argumen)m(ts.)40 b(This)26 b(is)g(easy)i(to)g(e\013ect)h(b)m(y)e
(adapting)g(the)h(observ)m(er's)300 3548 y(in)m(terface:)443
3777 y Fk(thunk2\()46 b(ptr_to_fun\(&AnObserver::)o(upda)o(te\),)41
b(this,)46 b(current_time\(\))e(\))300 4005 y Fm(In)30
b(the)g(ab)s(o)m(v)m(e,)i(w)m(e)f(used)f(a)h(constan)m(t)h(v)-5
b(alue)30 b(\(the)h(curren)m(t)f(time\))h(to)g(sp)s(ecialize)e(the)i
(up)s(date)e(metho)s(d)300 4193 y(so)34 b(that)g(it)f(conforms)g(to)h
(the)g(required)d(in)m(terface.)51 b(That)33 b(is,)h(all)e(up)s(date)h
(ev)m(en)m(ts)i(will)30 b(get)35 b(the)f(same)300 4380
y(timestamp|one)d(that)h(indicates)e(the)h(subscription)d(time)j
(instead)g(of)g(the)g(up)s(date)g(time.)43 b(A)31 b(b)s(etter)300
4568 y(approac)m(h)g(is:)443 4796 y Fk(compose\()46 b
(ptr_to_fun\(&AnObserver:)o(:upd)o(ate\))o(\(th)o(is\),)873
4984 y(ptr_to_fun\(current_time)o(\))c(\))300 5213 y
Fm(In)29 b(this)g(example)h(w)m(e)h(com)m(bined)e(currying)f(with)h
(function)g(comp)s(osition)g(in)g(order)g(to)i(sp)s(ecialize)e(the)300
5400 y(in)m(terface.)40 b(The)28 b(resulting)e(function)g(tak)m(es)k
(no)e(argumen)m(ts)g(but)f(uses)g(global)h(state)h(\(returned)e(b)m(y)h
(the)2055 5700 y(80)p eop
%%Page: 81 90
81 89 bop 300 91 a Fk(current_time\(\))25 b Fm(routine\))j(as)h(the)g
(v)-5 b(alue)28 b(of)h(the)f(argumen)m(t)i(of)e(the)h
Fk(update)e Fm(metho)s(d.)40 b(In)28 b(this)f(w)m(a)m(y)-8
b(,)300 279 y(eac)m(h)34 b(up)s(date)e(will)f(b)s(e)h(correctly)i
(timestamp)s(ed)e(with)f(the)j(v)-5 b(alue)32 b(of)h(the)h(system)f
(clo)s(c)m(k)g(at)h(the)f(time)300 466 y(of)e(the)f(up)s(date!)441
654 y(Other)c(parametric)g(p)s(olymorphism)c(approac)m(hes)27
b(\(e.g.,)i(the)d(functional)e(part)i(of)g(the)h(C++)e(Stan-)300
841 y(dard)c(Library)f([59)q(],)k(or)e(Alexandrescu's)f(framew)m(ork)h
(for)g(functions)e([2)q(],)k(Ch.5\))e(supp)s(ort)e(currying)h(and)300
1028 y(comp)s(osition)31 b(for)h Fi(monomorphic)41 b
Fm(functions.)k(The)32 b(previous)f(examples)g(demonstrate)i(the)g(v)-5
b(alue)32 b(of)300 1216 y(C++)24 b(t)m(yp)s(e)i(inference,)f(whic)m(h)f
(is)g(not)i(unique)d(to)j(F)m(C++.)39 b(Nev)m(ertheless,)27
b(F)m(C++)e(also)g(extends)g(C++)300 1403 y(t)m(yp)s(e)j(inference)g
(to)h Fi(p)-5 b(olymorphic)37 b Fm(functions.)h(W)-8
b(e)30 b(will)25 b(see)k(examples)f(of)g(currying)f(and)g(comp)s
(osition)300 1591 y(of)k(p)s(olymorphic)c(op)s(erations)j(in)f(the)h
(implemen)m(tations)f(of)i(the)f(next)h(few)f(patterns.)441
1778 y Fl(Decorator.)54 b Fm(The)35 b(Decorator)h(pattern)f(is)f(used)g
(to)h(attac)m(h)i(additional)c(resp)s(onsibilities)d(to)35
b(an)300 1966 y(ob)5 b(ject.)42 b(Although)30 b(this)f(can)i(happ)s(en)
e(dynamically)-8 b(,)29 b(most)i(of)g(the)f(common)h(uses)f(of)h(the)g
(Decorator)300 2153 y(pattern)f(can)g(b)s(e)g(handled)e(statically)-8
b(.)40 b(Consider,)29 b(for)h(instance,)g(a)g(generic)g(library)e(for)i
(the)g(manipu-)300 2340 y(lation)24 b(of)h(windo)m(wing)e(ob)5
b(jects.)40 b(This)23 b(library)g(ma)m(y)i(con)m(tain)h(adapters,)g
(wrapp)s(ers,)e(and)h(com)m(binators)300 2528 y(of)31
b(graphical)e(ob)5 b(jects.)41 b(F)-8 b(or)32 b(example,)e(one)h(of)f
(its)g(op)s(erations)g(could)f(tak)m(e)j(a)f(windo)m(w)e(and)h
(annotate)300 2715 y(it)j(with)f(v)m(ertical)i(scrollbars.)48
b(The)33 b(problem)f(is)h(that)h(the)f(generic)h(library)d(has)i(no)g
(w)m(a)m(y)i(of)f(creating)300 2903 y(new)26 b(ob)5 b(jects)28
b(for)e(applications)f(that)i(ma)m(y)g(happ)s(en)e(to)j(use)e(it.)39
b(The)26 b(generic)h(co)s(de)f(do)s(es)h(not)g(share)f(an)300
3090 y(inheritance)h(hierarc)m(h)m(y)h(with)f(an)m(y)i(particular)d
(application,)i(so)g(it)g(is)g(imp)s(ossible)d(to)k(pass)f(it)f
(concrete)300 3278 y(factory)k(ob)5 b(jects)31 b(\(as)g(it)f(cannot)h
(declare)g(references)f(to)h(an)g(abstract)g(factory)g(class\).)441
3465 y(This)i(problem)g(can)i(b)s(e)e(solv)m(ed)i(b)m(y)f(making)g(the)
h(generic)f(op)s(erations)g(b)s(e)g(parametrically)f(p)s(oly-)300
3653 y(morphic)k(and)h(enabling)e(C++)i(t)m(yp)s(e)h(inference.)64
b(F)-8 b(or)39 b(instance,)h(w)m(e)f(can)g(write)f(a)h(generic)f(F)m
(C++)300 3840 y(functoid)29 b(that)i(will)d(annotate)k(a)e(windo)m(w)f
(with)g(a)i(scrollbar:)443 4088 y Fk(struct)46 b(AddScrollbar)f({)586
4275 y(template)h(<class)g(W>)586 4463 y(struct)g(Sig)h(:)h(public)e
(FunType<W,ScrollWindow<W)o(>)c(*>)47 b({};)586 4838
y(template)f(<class)g(W>)586 5025 y(typename)g(Sig<W>::ResultType)d
(operator\(\))i(\(const)h(W&)h(window\))f(const)g({)730
5213 y(return)g(new)h(ScrollWindow<W>\(window\))o(;)586
5400 y(})2055 5700 y Fm(81)p eop
%%Page: 82 91
82 90 bop 443 91 a Fk(})48 b(add_scrollbar;)300 351 y
Fm(The)35 b(ab)s(o)m(v)m(e)h(decorator)h(functoid)c(can)j(b)s(e)f(used)
f(with)g(sev)m(eral)i(di\013eren)m(t)e(t)m(yp)s(es)i(of)f(windo)m(ws.)
54 b(F)-8 b(or)36 b(a)300 539 y(windo)m(w)f(t)m(yp)s(e)h
Fk(W)p Fm(,)g(the)h(functoid's)e(return)g(t)m(yp)s(e)i(will)c(b)s(e)j
(a)h(p)s(oin)m(ter)e(to)i(a)f(decorated)i(windo)m(w)d(t)m(yp)s(e:)300
726 y Fk(ScrollWindow<W>)p Fm(.)43 b(\(In)32 b(fact,)j
Fk(ScrollWindow)29 b Fm(can)k(b)s(e)f(a)h(mixin,)e(inheriting)e(from)j
(its)g(parameter,)300 914 y Fk(W)p Fm(.\))441 1101 y(Since)27
b(the)i(functoid)e(conforms)h(to)h(the)g(F)m(C++)f(con)m(v)m(en)m
(tions,)i(it)d(can)i(b)s(e)f(manipulated)e(using)h(the)300
1288 y(standard)22 b(F)m(C++)i(op)s(erators)f(\(e.g.,)k(comp)s(osed)c
(with)f(other)h(functoids,)h(curried,)f(etc.\).)40 b(Comp)s(osition)300
1476 y(is)25 b(particularly)f(useful,)h(as)h(it)g(enables)f(creating)i
(more)f(complex)g(generic)f(manipulators)f(from)i(simple)300
1663 y(ones.)49 b(F)-8 b(or)34 b(instance,)g(a)f(function)f(to)i(add)e
(b)s(oth)h(a)g(scrollbar)f(and)g(a)i(title)f(bar)f(to)i(a)g(windo)m(w)d
(can)j(b)s(e)300 1851 y(expressed)c(as)g(a)h(comp)s(osition:)443
2111 y Fk(compose\(add_titlebar,)42 b(add_scrollbar\))300
2371 y Fm(instead)f(of)i(adding)e(a)h(new)g(function)f(to)i(the)f(in)m
(terface)h(of)f(a)h(generic)f(library)-8 b(.)74 b(Similarly)-8
b(,)43 b(if)e(the)300 2558 y Fk(add_titlebar)24 b Fm(op)s(eration)k
(accepts)h(one)f(more)g(argumen)m(t)g(\(the)g(windo)m(w)f(title\),)h
(the)g(currying)e(op)s(er-)300 2746 y(ation)k(can)h(b)s(e)f(used)f
(\(implicitly)e(in)i(the)i(example)f(b)s(elo)m(w\):)443
3006 y Fk(add_titlebar\("Window)42 b(Title"\))441 3266
y Fm(The)37 b(previous)f(examples)g(sho)m(w)m(ed)i(ho)m(w)f(classes)h
(can)f(b)s(e)g(statically)g(decorated,)j(p)s(ossibly)34
b(with)300 3453 y(new)29 b(abilities)f(added)h(to)h(them.)41
b(Nev)m(ertheless,)31 b(a)f(common)g(kind)e(of)i(decoration)g(is)f
(pure)g(wrapping,)300 3641 y(where)c(the)i(in)m(terface)f(of)g(the)h
(class)e(do)s(es)h(not)g(c)m(hange,)i(but)e(old)f(op)s(erations)g(are)i
(extended)f(with)e(extra)300 3828 y(functionalit)m(y)-8
b(.)48 b(Using)32 b(parametric)h(p)s(olymorphism)d(one)j(can)h(write)e
(sp)s(ecial-purp)s(ose)f(p)s(olymorphic)300 4015 y(wrapp)s(ers)g(that)i
(are)g(quite)f(general.)48 b(These)33 b(could)f(also)g(b)s(e)g(written)
g(as)h(C++)f(function)f(templates,)300 4203 y(but)i(if)f(they)h(are)h
(written)e(as)i(F)m(C++)f(functoids,)f(they)i(can)f(b)s(e)g(applied)e
(to)j(p)s(olymorphic)c(functoids)300 4390 y(and)j(they)g(can)h
(themselv)m(es)f(b)s(e)g(manipulated)e(b)m(y)i(other)g(functoids)f
(\(lik)m(e)h Fk(compose)p Fm(\).)48 b(Consider,)32 b(for)300
4578 y(instance,)27 b(an)e(instrumen)m(tation)g(functoid)f(that)j
(calls)e(a)h(one-argumen)m(t)h(op)s(eration,)g(prin)m(ts)d(the)i
(result)300 4765 y(of)31 b(the)f(in)m(v)m(o)s(cation)g(\(regardless)h
(of)f(its)g(t)m(yp)s(e\))h(and)f(returns)f(that)i(same)f(result:)443
5025 y Fk(struct)46 b(GenericInstrumentor)d({)586 5213
y(template)j(<class)g(C,)h(class)g(A>)g(struct)f(Sig)586
5400 y(:)i(public)e(FunType<C,)f(A,)i(C::Sig<A>::ResultType>)42
b({};)2055 5700 y Fm(82)p eop
%%Page: 83 92
83 91 bop 586 279 a Fk(template)46 b(<class)g(C,)h(class)g(A>)586
466 y(typename)f(C::template)f(Sig<A>::ResultType)586
654 y(operator\(\))g(\()j(const)e(C&)h(operation,)e(const)i(A&)g
(argument)e(\))j(const)e({)730 841 y(typename)f(C::template)g
(Sig<A>::ResultType)e(r)k(=)h(operation\(argument\);)730
1028 y(std::cerr)d(<<)i("Result)f(is:)h(")g(<<)g(r)h(<<)f(std::endl;)
730 1216 y(return)f(r;)586 1403 y(})443 1591 y(})i
(generic_instrumentor;)300 1853 y(GenericInstrumentor)24
b Fm(exempli\014es)k(a)i(sp)s(ecial-purp)s(ose)c(functoid)i(\(it)i
(logs)f(the)h(results)e(of)i(calls)e(to)300 2040 y(an)36
b(error)f(stream\))i(that)g(can)f(b)s(e)f(generally)g(applied)f(\(it)i
(can)g(wrap)f(an)m(y)i(one-argumen)m(t)g(function\).)300
2228 y(Note)i(that)f(the)g Fk(before\(\))d Fm(and)i Fk(after\(\))f
Fm(com)m(binators)h(\(describ)s(ed)f(in)h(Section)g(2.2.9\))j(are)e
(other)300 2415 y(examples)30 b(of)g(generally)g(useful)f(metho)s(d)g
(decorators.)441 2603 y Fl(Builder.)42 b Fm(The)30 b(Builder)e(design)h
(pattern)i(generalizes)g(the)f(construction)g(pro)s(cess)g(of)h
(conceptu-)300 2790 y(ally)26 b(similar)e(comp)s(osite)j(ob)5
b(jects)28 b(so)f(that)g(a)h(generic)f(pro)s(cess)f(can)h(b)s(e)g(used)
f(to)h(create)i(the)e(comp)s(osite)300 2978 y(ob)5 b(jects)40
b(b)m(y)e(rep)s(eatedly)g(creating)h(their)f(parts.)66
b(More)39 b(concretely)-8 b(,)43 b(the)c(main)e(roles)h(in)g(a)h
(Builder)300 3165 y(pattern)31 b(are)h(those)f(of)g(a)h
Fi(Dir)-5 b(e)g(ctor)42 b Fm(and)30 b(a)i Fi(Builder)p
Fm(.)43 b(The)30 b(Director)i(ob)5 b(ject)32 b(holds)d(a)j(reference)f
(to)h(an)300 3352 y(abstract)k(Builder)e(class)h(and,)h(th)m(us,)h(can)
e(b)s(e)g(used)g(with)f(m)m(ultiple)f(concrete)k(Builders.)53
b(Whenev)m(er)300 3540 y(the)25 b(Director)g(needs)f(to)h(create)h(a)f
(part)f(of)h(the)g(comp)s(osite)f(ob)5 b(ject,)27 b(it)d(calls)g(the)g
(Builder.)37 b(The)24 b(Builder)300 3727 y(is)29 b(resp)s(onsible)f
(for)i(aggregating)i(the)f(parts)f(to)h(form)f(the)g(en)m(tire)h(ob)5
b(ject.)441 3915 y(A)24 b(common)g(application)e(domain)g(for)h(the)h
(Builder)e(pattern)h(is)g(that)h(of)g(data)g(in)m(terpretation.)38
b(F)-8 b(or)300 4102 y(instance,)26 b(consider)f(an)g(in)m(terpreter)g
(for)g(HTML)g(data.)40 b(The)25 b(main)g(structure)f(of)i(suc)m(h)f(an)
h(in)m(terpreter)300 4290 y(is)35 b(the)i(same,)h(regardless)d(of)i
(whether)e(it)h(is)f(used)h(to)h(displa)m(y)d(w)m(eb)i(pages,)j(to)e
(con)m(v)m(ert)h(the)e(HTML)300 4477 y(data)j(in)m(to)g(some)g(other)g
(markup)e(language)j(or)e(w)m(ord-pro)s(cessing)g(format,)j(to)e
(extract)i(the)d(ASCI)s(I)300 4664 y(text)h(from)e(the)i(data,)h(etc.)
65 b(Th)m(us,)39 b(the)f(in)m(terpreter)g(can)g(b)s(e)f(the)h(Director)
h(in)d(a)j(Builder)d(pattern.)300 4852 y(Then)31 b(it)h(can)h(call)e
(the)i(appropriate)e(builders)e(for)j(eac)m(h)i(kind)c(of)j(do)s(cumen)
m(t)f(elemen)m(t)h(it)f(encoun)m(ters)300 5039 y(in)d(the)i(HTML)f
(data)h(\(e.g.,)h(fon)m(t)f(c)m(hange,)h(paragraph)e(end,)g(text)h
(strings,)f(etc.\).)441 5227 y(In)g(the)g(Builder)f(pattern,)h(the)h
(Director)g(ob)5 b(ject)31 b(often)g(implemen)m(ts)e(a)h(metho)s(d)g
(of)h(the)f(form:)2055 5700 y(83)p eop
%%Page: 84 93
84 92 bop 443 91 a Fk(void)47 b(construct\(ObjCollection)41
b(objs\))47 b({)586 279 y(for)g(all)g(objects)f(in)h(objs)g({)95
b(//)47 b("for)g(all")f(is)i(pseudocode)730 466 y(if)f(\(object)f(is_a)
g(A\))286 b(//)47 b("is_a")f(is)h(pseudocode)873 654
y(builder->build_part_A\(o)o(bjec)o(t\);)730 841 y(else)f(if)h
(\(object)f(is_a)h(B\))873 1028 y(builder->build_part_B\(o)o(bjec)o
(t\);)730 1216 y(...)539 1403 y(})443 1591 y(})300 1839
y Fm(Note)g(that)e(the)h Fk(build_part)c Fm(metho)s(d)j(of)g(the)h
Fk(builder)d Fm(ob)5 b(jects)46 b(returns)e(no)h(result.)84
b(Instead,)300 2026 y(the)34 b(Builder)d(ob)5 b(ject)35
b(aggregates)h(the)e(results)f(of)h(eac)m(h)g Fk(build_part)d
Fm(op)s(eration)i(and)h(returns)e(them)300 2214 y(through)j(a)h(metho)s
(d)g(\(w)m(e)g(will)e(call)h(it)g Fk(get_result)p Fm(\).)55
b(This)34 b(metho)s(d)i(is)e(called)i(b)m(y)f(a)i(clien)m(t)e(ob)5
b(ject)300 2401 y(\(i.e.,)31 b Fi(not)40 b Fm(the)30
b(Director!\).)441 2589 y(A)36 b(more)f(natural)g(organization)h(w)m
(ould)e(ha)m(v)m(e)j(the)e(Director)h(collect)g(the)g(pro)s(ducts)e(of)
i(building)300 2776 y(and)44 b(return)g(them)h(to)h(the)f(clien)m(t)g
(as)g(a)h(result)e(of)h(the)g Fk(construct)e Fm(call.)84
b(In)44 b(an)h(extreme)h(case,)300 2963 y(the)34 b Fk(get_result)e
Fm(metho)s(d)h(could)h(b)s(e)f(unnecessary:)48 b(the)34
b(Director)h(could)e(k)m(eep)i(all)e(the)i(state)g(\(i.e.,)300
3151 y(the)f(accum)m(ulated)g(results)e(of)i(previous)e
Fk(build_part)f Fm(calls\))i(and)g(the)h(Builder)d(could)i(b)s(e)g
(stateless.)300 3338 y(Nev)m(ertheless,)i(this)d(is)g(imp)s(ossible)e
(in)i(the)h(original)e(implemen)m(tation)h(of)h(the)h(pattern.)49
b(The)33 b(reason)300 3526 y(for)j(k)m(eeping)h(the)f(state)i(in)e(the)
g(Builders)e(is)i(that)h(Directors)g(ha)m(v)m(e)h(no)e(idea)g(what)h
(the)f(t)m(yp)s(e)h(of)g(the)300 3713 y(result)31 b(of)i(the)g
Fk(build_part)c Fm(metho)s(d)j(migh)m(t)g(b)s(e.)47 b(Th)m(us,)32
b(Directors)h(cannot)g(declare)f(an)m(y)h(v)-5 b(ariables,)300
3901 y(con)m(tainers,)31 b(etc.)41 b(based)30 b(on)g(the)g(t)m(yp)s(e)g
(of)g(data)h(returned)e(b)m(y)h(a)g(Builder.)39 b(Gamma)30
b(et)h(al.)40 b([23)q(])30 b(write:)300 4088 y(\\In)k(the)h(common)g
(case,)h(the)f(pro)s(ducts)e(pro)s(duced)g(b)m(y)h(the)h(concrete)h
(builders)31 b(di\013er)j(so)g(greatly)h(in)300 4275
y(their)j(represen)m(tation)h(that)h(there)f(is)f(little)g(to)h(gain)g
(from)f(giving)g(di\013eren)m(t)h(pro)s(ducts)e(a)j(common)300
4463 y(paren)m(t)31 b(class.")441 4650 y(This)40 b(scenario)h(\(no)h
(common)g(in)m(terface\))g(is)f(exactly)h(one)g(where)f(parametric)h(p)
s(olymorphism)300 4838 y(is)i(appropriate)g(instead)g(of)h(subt)m(yp)s
(e)f(p)s(olymorphism.)81 b(Using)44 b(parametric)h(p)s(olymorphism,)g
(the)300 5025 y(Director)37 b(class)g(could)e(infer)g(the)i(result)f(t)
m(yp)s(es)h(of)f(individual)c(Builders)j(and)h(de\014ne)g(state)i(to)f
(k)m(eep)300 5213 y(their)43 b(pro)s(ducts.)81 b(Of)44
b(course,)k(this)43 b(requires)g(that)i(the)f(kind)e(of)j(Builder)d(ob)
5 b(ject)45 b(used)e(\(e.g.,)50 b(an)300 5400 y(HTML)30
b(to)i(PDF)f(con)m(v)m(erter,)h(an)f(on-screen)g(HTML)f(bro)m(wser,)g
(etc.\))43 b(b)s(e)30 b(\014xed)g(for)g(eac)m(h)i(iteration)e(of)2055
5700 y(84)p eop
%%Page: 85 94
85 93 bop 300 91 a Fm(the)37 b Fk(construct)e Fm(lo)s(op,)j(sho)m(wn)e
(earlier.)60 b(This)35 b(is,)j(ho)m(w)m(ev)m(er,)j(exactly)c(ho)m(w)h
(the)f(Builder)e(pattern)i(is)300 279 y(used:)k(the)32
b(in)m(terpretation)e(engine)h(do)s(es)g(not)g(c)m(hange)h(in)e(the)h
(middle)e(of)i(the)g(in)m(terpretation.)43 b(Th)m(us,)300
466 y(the)24 b(pattern)f(is)g Fi(static)5 b Fm(|another)25
b(reason)e(to)i(prefer)d(parametric)i(p)s(olymorphism)c(to)k(subt)m
(yping.)37 b(This)300 654 y(ma)m(y)30 b(result)e(in)g(impro)m(v)m(ed)h
(p)s(erformance)g(b)s(ecause)g(the)g(costs)i(of)e(dynamic)f(dispatc)m
(h)h(are)h(eliminated.)441 841 y(The)k(new)g(organization)h(also)f(has)
h(other)f(b)s(ene\014ts.)52 b(First,)36 b(the)e(con)m(trol)h(\015o)m(w)
g(of)g(the)f(pattern)h(is)300 1028 y(simpler:)43 b(the)33
b(clien)m(t)f(nev)m(er)h(calls)e(the)i(Builder)e(ob)5
b(ject)33 b(directly)-8 b(.)47 b(Instead)32 b(of)h(the)g
Fk(get_result)c Fm(call,)300 1216 y(the)e(results)f(are)i(returned)e(b)
m(y)h(the)g Fk(construct)e Fm(call)h(made)h(to)h(the)f(Director.)40
b(Second,)28 b(Directors)g(can)300 1403 y(no)m(w)g(b)s(e)g(more)g
(sophisticated:)39 b(they)29 b(can,)g(for)f(instance,)h(declare)f(temp)
s(orary)g(v)-5 b(ariables)27 b(of)h(the)h(same)300 1591
y(t)m(yp)s(e)23 b(as)g(the)g(t)m(yp)s(e)g(of)f(the)h(Builder's)e(pro)s
(duct.)37 b(These)22 b(can)h(b)s(e)f(useful)f(for)i(cac)m(hing)g
(previous)e(pro)s(ducts,)300 1778 y(without)26 b(co)s(op)s(eration)i
(from)f(the)g(Builder)f(classes.)39 b(Additionally)-8
b(,)26 b(Directors)i(can)g(no)m(w)f(decide)g(when)300
1966 y(the)37 b(data)g(should)d(b)s(e)i(consumed)g(b)m(y)g(the)h(clien)
m(t.)58 b(F)-8 b(or)37 b(instance,)h(the)f(Observ)m(er)f(pattern)g
(could)g(b)s(e)300 2153 y(used:)k(clien)m(ts)30 b(of)g(an)g(HTML)g(in)m
(terpreter)g(could)f(register)h(a)h(callbac)m(k)f(ob)5
b(ject.)42 b(The)29 b(Director)i(ob)5 b(ject)300 2340
y(\(i.e.,)26 b(the)e(in)m(terpreter\))g(can)g(then)g(in)m(v)m(ok)m(e)h
(the)f(callbac)m(k)g(whenev)m(er)g(data)g(are)h(to)f(b)s(e)g(consumed.)
38 b(Th)m(us,)300 2528 y(the)25 b Fk(construct)e Fm(metho)s(d)i(ma)m(y)
g(only)f(b)s(e)h(called)f(once)i(for)f(an)g(en)m(tire)g(do)s(cumen)m
(t,)h(but)f(the)g(clien)m(t)g(could)300 2715 y(b)s(e)30
b(getting)h(data)g(after)g(eac)m(h)g(paragraph)f(has)g(b)s(een)g(in)m
(terpreted.)441 2903 y(Another)i(observ)-5 b(ation)32
b(is)f(that)i(the)f(Director)h(class)f(can)h(b)s(e)e(replaced)h(b)m(y)g
(a)g(functoid)f(so)i(that)f(it)300 3090 y(can)27 b(b)s(e)g(manipulated)
e(using)g(general)i(to)s(ols.)40 b(Note)28 b(that)g(the)f(Director)g
(class)g(in)f(the)h(Builder)e(pattern)300 3278 y(only)h(supp)s(orts)e
(a)j(single)f(metho)s(d)g(call.)39 b(Th)m(us,)26 b(it)g(can)h(easily)f
(b)s(e)g(made)h(in)m(to)f(a)h(functoid.)38 b(Calling)25
b(the)300 3465 y(functoid)h(will)g(b)s(e)h(equiv)-5 b(alen)m(t)27
b(to)h(calling)f Fk(construct)e Fm(in)h(the)i(original)e(pattern.)40
b(The)27 b(return)g(t)m(yp)s(e)h(of)300 3653 y(the)33
b(functoid)e(dep)s(ends)f(on)j(the)g(t)m(yp)s(e)f(of)h(builder)c
(passed)j(to)i(it)e(as)g(an)h(argumen)m(t)g(\(instead)f(of)g(b)s(eing)
300 3840 y Fk(void)p Fm(\).)40 b(An)30 b(example)g(functoid)f(whic)m(h)
g(in)m(tegrates)j(these)e(ideas)g(is)g(sho)m(wn)f(here:)443
4088 y Fk(struct)46 b(DoBuild)g({)539 4275 y(template)f(<class)h(B,)h
(class)g(OC>)539 4463 y(struct)f(Sig:)g(public)g
(FunType<B,OC,Container<B::)o(Resu)o(ltT)o(ype>)41 b(>)48
b({};)539 4650 y(template<class)c(B,)j(class)f(OC>)539
4838 y(Container<B::ResultType)o(>)c(operator\(\)\()j(B)i(b,)g(OC)g
(objs)g(\))g(const)g({)682 5025 y(Container<B::ResultType>)41
b(c;)682 5213 y(for)47 b(all)g(objects)e(in)j(objs)e({)95
b(//)48 b("for)e(all")h(is)g(pseudocode)825 5400 y(if)g(\(object)f
(is_a)h(A\))285 b(//)48 b("is_a")e(is)h(pseudocode)2055
5700 y Fm(85)p eop
%%Page: 86 95
86 94 bop 968 91 a Fk(c.add\(b.build_part_A\(obje)o(ct\)\))o(;)825
279 y(else)47 b(if)g(\(object)f(is_a)g(B\))968 466 y
(c.add\(b.build_part_B\(obje)o(ct\)\))o(;)825 654 y(...)682
841 y(})682 1028 y(return)g(c;)539 1216 y(})443 1403
y(})i(do_build;)300 1665 y Fm(With)36 b(this)g(approac)m(h,)j(the)d
(\\director")i(functoid)d(is)h(in)f(full)g(con)m(trol)i(of)g(the)f
(data)i(pro)s(duction)d(and)300 1853 y(consumption.)j(The)28
b(Director)g(can)g(b)s(e)g(sp)s(ecialized)e(via)h(currying)f(to)j(b)s
(e)e(applied)f(to)j(sp)s(eci\014c)d(ob)5 b(jects)300
2040 y(or)21 b(to)g(use)g(a)g(sp)s(eci\014c)e(Builder.)36
b(Tw)m(o)20 b(di\013eren)m(t)h(Directors)g(can)g(ev)m(en)g(b)s(e)f
(comp)s(osed|the)h(\014rst)f(building)300 2228 y(pro)s(cess)30
b(can)h(assem)m(ble)f(a)h(builder)c(ob)5 b(ject)31 b(for)f(the)h
(second!)300 2468 y Fl(2.4.3)105 b(Other)35 b(applications)300
2714 y Fm(F)m(C++)d(has)g(applications)f(outside)g(the)i(area)g(of)f
(OO)g(design)f(patterns,)i(as)g(w)m(ell.)45 b(Here)33
b(w)m(e)g(describ)s(e)300 2901 y(other)c(application)e(domains)g(for)i
(F)m(C++,)g(and)f(other)g(en)m(tire)h(libraries)d(whic)m(h)h(ha)m(v)m
(e)j(b)s(een)e(built)e(atop)300 3089 y(the)31 b(F)m(C++)f
(infrastructure.)441 3276 y(As)f(describ)s(ed)e(in)h(Section)h
(2.3.2.5,)j(F)m(C++'s)e(supp)s(ort)d(for)i(functional)e(programming)h
(and)h(mon-)300 3464 y(ads)f(mak)m(es)h(it)f(p)s(ossible)e(to)j
(implemen)m(t)d(monadic)i(parser)g(com)m(binators)g(in)f(F)m(C++.)40
b(W)-8 b(e)29 b(ha)m(v)m(e)h(imple-)300 3651 y(men)m(ted)f(a)g(small)e
(parser)h(com)m(binator)h(library)-8 b(,)27 b(using)g(the)i(same)g
(elegan)m(t)g(design)f(found)f(in)g(reference)300 3839
y([33)q(])k(\(whic)m(h)e(describ)s(es)g(suc)m(h)h(a)h(library)d
(written)h(in)g(Hask)m(ell\).)441 4026 y(F)m(C++)f(is)f(also)h(useful)e
(on)i(a)h(v)m(ery)f(small)f(scale)h(for)g(creating)g(new)g(anon)m
(ymous)g(functions)e(for)i(use)300 4213 y(with)20 b(standard)h
(algorithms.)37 b(A)22 b(go)s(o)s(d)f(example)h(of)g(this)e(is)h
(illustrated)f(in)g(Section)h(2.2.9)j(\(the)e(example)300
4401 y(whic)m(h)36 b(adds)h Fk(3)g Fm(to)h(eac)m(h)h(elemen)m(t)f(of)g
(a)g Fk(std::vector)p Fm(\).)59 b(The)37 b(currying)f(and)h(lam)m(b)s
(da)f(facilities)g(of)300 4588 y(F)m(C++)30 b(mak)m(e)i(it)d(m)m(uc)m
(h)i(easier)f(to)h(write)f(tin)m(y)g(anon)m(ymous)g(functions.)441
4776 y(On)d(a)h(m)m(uc)m(h)g(larger)g(scale,)h(F)m(C++)f(is)e(useful)h
(for)g(functional)f(programmers)i(b)s(ecause)g(it)f(pro)m(vides)300
4963 y(an)d(alternativ)m(e,)i(commonly)e(a)m(v)-5 b(ailable)24
b(platform)f(for)h(implemen)m(ting)e(familiar)g(designs.)37
b(An)24 b(example)300 5151 y(of)31 b(this)f(approac)m(h)i(is)e(the)h
(XR)g(\()p Fi(Exact)j(R)-5 b(e)g(al)9 b Fm(\))34 b(library)28
b([12)r(].)43 b(XR)31 b(uses)g(the)g(F)m(C++)g(infrastructure)e(to)300
5338 y(pro)m(vide)g(exact)j(\(or)f Fi(c)-5 b(onstructive)7
b Fm(\))31 b(real-n)m(um)m(b)s(er)e(arithmetic,)h(using)f(lazy)i(ev)-5
b(aluation.)2055 5700 y(86)p eop
%%Page: 87 96
87 95 bop 441 91 a Fm(Another)24 b(third-part)m(y)f(library)e(built)h
(atop)i(F)m(C++)g(is)f(BSF)m(C++)g([16)q(].)39 b(The)23
b(BSF)m(C++)h(Library)e(is)300 279 y(a)k(library)c(for)j(F)-8
b(unctional)25 b(Bulk)f(Sync)m(hronous)g(P)m(arallel)g(Programming)h
(whic)m(h)f(utilizes)f(a)j(functional)300 466 y(design.)37
b(And)21 b(\014nally)-8 b(,)22 b(the)h(LC++)d(library)g(for)i(logic)g
(programming)e(\(describ)s(ed)h(in)f(the)j(next)f(c)m(hapter\))300
654 y(is)29 b(another)i(en)m(tire)f(library)e(built)g(on)j(top)f(of)h
(the)f(F)m(C++)h(infrastructure.)441 841 y(T)-8 b(o)34
b(sum)f(up,)h(the)f(F)m(C++)h(library)d(supp)s(orts)h(functional)g
(programming)g(in)g(C++,)i(b)m(y)g(enabling)300 1028
y(users)k(to)j(write)d(and)h(manipulate)e(p)s(olymorphic)g(and)i
(higher-order)e(functions.)66 b(The)39 b(library)e(has)300
1216 y(a)i(smo)s(oth)g(in)m(terface)g(to)g(the)g(rest)g(of)g(C++,)h(so)
f(that)h(functional)d(co)s(de)i(and)f(OO)g(co)s(de)h(can)g(blend)300
1403 y(w)m(ell.)f(Ov)m(erall,)27 b(F)m(C++)f(has)g(man)m(y)g(useful)e
(applications,)i(in)m(v)m(olving)f(a)h(n)m(um)m(b)s(er)f(of)i
(di\013eren)m(t)e(domains)300 1591 y(\(suc)m(h)36 b(as)g(parsing)e(and)
h(parallel)f(programming\),)j(and)e(spanning)f(the)i(gam)m(ut)h(of)f
(size)f(\(F)m(C++)h(has)300 1778 y(utilit)m(y)d(for)h(tin)m(y)f
(one-liners,)h(for)g(design)g(pattern)g(implemen)m(tations,)g(and)g(as)
g(an)g(en)m(tire)h(functional)300 1966 y(infrastructure)28
b(on)j(whic)m(h)e(to)i(build)c(other)k(libraries\).)300
2237 y Fj(2.5)140 b(Pr)-7 b(actic)g(al)48 b(c)-7 b(onsider)g(ations)300
2483 y Fm(In)39 b(this)g(section)h(w)m(e)h(fo)s(cus)e(on)h(pragmatics.)
70 b(The)40 b(\014rst)f(t)m(w)m(o)i(subsections)e(discuss)f
(e\016ciency:)60 b(w)m(e)300 2670 y(describ)s(e)38 b(exp)s(erimen)m(ts)
g(w)m(e)i(ha)m(v)m(e)h(done)e(to)i(measure)e(the)h(p)s(erformance)f(of)
g(F)m(C++)h(and)e(the)i(opti-)300 2858 y(mizations)31
b(w)m(e)h(ha)m(v)m(e)g(applied)e(to)i(ac)m(hiev)m(e)h(it.)43
b(The)31 b(\014nal)f(subsection)h(deal)g(with)f(expressiv)m(eness:)42
b(w)m(e)300 3045 y(discuss)33 b(the)i(capabilities)e(and)h(limitations)
e(of)j(the)g(library)-8 b(.)52 b(F)-8 b(or)36 b(a)f(detailed)f
(comparison)g(to)i(other)300 3233 y(libraries)27 b(that)k(similarly)c
(\\sugarize")32 b(C++,)d(see)i(Section)f(5.1.2.)300 3467
y Fl(2.5.1)105 b(P)m(erformance)300 3713 y Fm(F)m(C++)25
b(is)f(quite)h(e\016cien)m(t)g(in)f(its)h(implemen)m(tation)f(of)h
(functional)f(concepts.)39 b(F)-8 b(or)26 b(common)g(program-)300
3901 y(ming)20 b(tasks)i(that)g(use)f(the)h(F)m(C++)f(con)m(v)m(en)m
(tions,)k(the)d(o)m(v)m(erhead)g(is)f(either)g(zero)h(or)f(negligible)f
(\(i.e.,)k(just)300 4088 y(a)36 b(dynamic)f(dispatc)m(h)h(indirection)d
(for)j(indirect)e(functoids\).)57 b(The)36 b(only)f(case)i(where)f(p)s
(erformance)300 4275 y(is)31 b(a)h(legitimate)g(concern)g(is)f(if)g
(one)h(attempts)h(to)g(cop)m(y)g(functional)d(idioms)g(directly)h(to)h
(C++)f(using)300 4463 y(F)m(C++.)40 b(F)m(C++)29 b(is)f(not)h(an)g
(optimizing)e(compiler)h(for)h(a)g(functional)f(language,)i(so)f(it)g
(misses)f(sev)m(eral)300 4650 y(common)36 b(optimizations;)h(for)f
(example:)51 b(no)35 b(sp)s(ecial)g(run)m(time)f(supp)s(ort)g(for)i(sp)
s(ecialized)d(functions)300 4838 y(exists;)44 b(tail-recursion)37
b(elimination)g(is)h(not)i(automatically)f(p)s(erformed;)j(no)e(run)m
(time)e(supp)s(ort)f(for)300 5025 y(lazy)e(ev)-5 b(aluation)35
b(exists.)55 b(Additionally)-8 b(,)34 b(F)m(C++)h(o\013ers)h(a)g
(simple)d(reference)j(coun)m(ting)f(mec)m(hanism)300
5213 y(\(used)25 b(in)m(ternally)e(for)j(indirect)d(functoids)h(and)h
(lazy)h(lists\),)f(whic)m(h)f(is)h(not)h(directly)e(comparable)h(to)h
(an)300 5400 y(optimized)32 b(garbage)j(collector.)51
b(Nev)m(ertheless,)35 b(the)e(implemen)m(tation)f(of)i(F)m(C++)f
(carefully)f(tries)h(to)2055 5700 y(87)p eop
%%Page: 88 97
88 96 bop 300 91 a Fm(a)m(v)m(oid)32 b(unnecessary)e(o)m(v)m(erhead)i
(and)f(a)g(n)m(um)m(b)s(er)f(of)h(optimizations)f(are)h(emplo)m(y)m
(ed.)43 b(In)30 b(the)h(follo)m(wing)300 279 y(section)g(\(Section)f
(2.5.2\),)j(w)m(e)e(will)c(describ)s(e)i(the)i(optimizations)e(in)g
(detail.)441 466 y(In)36 b(this)f(section)h(w)m(e)h(sho)m(w)f(some)g
(simple)f(p)s(erformance)g(measuremen)m(ts)i(comparing)e(F)m(C++)h(to)
300 654 y(Hugs)28 b(\(a)g(w)m(ell-kno)m(wn)f(Hask)m(ell)g(in)m
(terpreter)h([32)q(]\))g(and)f(ghc)h(\(an)g(optimizing)e(Hask)m(ell)i
(compiler)e([26)q(]\).)300 841 y(The)21 b(b)s(enc)m(hmarks)f(are)i
(programs)f(that)h(C++)e(programmers)h(are)h(unlik)m(ely)d(to)j(write)e
(in)g(this)h(form,)i(but)300 1028 y(they)36 b(sho)m(w)f(common)h
(functional)e(programming)g(idioms,)h(in)m(v)m(olving)f(hea)m(vy)i(use)
f(of)h(lazy)g(\(in\014nite\))300 1216 y(lists.)j(Therefore,)31
b(these)f(b)s(enc)m(hmarks)g(serv)m(e)h(as)f(stress)h(tests)g(of)f(F)m
(C++'s)h(lazy)f(lists.)441 1403 y(F)-8 b(or)37 b(eac)m(h)h(b)s(enc)m
(hmark,)g(w)m(e)f(wrote)g(t)m(w)m(o)h(programs:)52 b(one)37
b(in)f(Hask)m(ell,)i(and)e(one)h(in)e(C++)g(using)300
1591 y(the)d(F)m(C++)f(library)-8 b(.)43 b(The)31 b(programs)g(are)h
(faithful)d(translations)i(of)g(eac)m(h)i(other,)g(in)d(that)i(they)g
(eac)m(h)300 1778 y(represen)m(t)f(the)h(same)f(solution)f(to)i(the)g
(giv)m(en)f(problem.)42 b(The)31 b(programs)f(w)m(ere)i(run)e(on)h(a)h
(Sun)e(Sparc)300 1966 y(Ultra-30)c(with)d(128M)j(of)f(RAM.)h(W)-8
b(e)26 b(used)e(g++2.95.2,)k(ghc5.00.1,)g(and)d(the)g(F)-8
b(ebruary)24 b(2001)i(v)m(ersion)300 2153 y(of)31 b(Hugs.)40
b(In)30 b(the)g(case)i(of)e(b)s(oth)g(g++)g(and)g(ghc,)h(w)m(e)g(used)e
(-O2)i(and)f(static)h(linking.)441 2340 y(The)42 b(next)h(three)f
(subsections)g(illustrate)e(our)i(b)s(enc)m(hmark)g(programs)g(and)g
(the)h(p)s(erformance)300 2528 y(results.)69 b(The)40
b(\014nal)f(subsection)h(in)f(this)g(section)i(notes)g(the)f(man)m(y)h
(ca)m(v)m(eats)i(of)d(a)h(cross-language)300 2715 y(p)s(erformance)30
b(comparison,)g(and)f(dra)m(ws)h(only)g(a)g(v)m(ery)h(basic)f
(conclusion)f(from)h(our)g(data.)450 2955 y Fi(2.5.1.1)94
b(Primes)300 3202 y Fm(Primes)33 b(is)g(a)h(simple)e(program)i(that)h
(computes)f(a)h(\(lazy\))f(list)f(of)h(the)h(\014rst)e
Fi(N)48 b Fm(prime)33 b(n)m(um)m(b)s(ers)g(and)300 3389
y(then)e(prin)m(ts)f(the)h Fi(N)15 b Fm(th)31 b(prime.)42
b(It)31 b(do)s(es)g(so)g(simply)e(b)m(y)i(\014ltering)f(all)g(the)i
(primes)d(from)i(the)h(\(in\014nite\))300 3576 y(list)g(of)h(in)m
(tegers,)h(and)f(then)g(taking)g(the)g(\014rst)f Fi(N)48
b Fm(of)33 b(them.)49 b(Figure)32 b(11)i(sho)m(ws)f(the)g(co)s(de)h
(for)f(primes)300 3764 y(in)c(Hask)m(ell.)41 b(Figure)29
b(12)j(sho)m(ws)e(the)g(co)s(de)h(for)f(primes)f(in)g(F)m(C++.)441
3951 y(T)-8 b(able)42 b(1)h(sho)m(ws)f(the)h(p)s(erformance)f(results)f
(for)h(primes)f(for)h(v)-5 b(arious)42 b(v)-5 b(alues)42
b(of)g Fi(N)p Fm(.)h(F)m(C++)f(is)300 4139 y(ab)s(out)f(55)h(times)e
(as)h(fast)h(as)f(Hugs)g(for)g(this)f(program,)j(and)e(also)g
(consisten)m(tly)f(faster)i(than)e(ghc.)300 4326 y(While)c(Hask)m(ell)h
(uses)f(the)i(arbitrary)d(precision)h(t)m(yp)s(e)h Fk(Integer)e
Fm(b)m(y)i(default,)h(explicitly)d(requesting)300 4514
y(32-bit)d Fk(Int)p Fm(s)e(had)h(no)h(measurable)f(e\013ect)i(on)e(the)
h(ghc-compiled)f(program's)g(p)s(erformance.)44 b(On)31
b(the)300 4701 y(other)25 b(hand,)f(using)f Fk(Int)p
Fm(s)h(did)e(sp)s(eed)i(up)f(the)i(Hugs)f(times)g(b)m(y)h(ab)s(out)f
(15)p Fk(\045)h Fm(for)f(eac)m(h)h(run)e(\(the)i(n)m(um)m(b)s(ers)300
4888 y(in)k(the)i(table)f(for)g(Hugs)g(are)h(without)e(the)i(sp)s
(eedup\).)2055 5700 y(88)p eop
%%Page: 89 98
89 97 bop 443 56 a Fk(divisible)45 b(t)j(n)f(=)h(t)f(`rem`)g(n)g(==)g
(0)443 281 y(factors)f(x)h(=)h(filter)e(\(divisible)f(x\))i([1..x])443
507 y(prime)g(x)g(=)g(factors)f(x)i(==)f([1,x])443 733
y(primes)f(n)i(=)f(take)g(n)g(\(filter)f(prime)g([1..]\))443
959 y(l)i(=)f(primes)f(600)443 1185 y(main)h(=do)g(print)f(\(l)h(!!)g
(599\))1496 1480 y Fl(Figure)35 b(11:)47 b Fm(Primes)29
b(in)g(Hask)m(ell)p 1497 1601 1206 4 v 1495 1714 4 113
v 1604 1680 a(N)p 1777 1714 V 156 w(F)m(C++)p 2140 1714
V 112 w(ghc)p 2402 1714 V 113 w(Hugs)p 2701 1714 V 1497
1717 1206 4 v 1497 1734 V 1495 1847 4 113 v 1570 1813
a(200)p 1777 1847 V 174 w(0.26)p 2140 1847 V 153 w(0.27)p
2402 1847 V 156 w(13)p 2701 1847 V 1497 1850 1206 4 v
1495 1963 4 113 v 1570 1929 a(400)p 1777 1963 V 174 w(1.17)p
2140 1963 V 153 w(1.21)p 2402 1963 V 156 w(60)p 2701
1963 V 1497 1966 1206 4 v 1495 2079 4 113 v 1570 2045
a(600)p 1777 2079 V 174 w(2.64)p 2140 2079 V 153 w(3.46)p
2402 2079 V 133 w(146)p 2701 2079 V 1497 2082 1206 4
v 1495 2195 4 113 v 1570 2161 a(800)p 1777 2195 V 174
w(4.89)p 2140 2195 V 153 w(5.37)p 2402 2195 V 133 w(271)p
2701 2195 V 1497 2199 1206 4 v 1495 2312 4 113 v 1547
2278 a(1000)p 1777 2312 V 152 w(7.77)p 2140 2312 V 153
w(8.56)p 2402 2312 V 133 w(424)p 2701 2312 V 1497 2315
1206 4 v 1319 2574 a Fl(T)-9 b(able)34 b(1:)47 b Fm(Primes)29
b(\(all)h(times)g(in)f(seconds\))450 2854 y Fi(2.5.1.2)94
b(T)-7 b(r)i(e)g(e)300 3100 y Fm(T)d(ree)31 b(is)g(a)g(program)g(that)g
(generates)i(a)e(random)f(binary)g(searc)m(h)h(tree)h(of)f(in)m(tegers)
h(and)e(then)h(\(lazily\))300 3288 y(computes)26 b(the)g(\\fringe")f
(of)h(the)g(tree.)40 b(The)25 b(fringe)g(of)h(a)g(tree)g(is)f(a)h(list)
e(of)i(all)f(of)g(the)h(lea)m(v)m(es)h(of)f(the)g(tree,)300
3475 y(in)g(the)i(order)g(they)f(are)i(encoun)m(tered)f(during)d(an)j
(inorder)e(tra)m(v)m(ersal.)41 b(The)27 b(main)f(program)i(prin)m(ts)e
(all)300 3662 y(of)32 b(the)g(no)s(des)f(in)f(the)i(fringe)e(that)j
(matc)m(h)f(an)g(arbitrary)e(v)-5 b(alue)31 b(\(13)i(in)e(the)h
(listings\);)e(this)h(is)g(merely)300 3850 y(a)g(con)m(v)m(enien)m(t)g
(w)m(a)m(y)h(to)f(force)g(the)f(ev)-5 b(aluation)30 b(of)h(the)f(lazy)h
(list.)441 4037 y(Figure)d(13)h(sho)m(ws)f(the)h(Hask)m(ell)f(co)s(de)h
(for)f(tree;)i(Figure)e(14)h(sho)m(ws)f(tree)h(in)e(F)m(C++.)40
b(F)-8 b(or)29 b(b)s(oth)f(the)300 4225 y(Hask)m(ell)f(and)f(C++)f
(programs,)j(the)f(co)s(de)g(that)g(actually)f(builds)e(the)j(random)f
(binary)f(trees)i(is)f(elided)300 4412 y(from)k(the)g(listings.)441
4600 y(T)-8 b(able)24 b(2)h(sho)m(ws)f(the)g(p)s(erformance)g(results)f
(for)h(tree.)39 b Fi(N)g Fm(is)23 b(the)i(n)m(um)m(b)s(er)e(of)h(no)s
(des)g(in)f(the)h(tree.)39 b(No)300 4787 y(results)30
b(are)i(rep)s(orted)f(for)g(Hugs)h(for)f(more)h(than)f(30,000)j(no)s
(des)c(b)s(ecause)i(the)g(system)f(memory)h(w)m(as)300
4975 y(exhausted.)56 b(F)-8 b(or)37 b(this)d(b)s(enc)m(hmark,)i(F)m
(C++)g(is)e(consisten)m(tly)h(faster)h(than)g(Hugs,)h(but)d(ab)s(out)i
(three)300 5162 y(times)24 b(slo)m(w)m(er)g(than)g(ghc.)39
b(In)m(v)m(estigating)25 b(the)g(disparit)m(y)d(b)s(et)m(w)m(een)j(the)
g(F)m(C++)f(and)g(ghc)g(p)s(erformance,)300 5349 y(w)m(e)e(found)d
(that)j(ghc)f(p)s(erforms)f(lazy)h(list)e(concatenation)k(m)m(uc)m(h)e
(faster)g(than)g(F)m(C++)g(do)s(es.)37 b(W)-8 b(e)23
b(plan)c(to)2055 5700 y(89)p eop
%%Page: 90 99
90 98 bop 300 765 a Fk(#include)46 b(<iostream>)300 878
y(#include)g("prelude.h")300 990 y(using)g(namespace)g(fcpp;)300
1103 y(using)g(std::cout;)f(using)i(std::endl;)300 1329
y(struct)f(Divisible)f(:)j(public)e(CFunType<int,int,bool>)c({)443
1442 y(bool)47 b(operator\(\)\()e(int)h(x,)i(int)f(y)g(\))g(const)443
1555 y({)h(return)e(x\045y==0;)g(})300 1668 y(})h(divisible;)300
1894 y(struct)f(Factors)g(:)h(public)f(CFunType<int,OddList<int>)41
b(>)48 b({)443 2007 y(OddList<int>)d(operator\(\)\()f(int)j(x)h(\))f
(const)g({)586 2120 y(return)f(filter\()g(thunk2\(divisible,x\),)1302
2232 y(enumFromTo\(1,x\))e(\);)443 2345 y(})300 2458
y(})j(factors;)300 2684 y(struct)f(Prime)g(:)i(public)e
(CFunType<int,bool>)d({)443 2797 y(bool)k(operator\(\)\()e(int)h(x)i
(\))f(const)g({)586 2910 y(return)f(factors\(x\)==cons\(1,cons\(x,)o
(NIL\))o(\);)443 3023 y(})300 3136 y(})h(prime;)300 3362
y(struct)f(Primes)g(:)i(public)e(CFunType<int,OddList<in)o(t>)c(>)47
b({)443 3474 y(OddList<int>)e(operator\(\)\()f(int)j(n)h(\))f(const)g
({)586 3587 y(return)f(take\()h(n,)g(filter\()f(prime,)g(enumFrom\(1\))
f(\))i(\);)443 3700 y(})300 3813 y(})g(primes;)300 4039
y(int)g(main\(\))f({)443 4152 y(OddList<int>)f(l)i(=)h(primes\(NUM\);)
443 4265 y(cout)f(<<)g(at\()g(l,)g(NUM-1)f(\))i(<<)f(endl;)300
4378 y(})1507 4673 y Fl(Figure)35 b(12:)47 b Fm(Primes)29
b(in)g(F)m(C++)2055 5700 y(90)p eop
%%Page: 91 100
91 99 bop 300 63 a Fk(data)47 b(Tree)f(a)i(=)f(Node)g(!a)g(!\(Tree)f
(a\))h(!\(Tree)f(a\))873 176 y(|)h(Nil)300 402 y(leaf)g(\(Node)f(_)h
(Nil)g(Nil\))g(=)g(True)300 515 y(leaf)g(\(Node)f(_)h(_)h(_\))238
b(=)47 b(False)300 741 y(fringe)f(Nil)620 b(=)47 b([])300
854 y(fringe)f(n@\(Node)g(d)h(l)h(r\))443 966 y(|)g(leaf)e(n)573
b(=)47 b([d])443 1079 y(|)h(otherwise)427 b(=)47 b(fringe)f(l)i(++)f
(fringe)f(r)300 1305 y(main)h(=do)g(--//)f(code)h(to)g(make)g(a)g
(random)f(tree)h("t")730 1418 y(print)f(\(filter)g(\(==)h(13\))g
(\(fringe)e(t\)\))1546 1714 y Fl(Figure)35 b(13:)47 b
Fm(T)-8 b(ree)31 b(in)e(Hask)m(ell)p 1452 1834 1297 4
v 1450 1947 4 113 v 1604 1913 a(N)p 1822 1947 V 202 w(F)m(C++)p
2186 1947 V 112 w(ghc)p 2447 1947 V 113 w(Hugs)p 2747
1947 V 1452 1950 1297 4 v 1452 1967 V 1450 2080 4 113
v 1524 2046 a(10000)p 1822 2080 V 176 w(0.08)p 2186 2080
V 152 w(0.03)p 2447 2080 V 121 w(0.24)p 2747 2080 V 1452
2083 1297 4 v 1450 2196 4 113 v 1524 2162 a(20000)p 1822
2196 V 176 w(0.19)p 2186 2196 V 152 w(0.06)p 2447 2196
V 121 w(0.56)p 2747 2196 V 1452 2200 1297 4 v 1450 2312
4 113 v 1524 2279 a(30000)p 1822 2312 V 176 w(0.29)p
2186 2312 V 152 w(0.10)p 2447 2312 V 121 w(0.89)p 2747
2312 V 1452 2316 1297 4 v 1450 2429 4 113 v 1524 2395
a(40000)p 1822 2429 V 176 w(0.41)p 2186 2429 V 152 w(0.12)p
2447 2429 V 186 w(-)p 2747 2429 V 1452 2432 1297 4 v
1450 2545 4 113 v 1524 2511 a(80000)p 1822 2545 V 176
w(0.87)p 2186 2545 V 152 w(0.26)p 2447 2545 V 186 w(-)p
2747 2545 V 1452 2548 1297 4 v 1450 2661 4 113 v 1501
2627 a(160000)p 1822 2661 V 154 w(1.69)p 2186 2661 V
152 w(0.56)p 2447 2661 V 186 w(-)p 2747 2661 V 1452 2664
1297 4 v 1369 2924 a Fl(T)-9 b(able)35 b(2:)46 b Fm(T)-8
b(ree)31 b(\(all)f(times)g(in)f(seconds\))300 3204 y(searc)m(h)g
(further)e(for)i(a)g(generally)f(applicable)e(optimization)i(that)h
(will)d(sp)s(eed)h(up)h(list)f(concatenation.)300 3391
y(Note)34 b(that)f(for)g(T)-8 b(ree,)34 b(using)d Fk(Int)p
Fm(s)h(instead)g(of)h Fk(Integer)p Fm(s)d(had)i(no)h(measurable)f
(e\013ect)i(on)e(the)h(times)300 3579 y(for)d(either)g(ghc)h(or)f
(Hugs.)450 3819 y Fi(2.5.1.3)94 b(Hamming)300 4065 y
Fm(The)37 b(\014nal)g(program)h(computes)g(Hamming)f(n)m(um)m(b)s(ers.)
62 b(Hamming)38 b(n)m(um)m(b)s(ers)e(are)j(all)e(the)h(in)m(tegers)300
4252 y(whic)m(h)31 b(are)h(pro)s(ducts)f(of)h(p)s(o)m(w)m(ers)g(of)g
(2,)h(3,)g(and)f(5.)46 b(An)31 b(elegan)m(t)j(w)m(a)m(y)f(to)f(compute)
h(the)f(\(in\014nite\))e(list)300 4440 y(of)k(all)f(Hamming)g(n)m(um)m
(b)s(ers)g(is)g(to)i(sa)m(y)g(that)f(the)g(\014rst)g(n)m(um)m(b)s(er)e
(in)h(the)h(list)f(is)g(1,)j(and)d(that)i(the)f(rest)300
4627 y(of)f(the)f(list)f(is)h(computed)g(b)m(y)g(merging)g(three)g
(other)h(lists:)43 b(t)m(wice,)34 b(three)f(times,)f(and)g(\014v)m(e)h
(times)f(the)300 4815 y(list)c(of)h(Hamming)g(n)m(um)m(b)s(ers)f
(itself.)39 b(The)29 b(solution)e(is)i(v)m(ery)g(easy)h(to)g(express)f
(recursiv)m(ely)f(in)g(Hask)m(ell;)300 5002 y(it)k(is)g(giv)m(en)h(in)e
(Figure)h(15.)49 b(Notice)34 b(ho)m(w)e(the)h(de\014nition)e(of)i
Fk(hamming)d Fm(refers)j(to)g Fk(hamming)e Fm(itself.)46
b(T)-8 b(o)300 5189 y(construct)29 b(the)f(same)h(solution)e(in)g(C++,)
h(w)m(e)g(need)g(to)h(b)s(e)f(a)h(little)e(more)h(v)m(erb)s(ose,)h(but)
f(the)g(structure)300 5377 y(is)h(exactly)j(the)e(same.)41
b(The)30 b(F)m(C++)g(co)s(de)h(is)e(sho)m(wn)h(in)f(Figure)h(16.)2055
5700 y(91)p eop
%%Page: 92 101
92 100 bop 300 595 a Fk(#include)46 b(<iostream>)300
708 y(#include)g("prelude.h")300 821 y(using)g(namespace)g(fcpp;)300
934 y(using)g(std::cout;)f(using)i(std::endl;)300 1160
y(struct)f(Tree)h({)443 1273 y(int)g(data;)443 1386 y(Tree)g(*left;)443
1499 y(Tree)g(*right;)443 1724 y(Tree\()g(int)f(x)i(\))f(:)h
(data\(x\),)d(left\(0\),)h(right\(0\))f({})443 1837 y(Tree\()i(int)f
(x,)i(Tree*)e(l,)h(Tree*)g(r)g(\))g(:)h(data\(x\),)d(left\(l\),)h
(right\(r\))g({})443 1950 y(bool)h(leaf\(\))f(const)g({)i(return)e
(\(left==0\))f(&&)i(\(right==0\);)e(})300 2063 y(};)300
2289 y(struct)h(Fringe)g(:)i(public)e(CFunType<Tree*,OddList<)o(int>)41
b(>)48 b({)443 2402 y(OddList<int>)d(operator\(\)\()f(Tree*)j(t)g(\))h
(const)e({)586 2515 y(if\()h(t==0)g(\))730 2628 y(return)f(NIL;)586
2741 y(else)h(if\()g(t->leaf\(\))e(\))730 2853 y(return)h
(cons\(t->data,NIL\);)586 2966 y(else)730 3079 y(return)g(cat\()g
(Fringe\(\)\(t->left\),)d(thunk1\(Fringe\(\),t->right\))e(\);)443
3192 y(})300 3305 y(};)300 3418 y(Fringe)46 b(fringe;)300
3644 y(int)h(main\(\))f({)443 3757 y(//)h(code)g(to)g(build)g(tree)f
("t")443 3870 y(List<int>)f(l)j(=)f(fringe\(t\);)443
3983 y(l)h(=)f(filter\()f(fcpp::equal\(13\),)d(l)48 b(\);)443
4095 y(while\()e(!null\(l\))g(\))h({)586 4208 y(cout)g(<<)g(head\(l\))f
(<<)h(endl;)586 4321 y(l)h(=)f(tail\(l\);)443 4434 y(})300
4547 y(})1557 4843 y Fl(Figure)35 b(14:)47 b Fm(T)-8
b(ree)31 b(in)e(F)m(C++)2055 5700 y(92)p eop
%%Page: 93 102
93 101 bop 443 63 a Fk(merge)47 b(a@\(x:xs\))e(b@\(y:ys\))h(=)586
176 y(if)286 b(x)48 b(<)f(y)h(then)e(x)i(:)f(\(merge)f(xs)h(b\))586
289 y(else)g(if)g(x)h(>)f(y)h(then)e(y)i(:)f(\(merge)f(a)i(ys\))586
402 y(else)715 b(x)48 b(:)f(\(merge)f(xs)h(ys\))443 628
y(hamming)f(=)586 741 y(1)i(:)f(\(merge)f(\(merge)g(\(map)h(\(*2\))g
(hamming\))1445 854 y(\(map)g(\(*3\))g(hamming\)\))1111
966 y(\(map)g(\(*5\))g(hamming\))e(\))443 1192 y(main)i(=do)g(putStr)f
("Hamming)f(number:)h(")873 1305 y(print)g(2000)873 1418
y(putStr)g("is)h(")873 1644 y(print)f(\(hamming)g(!!)h(2000\))1440
1939 y Fl(Figure)35 b(15:)47 b Fm(Hamming)30 b(in)f(Hask)m(ell)p
1474 2060 1252 4 v 1472 2173 4 113 v 1604 2139 a(N)p
1800 2173 V 179 w(F)m(C++)p 2163 2173 V 112 w(ghc)p 2424
2173 V 113 w(Hugs)p 2724 2173 V 1474 2176 1252 4 v 1474
2193 V 1472 2306 4 113 v 1547 2272 a(1000)p 1800 2306
V 175 w(0.02)p 2163 2306 V 153 w(0.01)p 2424 2306 V 120
w(0.17)p 2724 2306 V 1474 2309 1252 4 v 1472 2422 4 113
v 1547 2388 a(1500)p 1800 2422 V 175 w(0.03)p 2163 2422
V 153 w(0.02)p 2424 2422 V 120 w(0.24)p 2724 2422 V 1474
2425 1252 4 v 1472 2538 4 113 v 1547 2504 a(2000)p 1800
2538 V 175 w(0.03)p 2163 2538 V 153 w(0.02)p 2424 2538
V 120 w(0.34)p 2724 2538 V 1474 2542 1252 4 v 1472 2654
4 113 v 1547 2621 a(4000)p 1800 2654 V 175 w(0.07)p 2163
2654 V 153 w(0.05)p 2424 2654 V 120 w(0.68)p 2724 2654
V 1474 2658 1252 4 v 1472 2771 4 113 v 1547 2737 a(8000)p
1800 2771 V 175 w(0.14)p 2163 2771 V 153 w(0.13)p 2424
2771 V 120 w(1.42)p 2724 2771 V 1474 2774 1252 4 v 1472
2887 4 113 v 1524 2853 a(12000)p 1800 2887 V 153 w(0.21)p
2163 2887 V 153 w(0.19)p 2424 2887 V 120 w(2.21)p 2724
2887 V 1474 2890 1252 4 v 1263 3149 a Fl(T)-9 b(able)35
b(3:)46 b Fm(Hamming)30 b(\(all)g(times)g(in)f(seconds\))441
3430 y(T)-8 b(able)40 b(3)h(sho)m(ws)g(the)g(relativ)m(e)f(p)s
(erformance)g(of)h(the)g(programs)f(to)i(prin)m(t)d(the)i
Fi(N)15 b Fm(th)40 b(Hamming)300 3617 y(n)m(um)m(b)s(er.)i(Again,)32
b(F)m(C++)f(outp)s(erforms)f(Hugs,)i(this)e(time)h(b)m(y)g(a)h(factor)g
(of)g(ab)s(out)f(10;)i(the)e(times)g(for)300 3804 y(F)m(C++)26
b(and)g(ghc)g(are)h(nearly)f(equal.)38 b(F)-8 b(or)28
b(this)d(program,)i(w)m(e)g(could)e(not)i(use)f(the)g(32-bit)h
Fk(Int)e Fm(in)g(place)300 3992 y(of)34 b Fk(Integer)p
Fm(,)g(as)g Fk(Int)f Fm(is)g(not)i(wide)e(enough|our)g(C++)g(Hamming)h
(co)s(de)g(needs)g(the)g(g++-sp)s(eci\014c)300 4179 y
Fk(long)47 b(long)f(int)30 b Fm(\(64)h(bits\))f(to)h(handle)e(the)i
(large)f(n)m(um)m(b)s(ers)f(in)m(v)m(olv)m(ed)h(in)f(this)g(example.)
450 4419 y Fi(2.5.1.4)94 b(Disclaimers)34 b(and)f(c)-5
b(onclusions)300 4665 y Fm(In)21 b(this)f(section,)k(w)m(e)e(ha)m(v)m
(e)g(compared)g(the)g(p)s(erformance)e(of)i(C++)f(programs)g(with)f
(Hask)m(ell)h(programs.)300 4853 y(It)35 b(is)e(imp)s(ortan)m(t)h(to)h
(note)g(that)g(no)g(direct)f(comparison)g(can)g(really)g(b)s(e)g(made.)
53 b(All)33 b(cross-language)300 5040 y(exp)s(erimen)m(ts)j(are)h
(fraugh)m(t)g(with)e(factors)j(that)f(mak)m(e)h(a)f(direct)g
(apples-to-apples)f(comparison)g(im-)300 5228 y(p)s(ossible,)29
b(and)h(our)g(exp)s(erimen)m(ts)g(are)i(no)e(di\013eren)m(t.)42
b(There)30 b(are)i(man)m(y)f(confounding)e(factors,)j(a)f(few)2055
5700 y(93)p eop
%%Page: 94 103
94 102 bop 300 313 a Fk(#include)46 b(<iostream>)300
426 y(#include)g("prelude.h")300 539 y(using)g(namespace)g(fcpp;)300
652 y(using)g(std::cout;)f(using)i(std::endl;)300 878
y(struct)f(Merge)g({)443 990 y(template)g(<class)g(L,)h(class)f(M>)443
1103 y(struct)g(Sig)h(:)h(public)e(FunType<L,M,OddList<L::)o(Elem)o
(entT)o(ype)o(>)c(>)47 b({};)443 1329 y(template)f(<class)g(T>)443
1442 y(OddList<T>)f(operator\(\)\()g(const)h(List<T>&)g(a,)h(const)f
(List<T>&)g(b)h(\))h(const)e({)586 1555 y(T)i(x)f(=)h(head\(a\);)586
1668 y(T)g(y)f(=)h(head\(b\);)586 1781 y(if\()f(x)h(<)f(y)h(\))730
1894 y(return)e(cons\()g(x,)h(thunk2\()f(Merge\(\),)g(tail\(a\),)f(b)j
(\)\);)586 2007 y(else)f(if\()g(x)g(>)h(y)f(\))730 2120
y(return)f(cons\()g(y,)h(thunk2\()f(Merge\(\),)g(a,)h(tail\(b\))f
(\)\);)586 2232 y(else)730 2345 y(return)g(cons\()g(x,)h(thunk2\()f
(Merge\(\),)g(tail\(a\),)f(tail\(b\))h(\)\);)443 2458
y(})300 2571 y(})h(merge;)300 2797 y(typedef)f(long)g(long)h(int)g
(FOO;)g(//)g(g++)g(has)g("long)f(long")300 3023 y(struct)g(Hamming)g(:)
h(public)f(CFunType<)g(List<FOO>)f(>)i({)443 3136 y(List<FOO>)e
(operator)h(\(\))h(\(\))g(const)g({)586 3249 y(using)g
(fcpp::multiplies;)586 3362 y(static)f(List<FOO>)g(h)h(=)h
(Hamming\(\);)586 3474 y(static)e(List<FOO>)g(x)h(=)h(thunk2\()d(map,)i
(multiplies\()e(\(FOO\)2\),)g(h)j(\);)586 3587 y(static)e(List<FOO>)g
(y)h(=)h(thunk2\()d(map,)i(multiplies\()e(\(FOO\)3\),)g(h)j(\);)586
3700 y(static)e(List<FOO>)g(z)h(=)h(thunk2\()d(map,)i(multiplies\()e
(\(FOO\)5\),)g(h)j(\);)586 3813 y(static)e(List<FOO>)g(m1=)h(thunk2\()e
(merge,)i(x,)g(y)g(\);)586 3926 y(static)f(List<FOO>)g(m2=)h(thunk2\()e
(merge,)i(m1,)f(z)i(\);)586 4039 y(return)e(cons\()h(\(FOO\)1,)f(m2)h
(\);)443 4152 y(})300 4265 y(})g(hamming;)300 4491 y(int)g(main\(\))f
({)443 4604 y(cout)h(<<)g("The)g("<<NUM<<"th)d(hamming)i(number)g(is:)h
(";)443 4716 y(cout)g(<<)g(at\()g(hamming\(\),)e(NUM)i(\))g(<<)g(endl;)
300 4829 y(})1451 5125 y Fl(Figure)35 b(16:)47 b Fm(Hamming)30
b(in)f(F)m(C++)2055 5700 y(94)p eop
%%Page: 95 104
95 103 bop 300 91 a Fm(of)29 b(whic)m(h)e(w)m(ere)i(men)m(tioned)f(at)h
(the)g(b)s(eginning)d(of)i(this)g(section.)40 b(Here)29
b(w)m(e)g(list)e(a)i(handful)d(of)j(ob)m(vious)300 279
y(di\013erences)h(b)s(et)m(w)m(een)h(F)m(C++)f(and)g(Hask)m(ell)g(whic)
m(h)f(w)m(e)i(ha)m(v)m(e)g(not)g(attempted)g(to)g(accoun)m(t)h(for.)436
566 y Fh(\017)46 b Fi(Strictness)p Fm(.)57 b(Hask)m(ell)35
b(is)f(lazy)h(\(non-strict\))h(throughout,)g(whereas)f(C++)g(is)f
(strict)h(except)h(in)527 753 y(F)m(C++)30 b(lazy)h(lists,)e(whic)m(h)g
(are)i(explicitly)d(co)s(ded)i(to)h(b)s(e)f(lazy)-8 b(.)436
1015 y Fh(\017)46 b Fi(Memory)34 b(management)p Fm(.)45
b(F)m(C++)31 b(manages)h(memory)f(with)f(reference-coun)m(ted)i(p)s
(oin)m(ters)f(and)527 1203 y(uses)45 b(the)g(default)g(allo)s(cator)g
(pro)m(vided)f(b)m(y)h(our)f(implemen)m(tation.)84 b(Hask)m(ell)45
b(uses)g(garbage)527 1390 y(collection,)34 b(and)f(a)g(sophisticated)f
(allo)s(cator)i(designed)e(for)h(optimal)f(p)s(erformance)g(for)h(a)h
(lazy)527 1578 y(functional)29 b(language.)436 1840 y
Fh(\017)46 b Fi(Exc)-5 b(eption)43 b(hand)5 b(ling)p
Fm(.)73 b(Hask)m(ell)40 b(has)h(more)f(exception-handling)f(b)m(y)h
(default;)46 b(for)40 b(example,)527 2027 y(taking)33
b(the)g Fk(head\(\))e Fm(of)i(an)g(empt)m(y)g(list)f(raises)g(an)g
(exception)h(in)f(Hask)m(ell,)h(whereas)g(it)f(simply)527
2215 y(leads)25 b(to)i(unde\014ned)c(b)s(eha)m(vior)i(in)f(F)m(C++)h
(\(though)h(w)m(e)g(do)g(ha)m(v)m(e)g(a)g(compiler)e(\015ag)i(that)h
(enables)527 2402 y(exceptions)k(for)f(this)f(kind)g(of)h(misuse\).)436
2664 y Fh(\017)46 b Fi(R)n(untime)p Fm(.)40 b(Hask)m(ell)28
b(has)g(a)h(run-time)e(system)h(whic)m(h)f(supp)s(orts)f(a)j(mix)e(of)h
(compiled)f(and)g(in)m(ter-)527 2852 y(preted)35 b(co)s(de,)i(manages)f
(storage)h(allo)s(cation,)f(and)e(supp)s(orts)g(concurren)m(t)h
(threads)g(of)g(execu-)527 3039 y(tion.)40 b(C++)30 b(has)g(no)g
(comparable)g(run-time)f(system.)436 3301 y Fh(\017)46
b Fi(Optimizations)p Fm(.)81 b(Man)m(y)44 b(F)m(C++)f(optimizations)f
(m)m(ust)h(b)s(e)g(done)g(\\b)m(y)h(hand";)49 b(the)43
b(Hask)m(ell)527 3489 y(compiler)29 b(p)s(erforms)g(similar)f
(optimizations)h(automatically)-8 b(.)441 3776 y(By)34
b(listing)d(these)j(confounding)d(factors,)36 b(it)c(is)h(not)g(our)g
(in)m(ten)m(tion)g(to)h(in)m(v)-5 b(alidate)32 b(the)i(results)e(of)300
3963 y(the)38 b(exp)s(erimen)m(ts)g(of)g(this)f(section.)65
b(Rather,)41 b(w)m(e)d(simply)e(wish)h(to)i(mak)m(e)g(explicit)e(the)h
(con)m(text)i(in)300 4151 y(whic)m(h)35 b(the)i(results)f(m)m(ust)g(b)s
(e)g(in)m(terpreted.)59 b(It)37 b(is)f(meaningless)f(to)j(mak)m(e)g
(general)e(statemen)m(ts)j(lik)m(e)300 4338 y(\\F)m(C++)29
b(is)f(faster)i(than)f(Hask)m(ell")g(or)g(vice-v)m(ersa.)42
b(Our)27 b(goal)j(is)e(merely)h(to)g(demonstrate)h(that,)g(ev)m(en)300
4526 y(for)41 b(b)s(enc)m(hmarks)g(whic)m(h)f(mak)m(e)j(hea)m(vy)f(use)
f(of)h(lists)e(and)h(lazy)h(ev)-5 b(aluation,)44 b(F)m(C++)d(can)h(p)s
(erform)300 4713 y(roughly)29 b(comparably)h(to)h(an)f(optimized)f
(functional)g(implemen)m(tation.)300 4953 y Fl(2.5.2)105
b(P)m(erformance)35 b(analysis)h(and)f(optimizations)300
5199 y Fm(The)j(curren)m(t)h(F)m(C++)f(implemen)m(tation)g(is)f(more)i
(than)g(an)f(order)h(or)f(magnitude)g(faster)h(than)g(the)300
5387 y(previous)30 b(release)i(of)f(the)h(library)-8
b(.)42 b(In)31 b(this)g(section,)h(w)m(e)g(discuss)d(six)i(ma)5
b(jor)31 b(optimizations)g(w)m(e)h(ha)m(v)m(e)2055 5700
y(95)p eop
%%Page: 96 105
96 104 bop 300 91 a Fm(applied)30 b(to)j(our)f(implemen)m(tation,)g
(quan)m(tifying)f(the)i(individual)28 b(b)s(ene\014ts)j(whenev)m(er)i
(p)s(ossible.)44 b(F)-8 b(or)300 279 y(eac)m(h)23 b(optimization,)f(w)m
(e)g(pic)m(k)m(ed)g(an)g(appropriate)e(b)s(enc)m(hmark)h(that)h
(clearly)f(demonstrates)h(the)g(di\013er-)300 466 y(ence)30
b(in)e(p)s(erformance.)40 b(\(The)29 b(di\013erence)f(for)i(the)f
(other)h(programs)e(is)h(t)m(ypically)f(less)h(dramatic.\))40
b(A)m(t)300 654 y(the)29 b(end)g(of)g(the)h(section,)f(w)m(e)h(also)f
(rep)s(eat)h(an)f(exp)s(erimen)m(t)f(from)h([48)q(],)h(comparing)e(the)
i(p)s(erformance)300 841 y(of)h(F)m(C++)f(with)f(L\177)-45
b(aufer's)30 b(library)-8 b(.)450 1080 y Fi(2.5.2.1)94
b(Caching)300 1326 y Fm(The)24 b(\014rst)g(optimization)f(is)h(cac)m
(hing)h(\(memoization\))g(in)e(lazy)i(lists.)37 b(A)25
b(lazy)f(list)g(is)f(represen)m(ted)i(b)m(y)f(an)300
1514 y(unev)-5 b(aluated)26 b(function,)g(or)h(\\th)m(unk".)39
b(When)27 b(the)f(v)-5 b(alue)26 b(of)h(the)g(list)e(is)h(requested)g
(\()p Fk(head\(\))p Fm(,)g Fk(tail\(\))p Fm(,)300 1701
y(or)31 b Fk(null\(\))e Fm(is)h(called\),)g(the)h(th)m(unk)f(is)g
(called)g(in)f(order)i(to)g(pro)s(duce)f(the)h(v)-5 b(alue.)41
b(Rather)31 b(than)f(re-call)300 1888 y(the)e(th)m(unk)e(eac)m(h)j
(time)e(the)h(list's)e(v)-5 b(alue)27 b(is)f(needed,)i(the)g(th)m(unk)e
(should)g(b)s(e)h(called)f(only)h(once,)i(and)e(its)300
2076 y(v)-5 b(alue)36 b(remem)m(b)s(ered.)58 b(This)35
b(optimization)h(is)f(imp)s(erativ)m(e)h(for)g(programs)g(lik)m(e)g
(Hamming;)j(without)300 2263 y(cac)m(hing,)28 b(Hamming)d(gro)m(ws)i
(exp)s(onen)m(tially)e(\(rather)h(than)g(linearly\).)38
b(In)25 b(an)h(older)g(v)m(ersion)g(of)g(F)m(C++)300
2451 y(where)k(cac)m(hing)h(w)m(as)f(not)h(a)m(v)-5 b(ailable)30
b(to)h(lists,)e(Hamming\(300\))j(to)s(ok)f(o)m(v)m(er)g(30)h(seconds)e
(to)h(compute!)441 2638 y(Cac)m(hing)c(is)g(implemen)m(ted)f(as)h(a)h
(kind)e(of)h(v)-5 b(arian)m(t)28 b(record.)39 b(Conceptually)-8
b(,)28 b(a)f(\\memoized)h(th)m(unk")300 2826 y(or)i(\\cac)m(he")j(is)
443 3082 y Fk(class)47 b(Cache)f({)586 3269 y(bool)h(value_is_valid;)
586 3457 y(Fun0<Value>)e(function;)586 3644 y(Value)i(value;)443
3832 y(public:)586 4019 y(Value)g(val\(\))f({)730 4207
y(if\()g(!value_is_valid)e(\))873 4394 y({)j(value=function\(\);)c
(value_is_valid=true;)g(})730 4581 y(return)j(value;)586
4769 y(})443 4956 y(};)300 5213 y Fm(In)33 b(the)g(actual)h(implemen)m
(tation,)e(w)m(e)i(eliminate)e(the)i(space)f(o)m(v)m(erhead)i(of)e(the)
h(b)s(o)s(olean)e(v)-5 b(ariable)32 b(b)m(y)300 5400
y(using)d(a)i(distinguished)26 b Fk(Value)j Fm(\(named)h
Fk(XBAD)p Fm(\))g(to)h(represen)m(t)f(the)h Fk(!value_is_valid)26
b Fm(state.)2055 5700 y(96)p eop
%%Page: 97 106
97 105 bop 300 2308 a @beginspecial 0 @llx 0 @lly 371
@urx 277 @ury 3710 @rwi @setspecial
%%BeginDocument: figurex.eps
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 277 moveto 0 0 lineto 371 0 lineto 371 277 lineto closepath clip newpath
-12.0 287.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 1319 3487 m
 1319 3925 l gs col0 s gr 
% Polyline
n 1264 3487 m 1976 3487 l 1976 3925 l 1264 3925 l
 cp gs col0 s gr 
% Polyline
gs  clippath
1231 3722 m 1217 3680 l 1105 3717 l 1195 3711 l 1118 3759 l cp
eoclip
n 881 3815 m
 1210 3706 l gs col0 s gr gr

% arrowhead
n 1118 3759 m 1195 3711 l 1105 3717 l 1118 3759 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
2269 3722 m 2257 3680 l 2142 3712 l 2233 3710 l 2154 3755 l cp
eoclip
n 1866 3815 m
 2249 3706 l gs col0 s gr gr

% arrowhead
n 2154 3755 m 2233 3710 l 2142 3712 l 2154 3755 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 2249 2065 m
 2960 2065 l gs col0 s gr 
% Polyline
n 2632 2065 m 2632 2119 l 2632 2229 l
 2632 2284 l gs col0 s gr 
% Polyline
n 2304 1846 m
 2304 2284 l gs col0 s gr 
% Polyline
n 2249 1846 m 2960 1846 l 2960 2284 l 2249 2284 l
 cp gs col0 s gr 
% Polyline
n 1210 2065 m
 1921 2065 l gs col0 s gr 
% Polyline
n 1593 2065 m 1593 2119 l 1593 2229 l
 1593 2284 l gs col0 s gr 
% Polyline
n 1264 1846 m
 1264 2284 l gs col0 s gr 
% Polyline
n 1210 1846 m 1921 1846 l 1921 2284 l 1210 2284 l
 cp gs col0 s gr 
% Polyline
gs  clippath
1176 2081 m 1162 2039 l 1050 2076 l 1140 2070 l 1063 2118 l cp
eoclip
n 827 2174 m
 1155 2065 l gs col0 s gr gr

% arrowhead
n 1063 2118 m 1140 2070 l 1050 2076 l 1063 2118 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
2214 2081 m 2202 2039 l 2087 2071 l 2178 2069 l 2099 2114 l cp
eoclip
n 1811 2174 m
 2194 2065 l gs col0 s gr gr

% arrowhead
n 2099 2114 m 2178 2069 l 2087 2071 l 2099 2114 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 1593 424 m
 1593 642 l gs col0 s gr 
% Polyline
n 1374 424 m 1811 424 l 1811 642 l 1374 642 l
 cp gs col0 s gr 
% Polyline
gs  clippath
574 549 m 560 507 l 448 544 l 538 538 l 461 586 l cp
eoclip
n 225 642 m
 553 533 l gs col0 s gr gr

% arrowhead
n 461 586 m 538 538 l 448 544 l 461 586 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 3070 424 m
 3070 642 l gs col0 s gr 
% Polyline
n 2851 424 m 3289 424 l 3289 642 l 2851 642 l
 cp gs col0 s gr 
% Polyline
gs  clippath
2817 549 m 2803 507 l 2691 544 l 2781 538 l 2704 586 l cp
eoclip
n 2468 642 m
 2796 533 l gs col0 s gr gr

% arrowhead
n 2704 586 m 2781 538 l 2691 544 l 2704 586 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
2045 554 m 2045 511 l 1926 511 l 2014 533 l 1926 554 l cp
eoclip
n 1702 533 m
 2030 533 l gs col0 s gr gr

% arrowhead
n 1926 554 m 2014 533 l 1926 511 l 1926 554 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
1340 549 m 1326 507 l 1214 544 l 1304 538 l 1227 586 l cp
eoclip
n 991 642 m
 1319 533 l gs col0 s gr gr

% arrowhead
n 1227 586 m 1304 538 l 1214 544 l 1227 586 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 1647 3706 m 1647 3761 l 1647 3870 l
 1647 3925 l gs col0 s gr 
/Times-Roman ff 135.00 scf sf
2468 4308 m
gs 1 -1 sc (2) col0 sh gr
/Times-Roman ff 135.00 scf sf
1429 4308 m
gs 1 -1 sc (1) col0 sh gr
/Times-Roman ff 135.00 scf sf
2413 2229 m
gs 1 -1 sc (2) col0 sh gr
/Times-Roman ff 135.00 scf sf
1374 2229 m
gs 1 -1 sc (1) col0 sh gr
/Times-Roman ff 135.00 scf sf
2906 588 m
gs 1 -1 sc (2) col0 sh gr
/Times-Roman ff 135.00 scf sf
1429 588 m
gs 1 -1 sc (1) col0 sh gr
/Times-Roman ff 135.00 scf sf
2577 3651 m
gs 1 -1 sc (fxn) col0 sh gr
/Times-Roman ff 135.00 scf sf
1538 3651 m
gs 1 -1 sc (fxn) col0 sh gr
/Times-Roman ff 135.00 scf sf
2523 2010 m
gs 1 -1 sc (fxn) col0 sh gr
/Times-Roman ff 135.00 scf sf
1483 2010 m
gs 1 -1 sc (fxn) col0 sh gr
/Times-Roman ff 135.00 scf sf
1593 2885 m
gs 1 -1 sc (MIDDLE) col0 sh gr
/Times-Roman ff 135.00 scf sf
1593 4636 m
gs 1 -1 sc (BOTTOM) col0 sh gr
/Times-Roman ff 135.00 scf sf
1647 1080 m
gs 1 -1 sc (TOP) col0 sh gr
% Polyline
n 1264 3706 m
 1976 3706 l gs col0 s gr 
% Polyline
gs  clippath
2501 4104 m 2544 4104 l 2544 3985 l 2523 4073 l 2501 3985 l cp
eoclip
n 2523 3815 m
 2523 4089 l gs col0 s gr gr

% arrowhead
n 2501 3985 m 2523 4073 l 2544 3985 l 2501 3985 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
1461 4104 m 1504 4104 l 1504 3985 l 1483 4073 l 1461 3985 l cp
eoclip
n 1483 3815 m
 1483 4089 l gs col0 s gr gr

% arrowhead
n 1461 3985 m 1483 4073 l 1504 3985 l 1461 3985 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 2359 4144 m 2687 4144 l 2687 4362 l 2359 4362 l
 cp gs col0 s gr 
% Polyline
n 1319 4144 m 1647 4144 l 1647 4362 l 1319 4362 l
 cp gs col0 s gr 
% Polyline
n 2304 3706 m
 3015 3706 l gs col0 s gr 
% Polyline
n 2687 3706 m 2687 3761 l 2687 3870 l
 2687 3925 l gs col0 s gr 
% Polyline
n 2359 3487 m
 2359 3925 l gs col0 s gr 
% Polyline
n 2304 3487 m 3015 3487 l 3015 3925 l 2304 3925 l
 cp gs col0 s gr 
% Polyline
n 3234 3706 m
 3234 3925 l gs col0 s gr 
/Courier ff 135.00 scf sf
3781 2207 m
gs 1 -1 sc (   Cache* c;) col0 sh gr
/Courier ff 135.00 scf sf
3781 2054 m
gs 1 -1 sc (class List {) col0 sh gr
/Courier ff 135.00 scf sf
3781 1901 m
gs 1 -1 sc (MIDDLE) col0 sh gr
/Courier ff 135.00 scf sf
3781 2666 m
gs 1 -1 sc (   typedef pair<int,List> Value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 4767 m
gs 1 -1 sc (};) col0 sh gr
/Courier ff 135.00 scf sf
3781 4001 m
gs 1 -1 sc (};) col0 sh gr
/Courier ff 135.00 scf sf
3781 3542 m
gs 1 -1 sc (BOTTOM) col0 sh gr
/Courier ff 135.00 scf sf
3781 4614 m
gs 1 -1 sc (   Value value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 4461 m
gs 1 -1 sc (   Fun0<Value> function;) col0 sh gr
/Courier ff 135.00 scf sf
3781 4308 m
gs 1 -1 sc (   typedef pair<int*,List> Value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 4154 m
gs 1 -1 sc (class Cache {) col0 sh gr
/Courier ff 135.00 scf sf
3781 3848 m
gs 1 -1 sc (   Cache* c;) col0 sh gr
/Courier ff 135.00 scf sf
3781 3695 m
gs 1 -1 sc (class List {) col0 sh gr
/Courier ff 135.00 scf sf
3781 1485 m
gs 1 -1 sc (};) col0 sh gr
/Courier ff 135.00 scf sf
3781 1332 m
gs 1 -1 sc (   Value value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 1178 m
gs 1 -1 sc (   Fun0<Value> function;) col0 sh gr
/Courier ff 135.00 scf sf
3781 872 m
gs 1 -1 sc (class Cache {) col0 sh gr
/Courier ff 135.00 scf sf
3781 719 m
gs 1 -1 sc (};) col0 sh gr
/Courier ff 135.00 scf sf
3781 566 m
gs 1 -1 sc (   Cache* c;) col0 sh gr
/Courier ff 135.00 scf sf
3781 413 m
gs 1 -1 sc (class List {) col0 sh gr
/Courier ff 135.00 scf sf
3781 259 m
gs 1 -1 sc (TOP) col0 sh gr
/Courier ff 135.00 scf sf
3781 1025 m
gs 1 -1 sc (   typedef pair<int,List>* Value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 2360 m
gs 1 -1 sc (};) col0 sh gr
% Polyline
n 3179 3706 m
 3179 3925 l gs col0 s gr 
% Polyline
n 2851 3815 m
 3234 3815 l gs col0 s gr 
% Polyline
n 3179 2065 m
 3179 2284 l gs col0 s gr 
% Polyline
n 3124 2065 m
 3124 2284 l gs col0 s gr 
% Polyline
n 2796 2174 m
 3179 2174 l gs col0 s gr 
% Polyline
n 3507 424 m
 3507 642 l gs col0 s gr 
% Polyline
n 3453 424 m
 3453 642 l gs col0 s gr 
% Polyline
n 3124 533 m
 3507 533 l gs col0 s gr 
/Times-Roman ff 135.00 scf sf
2249 478 m
gs 1 -1 sc (fxn) col0 sh gr
% Polyline
n 2140 314 m
 2140 752 l gs col0 s gr 
% Polyline
n 2136 533 m 2144 533 l gs col0 s gr
% Polyline
n 2085 533 m
 2577 533 l gs col0 s gr 
% Polyline
n 2085 314 m 2577 314 l 2577 752 l 2085 752 l
 cp gs col0 s gr 
/Times-Roman ff 135.00 scf sf
772 478 m
gs 1 -1 sc (fxn) col0 sh gr
% Polyline
n 663 314 m
 663 752 l gs col0 s gr 
% Polyline
n 659 533 m 667 533 l gs col0 s gr
% Polyline
n 608 533 m
 1100 533 l gs col0 s gr 
% Polyline
n 608 314 m 1100 314 l 1100 752 l 608 752 l
 cp gs col0 s gr 
/Courier ff 135.00 scf sf
3781 3126 m
gs 1 -1 sc (};) col0 sh gr
/Courier ff 135.00 scf sf
3781 2973 m
gs 1 -1 sc (   Value value;) col0 sh gr
/Courier ff 135.00 scf sf
3781 2820 m
gs 1 -1 sc (   Fun0<Value> function;) col0 sh gr
/Courier ff 135.00 scf sf
3781 2513 m
gs 1 -1 sc (class Cache {) col0 sh gr
$F2psEnd
rs

%%EndDocument
 @endspecial 1139 2504 a Fl(Figure)35 b(17:)47 b Fm(Three)30
b(p)s(ossible)e(list)h(implemen)m(tations)450 2779 y
Fi(2.5.2.2)94 b(Structur)-5 b(e)34 b(of)f(list)g(implementation)300
3025 y Fm(When)f(w)m(e)h(reimplemen)m(ted)e(F)m(C++)h(lazy)g(lists)f
(to)i(use)f(cac)m(hing,)i(w)m(e)e(exp)s(erimen)m(ted)g(with)f(three)h
(dif-)300 3213 y(feren)m(t)e(structures)f(for)g(the)h(underlying)c
(implemen)m(tation)i(of)i(lazy)f(lists.)39 b(W)-8 b(e)31
b(arbitrarily)c(named)i(the)300 3400 y(three)k(v)m(ersions)f(TOP)-8
b(,)32 b(MIDDLE,)i(and)e(BOTTOM)g(\(the)h(names)f(re\015ect)h(the)g
(order)f(that)h(w)m(e)h(wrote)300 3588 y(them)c(on)g(a)g(white)f(b)s
(oard\).)40 b(These)30 b(structures)f(are)h(represen)m(ted)g(b)s(oth)g
(as)g(sk)m(eleton)g(C++)f(co)s(de)i(and)300 3775 y(pictorially)e(in)h
(Figure)h(17.)45 b(\(T)-8 b(o)32 b(simplify)c(the)j(exp)s(osition,)g
(the)g(co)s(de)h(assumes)f(that)h(lists)e(hold)g(only)300
3963 y Fk(int)p Fm(s)39 b(\(rather)h(than)g(b)s(eing)f
Fk(template)45 b(<class)h(T>)p Fm(s\),)c(and)e(also)g(uses)f(ra)m(w)h
(p)s(oin)m(ters)f(rather)h(than)300 4150 y(reference-coun)m(ted)32
b(p)s(oin)m(ters.\))441 4337 y(W)-8 b(e)46 b(tested)g(all)d(three)i
(list)f(implemen)m(tations)f(on)i(Primes\(1000\);)53
b(the)45 b(results)f(are)h(sho)m(wn)f(in)300 4525 y(T)-8
b(able)32 b(4.)48 b(It)33 b(should)e(b)s(e)h(no)h(surprise)d(that)j
(MIDDLE)g(w)m(as)h(the)e(winner;)g(MIDDLE)i(con)m(tains)f(few)m(er)300
4712 y(indirections)28 b(than)j(the)g(other)h(t)m(w)m(o)g(solutions.)41
b(TOP)31 b(and)f(BOTTOM)h(are)g(b)s(oth)f(slo)m(w)m(er)i(due)e(to)i
(the)300 4900 y(extra)26 b(indirection)c(and)i(p)s(o)s(orer)g(lo)s
(calit)m(y)-8 b(.)39 b(Additionally)-8 b(,)23 b(BOTTOM)i(\(and)f
(MIDDLE)i(to)s(o,)h(actually\))300 5087 y(su\013ers)e(another)h(hit)e
(b)s(ecause)i(it)f(needs)g(a)h(sp)s(ecial)e Fk(value)h
Fm(to)h(represen)m(t)g(the)f(empt)m(y)h(list)f(\(called)g
Fk(XNIL)p Fm(,)300 5275 y(whic)m(h)31 b(is)g(lik)m(e)g
Fk(XBAD)f Fm(men)m(tioned)i(in)e(Section)i(2.5.2.1\),)j(and)d(ev)m(ery)
g(ev)-5 b(aluation)32 b(of)g(a)g(list)f(requires)f(an)2055
5700 y(97)p eop
%%Page: 98 107
98 106 bop 1565 3 1071 4 v 1563 116 4 113 v 1615 82 a
Fm(Primes\(1000\))p 2190 116 V 100 w(Time)30 b(\(s\))p
2634 116 V 1565 120 1071 4 v 1565 136 V 1563 249 4 113
v 1779 215 a(TOP)p 2190 249 V 332 w(12.43)p 2634 249
V 1565 252 1071 4 v 1563 365 4 113 v 1691 331 a(MIDDLE)p
2190 365 V 269 w(7.77)p 2634 365 V 1565 369 1071 4 v
1563 482 4 113 v 1668 448 a(BOTTOM)p 2190 482 V 221 w(26.36)p
2634 482 V 1565 485 1071 4 v 1136 739 a Fl(T)-9 b(able)35
b(4:)46 b Fm(Comparison)29 b(of)i(di\013eren)m(t)f(list)f(structures)
300 1406 y @beginspecial 0 @llx 0 @lly 393 @urx 66 @ury
3930 @rwi @setspecial
%%BeginDocument: figure2x.eps
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 66 moveto 0 0 lineto 393 0 lineto 393 66 lineto closepath clip newpath
-9.0 69.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
 0.06000 0.06000 sc
/Times-Roman ff 180.00 scf sf
150 525 m
gs 1 -1 sc ( ) col0 sh gr
/Times-Roman ff 180.00 scf sf
6375 300 m
gs 1 -1 sc (ref) col0 sh gr
/Times-Roman ff 180.00 scf sf
4275 300 m
gs 1 -1 sc (ref) col0 sh gr
% Polyline
7.500 slw
n 5025 75 m 5850 75 l 5850 1125 l 5025 1125 l
 cp gs col0 s gr 
% Polyline
gs  clippath
5910 495 m 5910 555 l 6061 555 l 5941 525 l 6061 495 l cp
eoclip
n 6450 525 m
 5925 525 l gs col0 s gr gr

% arrowhead
n 6061 495 m 5941 525 l 6061 555 l 6061 495 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
4965 555 m 4965 495 l 4814 495 l 4934 525 l 4814 555 l cp
eoclip
n 4425 525 m
 4950 525 l gs col0 s gr gr

% arrowhead
n 4814 555 m 4934 525 l 4814 495 l 4814 555 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 6300 375 m 6675 375 l 6675 675 l 6300 675 l
 cp gs col0 s gr 
% Polyline
n 4200 375 m 4575 375 l 4575 675 l 4200 675 l
 cp gs col0 s gr 
/Times-Roman ff 180.00 scf sf
5175 975 m
gs 1 -1 sc (obj data) col0 sh gr
/Times-Roman ff 180.00 scf sf
5175 300 m
gs 1 -1 sc ( object) col0 sh gr
/Times-Roman ff 180.00 scf sf
5175 600 m
gs 1 -1 sc ( count) col0 sh gr
% Polyline
n 5100 375 m 5775 375 l 5775 1125 l 5100 1125 l
 cp gs col0 s gr 
% Polyline
n 5100 750 m
 5775 750 l gs col0 s gr 
/Times-Roman ff 180.00 scf sf
3300 225 m
gs 1 -1 sc (ref) col0 sh gr
/Times-Roman ff 180.00 scf sf
1200 225 m
gs 1 -1 sc (ref) col0 sh gr
/Times-Roman ff 180.00 scf sf
2100 975 m
gs 1 -1 sc ( object) col0 sh gr
/Times-Roman ff 180.00 scf sf
2100 375 m
gs 1 -1 sc ( count) col0 sh gr
% Polyline
n 2025 675 m 2700 675 l 2700 1125 l 2025 1125 l
 cp gs col0 s gr 
% Polyline
gs  clippath
2760 720 m 2760 780 l 2911 780 l 2791 750 l 2911 720 l cp
eoclip
n 3375 750 m
 2775 750 l gs col0 s gr gr

% arrowhead
n 2911 720 m 2791 750 l 2911 780 l 2911 720 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
1965 780 m 1965 720 l 1814 720 l 1934 750 l 1814 780 l cp
eoclip
n 1350 750 m
 1950 750 l gs col0 s gr gr

% arrowhead
n 1814 780 m 1934 750 l 1814 720 l 1814 780 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
2767 267 m 2753 325 l 2900 362 l 2791 304 l 2914 304 l cp
eoclip
n 3375 450 m
 2775 300 l gs col0 s gr gr

% arrowhead
n 2914 304 m 2791 304 l 2900 362 l 2914 304 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
gs  clippath
1971 325 m 1957 267 l 1810 304 l 1934 304 l 1824 362 l cp
eoclip
n 1350 450 m
 1950 300 l gs col0 s gr gr

% arrowhead
n 1824 362 m 1934 304 l 1810 304 l 1824 362 l  cp gs 0.00 setgray ef gr  col0 s
% Polyline
n 2025 150 m 2700 150 l 2700 450 l 2025 450 l
 cp gs col0 s gr 
% Polyline
n 3225 600 m
 3600 600 l gs col0 s gr 
% Polyline
n 3225 300 m 3600 300 l 3600 900 l 3225 900 l
 cp gs col0 s gr 
% Polyline
n 1125 600 m
 1500 600 l gs col0 s gr 
% Polyline
n 1125 300 m 1500 300 l 1500 900 l 1125 900 l
 cp gs col0 s gr 
$F2psEnd
rs

%%EndDocument
 @endspecial 196 x Fl(Figure)j(18:)46 b Fm(Non-in)m(trusiv)m(e)27
b(reference)i(coun)m(ting)f(\(left\))g(and)g(in)m(trusiv)m(e)e
(reference)j(coun)m(ting)f(\(righ)m(t\))300 1882 y(extra)j(test)g(to)g
(determine)f(whic)m(h)f(mem)m(b)s(er)h(of)g(the)h(v)-5
b(arian)m(t)30 b(record)h(is)e(activ)m(e.)441 2070 y(The)f(c)m
(hallenge)h(is)e(implemen)m(ting)g(MIDDLE)i(for)f Fk(List<T>)p
Fm(s)f(where)h Fk(T)g Fm(has)g(no)h(default)f(construc-)300
2257 y(tor.)40 b(C++)28 b(requires)f(that)i(constructors)g(b)s(e)f
(called)g(for)g(all)f(mem)m(b)s(ers)h(of)h(an)f(ob)5
b(ject,)30 b(but)e(in)f(the)i(case)300 2445 y(of)g(MIDDLE,)i(when)d
(the)h Fk(value)f Fm(in)g(the)h Fk(Cache)f Fm(isn't)h(v)-5
b(alid,)28 b(w)m(e)h(ha)m(v)m(e)i(no)e(constructor)h(to)g(call.)39
b(As)30 b(a)300 2632 y(result,)g(the)h(\014rst)f(\014eld)g(of)h(the)g
Fk(pair)e Fm(is)h(actually)h(an)g Fk(unsigned)45 b(char)30
b Fm(arra)m(y)h(whose)g(size)g(and)f(align-)300 2819
y(men)m(t)f(are)f(appropriate)g(for)g Fk(T)p Fm(s.)39
b(Placemen)m(t)30 b Fk(new)d Fm(and)h(explicit)e(destructor)j(in)m(v)m
(o)s(cations)f(are)h(used)e(to)300 3007 y(explicitly)33
b(manage)i(the)h(lifetime)d(of)i(the)g Fk(T)g Fm(created)h(in)d(the)i
(ra)m(w)g(storage)i(when)d(the)h Fk(Cache)46 b(value)300
3194 y Fm(b)s(ecomes)26 b(v)-5 b(alid.)38 b(It)26 b(should)e(b)s(e)i
(noted)g(that)h(the)f(C++)g(language)g(standard)f(pro)m(vides)h(no)g
(mec)m(hanism)300 3382 y(to)31 b(ensure)f(that)h(the)g
Fk(unsigned)45 b(char)30 b Fm(arra)m(y)h(is)e(prop)s(erly)g(aligned)g
(to)i(hold)f(data)h(of)f(t)m(yp)s(e)h Fk(T)p Fm(.)g(Nev)m(er-)300
3569 y(theless,)g(there)h(is)e(a)i(relativ)m(ely)f(p)s(ortable)f(\\hac)
m(k":)44 b(creating)32 b(a)g(union)d(of)j(all)e(kinds)f(of)j(C++)e(ob)5
b(jects)300 3757 y(\(primitiv)m(e)24 b(data)i(t)m(yp)s(es,)h
(structures,)f(p)s(oin)m(ters,)g(p)s(oin)m(ters)e(to)j(functions,)e(p)s
(oin)m(ters)g(to)h(mem)m(b)s(ers,)g(etc.\))300 3944 y(ensures)f(that)h
(the)g(alignmen)m(t)f(of)g(the)h(union)e(is)g(wide)h(enough)g(to)h
(hold)f(an)m(y)g(kind)f(of)i(ob)5 b(ject)26 b(on)g(almost)300
4131 y(an)m(y)k(system.)40 b(Life)28 b(w)m(ould)g(b)s(e)h(a)h(lot)f
(simpler)e(if)h(C++)g(w)m(ere)i(extended)f(to)h(ha)m(v)m(e)g(either)f
(a)h(mec)m(hanism)300 4319 y(to)25 b(sp)s(ecify)e(alignmen)m(ts)h(\(a)h
(system-lev)m(el)f(solution\))f(or)i(a)f(w)m(a)m(y)i(to)f(explicitly)d
(ask)i(to)h(ha)m(v)m(e)h(a)f(particular)300 4506 y(structure)33
b(mem)m(b)s(er's)g(constructor)h Fi(not)43 b Fm(called)33
b(when)f(the)i(structure)f(is)g(created)h(\(a)g(language-lev)m(el)300
4694 y(solution\);)39 b(in)c(the)h(mean)m(time,)j(the)d(hac)m(k)h(w)m
(orks)g(w)m(ell)e(enough)h(on)g(most)h(systems.)59 b(\(A)37
b(system)f(for)300 4881 y(whic)m(h)c(the)h(hac)m(k)g(do)s(es)g(not)g(w)
m(ork)f(can)i(alw)m(a)m(ys)f(rev)m(ert)g(to)h(an)f(alternativ)m(e)g
(implemen)m(tation)e(of)i(lists,)300 5069 y(e.g.)42 b
Fk(TOP)p Fm(.\))2055 5700 y(98)p eop
%%Page: 99 108
99 107 bop 1077 3 2046 4 v 1075 116 4 113 v 1143 82 a
Fm(Hamming\(12000\))33 b(\(no)d(functoid)f(reuse\))p
2677 116 V 116 w(Time)g(\(s\))p 3121 116 V 1077 120 2046
4 v 1077 136 V 1075 249 4 113 v 1127 215 a(F)m(C++,)i(non-in)m(trusiv)m
(e)d(\(-IR)m(C)j(-REUSE\))p 2677 249 V 168 w(0.451)p
3121 249 V 1077 252 2046 4 v 1075 365 4 113 v 1195 331
a(F)m(C++,)g(in)m(trusiv)m(e)e(\(+IR)m(C)h(-REUSE\))p
2677 365 V 236 w(0.280)p 3121 365 V 1077 369 2046 4 v
1084 623 a Fl(T)-9 b(able)34 b(5:)47 b Fm(The)30 b(v)-5
b(alue)30 b(of)h(in)m(trusiv)m(e)d(reference)j(coun)m(ting)450
898 y Fi(2.5.2.3)94 b(Intrusive)33 b(r)-5 b(efer)g(enc)g(e)33
b(c)-5 b(ounting)300 1144 y Fm(The)22 b(F)m(C++)g(library)e(con)m
(tains)j(t)m(w)m(o)h(reference-coun)m(ted)g(p)s(oin)m(ter)d(classes:)37
b(one)23 b(that)g(uses)f(an)g(in)m(trusiv)m(e)300 1331
y(reference)31 b(coun)m(t,)g(and)e(one)i(that)f(is)g(non-in)m(trusiv)m
(e.)39 b(The)29 b(t)m(w)m(o)j(sc)m(hemes)e(are)h(depicted)e(in)g
(Figure)h(18.)300 1519 y(The)i(adv)-5 b(an)m(tage)33
b(of)g(non-in)m(trusiv)m(e)d(reference)j(coun)m(ts)f(is)f(that)i(the)f
(ob)5 b(ject)33 b(b)s(eing)d(coun)m(ted)j(do)s(es)f(not)300
1706 y(need)f(to)h(supp)s(ort)d(an)m(y)j(particular)d(in)m(terface;)k
(it)e(is)f(ignoran)m(t)h(of)h(the)f(reference)h(coun)m(ting.)43
b(In)m(trusiv)m(e)300 1894 y(reference)25 b(coun)m(ts,)h(on)f(the)g
(other)f(hand,)h(require)e(that)i(the)g(ob)5 b(jects)25
b(they)g(coun)m(t)g(supply)d(the)j(coun)m(ting)300 2081
y(mec)m(hanism.)81 b(The)44 b(b)s(ene\014ts)f(of)i(in)m(trusiv)m(e)d
(reference)j(coun)m(ts)g(are)f(increased)g(lo)s(calit)m(y)f(and)h(few)m
(er)300 2268 y(separate)30 b(calls)f(to)h Fk(new)p Fm(.)39
b(\(F)-8 b(or)30 b(a)g(more)f(thorough)g(in)m(tro)s(duction)f(to)i(the)
f(topic)g(of)h(in)m(trusiv)m(e)d(reference)300 2456 y(coun)m(ts,)k(see)
g(reference)g([2)q(],)f(Chapter)g(7.\))441 2643 y(W)-8
b(e)28 b(tested)g(Hamming)f(b)s(oth)f(with)g(and)h(without)f(in)m
(trusiv)m(e)g(reference)h(coun)m(ts.)40 b(Since)26 b(the)i(\\reuse)300
2831 y(functoids")j(optimization)g(\(discussed)f(in)h(the)h(follo)m
(wing)e(subsection\))i(requires)e(in)m(trusiv)m(e)g(reference)300
3018 y(coun)m(ts,)47 b(w)m(e)d(turned)e(o\013)i(that)g(optimization)e
(for)h(b)s(oth)g(of)g(these)h(runs,)h(in)d(order)h(to)h(ha)m(v)m(e)g(a)
g(fair)300 3206 y(comparison.)39 b(As)26 b(seen)h(in)e(T)-8
b(able)26 b(5,)i(the)f(lac)m(k)g(of)f(in)m(trusiv)m(e)f(reference)i
(coun)m(ts)g(mak)m(es)h(Hamming)d(slo)m(w)300 3393 y(do)m(wn)30
b(b)m(y)g(a)h(factor)g(of)g(ab)s(out)f(1.6.)450 3633
y Fi(2.5.2.4)94 b(R)-5 b(eusing)33 b(functoids)g(during)g(r)-5
b(e)g(cursive)33 b(c)-5 b(al)5 b(ls)300 3879 y Fm(The)37
b(t)m(ypical)g(implemen)m(tation)g(of)h(a)g(functoid)e(whic)m(h)g(op)s
(erates)i(on)g(lazy)g(lists)e(con)m(tains)i(a)g(curried)300
4067 y(recursiv)m(e)32 b(call)h(as)g(its)f(last)h(line.)46
b(F)-8 b(or)34 b(example,)g(consider)d(the)i Fk(Take)f
Fm(functoid)g(sho)m(wn)g(in)g(Figure)g(19)300 4254 y(\(with)40
b Fk(Sig)h Fm(mem)m(b)s(er)f(elided\).)72 b(\(Recall)41
b(that)h Fk(take)e Fm(selects)i(the)f(\014rst)g Fi(N)55
b Fm(elemen)m(ts)42 b(of)f(a)h(list)e(and)300 4442 y(discards)35
b(the)j(rest.\))61 b(The)37 b(call)f(to)i Fk(thunk2\(\))d
Fm(that)i(is)f(passed)h(to)h Fk(cons\(\))d Fm(in)h(the)h(last)g(line)f
(of)h(the)300 4629 y(functoid)c(creates)j(a)f(new)f(ob)5
b(ject)36 b(on)e(the)h(heap)f(that)i(represen)m(ts)e(the)h(recursiv)m
(e)f(call)g(\(the)h(\\th)m(unk")300 4816 y(that)29 b(mak)m(es)g
(functoids)e(lazy\).)40 b(The)28 b(only)f(thing)h(that)h(di\013ers)d(b)
s(et)m(w)m(een)j(the)g(newly)e(created)i(functoid)300
5004 y(and)34 b(the)h(curren)m(t)g(functoid)e(itself)h(are)h(the)g(v)-5
b(alues)34 b(of)h Fk(l)g Fm(and)f Fk(n)p Fm(.)54 b(Instead)34
b(of)h(discarding)e(the)i(called)300 5191 y(functoid)40
b(and)i(creating)g(a)g(similar)d(new)i(functoid,)j(w)m(e)e(can)g(reco)s
(de)g Fk(take)f Fm(so)h(that)g(it)f(reuses)h(the)300
5379 y(functoid.)d(Figure)30 b(20)h(sho)m(ws)g(the)f(co)s(de)h(with)e
(this)g(reuse)h(\(again,)h(with)e Fk(Sig)h Fm(mem)m(b)s(ers)f
(elided\).)2055 5700 y(99)p eop
%%Page: 100 109
100 108 bop 300 180 a Fk(struct)46 b(Take)h({)443 293
y(template)f(<class)g(T>)443 406 y(OddList<T>)f(operator\(\)\()g
(size_t)h(n,)h(const)g(List<T>&)e(l)j(\))f(const)f({)586
519 y(if\()h(n==0)g(||)g(null\(l\))f(\))730 632 y(return)g(NIL;)586
745 y(else)682 858 y(return)g(cons\()g(head\(l\),)g(thunk2\()g
(Take\(\),)f(n-1,)i(tail\(l\))f(\))h(\);)443 971 y(})300
1083 y(})g(take;)1262 1379 y Fl(Figure)35 b(19:)47 b
Fm(tak)m(e\(\))33 b(without)c(functoid)g(reuse)300 1765
y Fk(struct)46 b(TakeHelp)g(:)h(public)f(Fun0Impl<OddList<T>)d(>)k({)
443 1878 y(mutable)f(size_t)g(n;)443 1991 y(mutable)g(List<T>)g(l;)443
2104 y(TakeHelp\()f(size_t)i(nn,)f(const)h(List<T>&)e(ll)j(\))f(:)g
(n\(nn\),)g(l\(ll\))f({})443 2217 y(OddList<T>)f(operator\(\)\(\))g
(const)h({)586 2330 y(if\()h(n==0)g(||)g(null\(l\))f(\))730
2443 y(return)g(NIL;)586 2556 y(else)h({)730 2669 y(T)g(x)g(=)h
(head\(l\);)730 2782 y(l)f(=)g(tail\(l\);)730 2895 y(--n;)730
3007 y(return)f(cons\()g(x,)h(Fun0<OddList<T>)d(>\(this\))i(\);)586
3120 y(})443 3233 y(})300 3346 y(};)300 3459 y(struct)g(Take)h({)443
3572 y(template)f(<class)g(T>)443 3685 y(List<T>)g(operator\(\)\()f
(size_t)h(n,)h(const)f(List<T>&)g(l)h(\))h(const)e({)586
3798 y(return)g(Fun0<OddList<T>)e(>\()j(new)g(TakeHelp<T>\(n,l\))d(\);)
443 3911 y(})300 4024 y(})j(take;)1328 4319 y Fl(Figure)35
b(20:)47 b Fm(tak)m(e\(\))32 b(with)d(functoid)h(reuse)p
1090 4646 2020 4 v 1088 4759 4 113 v 1615 4725 a(Primes\(1000\))p
2664 4759 V 575 w(Time)f(\(s\))p 3108 4759 V 1090 4762
2020 4 v 1090 4779 V 1088 4892 4 113 v 1156 4858 a(F)m(C++,)h(no)g
(functoid)f(reuse)h(\(-REUSE\))p 2664 4892 V 184 w(26.36)p
3108 4892 V 1090 4895 2020 4 v 1088 5008 4 113 v 1140
4974 a(F)m(C++,)h(reusing)e(functoids)f(\(+REUSE\))p
2664 5008 V 191 w(7.77)p 3108 5008 V 1090 5011 2020 4
v 1293 5265 a Fl(T)-9 b(able)35 b(6:)47 b Fm(The)30 b(v)-5
b(alue)30 b(of)g(reusing)f(functoids)2032 5700 y(100)p
eop
%%Page: 101 110
101 109 bop 300 63 a Fk(struct)46 b(Take)h({)443 176
y(template)f(<class)g(T>)443 289 y(OddList<T>)f(operator\(\)\()g
(size_t)h(n,)h(const)g(List<T>&)e(l,)1541 402 y
(Reuser2<Inv,Var,Var,Take)o(,siz)o(e_t)o(,Lis)o(t<T>)c(>)1541
515 y(r)47 b(=)h(REUSE_INIT)d(\))i(const)g({)586 628
y(if\()g(n==0)g(||)g(null\(l\))f(\))730 741 y(return)g(NIL;)586
854 y(else)730 966 y(return)g(cons\()g(head\(l\),)g(r\()h(Take\(\),)f
(n-1,)g(tail\(l\))g(\))h(\);)443 1079 y(})300 1192 y(})g(take;)1243
1488 y Fl(Figure)35 b(21:)47 b Fm(tak)m(e\(\))33 b(with)c(reuse)h(via)g
(a)h(Reuser)441 1768 y(W)-8 b(e)34 b(tested)f(Primes)e(b)s(oth)g(with)g
(and)h(without)g(\\reuse")g(v)m(ersions)g(of)h Fk(filter\(\))p
Fm(,)d Fk(take\(\))p Fm(,)i Fk(at\(\))p Fm(,)300 1955
y Fk(enumFrom\(\))p Fm(,)e(and)i Fk(enumFromTo\(\))p
Fm(.)44 b(The)32 b(results)f(are)i(sho)m(wn)f(in)f(T)-8
b(able)32 b(6.)47 b(Clearly)-8 b(,)33 b(reusing)e(func-)300
2143 y(toids)h(is)g(a)h(big)f(win.)46 b(When)32 b(there)h(is)f(no)g
(reuse,)i(eac)m(h)g(call)e(to)h Fk(take\(\))e Fm(has)h(a)h(functoid)f
(destructed,)300 2330 y(deallo)s(cated,)k(and)e(has)g(a)h(new)f
(functoid)f(allo)s(cated)i(and)f(constructed.)53 b(With)34
b(reuse,)i(there)e(is)g(only)300 2518 y(m)m(utation;)d(no)f(heap)g
(allo)s(cation/deallo)s(cation)f(o)s(ccurs.)441 2705
y(Comparing)41 b(Figures)h(19)h(and)e(20,)47 b(one)42
b(can)h(see)g(that)f(hand-co)s(ding)f(a)i(\\reuse")f(v)m(ersion)g(of)h
(a)300 2892 y(functoid)29 b(tak)m(es)j(a)f(bit)f(more)g(co)s(de)h(than)
f(the)h(non-reuse)f(v)m(ersion.)41 b(In)30 b(order)g(to)h(simplify)c
(the)k(task)g(of)300 3080 y(applying)26 b(this)i(v)-5
b(aluable)27 b(optimization,)h(w)m(e)h(ha)m(v)m(e)h(added)e
Fk(Reuser)p Fm(s)f(to)i(the)g(library)-8 b(.)38 b Fk(Reuser)p
Fm(s)26 b(enable)300 3267 y(us)33 b(to)i(capture)f(the)g(essence)h(of)f
(functoid)e(reuse)i(with)e(signi\014can)m(tly)h(less)g(co)s(ding)g
(e\013ort.)52 b(Figure)33 b(21)300 3455 y(sho)m(ws)43
b Fk(Take)f Fm(written)g(with)g(a)h Fk(Reuser)p Fm(.)78
b(A)43 b Fk(ReuserN)e Fm(is)h(similar)f(to)j(a)f(call)g(to)h
Fk(thunkN\(\))p Fm(.)76 b(The)300 3642 y Fk(Reuser)28
b Fm(app)s(ears)h(as)h(an)f(extra)h(parameter)g(to)h(the)e(functoid.)40
b(This)27 b(parameter)j(has)g(a)g(default)e(v)-5 b(alue)300
3830 y(\(th)m(us)31 b(making)g(the)h(in)m(terface)g(c)m(hange)g
(e\013ectiv)m(ely)h(\\in)m(visible")c(to)j(clien)m(ts\))f(whic)m(h)f
(is)h(used)f(to)i(create)300 4017 y(a)f(new)g(th)m(unk)f(on)h(the)h
(heap.)42 b(As)31 b(a)h(result,)e(the)h(initial)e(call)h(to)i(a)f
(functoid)f(that)i(emplo)m(ys)e(a)i Fk(Reuser)300 4204
y Fm(allo)s(cates)40 b(space)h(for)f(a)g(th)m(unk.)69
b(Subsequen)m(t)38 b(recursiv)m(e)i(calls)f(are)h(then)g(c)m(hannelled)
e(through)i(the)300 4392 y Fk(Reuser)i Fm(\(rather)i(than)g(via)f(a)h
(call)f(to)i Fk(thunkN\(\))p Fm(\);)k(the)44 b Fk(Reuser)p
Fm('s)e(heap)i(th)m(unk,)i(when)d(in)m(v)m(ok)m(ed,)300
4579 y(explicitly)29 b(passes)j(itself)f(along)h(to)g(the)g(next)g
(call)f(as)h(the)g(extra)h(parameter.)45 b(This)30 b(enables)h(reuse)h
(of)300 4767 y(the)e(existing)f(heap)h(th)m(unk.)40 b
Fk(Reuser)p Fm(s)28 b(tak)m(e)k(template)f(parameters)f(sp)s(ecifying)e
(the)i(argumen)m(t)h(t)m(yp)s(es)300 4954 y(of)k(the)g(to-b)s
(e-curried)f(call,)h(as)g(w)m(ell)f(as)h(extra)g(template)g(parameters)
h(that)f(sp)s(ecify)e(whether)h(those)300 5142 y(parameters)40
b(are)g(in)m(v)-5 b(arian)m(t)39 b(\()p Fk(Inv)p Fm(\))g(or)g(v)-5
b(arian)m(t)40 b(\()p Fk(Var)p Fm(\))f(b)s(et)m(w)m(een)h(calls)f
(\(kno)m(wing)g(this)g(information)300 5329 y(prev)m(en)m(ts)29
b(needless)f(o)m(v)m(erwriting)g(of)h(duplicate)e(v)-5
b(alues\).)40 b(Though)28 b(the)g(in)m(ternal)g(mec)m(hanism)g(is)g
(quite)2032 5700 y(101)p eop
%%Page: 102 111
102 110 bop 300 91 a Fm(complicated,)28 b Fk(Reuser)p
Fm(s)e(are)i(relativ)m(ely)f(easy)i(to)f(apply)f(\(compare)h(the)g(co)s
(de)g(in)f(Figures)g(19)h(and)f(21\),)300 279 y(and)k(p)s(erform)f
(nearly)g(as)i(w)m(ell)f(as)g(the)h(\\hand-written")f(co)s(de)g(to)h(p)
s(erform)e(the)i(optimization)e(\(there)300 466 y(is)f(only)h(a)h
(small)e(\\abstraction)i(p)s(enalt)m(y"\).)450 706 y
Fi(2.5.2.5)94 b(A)n(voiding)33 b(functions)g(with)g(static)g(data)300
952 y Fm(The)45 b Fk(Cache)e Fm(implemen)m(tation)h(\(Figure)h(17,)k
(MIDDLE\))d(uses)f(t)m(w)m(o)h(distinguished)41 b(v)-5
b(alues)45 b(for)g(its)300 1140 y(p)s(oin)m(ter)35 b(\014eld.)55
b(The)36 b(v)-5 b(alue)35 b Fk(XNIL)g Fm(represen)m(ts)g(an)h(empt)m(y)
g(list,)g(and)f(the)h(v)-5 b(alue)36 b Fk(XBAD)e Fm(represen)m(ts)i(an)
300 1327 y(\\uncac)m(hed")29 b(v)-5 b(alue)28 b(\(the)h(function)d(is)i
(v)-5 b(alid,)27 b(the)h(v)-5 b(alue)28 b(is)f(not\).)41
b(These)28 b(w)m(ere)g(originally)e(enco)s(ded)i(as)443
1589 y Fk(template)46 b(<class)g(T>)h(class)f(Cache)h({)g(...)586
1777 y(static)f(Ref<Cache<T>)f(>&)i(XNIL\(\))f({)730
1964 y(static)g(Ref<Cache<T>)e(>)k(dummy\()e(new)h(Cache)f(\);)730
2152 y(return)g(dummy;)586 2339 y(})i(//)f(XBAD)g(similarly)443
2527 y(};)300 2789 y Fm(Ho)m(w)m(ev)m(er)32 b(for)f(man)m(y)f
(compilers,)f(it)h(is)f(far)i(b)s(etter)f(to)h(sa)m(y)443
3051 y Fk(template)46 b(<class)g(T>)h(class)f(Cache)h({)g(...)586
3238 y(static)f(Ref<Cache<T>)f(>)i(XNIL;)443 3426 y(};)443
3613 y(Ref<Cache<T>)e(>)i(Cache<T>::XNIL\()d(new)j(Cache)f(\);)300
3875 y Fm(In)26 b(the)g(former,)i(eac)m(h)f(time)f Fk(XNIL\(\))f
Fm(is)h(called,)h(a)g(b)s(o)s(olean)e(\015ag)i(\(inserted)f(b)m(y)g
(the)h(compiler\))e(m)m(ust)i(b)s(e)300 4063 y(c)m(hec)m(k)m(ed)34
b(\(to)g(see)f(if)e(initialization)f(of)i(the)h(static)g(v)-5
b(ariable)31 b(has)h(already)g(o)s(ccurred)3237 4030
y Fg(9)3276 4063 y Fm(\).)47 b(In)32 b(the)g(latter,)300
4250 y(initialization)24 b(happ)s(ens)i(at)i(the)f(start)h(of)g(the)f
(program,)h(and)f Fk(XNIL)f Fm(is)g(just)h(a)h(v)-5 b(alue.)39
b(W)-8 b(e)29 b(tested)f(b)s(oth)300 4438 y(v)m(ersions)i(on)g(Primes;)
f(the)i(results)e(are)i(sho)m(wn)e(in)h(T)-8 b(able)30
b(7.)441 4625 y(Using)25 b(global)f(data)i(with)f(static)h
(initializations)c(that)k(require)e(constructors)h(to)i(b)s(e)d(called)
h(can)h(b)s(e)300 4813 y(p)s(erilous;)d(there)h(are)g
(order-of-initialization)e(and)h(order-of-destruction)g(issues)f(for)i
(global)f(ob)5 b(jects)24 b(in)300 5000 y(C++)h(that)i(are)f(often)h
(hard)e(to)i(solv)m(e.)39 b(F)-8 b(ortunately)g(,)29
b(all)c(of)h(these)g(global)g(ob)5 b(jects)27 b(\(whic)m(h)e(sometimes)
p 300 5142 1440 4 v 404 5195 a Ff(9)438 5227 y Fe(Some)i(compilers)i
(ma)n(y)d(emplo)n(y)h(clev)n(er)h(optimizations)h(to)f(a)n(v)n(oid)g
(the)f(b)r(o)r(olean)i(c)n(hec)n(k)e(eac)n(h)i(time)e(the)g(function)h
(is)300 5318 y(called,)f(ho)n(w)n(ev)n(er)f(g++2.95.2)h(do)r(es)g(not)e
(app)r(ear)h(to)g(b)r(e)f(one)h(of)h(them.)2032 5700
y Fm(102)p eop
%%Page: 103 112
103 111 bop 1078 3 2045 4 v 1076 116 4 113 v 1615 82
a Fm(Primes\(1000\))p 2677 116 V 588 w(Time)29 b(\(s\))p
3121 116 V 1078 120 2045 4 v 1078 136 V 1076 249 4 113
v 1127 215 a(F)m(C++,)i(static)g(data)g(in)e(functions)g(\(-GL\))p
2677 249 V 169 w(11.63)p 3121 249 V 1078 252 2045 4 v
1076 365 4 113 v 1346 331 a(F)m(C++,)i(global)e(data)j(\(+GL\))p
2677 365 V 410 w(7.77)p 3121 365 V 1078 369 2045 4 v
1290 623 a Fl(T)-9 b(able)35 b(7:)46 b Fm(The)30 b(v)-5
b(alue)30 b(of)h(using)e(global)g(data)p 1151 743 1898
4 v 1149 856 4 113 v 1615 822 a(Primes\(1000\))p 2604
856 V 514 w(Time)g(\(s\))p 3047 856 V 1151 860 1898 4
v 1151 876 V 1149 989 4 113 v 1201 955 a(F)m(C++)h(with)f(tail)h
(recursion)f(\(-TR)m(O\))p 2604 989 V 169 w(10.69)p 3047
989 V 1151 992 1898 4 v 1149 1105 4 113 v 1272 1071 a(F)m(C++)h(with)f
(iteration)h(\(+TR)m(O\))p 2604 1105 V 262 w(7.77)p 3047
1105 V 1151 1109 1898 4 v 824 1363 a Fl(T)-9 b(able)35
b(8:)47 b Fm(The)30 b(v)-5 b(alue)30 b(of)g(transforming)f(tail)h
(recursion)f(in)m(to)h(iteration)300 1638 y(refer)45
b(to)h(one)f(another\))h(are)g(de\014ned)e(in)f(the)j(same)f
(translation)g(unit.)83 b(This)44 b(greatly)h(simpli\014es)300
1825 y(the)g(issue,)j(and)c(enables)h(us)f(to)i(ensure)e(the)h(correct)
h(order)f(of)g(initialization)d(for)j(these)g(ob)5 b(jects)300
2013 y(\(section)32 b(3.6.2,)h(paragraph)e(1)h(of)f(the)h(C++)e
(standard)h([34)q(],)h(prescrib)s(es)d(the)j(order)f(of)g
(initialization)300 2200 y(for)g(suc)m(h)f(ob)5 b(jects\).)43
b(As)31 b(for)g(order-of-destruction)f(issues,)g(w)m(e)h(circum)m(v)m
(en)m(t)g(the)g(p)s(oten)m(tial)g(problems)300 2387 y(b)m(y)k
(arti\014cally)e(incremen)m(ting)g(the)i(reference)g(coun)m(ts)g(of)g
(the)g(global)f(ob)5 b(jects)35 b(during)e(initialization.)300
2575 y(Then,)41 b(ev)m(en)f(when)e(the)h(reference-coun)m(ted)i(p)s
(oin)m(ters)d(are)i(destructed)f(after)h(the)f(end)g(of)g
Fk(main\(\))p Fm(,)300 2762 y(the)32 b(ref)f(coun)m(ts)h(do)f(not)h(go)
g(to)g(zero,)h(and)e(so)h(the)f(ob)5 b(jects)33 b(to)f(whic)m(h)e(they)
i(refer)f(are)h(left)f(aliv)m(e;)h(they)300 2950 y(dangle)e(in)f(the)i
(heap)f(un)m(til)e(the)j(system)f(collects)h(them)f(when)g(the)g
(program)g(exits.)441 3137 y(Note)25 b(also)f(that)g(ha)m(ving)f
Fk(XNIL\(\))f Fm(return)h(a)h(reference)g(in)e(the)i(former)g(v)m
(ersion)f(is)f(quite)i(imp)s(ortan)m(t;)300 3325 y(return)g(b)m(y)i(v)
-5 b(alue)25 b(ma)m(y)h(degrade)f(the)h(p)s(erformance)f(ev)m(en)h
(more)f(sev)m(erely)-8 b(.)40 b(This)24 b(is)g(b)s(ecause)i(returning)
300 3512 y(a)45 b Fk(Ref)f Fm(ob)5 b(ject)46 b(b)m(y)f(v)-5
b(alue)44 b(ma)m(y)h(create)i(\(needless\))d(w)m(ork,)49
b(incremen)m(ting)44 b(and)g(decremen)m(ting)h(the)300
3699 y(reference)31 b(coun)m(t)g(as)f(the)h(temp)s(orary)f(ob)5
b(ject)31 b(liv)m(es)f(its)f(short)i(life.)450 3940 y
Fi(2.5.2.6)94 b(Using)33 b(iter)-5 b(ation)34 b(inste)-5
b(ad)34 b(of)f(tail)g(r)-5 b(e)g(cursion)300 4186 y Fm(g++)31
b(do)s(es)g(not)h(transform)f(tail)g(recursion)f(in)m(to)h(iteration.)
44 b(As)31 b(a)h(result,)f(w)m(e)h(ha)m(v)m(e)h(done)e(the)h(trans-)300
4373 y(formation)43 b(b)m(y)f(hand)g(in)g(library)e(functions)i(lik)m
(e)g Fk(filter\(\))f Fm(and)h Fk(at\(\))p Fm(,)k(and)c(call)g(this)g
(the)h(\\tail)300 4561 y(recursion)32 b(optimization".)49
b(W)-8 b(e)34 b(ran)f(Primes)f(b)s(oth)h(with)f(and)h(without)f(this)g
(optimization;)i(the)g(re-)300 4748 y(sults)26 b(are)h(sho)m(wn)g(in)f
(T)-8 b(able)26 b(8.)40 b(T)-8 b(ransforming)26 b(tail)g(recursion)f
(to)j(iteration)f(has)g(a)g(signi\014can)m(t)f(impact)300
4935 y(on)k(the)h(p)s(erformance.)2032 5700 y(103)p eop
%%Page: 104 113
104 112 bop 1059 3 2083 4 v 1057 116 4 113 v 1615 82
a Fm(Primes\(1000\))p 2696 116 V 607 w(Time)29 b(\(s\))p
3140 116 V 1059 120 2083 4 v 1059 136 V 1057 249 4 113
v 1189 215 a(F)m(C++)h(\(-IR)m(C)h(-REUSE)f(-GL)h(-TR)m(O\))p
2696 249 V 249 w(62.05)p 3140 249 V 1059 252 2083 4 v
1057 365 4 113 v 1108 331 a(F)m(C++)g(\(+IR)m(C)f(+REUSE)f(+GL)h(+TR)m
(O\))p 2696 365 V 191 w(7.77)p 3140 365 V 1059 369 2083
4 v 1065 623 a Fl(T)-9 b(able)35 b(9:)47 b Fm(The)29
b(v)-5 b(alue)30 b(of)h(four)e(optimizations)h(com)m(bined)p
1059 743 V 1057 856 4 113 v 1619 822 a(T)-8 b(ree\(100000\))p
2696 856 V 615 w(Time)29 b(\(s\))p 3140 856 V 1059 860
2083 4 v 1059 876 V 1057 989 4 113 v 1108 955 a(F)m(C++)i(\(+IR)m(C)f
(+REUSE)f(+GL)h(+TR)m(O\))p 2696 989 V 191 w(1.62)p 3140
989 V 1059 992 2083 4 v 1057 1105 4 113 v 1571 1071 a(L\177)-45
b(aufer's)30 b(library)p 2696 1105 V 629 w(23.00)p 3140
1105 V 1059 1109 2083 4 v 1077 1363 a Fl(T)-9 b(able)35
b(10:)47 b Fm(Latest)32 b(comparison)d(with)g(L\177)-45
b(aufer's)30 b(library)450 1638 y Fi(2.5.2.7)94 b(Summary)34
b(of)f(optimizations)300 1884 y Fm(The)g(results)f(of)h(these)h
(optimizations)e(accum)m(ulate.)50 b(W)-8 b(e)34 b(ran)f(Primes)e(b)s
(oth)i(in)f(its)g(optimal)g(con\014g-)300 2071 y(uration,)e(and)g(also)
h(with)f(all)f(four)h(of)h(the)g(previous)e(optimizations)h(turned)g
(o\013)h(\(in)m(trusiv)m(e)e(reference)300 2259 y(coun)m(ting)e(\(IR)m
(C\),)h(reusing)e(functoids)g(\(REUSE\),)i(global)e(data)j(\(GL\),)f
(and)f(tail)f(recursion)g(optimiza-)300 2446 y(tion)c(\(TR)m(O\)\).)h
(The)f(results)g(are)g(sho)m(wn)g(in)f(T)-8 b(able)22
b(9;)k(note)d(that)g(without)f(an)m(y)g(of)h(these)g(optimizations,)300
2634 y(Primes)i(is)f(eigh)m(t)j(times)e(slo)m(w)m(er.)40
b(Keep)25 b(in)g(mind)f(also)i(that)g(the)g(unoptimized)e(program)i
(still)d(includes)300 2821 y(the)e(b)s(est)g(cac)m(hing)h(and)e(list)g
(implemen)m(tation;)j(our)e(original)e(naiv)m(e)i(implemen)m(tation)f
(w)m(as)i(ev)m(en)g(slo)m(w)m(er.)450 3061 y Fi(2.5.2.8)94
b(A)33 b(\014nal)g(c)-5 b(omp)g(arison)300 3307 y Fm(In)22
b([48)q(],)j(w)m(e)f(ran)e(an)h(exp)s(erimen)m(t)f(comparing)g(the)i(p)
s(erformance)e(of)h(the)g(F)m(C++)g(library)e(with)g(L\177)-45
b(aufer's)300 3495 y(functoid)36 b(library)-8 b(.)59
b(That)37 b(exp)s(erimen)m(t)f(used)h(a)g(program)g(similar)e(to)i(the)
h(\\tree")h(program)e(in)e(Sec-)300 3682 y(tion)f(2.5.1.2.)55
b(The)34 b(exp)s(erimen)m(t)g(sho)m(w)m(ed)g(that)h(the)g(\(previous\))
e(F)m(C++)i(implemen)m(tation)e(w)m(as)h(4)h(to)300 3870
y(8)30 b(times)g(as)g(fast)g(as)g(L\177)-45 b(aufer's)29
b(library)-8 b(,)29 b(thanks)g(to)i(the)f(reference-coun)m(ting)g(in)f
(our)g(implemen)m(tation.)300 4057 y(W)-8 b(e)26 b(re-ran)e(the)h(exp)s
(erimen)m(t)e(with)g(the)i(new)f(F)m(C++)g(implemen)m(tation)f(with)g
(all)h(of)g(the)h(optimizations)300 4244 y(enabled.)48
b(The)32 b(results)g(are)h(sho)m(wn)g(in)e(T)-8 b(able)33
b(10;)i(F)m(C++)e(is)f(no)m(w)h(more)g(than)g(14)h(times)f(as)g(fast)g
(for)300 4432 y(this)c(b)s(enc)m(hmark.)300 4672 y Fl(2.5.3)105
b(Expressiv)m(eness)36 b(and)f(limitations)300 4918 y
Fm(W)-8 b(e)34 b(no)m(w)e(summarize)g(the)h(lev)m(el)f(of)h(supp)s(ort)
e(for)h(functional)f(programming)g(that)j(F)m(C++)e(o\013ers,)i(as)300
5106 y(w)m(ell)29 b(as)i(its)f(limitations.)436 5393
y Fh(\017)46 b Fi(Complexity)40 b(of)d(typ)-5 b(e)39
b(signatur)-5 b(e)38 b(sp)-5 b(e)g(ci\014c)g(ations:)59
b Fm(F)m(C++)35 b(allo)m(ws)h(higher-order)e(p)s(olymorphic)2032
5700 y(104)p eop
%%Page: 105 114
105 113 bop 527 91 a Fm(function)22 b(t)m(yp)s(es)h(to)g(b)s(e)f
(expressed)g(and)h(used.)37 b(T)m(yp)s(e)22 b(signatures)g(are)h
(explicitly)e(declared)h(in)f(our)527 279 y(framew)m(ork,)36
b(unlik)m(e)c(in)h(ML)h(or)g(Hask)m(ell,)h(where)e(t)m(yp)s(es)h(can)g
(b)s(e)g(inferred.)49 b(F)-8 b(urthermore,)35 b(our)527
466 y(language)c(for)g(sp)s(ecifying)d(t)m(yp)s(e)j(computations)f
(\(i.e.,)i(our)e(building)c(blo)s(c)m(ks)k(for)h Fk(Sig)f
Fm(template)527 654 y(classes\))41 b(is)e(a)h(little)f(a)m(wkw)m(ard.)
69 b(Nev)m(ertheless)41 b(w)m(e)f(ha)m(v)m(e)h(used)e(our)h(framew)m
(ork)g(to)g(de\014ne)g(a)527 841 y(large)j(n)m(um)m(b)s(er)e(\(o)m(v)m
(er)j(100\))f(functoids)e(and)h(ha)m(v)m(e)h(not)g(found)e(our)h(t)m
(yp)s(e)g(language)h(to)g(b)s(e)f(a)527 1028 y(problem|learning)27
b(to)32 b(use)e(it)f(required)g(only)h(minimal)d(e\013ort.)527
1253 y(The)20 b(real)g(adv)-5 b(an)m(tage)23 b(of)e(F)m(C++)f(is)f
(that,)24 b(although)c(function)f Fi(de\014nitions)29
b Fm(need)20 b(to)h(b)s(e)f(explicitly)527 1441 y(t)m(yp)s(ed,)45
b(function)40 b Fi(uses)49 b Fm(do)42 b(not)g(\(ev)m(en)h(for)f(p)s
(olymorphic)c(functions\).)74 b(In)41 b(short,)k(with)40
b(our)527 1628 y(framew)m(ork,)31 b(C++)e(has)h(as)h(go)s(o)s(d)f(supp)
s(ort)f(for)h(higher-order)f(and)g(p)s(olymorphic)f(functions)h(as)527
1816 y(it)h(do)s(es)g(for)g(an)m(y)h(other)g(\014rst-class)e(C++)h(t)m
(yp)s(e.)436 2078 y Fh(\017)46 b Fi(Polymorphic)f(variables:)68
b Fm(While)40 b(F)m(C++)h(has)g(a)g(great)i(deal)d(of)i(supp)s(ort)d
(for)i(p)s(olymorphic)527 2265 y(functions,)32 b(w)m(e)h(still)e
(cannot)i(create)h(run-time)d(v)-5 b(ariables)32 b(with)f(p)s
(olymorphic)f(t)m(yp)s(es,)j(b)s(ecause)527 2453 y(these)39
b(t)m(yp)s(es)f(cannot)h(b)s(e)e(expressed)h(directly)e(in)h(C++.)63
b(F)-8 b(or)39 b(example,)h(ev)m(en)e(though)g Fk(tail)527
2640 y Fm(and)32 b Fk(init)g Fm(\(the)h(dual)e(of)i Fk(tail)p
Fm(,)f(whic)m(h)f(discards)g(the)i Fi(last)42 b Fm(elemen)m(t)33
b(of)g(a)g(list\))e(b)s(oth)h(ha)m(v)m(e)i(the)527 2827
y(signature)670 3127 y Fk([a])47 b(->)h([a])527 3426
y Fm(w)m(e)41 b(cannot)g(create)g(a)g(v)-5 b(ariable)39
b(\\f)7 b(")41 b(whic)m(h)e(can)h(b)s(e)g(b)s(ound)e(to)j(b)s(oth)e
(functions)g(during)f(the)527 3614 y(course)31 b(of)f(its)g(lifetime)
670 3913 y Fk(f)48 b(=)f(tail;)670 4101 y(...)670 4288
y(f)h(=)f(init;)527 4588 y Fm(b)s(ecause)41 b(w)m(e)h(ha)m(v)m(e)h(no)e
(C++)f(t)m(yp)s(e)h(to)h(declare)g(\\f)7 b(")42 b(to)f(b)s(e)g(an)g
(instance)g(of.)74 b(Similarly)-8 b(,)40 b(w)m(e)527
4775 y(cannot)33 b(create)h(a)f Fk(List)e Fm(whic)m(h)g(con)m(tains)h
(b)s(oth)g Fk(tail)f Fm(and)h Fk(init)p Fm(,)g(as)g(these)h(t)m(w)m(o)h
(ob)5 b(jects)33 b(ha)m(v)m(e)527 4963 y(di\013eren)m(t)j(C++)f(t)m(yp)
s(es)h(\(namely)f Fk(Tail)g Fm(and)h Fk(Init)p Fm(\))f(and)g(therefore)
i(cannot)f(b)s(e)f(put)h(in)m(to)g(the)527 5150 y(same)46
b(\(homogeneously-t)m(yp)s(ed\))f(list.)83 b(This)43
b(limitation)g(is)h(fundamen)m(tal,)j(common)e(to)h(all)527
5337 y(approac)m(hes)31 b(to)g(functional)e(programming)g(in)g(C++.)
2032 5700 y(105)p eop
%%Page: 106 115
106 114 bop 436 91 a Fh(\017)46 b Fi(Limitations)33 b(in)e(the)h(numb)
-5 b(er)32 b(of)f(functoid)h(ar)-5 b(guments:)46 b Fm(There)28
b(is)g(a)i(b)s(ound)d(in)g(the)i(n)m(um)m(b)s(er)f(of)527
279 y(argumen)m(ts)k(that)f(our)g(functoids)f(can)h(supp)s(ort.)41
b(This)30 b(b)s(ound)f(can)i(b)s(e)g(made)g(arbitrarily)d(high)527
466 y(\(templates)33 b(with)d(more)i(parameters)g(can)h(b)s(e)e(added)g
(to)h(the)g(framew)m(ork\))h(but)e(it)g(will)e(alw)m(a)m(ys)527
654 y(b)s(e)h(\014nite.)40 b(This)28 b(has)i(not)h(pro)m(v)m(en)g(to)g
(b)s(e)f(a)g(signi\014can)m(t)g(problem)e(in)h(practice.)527
873 y(A)e(closely)f(related)g(issue)f(is)g(that)i(of)g(naming.)38
b(W)-8 b(e)27 b(sa)m(w)g(base)f(classes)h(lik)m(e)e Fk(Fun1)g
Fm(and)h Fk(Fun1Impl)527 1060 y Fm(in)40 b(F)m(C++,)45
b(as)c(w)m(ell)g(as)g(op)s(erators)h(lik)m(e)f Fk(makeFun1)e
Fm(and)i Fk(monomorphize1)p Fm(.)70 b(These)41 b(en)m(tities)527
1247 y(enco)s(de)f(in)e(their)h(names)g(the)h(n)m(um)m(b)s(er)e(of)i
(argumen)m(ts)g(of)g(the)f(functions)g(they)g(manipulate.)527
1435 y(Using)31 b(C++)g(template)i(sp)s(ecialization,)e(this)g(can)h(b)
s(e)f(a)m(v)m(oided,)i(at)g(least)f(in)f(the)h(case)h(of)f(class)527
1622 y(templates.)41 b(Th)m(us,)30 b(w)m(e)h(can)f(ha)m(v)m(e)i
(templates)e Fk(Fun)g Fm(and)g Fk(FunImpl)e Fm(with)h(a)i(v)-5
b(ariable)29 b(n)m(um)m(b)s(er)g(of)527 1810 y(argumen)m(ts.)53
b(If)33 b(template)i Fk(Fun)e Fm(is)g(used)g(with)g(t)m(w)m(o)j
(argumen)m(ts,)f(then)f(it)g(is)f(assumed)g(to)i(refer)527
1997 y(to)g(a)g(one-argumen)m(t)h(function)d(\(the)i(second)g(template)
g(argumen)m(t)g(is)e(the)i(return)e(t)m(yp)s(e\).)54
b(W)-8 b(e)527 2185 y(exp)s(erimen)m(ted)28 b(with)g(this)g(idea,)i
(and)e(elected)i(to)g(use)f(it)g(only)f(in)g(the)h Fk(CFunType)e
Fm(and)i Fk(FunType)527 2372 y Fm(classes)d(\(whic)m(h)e(help)g
(implemen)m(t)g Fk(Sig)g Fm(t)m(yp)s(e)i(signatures)e(in)g(class)h
(de\014nitions\).)37 b(In)25 b(clien)m(t)f(co)s(de,)527
2559 y(where)30 b(indirect)e(functoid)h(v)-5 b(ariables)29
b(are)i(declared)e(and)h(used,)g(the)g(redundan)m(t)f
Fk(N)h Fm(in)f(the)h Fk(FunN)527 2747 y Fm(names)h(seems)f(v)-5
b(aluable)29 b(to)i(the)g(h)m(uman)e(reader.)436 2997
y Fh(\017)46 b Fi(A)n(utomatic)37 b(currying:)53 b Fm(all)33
b(of)i(the)f(library)e(functoids)h(supp)s(ort)f(automatic)j(currying)e
(via)h(the)527 3185 y Fk(FullN)25 b Fm(com)m(binators.)39
b(This)24 b(enables)h(a)h(functoid)f(to)i(b)s(e)e(called)g(with)f(few)m
(er)j(argumen)m(ts)f(than)f(it)527 3372 y(exp)s(ects,)j(resulting)c(in)
h(a)h(new)g(functoid)f(whic)m(h)f(exp)s(ects)j(the)f(remainder)f(of)h
(the)g(argumen)m(ts.)40 b(It)527 3560 y(is)32 b(also)g(p)s(ossible)e
(to)j(enable)e(functoids)g(to)i(accept)h Fi(mor)-5 b(e)40
b Fm(argumen)m(ts)33 b(than)f(they)g(exp)s(ect.)47 b(F)-8
b(or)527 3747 y(example,)44 b(imagine)39 b(a)j(one-argumen)m(t)g
(function)d(named)h Fk(foo)g Fm(whic)m(h)g(returns)f(another)i(one-)527
3934 y(argumen)m(t)35 b(function.)51 b(W)-8 b(e)36 b(could)d(imagine)g
(writing)g Fk(foo\(x,y\))f Fm(to)j(mean)f(the)h(same)f(thing)g(as)527
4122 y Fk(foo\(x\)\(y\))p Fm(.)40 b(F)m(C++)30 b(only)g(supp)s(orts)f
(the)i(latter)g(form)f(b)m(y)h(default.)41 b(In)30 b(the)h(rare)g
(cases)g(where)527 4309 y(this)d(form)g(of)h(\\uncurrying")e(is)h
(desirable,)f(the)i Fk(split_args\(\))d Fm(functoid)h(can)i(b)s(e)f
(applied;)g(its)527 4497 y(general)j(b)s(eha)m(vior)e(is)h(describ)s
(ed)e(here:)670 4761 y Fk(split_args\(f\)\(x,y,z\))138
b(means)k(f\(x\)\(y\)\(z\))436 5025 y Fh(\017)46 b Fi(Compiler)h(err)-5
b(or)48 b(messages:)75 b Fm(C++)43 b(compilers)g(are)i(notoriously)f(v)
m(erb)s(ose)g(when)g(it)g(comes)527 5213 y(to)f(errors)e(in)f(template)
i(co)s(de.)75 b(Indeed,)44 b(our)d(exp)s(erience)g(is)g(that)h(when)f
(a)h(user)f(of)h(F)m(C++)527 5400 y(mak)m(es)k(a)g(t)m(yp)s(e)f(error,)
j(the)e(compiler)d(t)m(ypically)h(rep)s(orts)g(the)i(full)d(template)i
(instan)m(tiation)2032 5700 y(106)p eop
%%Page: 107 116
107 115 bop 527 91 a Fm(stac)m(k,)43 b(resulting)37 b(in)h(man)m(y)h
(lines)e(of)i(error)g(messages.)67 b(In)39 b(some)g(cases)h(this)e
(information)f(is)527 279 y(useful,)31 b(but)g(in)g(others)h(it)f(is)g
(not.)45 b(W)-8 b(e)33 b(can)g(distinguish)28 b(t)m(w)m(o)33
b(kinds)d(of)i(t)m(yp)s(e)g(errors:)43 b(errors)31 b(in)527
466 y(the)36 b Fk(Sig)f Fm(de\014nition)f(of)i(a)g(new)g(functoid)e
(and)i(errors)f(in)g(the)h(use)f(of)h(functoids.)56 b(Both)37
b(kinds)527 654 y(of)c(errors)f(are)g(usually)f(diagnosed)g(w)m(ell)h
(and)f(rep)s(orted)h(as)h(\\wrong)f(n)m(um)m(b)s(er)f(of)i
(parameters",)527 841 y(\\t)m(yp)s(e)38 b(mismatc)m(h)f(in)f(the)h(set)
h(of)f(parameters",)j(etc.)62 b(In)37 b(the)g(case)h(of)f
Fk(Sig)g Fm(errors,)h(ho)m(w)m(ev)m(er,)527 1028 y(insp)s(ection)28
b(of)i(the)f(template)h(instan)m(tiation)f(stac)m(k)i(is)e(necessary)h
(to)g(pinp)s(oin)m(t)d(the)j(lo)s(cation)f(of)527 1216
y(the)38 b(problem.)60 b(F)-8 b(ortunately)g(,)41 b(the)d(casual)f
(user)g(of)g(the)h(library)d(is)i(lik)m(ely)f(to)i(only)e(encoun)m(ter)
527 1403 y(errors)30 b(in)f(the)i Fi(use)37 b Fm(of)30
b(functoids.)527 1628 y(Rep)s(orting)43 b(of)i(t)m(yp)s(e)f(errors)g
(is)f(further)g(hindered)f(b)m(y)i(non-lo)s(cal)f(instan)m(tiations)g
(of)h(F)m(C++)527 1816 y(functoids.)39 b(P)m(olymorphic)27
b(functoids)g(can)h(b)s(e)g(passed)g(around)f(in)g(con)m(texts)j(that)f
(do)f(not)h(mak)m(e)527 2003 y(sense,)k(but)e(the)g(error)h(will)d(not)
j(b)s(e)f(disco)m(v)m(ered)h(un)m(til)e(their)h(subsequen)m(t)g(in)m(v)
m(o)s(cation.)44 b(In)31 b(that)527 2190 y(case,)g(it)d(is)f(not)i
(immediately)e(clear)i(whether)e(the)i(problem)e(is)h(in)f(the)i
(\014nal)e(in)m(v)m(o)s(cation)i(site)f(or)527 2378 y(the)e(p)s(oin)m
(t)e(where)h(the)g(p)s(olymorphic)d(functoid)i(w)m(as)i(passed)f(as)g
(a)h(parameter.)39 b(F)-8 b(undamen)m(tally)g(,)527 2565
y(this)24 b(problem)g(cannot)i(b)s(e)f(addressed)f(without)g(t)m(yp)s
(e)i(constrain)m(ts)f(in)f(template)i(instan)m(tiations,)527
2753 y(something)k(that)h(C++)e(do)s(es)i(not)f(o\013er.)527
2978 y(As)36 b(describ)s(ed)d(in)i(Section)g(2.3.3,)k(when)c(using)f
(expression-template)h(tec)m(hniques,)i(it)e(is)f(p)s(os-)527
3165 y(sible)h(to)i(apply)e(C++)h(metaprogramming)g(to)h(analyze)g(co)s
(de)g(for)f(certain)g(classes)h(of)f(errors.)527 3352
y(The)26 b(kinds)f(of)h(errors)g(detected)i(using)c(this)i(mec)m
(hanism)f(are)i(limited)d(to)j(those)g(the)g(library)d(im-)527
3540 y(plemen)m(tor)32 b(\(meta-\)programmed)h Fi(a)i(priori)p
Fm(.)46 b(Nev)m(ertheless,)33 b(exp)s(erience)e(with,)h(e.g.)46
b(F)m(C++'s)527 3727 y Fk(lambda)p Fm(,)33 b(has)f(sho)m(wn)h(us)f(the)
i(most)f(common)g(t)m(yp)s(es)g(of)h(errors,)f(and)g(w)m(e)g(ha)m(v)m
(e)i(written)d(meta-)527 3915 y(programs)e(to)h(detect)h(these)f
(errors)f(and)g(issue)f(a)h(suitable)f(diagnostic.)527
4139 y(Despite)41 b(these)h(issues,)h(o)m(v)m(erall)e(t)m(yp)s(e)g
(error)g(rep)s(orting)e(in)h(F)m(C++)h(is)f(adequate,)45
b(and,)e(with)527 4327 y(some)31 b(exp)s(erience,)f(users)g(ha)m(v)m(e)
h(little)e(di\016cult)m(y)g(with)g(it.)436 4589 y Fh(\017)46
b Fi(Pur)-5 b(e)39 b(functional)g(c)-5 b(o)g(de)40 b(vs.)60
b(c)-5 b(o)g(de)40 b(with)g(side-e\013e)-5 b(cts:)58
b Fm(In)37 b(C++,)h(an)m(y)f(metho)s(d)f(is)g(allo)m(w)m(ed)h(to)527
4776 y(mak)m(e)42 b(system)f(calls)f(\(e.g.,)45 b(to)c(p)s(erform)e
(I/O,)i(access)h(a)f(random)f(n)m(um)m(b)s(er)g(generator,)k(etc.\))527
4964 y(or)d(to)h(c)m(hange)g(the)f(state)i(of)e(global)f(v)-5
b(ariables.)71 b(Th)m(us,)43 b(there)e(is)f(no)h(w)m(a)m(y)h(to)g
(fully)c(prev)m(en)m(t)527 5151 y(side-e\013ects)g(in)d(user)i(co)s
(de.)60 b(Nev)m(ertheless,)39 b(b)m(y)e(declaring)f(a)h(metho)s(d)f(to)
i(b)s(e)e Fk(const)p Fm(,)h(w)m(e)h(can)527 5339 y(prev)m(en)m(t)32
b(it)e(from)g(mo)s(difying)e(the)j(state)h(of)e(the)h(enclosing)f(ob)5
b(ject)31 b(\(this)f(prop)s(ert)m(y)g(is)g(enforced)2032
5700 y(107)p eop
%%Page: 108 117
108 116 bop 527 91 a Fm(b)m(y)33 b(the)h(compiler\).)48
b(This)32 b(is)g(the)i(kind)d(of)i(\\side-e\013ect)i(freedom")f(that)g
(w)m(e)f(try)g(to)h(enforce)g(in)527 279 y(F)m(C++.)62
b(Our)37 b(indirect)e(functoids)i(\(as)h(sho)m(wn)f(in)f(Section)h
(2.2.3\))j(are)e(explicitly)d(side-e\013ect)527 466 y(free|an)m(y)23
b(class)f(inheriting)e(from)i(our)g Fk(FunNImpl)e Fm(classes)i(has)g
(to)i(ha)m(v)m(e)f(a)g Fk(const)46 b(operator\(\))p Fm(.)527
654 y(Nev)m(ertheless,)31 b(users)e(of)h(the)f(library)f(could)g
(decide)i(to)g(add)f(other)h(metho)s(ds)f(with)f(side-e\013ects)527
841 y(to)e(a)f(sub)s(class)e(of)i Fk(FunNImpl)p Fm(.)37
b(W)-8 b(e)26 b(strongly)e(discourage)g(this)g(practice)h(but)f(cannot)
i(prev)m(en)m(t)f(it.)527 1028 y(It)31 b(is)e(a)i(go)s(o)s(d)f(con)m(v)
m(en)m(tion)i(to)f(alw)m(a)m(ys)g(declare)f(metho)s(ds)g(of)g(indirect)
f(functoids)g(to)i(b)s(e)f Fk(const)p Fm(.)527 1253 y(F)-8
b(or)40 b(direct)e(functoids,)h(the)g(guaran)m(tees)h(are)f(ev)m(en)h
(w)m(eak)m(er.)67 b(W)-8 b(e)40 b(cannot)f(ev)m(en)g(ensure)f(that)527
1441 y Fk(operator\(\))30 b Fm(will)g(b)s(e)i Fk(const)p
Fm(,)g(although)f(this)h(is,)g(again,)h(a)g(go)s(o)s(d)g(practice.)47
b(While)31 b(functoids)527 1628 y(with)25 b(side)g(e\013ects)i(can)g(b)
s(e)e(implemen)m(ted)f(in)h(our)h(framew)m(ork)g(\(as)g(describ)s(ed)e
(in)h(Section)h(2.2.9\),)527 1816 y(suc)m(h)44 b(functoids)f(should)f
(b)s(e)h(used)g(with)g(care.)83 b(Other)43 b(opp)s(ortunities)f(for)i
(co)s(de)g(with)f(side)527 2003 y(e\013ects)h(ab)s(ound)c(in)h(C++.)74
b(Our)41 b(recommendation)h(is)f(that)h(most)h(co)s(de)f(with)f(side)g
(e\013ects)527 2190 y(should)29 b(b)s(e)h(implemen)m(ted)g(outside)g
(the)h(F)m(C++)g(framew)m(ork.)42 b(F)-8 b(or)31 b(instance,)g(suc)m(h)
g(co)s(de)g(could)527 2378 y(b)s(e)g(expressed)g(through)f(nativ)m(e)i
(C++)e(functions.)42 b(The)30 b(purist)g(can)h(ev)m(en)h(use)f(a)h
(state)g(monad)527 2565 y(\(whic)m(h)h(is)f(one)i(of)f(the)h(example)f
(monads)g(supplied)d(with)i(the)h(library\))f(as)h(an)g(alternativ)m(e)
h(to)527 2753 y(side-e\013ects.)300 3029 y Fj(2.6)140
b(Discussion)300 3276 y Fm(F)m(C++)33 b(demonstrates)h(that)g
(functional)e(programming)g(can)i(b)s(e)f(smo)s(othly)f(in)m(tegrated)i
(in)m(to)g(C++.)300 3463 y(The)h(library)d(supp)s(orts)i(ma)5
b(jor)35 b(features)g(found)f(in)g(mo)s(dern)g(functional)f
(programming)h(languages,)300 3650 y(including)26 b(\014rst-class)j
(functions,)f(laziness,)h(in\014x)f(syn)m(tax)i(and)f(currying,)f(lam)m
(b)s(da,)h(and)g(syn)m(tax)h(sup-)300 3838 y(p)s(ort)g(for)h(monadic)f
(programming.)41 b(These)31 b(features)g(ha)m(v)m(e)h(b)s(een)f(added)f
(to)h(the)h(host)f(language)g(in)f(a)300 4025 y(w)m(a)m(y)24
b(that)g(is)f(more)g(complete)h(and)f(seamless)g(than)g(prior)f
(attempts)i(to)h(add)d(functional)g(programming)300 4213
y(to)31 b(existing)e(ob)5 b(ject-orien)m(ted)32 b(languages.)441
4400 y(F)m(C++)39 b(adds)f(these)i(functional)d(abstractions)i(to)h
(C++)e(in)g(an)g(e\016cien)m(t)i(and)e(useful)g(manner.)300
4588 y(By)32 b(utilizing)c(features)k(of)g(C++)e(\(esp)s(ecially)g
(templates\),)j(most)f(of)g(the)f(features)h(ha)m(v)m(e)h(b)s(een)e
(added)300 4775 y(with)43 b(little)g(or)h(no)h(abstraction)f(p)s(enalt)
m(y;)51 b(ev)m(en)45 b(those)g(features)f(with)f(the)i(most)f(p)s(oten)
m(tial)g(run-)300 4962 y(time)33 b(exp)s(enses)f(\(lists)g(and)h
(laziness\))f(are)h(e\016cien)m(t)h(when)e(compared)h(with)f(similar)e
(co)s(de)k(pro)s(duced)300 5150 y(b)m(y)h(mo)s(dern)e(functional)g
(language)i(compilers.)52 b(F)-8 b(urthermore,)36 b(w)m(e)f(ha)m(v)m(e)
h(demonstrated)f(a)g(n)m(um)m(b)s(er)300 5337 y(of)42
b(applications)e(of)j(the)f(library)-8 b(,)43 b(including)c(design)i
(pattern)h(implemen)m(tations)f(and)g(third-part)m(y)2032
5700 y(108)p eop
%%Page: 109 118
109 117 bop 300 91 a Fm(libraries)27 b(built)i(atop)i(F)m(C++.)441
279 y(In)k(short,)h(F)m(C++)g(e\013ectiv)m(ely)g(b)s(eha)m(v)m(es)g(as)
f(a)h(domain-sp)s(eci\014c)d(em)m(b)s(edded)i(language)g(for)h(func-)
300 466 y(tional)e(programming)g(in)f(C++.)54 b(But)35
b(functional)e(programming)g(is)h(only)g(part)h(of)g(the)g(story|our)
300 654 y(thesis)28 b(also)g(states)i(that)f(logic)g(programming)e(can)
i(b)s(e)f(similarly)d(in)m(tegrated)k(in)m(to)g(C++.)39
b(Logic)29 b(pro-)300 841 y(gramming,)g(b)m(y)f(virtue)g(of)h(its)g
(more)g(un)m(usual)e(w)m(a)m(y)j(of)f(represen)m(ting)f(con)m(trol)h
(\015o)m(w)g(and)f(data,)j(creates)300 1028 y(a)26 b(n)m(um)m(b)s(er)e
(of)h(new)g(c)m(hallenges)h(for)f(a)h(seamless)f(in)m(tegration.)39
b(Th)m(us)24 b(the)i(next)f(c)m(hapter)h(describ)s(es)e(ho)m(w)300
1216 y(w)m(e)31 b(met)g(those)g(c)m(hallenges)f(with)f(LC++,)g(our)h
(logic)g(programming)f(library)-8 b(.)2032 5700 y(109)p
eop
%%Page: 110 119
110 118 bop 1660 91 a Fn(CHAPTER)44 b(I)t(I)t(I)1906
588 y(LC++)300 1025 y Fm(This)f(c)m(hapter)j(describ)s(es)e(LC++,)k(a)d
(library)e(for)i(logic)g(programming)f(in)g(C++.)84 b(W)-8
b(e)46 b(start)g(b)m(y)300 1212 y(describing)29 b(the)i(in)m(terface)h
(to)f(the)h(library)c(and)j(ho)m(w)g(it)f(supp)s(orts)f(the)j(ma)5
b(jor)31 b(features)g(of)g(logic)g(pro-)300 1400 y(gramming,)i
(including)d(queries,)i(uni\014cation,)g(bac)m(ktrac)m(king,)j(and)e
(functors.)47 b(Next)34 b(w)m(e)g(discuss)d(the)300 1587
y(LC++)25 b(implemen)m(tation,)i(whic)m(h)e(uses)h(man)m(y)g(of)h(the)g
(same)g(general)f(tec)m(hniques)g(used)g(in)f(the)i(F)m(C++)300
1775 y(implemen)m(tation.)71 b(The)40 b(main)g(c)m(hallenges)h(are)g
(di\013eren)m(t)g(from)f(F)m(C++,)k(ho)m(w)m(ev)m(er;)k(whereas)40
b(with)300 1962 y(functional)d(programming,)i(represen)m(ting)f
(functions)f(w)m(as)i(paramoun)m(t,)i(with)c(logic)h(programming)300
2150 y(the)28 b(con)m(trol)g(and)f(data)h(represen)m(tations)f(require)
f(the)i(most)g(ingen)m(uit)m(y)-8 b(.)39 b(W)-8 b(e)29
b(con)m(tin)m(ue)f(b)m(y)f(describing)300 2337 y(applications)38
b(of)h(the)h(library)-8 b(,)40 b(and)f(conclude)f(with)h(a)g
(comparison)g(of)h(the)f(most)h(directly)e(related)300
2524 y(w)m(ork.)300 2801 y Fj(3.1)140 b(Description)47
b(of)i(the)g(libr)-7 b(ary)300 3047 y Fm(The)22 b(LC++)f(library)e(mak)
m(es)k(it)f(p)s(ossible)e(to)j(do)f(logic)g(programming)e(in)h(C++.)37
b(The)22 b(o)m(v)m(erall)g(structure)300 3235 y(and)g(syn)m(tax)i(used)
e(are)i(v)m(ery)f(similar)d(to)k(logic)f(languages)g(suc)m(h)g(as)g
(Prolog)g(\(the)h(main)e(di\013erence)g(b)s(eing)300
3422 y(the)34 b(addition)d(of)j(a)g(static)g(t)m(yp)s(e)g(system\).)50
b(F)-8 b(acts)35 b(and)e(rules)f(are)i(asserted)g(in)m(to)f(the)h
(database,)i(and)300 3609 y(queries)25 b(are)h(run)f(to)h(unify)e(free)
i(logic)g(v)-5 b(ariables)24 b(with)h(v)-5 b(alues)25
b(that)i(solv)m(e)f(the)g(queries.)38 b(The)26 b(solutions)300
3797 y(can)34 b(b)s(e)f(accessed)i(programmatically)d(b)m(y)i(C++)f(co)
s(de,)i(and)e(they)g(are)h(only)f(computed)h(one-b)m(y-one)300
3984 y(\(on)d(demand\),)f(just)f(as)i(with)e(Prolog.)300
4224 y Fl(3.1.1)105 b(In)m(tro)s(ductory)36 b(example)e(and)h(syn)m
(tax)g(o)m(v)m(erview)300 4471 y Fm(Figure)30 b(22)i(sho)m(ws)e(an)h
(actual)g(part)g(of)f(an)h(LC++)f(program)g(describing)f(the)h
(Simpsons)f(family)g(rela-)300 4658 y(tionships.)47 b(The)33
b Fk(lassert\(\))e Fm(function)h(is)h(used)f(to)j(add)d(facts)j(and)d
(implications)f(to)j(the)g(database,)300 4845 y(and)28
b(the)h Fk(query\(\))e Fm(function)h(is)g(used)g(to)h(run)f(queries.)39
b(The)28 b(syn)m(tax)i(for)e(functors,)h(v)-5 b(alues,)29
b(and)f(logic)300 5033 y(v)-5 b(ariables)38 b(is)h(v)m(ery)h(similar)d
(to)j(that)g(of)g(Prolog;)45 b(T)-8 b(able)39 b(11)h(summarizes)f(the)g
(di\013erences)g(b)s(et)m(w)m(een)300 5220 y(LC++)29
b(syn)m(tax)i(and)f(Prolog)g(syn)m(tax.)2032 5700 y(110)p
eop
%%Page: 111 120
111 119 bop 300 260 a Fk(FUN2\(parent,string,strin)o(g\);)375
b(FUN1\(female,string\);)300 373 y(FUN2\(father,string,strin)o(g\);)g
(FUN2\(sibling,string,string)o(\);)300 486 y(FUN2\(mother,string,strin)
o(g\);)g(FUN2\(brother,string,string)o(\);)300 599 y
(FUN2\(child,string,string)o(\);)423 b(FUN2\(sister,string,string\))o
(;)300 712 y(FUN1\(male,string\);)806 b(FUN3\(ancestor,string,strin)o
(g,in)o(t\);)300 938 y(DECLARE\(Mom,)44 b(string,0\);)570
b(DECLARE\(Sib,)45 b(string,6\);)300 1051 y(DECLARE\(Dad,)f
(string,1\);)570 b(DECLARE\(Sib2,string,7\);)300 1164
y(DECLARE\(Kid,)44 b(string,2\);)570 b(DECLARE\(Anc,)45
b(string,8\);)300 1276 y(DECLARE\(Par,)f(string,3\);)570
b(DECLARE\(Tmp,)45 b(string,9\);)300 1389 y(DECLARE\(Bro,)f
(string,4\);)570 b(DECLARE\(X)141 b(,int,)94 b(10\);)300
1502 y(DECLARE\(Sis,)44 b(string,5\);)570 b(DECLARE\(Y)141
b(,int,)94 b(11\);)300 1728 y(string)46 b(bart="bart",)f(lisa="lisa",)f
(maggie="maggie",)443 1841 y(marge="marge",)g(homer="homer",)g
(abraham="abraham";)300 1954 y(lassert\()i(male\(bart\))f(\);)429
b(lassert\()45 b(female\(lisa\))g(\);)300 2067 y(lassert\()h
(male\(homer\))e(\);)382 b(lassert\()45 b(female\(maggie\))f(\);)300
2180 y(lassert\()i(male\(abraham\))e(\);)286 b(lassert\()45
b(female\(marge\))f(\);)300 2406 y(lassert\()i(parent\(marge,bart\))c
(\);)300 2518 y(lassert\()k(parent\(marge,lisa\))c(\);)300
2631 y(lassert\()k(parent\(marge,maggie\))c(\);)300 2744
y(lassert\()k(parent\(homer,bart\))c(\);)300 2857 y(lassert\()k
(parent\(homer,lisa\))c(\);)300 2970 y(lassert\()k
(parent\(homer,maggie\))c(\);)300 3083 y(lassert\()k
(parent\(abraham,homer\))c(\);)300 3309 y(lassert\()k
(mother\(Mom,Kid\))d(-=)k(parent\(Mom,Kid\))d(&&)j(female\(Mom\))e(\);)
300 3422 y(lassert\()h(father\(Dad,Kid\))d(-=)k(parent\(Dad,Kid\))d(&&)
j(male\(Dad\))e(\);)300 3535 y(lassert\()h(child\(Kid,Par\))d(-=)48
b(parent\(Par,Kid\))43 b(\);)300 3648 y(lassert\()j
(sibling\(Sib,Sib2\))d(-=)k(father\(Dad,Sib\))c(&&)48
b(father\(Dad,Sib2\))873 3761 y(&&)f(mother\(Mom,Sib\))d(&&)j
(mother\(Mom,Sib2\))873 3873 y(&&)g(not_provable\()d(Sib==Sib2)h(\))j
(\);)300 3986 y(lassert\()e(brother\(Bro,Sib\))d(-=)k
(sibling\(Bro,Sib\))c(&&)48 b(male\(Bro\))d(\);)300 4099
y(lassert\()h(sister\(Sis,Sib\))d(-=)k(sibling\(Sis,Sib\))d(&&)j
(female\(Sis\))e(\);)300 4212 y(lassert\()h(ancestor\(Par,Kid,1\))c(-=)
47 b(parent\(Par,Kid\))d(\);)300 4325 y(lassert\()i
(ancestor\(Anc,Kid,X\))c(-=)47 b(parent\(Anc,Tmp\))d(&&)873
4438 y(ancestor\(Tmp,Kid,Y\))e(&&)47 b(X.is\(plus,Y,1\))d(\);)300
4664 y(query\()i(father\(Dad,Kid\))e(\);)300 4777 y(query\()i
(sibling\(maggie,Sib2\))c(\);)300 4890 y(query\()k
(ancestor\(Anc,bart,X\))c(\);)1055 5185 y Fl(Figure)35
b(22:)47 b Fm(Simpsons)28 b(family)h(relationships)e(in)i(LC++)2032
5700 y(111)p eop
%%Page: 112 121
112 120 bop 1155 3 1891 4 v 1153 116 4 113 v 1310 82
a Fm(Description)p 1917 116 V 204 w(Prolog)p 2276 116
V 301 w(LC++)p 3044 116 V 1155 120 1891 4 v 1155 136
V 1153 249 4 113 v 1327 215 a(uni\014cation)p 1917 249
V 326 w Fk(=)p 2276 249 V 492 w(==)p 3044 249 V 1155
252 1891 4 v 1153 365 4 113 v 1306 331 a Fm(conjunction)p
1917 365 V 305 w Fk(,)p 2276 365 V 492 w(&&)p 3044 365
V 1155 369 1891 4 v 1153 482 4 113 v 1318 448 a Fm(disjunction)p
1917 482 V 316 w Fk(|)p 2276 482 V 492 w(||)p 3044 482
V 1155 485 1891 4 v 1153 598 4 113 v 1315 564 a Fm(implication)p
1917 598 V 288 w Fk(:-)p 2276 598 V 468 w(-=)p 3044 598
V 1155 601 1891 4 v 1153 714 4 113 v 1289 680 a Fm(not)31
b(pro)m(v)-5 b(able)p 1917 714 V 194 w Fk(not\(\))p 2276
714 V 108 w(not_provable\(\))p 3044 714 V 1155 717 1891
4 v 1153 830 4 113 v 1333 796 a Fm(ev)g(aluation)p 1917
830 V 310 w Fk(is)p 2276 830 V 420 w(is\(\))p 3044 830
V 1155 834 1891 4 v 1153 946 4 113 v 1205 913 a Fm(dumm)m(y)29
b(logic)h(v)-5 b(ar)p 1917 946 V 205 w Fk(_)p 2276 946
V 516 w(_)p 3044 946 V 1155 950 1891 4 v 987 1204 a Fl(T)c(able)35
b(11:)47 b Fm(Syn)m(tax)31 b(mapping)e(b)s(et)m(w)m(een)i(Prolog)f(and)
g(LC++)300 1461 y Fl(3.1.2)105 b(Declaring)36 b(relations)f(and)g
(logic)h(v)-6 b(ariables)300 1708 y Fm(LC++)28 b(uses)i(the)f(C++)g(t)m
(yp)s(e)h(system)f(and)g(templates)h(to)h(enforce)f(static)g(t)m(yping)
f(of)h(logic)f(program-)300 1895 y(ming)c(co)s(de.)39
b(T)-8 b(o)27 b(declare)f(a)g(functor,)h(w)m(e)f(use)g(the)g(form)g
Fk(FUN)p Fb(n)e Fm(\()p Fb(n)i Fm(denoting)f(the)i(arit)m(y)f(of)g(the)
g(functor\))300 2082 y(and)k(sp)s(ecify)f(the)i(functor's)f(name)h(as)f
(w)m(ell)g(as)h(the)f(t)m(yp)s(es)h(of)f(its)g(argumen)m(ts.)42
b(F)-8 b(or)31 b(example,)g Fk(parent)300 2270 y Fm(in)e(the)i
(preceding)e(example)h(is)f(declared)h(lik)m(e)g(this:)443
2510 y Fk(FUN2\(parent,string,string)o(\);)300 2750 y
Fm(In)22 b(fact,)k(the)d(declared)f(functor)h(is)f(a)h(singleton)f
(instance)g(of)i(a)f(class)f(with)g(an)h(o)m(v)m(erloaded)h
Fk(operator\(\))300 2938 y Fm(metho)s(d;)30 b(the)g(example)f(ab)s(o)m
(v)m(e)i(declares)f Fk(parent)e Fm(as)i(an)f(instance)h(of)g(class)f
Fk(parent_TYPE)e Fm(\(whic)m(h)i(is)300 3125 y(the)i(name)f(of)h(the)f
(class)g(created)i(b)m(y)e(the)g Fk(FUN2)g Fm(macro\).)441
3313 y(Similarly)-8 b(,)26 b(logic)i(v)-5 b(ariables)28
b(m)m(ust)g(b)s(e)g(declared)g(in)f(order)i(to)g(statically)f(t)m(yp)s
(ec)m(hec)m(k)i(them.)41 b(In)27 b(our)300 3500 y(example,)j(to)h
(declare)g(logic)f(v)-5 b(ariable)29 b Fk(X)h Fm(of)h(t)m(yp)s(e)f
Fk(int)p Fm(,)g(w)m(e)h(sa)m(y:)443 3740 y Fk(DECLARE\()46
b(X,)h(int,)g(10)g(\);)300 3981 y Fm(The)29 b(surprising)c(in)m(teger)
30 b(constan)m(t)h(parameter)e(will)e(b)s(e)i(explained)e(in)h(Section)
h(3.2.2.)42 b(As)30 b(in)e(Prolog,)300 4168 y(w)m(e)i(use)f(the)h(con)m
(v)m(en)m(tion)g(of)g(ha)m(ving)f(a)g(logic)h(v)-5 b(ariable's)28
b(name)h(b)s(egin)f(with)g(a)i(capital)f(letter.)41 b(Just)29
b(as)300 4356 y(with)k(the)i(macro)g(for)f(functors,)h(the)f
Fk(DECLARE)f Fm(macro)h(also)h(declares)f(a)h(new)f(t)m(yp)s(ename;)i
(the)f(C++)300 4543 y(t)m(yp)s(e)c(of)f(logic)g(v)-5
b(ariable)29 b Fk(X)h Fm(is)g(called)f Fk(X_TYPE)p Fm(.)300
4779 y Fl(3.1.3)105 b(Calling)35 b(out)g(to)g(C++)g(functions)300
5025 y Fm(Lik)m(e)h(Prolog,)h(LC++)d(uses)h(\\)p Fk(is)p
Fm(")h(to)h(bind)c(logic)i(v)-5 b(ariables)35 b(to)h(results)f(of)g(a)h
(computation.)57 b(In)35 b(the)300 5213 y(Simpsons)40
b(example,)45 b(the)d Fk(ancestor)e Fm(relation)h(computes)h(the)g(n)m
(um)m(b)s(er)f(of)h(generations)g(b)s(et)m(w)m(een)300
5400 y(direct)30 b(relativ)m(es)g(lik)m(e)g(so:)2032
5700 y(112)p eop
%%Page: 113 122
113 121 bop 443 91 a Fk(lassert\()46 b(ancestor\(Par,Kid,1\))c(-=)47
b(parent\(Par,Kid\))d(\);)443 279 y(lassert\()i(ancestor\(Anc,Kid,X\))c
(-=)47 b(parent\(Anc,Tmp\))d(&&)1016 466 y(ancestor\(Tmp,Kid,Y\))e(&&)
48 b(X.is\(plus,Y,1\))c(\);)300 708 y Fm(The)27 b(co)s(de)g
Fk(X.is\(plus,Y,1\))d Fm(adds)i(1)i(to)g(the)f(curren)m(t)g(v)-5
b(alue)27 b(of)g Fk(Y)g Fm(and)g(binds)e(the)i(resulting)e(v)-5
b(alue)27 b(to)300 896 y Fk(X)p Fm(.)e(Note)h(that)f
Fk(plus)f Fm(is)g(a)h(functoid)f(from)g(F)m(C++.)39 b(The)25
b(general)f(mec)m(hanism)h(to)g(call)f(out)i(to)f(arbitrary)300
1083 y(C++)k(co)s(de)i(in)e(LC++)g(is)443 1325 y Fk(SomeLogicVar.is\()
44 b(some_functoid,)f(arg1,)k(...,)f(argN)h(\))300 1567
y Fm(Th)m(us,)36 b(via)f Fk(is\(\))p Fm(,)h(LC++)f(has)g(a)h(general)g
(mec)m(hanism)f(to)h(call)f(functions)f(or)i(to)g(ha)m(v)m(e)h
(e\013ects;)j(just)300 1755 y(create)32 b(a)e(functoid)f(that)i
(describ)s(es)d(the)i(desired)f(computation,)h(and)g(pass)g(it)f(as)i
(the)f(\014rst)f(argumen)m(t)300 1942 y(to)i Fk(is\(\))p
Fm(.)300 2178 y Fl(3.1.4)105 b(Asserting)36 b(facts)f(and)g(rules,)g
(running)g(basic)h(queries)300 2425 y Fm(In)28 b(the)h(example,)g
Fk(lassert\(\))d Fm(w)m(as)j(used)f(to)h(p)s(opulate)f(the)h(database)g
(with)f(facts)h(and)f(implications,)300 2612 y(and)j
Fk(query\(\))e Fm(w)m(as)j(used)e(to)i(p)s(erform)e(queries.)42
b(But)32 b(what)f(do)s(es)g Fk(query\(\))e Fm(do)i(with)f(its)h
(results?)42 b(In)300 2799 y(fact)37 b(there)e(are)h(three)g
(di\013eren)m(t)f(query)g(functions.)55 b(W)-8 b(e)37
b(p)s(ostp)s(one)e(un)m(til)f(Section)h(3.2.1)j(discussion)300
2987 y(of)30 b(the)h(main)e Fk(query\(\))f Fm(function.)39
b(The)30 b(simplest)e(of)j(the)f(other)h(t)m(w)m(o)g(is)e
Fk(iquery\(\))p Fm(:)39 b(it)29 b(prin)m(ts)g(out)i(its)300
3174 y(results.)39 b(So)31 b(if)e(the)i(\014nal)e(query)g(from)h(the)h
(Simpsons)d(example)i(w)m(ere)443 3416 y Fk(iquery\()46
b(ancestor\(Anc,bart,X\))c(\);)300 3658 y Fm(then)30
b(the)h(results)443 3901 y Fk(Result)46 b(#1)491 4088
y(-)h(Anc)95 b(=)47 b(marge)491 4275 y(-)g(X)191 b(=)47
b(1)443 4463 y(Result)f(#2)491 4650 y(-)h(Anc)95 b(=)47
b(homer)491 4838 y(-)g(X)191 b(=)47 b(1)443 5025 y(Result)f(#3)491
5213 y(-)h(Anc)95 b(=)47 b(abraham)491 5400 y(-)g(X)191
b(=)47 b(2)2032 5700 y Fm(113)p eop
%%Page: 114 123
114 122 bop 300 91 a Fm(w)m(ould)29 b(b)s(e)h(prin)m(ted)f(to)i(the)f
(screen.)300 328 y Fl(3.1.5)105 b(More)36 b(on)f(queries,)g(en)m
(vironmen)m(ts,)g(and)g(result)g(lists)300 574 y Fm(Whereas)e
Fk(iquery\(\))d Fm(prin)m(ts)g(its)i(results,)f(the)i
Fk(lquery\(\))d Fm(function)g(returns)h(an)h(F)m(C++)g
Fk(List)f Fm(of)i(re-)300 761 y(sults.)38 b Fk(List)23
b Fm(is)h(a)h(lazy)g(list)f(data)h(t)m(yp)s(e|the)g(elemen)m(ts)g(are)h
(not)f(computed)f(un)m(til)f(actually)i(requested.)300
949 y(Eac)m(h)h(query)f(result)f(is)g(represen)m(ted)h(b)m(y)g(an)g(en)
m(vironmen)m(t)g(ob)5 b(ject)26 b(\(actually)-8 b(,)27
b(a)f(smart)f(p)s(oin)m(ter)f(\()p Fk(IRef)p Fm(\))300
1136 y(to)38 b(an)g(en)m(vironmen)m(t)f(ob)5 b(ject;)43
b(more)38 b(details)f(to)h(come)h(in)d(Section)i(3.2.1\),)k(whic)m(h)36
b(con)m(tains)i(all)f(the)300 1324 y(information)23 b(ab)s(out)h(the)h
(logic)f(v)-5 b(ariable)23 b(bindings.)36 b(The)24 b(t)m(yp)s(e)g(of)h
(the)g(en)m(vironmen)m(t)f(ob)5 b(ject)25 b(is)f(a)h(func-)300
1511 y(tion)k(of)h(whic)m(h)e(\(t)m(yp)s(es)i(of)7 b(\))30
b(logic)f(v)-5 b(ariables)29 b(app)s(ear)g(in)f(a)i(particular)e(query)
-8 b(.)40 b(Naming)29 b Fk(Environment)300 1698 y Fm(t)m(yp)s(es)h(can)
h(b)s(e)f(di\016cult;)e(the)j(result)e(t)m(yp)s(e)i(of)f(the)h(call)443
1940 y Fk(lquery\()46 b(ancestor\(Anc,bart,X\))c(\);)300
2183 y Fm(is)29 b(a)i Fk(List)e Fm(of)443 2425 y Fk
(IRef<Environment<TL::CONS)o(<X_T)o(YPE)o(,TL:)o(:CON)o(S<A)o(nc_T)o
(YPE,)o(TL:)o(:NIL)o(>)42 b(>)47 b(>)h(>)300 2667 y Fm(ob)5
b(jects.)49 b(That)33 b(is,)g(it)g(is)f(a)h(lazy)g(list)f(of)h
(references)g(to)h(a)f(binding)d(en)m(vironmen)m(t)j(holding)e(v)-5
b(alues)32 b(for)300 2854 y(logic)k(v)-5 b(ariables)34
b Fk(X)i Fm(and)f Fk(Anc)p Fm(.)57 b(\(More)37 b(ab)s(out)f(the)g
Fk(TL)g Fm(namespace)g(and)g(represen)m(ting)f(compile-time)300
3042 y(t)m(yp)s(e-lists)29 b(in)g(Section)i(3.2.2.2.\))441
3229 y(Suc)m(h)k(long)h(and)f(ugly)g(t)m(yp)s(e)i(names)e(are)i(a)f
(common)g(o)s(ccurrence)h(in)d(C++)h(template)i(libraries,)300
3416 y(esp)s(ecially)25 b(those)i(using)d(expression)i(templates.)39
b(F)-8 b(ortunately)27 b(w)m(e)g(can)g(shield)d(the)j(clien)m(t)f(from)
f(these)300 3604 y(names)43 b(b)m(y)g(pro)m(viding)d(a)k(\\t)m(yp)s(e)f
(computer")h(whic)m(h)d(pro)m(vides)h(a)h(managable)h(alias)e(for)g
(the)i(t)m(yp)s(e:)300 3791 y(the)34 b(t)m(yp)s(e)g Fk
(QRT<Foo_TYPE,Bar_TYPE>:)o(:IE)27 b Fm(describ)s(es)32
b(the)i(t)m(yp)s(e)f(of)h(results)f(of)g(a)h(query)f(in)m(v)m(olving)
300 3979 y(the)h(logic)f(v)-5 b(ariables)33 b Fk(Foo)g
Fm(and)g Fk(Bar)p Fm(.)50 b(\()p Fk(QRT)33 b Fm(stands)g(for)h(\\Query)
f(Return)g(T)m(yp)s(e")h(and)f Fk(IE)g Fm(stands)g(for)300
4166 y Fk(IRef<Environment>)p Fm(.\))j(As)31 b(a)f(result,)g(w)m(e)h
(can)g(just)e(sa)m(y)443 4408 y Fk(typedef)46 b
(QRT<Anc_TYPE,X_TYPE>::IE)41 b(IE;)443 4596 y(List<IE>)46
b(l)h(=)h(lquery\()d(ancestor\(Anc,bart,X\))e(\);)300
4838 y Fm(to)26 b(get)g(our)e(list)g(of)h(results.)37
b(W)-8 b(e)27 b(can)e(then)f(use)h(the)g(F)m(C++)g(functions)e
Fk(null\(\))p Fm(,)i Fk(head\(\))p Fm(,)f(and)h Fk(tail\(\))300
5025 y Fm(to)31 b(tra)m(v)m(erse)h(the)f(list)e(of)h(references)h(to)g
(en)m(vironmen)m(t)f(ob)5 b(jects.)441 5213 y(The)26
b(en)m(vironmen)m(t)g(ob)5 b(ject)27 b(itself)f(resp)s(onds)e(to)j(the)
g(metho)s(d)f Fk(at\()p Fi(SomeL)-5 b(o)g(gicV)e(ar)10
b Fk(\))p Fm(,)28 b(returning)c(an)300 5400 y(ob)5 b(ject)28
b(represen)m(ting)f(the)g(binding)d(for)k(that)f(logic)h(v)-5
b(ariable.)38 b(Assuming)26 b(the)h(v)-5 b(ariable)26
b(is)h(b)s(ound,)f(the)2032 5700 y(114)p eop
%%Page: 115 124
115 123 bop 300 91 a Fm(\\)p Fk(*)p Fm(")26 b(op)s(erator)f(returns)e
(the)j(v)-5 b(alue)24 b(it)h(is)e(b)s(ound)g(to.)40 b(This)23
b(w)m(a)m(y)j(the)f(clien)m(t)g(can)g(prin)m(t)f(the)h(results)e(using)
300 279 y(its)30 b(o)m(wn)g(c)m(hoice)h(of)g(formatting.)41
b(F)-8 b(or)31 b(example)443 528 y Fk(while\()46 b(!null\(l\))g(\))h({)
586 716 y(IE)h(env)e(=)i(head\(l\);)586 903 y(std::cout)e(<<)h("X)g(is)
g(")h(<<)f(*env->at\(X\))e(<<)i(")g(and)g(Anc)g(is)g(")777
1091 y(<<)g(*env->at\(Anc\))e(<<)i(std::endl;)586 1278
y(l)h(=)f(tail\(l\);)443 1466 y(})300 1715 y Fm(will)28
b(prin)m(t)h(to)i(the)f(screen:)443 1965 y Fk(X)48 b(is)f(1)g(and)g
(Anc)g(is)g(marge)443 2152 y(X)h(is)f(1)g(and)g(Anc)g(is)g(homer)443
2340 y(X)h(is)f(2)g(and)g(Anc)g(is)g(abraham)441 2589
y Fm(F)m(C++)35 b Fk(List)p Fm(s)f(are)i(lazy)-8 b(,)38
b(and)c(the)i(implemen)m(tation)e(of)h(the)h(LC++)e(query)h(functions)f
(exploits)300 2777 y(this)f(laziness)f(in)h(an)g(imp)s(ortan)m(t)g(w)m
(a)m(y)-8 b(.)52 b(F)-8 b(or)34 b(instance,)h(a)f(query)f(computation)g
(ma)m(y)i(not)f(terminate.)300 2964 y(The)24 b(query)g(ma)m(y)h(yield)e
(a)i(few)g(results)e(and)h(then)h(get)g(\\stuc)m(k")h(in)e(an)g
(in\014nite)f(lo)s(op,)i(or)f(the)h(query)f(ma)m(y)300
3152 y(return)34 b(an)h(in\014nite)d(n)m(um)m(b)s(er)i(of)h(results,)g
(suc)m(h)g(as)g(in)f(this)g(simple)f(example)h(in)m(v)m(olving)g(the)h
(natural)300 3339 y(n)m(um)m(b)s(ers:)443 3589 y Fk(FUN1\()47
b(nat,)f(int)h(\);)443 3776 y(DECLARE\()f(X,)h(int,)g(10)g(\);)443
3964 y(DECLARE\()f(Y,)h(int,)g(11)g(\);)443 4151 y(lassert\()f
(nat\(0\))g(\);)443 4338 y(lassert\()g(nat\(X\))g(-=)h(nat\(Y\))f(&&)h
(X.is\(plus,Y,1\))d(\);)300 4588 y Fm(Running)f(the)i(query)g
Fk(nat\(X\))e Fm(pro)s(duces)h(an)h(in\014nite)e(list)h(of)h(results.)
84 b(This)43 b(do)s(esn't)i(presen)m(t)h(a)300 4775 y(problem,)28
b(though;)h(if)f(w)m(e)i(are)f(only)f(in)m(terested)h(in)f(the)h
(\014rst)g(3)g(results,)f(w)m(e)i(just)e(ask)h(for)g(those.)41
b(That)300 4963 y(is,)30 b(w)m(e)h(can)f(sa)m(y)443 5213
y Fk(typedef)46 b(QRT<X_TYPE>::IE)e(IE;)443 5400 y(List<IE>)i(l)h(=)h
(lquery\()d(nat\(X\))i(\);)2032 5700 y Fm(115)p eop
%%Page: 116 125
116 124 bop 443 91 a Fk(for\()47 b(int)g(i=0;)f(i<3;)h(++i)g(\))g({)586
279 y(IE)h(env)e(=)i(head\(l\);)586 466 y(std::cout)e(<<)h("X)g(is)g(")
h(<<)f(*env->at\(X\))e(<<)i(std::endl;)586 654 y(l)h(=)f(tail\(l\);)443
841 y(})300 1084 y Fm(and)30 b(that)h(co)s(de)f(prin)m(ts)443
1326 y Fk(X)48 b(is)f(0)443 1513 y(X)h(is)f(1)443 1701
y(X)h(is)f(2)300 1943 y Fm(The)c(implemen)m(tation)g(of)g(this)g
(feature)h(\(laziness)f(of)h(query)f(results\))g(is)g(describ)s(ed)f
(at)i(length)f(in)300 2131 y(Section)30 b(3.2.1.)300
2367 y Fl(3.1.6)105 b(F)-9 b(unctors)36 b(and)f(data)f(structures)300
2613 y Fm(The)29 b(examples)f(of)h(the)h(previous)d(subsections)h
(illustrate)g(some)h(of)g(the)h(most)f(imp)s(ortan)m(t)f(features)i(of)
300 2801 y(the)g(library)-8 b(.)38 b(In)29 b(this)g(subsection)f(w)m(e)
i(discuss)e(some)i(of)g(the)f(deep)s(er)g(details)g(of)g(the)h(library)
d(in)m(terface)300 2988 y(that)k(are)g(not)f(co)m(v)m(ered)i(b)m(y)f
(the)f(simple)f(example.)450 3225 y Fi(3.1.6.1)94 b(User-de\014ne)-5
b(d)34 b(C++)d(typ)-5 b(es)34 b(as)f(LC++)f(atoms)300
3471 y Fm(User-de\014ned)i(t)m(yp)s(es)g(can)h(b)s(e)f(used)f(as)i
(\\atoms")h(for)e(LC++,)h(pro)m(vided)e(these)i(t)m(yp)s(es)f(pro)m
(vide)g(b)s(oth)300 3658 y(a)e(cop)m(y)g(constructor)g(and)f(an)g
(equalit)m(y)g(op)s(erator.)45 b(The)31 b(cop)m(y)h(constructor)g(is)e
(required)g(so)i(that)g(the)300 3846 y(ob)5 b(ject)36
b(can)e(b)s(e)g(copied)h(in)m(to)f(an)h(LC++)e(data)j(structure,)f(and)
f(the)h(equalit)m(y)f(op)s(erator)h(is)f(required)300
4033 y(for)e(uni\014cation.)45 b(Here)33 b(is)f(an)g(example)g(of)h(a)g
(user-de\014ned)e(t)m(yp)s(e)i(whic)m(h)e(can)i(b)s(e)e(used)h(as)h(an)
f(LC++)300 4220 y(atom:)443 4463 y Fk(struct)46 b(Point)h({)586
4650 y(int)g(x;)586 4838 y(int)g(y;)586 5025 y(bool)g(operator==\()e
(const)h(Point&)g(p)i(\))f(const)586 5213 y({)h(return)e(this->x)g(==)h
(p.x)95 b(&&)f(this->y)46 b(==)h(p.y;)g(})443 5400 y(};)2032
5700 y Fm(116)p eop
%%Page: 117 126
117 125 bop 300 91 a Fm(Dep)s(ending)26 b(up)s(on)h(ho)m(w)g(y)m(our)h
(application)e(is)h(structured,)h(it)f(migh)m(t)h(b)s(e)f(b)s(etter)h
(to)h(represen)m(t)f Fk(Point)p Fm(s)300 279 y(using)h(functors,)h
(instead)g(\(discussed)e(next\).)450 519 y Fi(3.1.6.2)94
b(LC++)32 b(functors)i(as)f(data)h(structur)-5 b(es)300
765 y Fm(Just)30 b(as)h(in)f(Prolog,)h(LC++)f(functors)g(can)i(b)s(e)e
(used)g(as)h(data)h(structures)e(as)h(w)m(ell)f(as)h(for)g(predicates.)
300 952 y(F)-8 b(or)31 b(example,)f(w)m(e)h(could)f(de\014ne)443
1213 y Fk(FUN2\(point,int,int\);)443 1400 y(DECLARE\()46
b(P,)h(point_TYPE,)e(0)i(\);)443 1588 y(DECLARE\()f(X,)h(int,)381
b(1)47 b(\);)300 1848 y Fm(and)24 b(then)g(use)g Fk(point\(\))f
Fm(to)i(create)h(data)g(structures)e(where)g(w)m(e)h(can)g(p)s(erform)e
(uni\014cation)f(on)j(v)-5 b(arious)300 2036 y(subparts:)443
2296 y Fk(iquery\()46 b(P)h(==)h(point\(X,3\))d(&&)i(X)g(==)g(4)h(\);)
443 2484 y(//)f(yields)f(result:)443 2671 y(//)95 b(-)48
b(P)190 b(=)48 b(point\(4,3\))443 2858 y(//)95 b(-)48
b(X)190 b(=)48 b(4)441 3119 y Fm(Indeed,)38 b(a)g(logic)e(v)-5
b(ariable)36 b(with)g(\\functor)h(shap)s(e")g(can)g(pla)m(y)g(b)s(oth)f
(the)i(role)e(of)h(a)h(term)f(and)g(a)300 3306 y(data)31
b(structure)f(within)e(one)i(query)-8 b(.)41 b(F)-8 b(or)31
b(example,)f(consider)g(the)g(v)-5 b(ariable)29 b Fk(A)i
Fm(in)e(this)g(query:)443 3567 y Fk(iquery\()46 b
(A==ancestor\(Anc,bart,X\))41 b(&&)48 b(A)f(\);)300 3827
y Fm(The)30 b(query)g(results)f(in)443 4088 y Fk(Result)46
b(#1)491 4275 y(-)h(Anc)95 b(=)47 b(marge)491 4463 y(-)g(X)191
b(=)47 b(1)491 4650 y(-)g(A)191 b(=)47 b(ancestor\(marge,bart,1\))443
4838 y(Result)f(#2)491 5025 y(-)h(Anc)95 b(=)47 b(homer)491
5213 y(-)g(X)191 b(=)47 b(1)491 5400 y(-)g(A)191 b(=)47
b(ancestor\(homer,bart,1\))2032 5700 y Fm(117)p eop
%%Page: 118 127
118 126 bop 443 91 a Fk(Result)46 b(#3)491 279 y(-)h(Anc)95
b(=)47 b(abraham)491 466 y(-)g(X)191 b(=)47 b(2)491 654
y(-)g(A)191 b(=)47 b(ancestor\(abraham,bart,2\))300 916
y Fm(where)38 b(the)g(v)-5 b(ariable)37 b Fk(A)h Fm(\(with)f(t)m(yp)s
(e)i Fk(ancestor_TYPE)p Fm(\))c(is)i(b)s(oth)g(uni\014ed)f(with)h(an)h
Fk(ancestor)e Fm(data)300 1103 y(structure)30 b(and)g(used)f(as)i(a)g
(query)e(term.)300 1343 y Fl(3.1.7)105 b(Limitations)300
1589 y Fm(The)26 b(curren)m(t)h(implemen)m(tation)e(of)j(LC++)d(has)i
(a)g(few)g(imp)s(ortan)m(t)f(limitations)e(and)j(omissions,)f(some)300
1777 y(of)31 b(whic)m(h)e(w)m(e)h(ma)m(y)h(address)f(in)f(the)i
(future.)441 1964 y Fi(Omissions.)43 b Fm(The)30 b(curren)m(t)g(LC++)g
(implemen)m(tation)g(omits)g(a)h(couple)f(notable)h(Prolog)g(en)m
(tities,)300 2152 y(namely)f(the)g Fk(cut)g Fm(\()p Fk(!)p
Fm(\))g(op)s(erator)h(and)f(a)h Fk(retract\(\))c Fm(function.)441
2339 y Fi(Par)-5 b(ametric)51 b(p)-5 b(olymorphism.)98
b Fm(One)47 b(ma)5 b(jor)49 b(restriction)e(with)g(LC++)g(is)g(that)i
(functors)f(are)300 2527 y Fi(monomorphic)p Fm(.)42 b(F)-8
b(or)25 b(example,)h(w)m(e)f(can)g(de\014ne)f Fk(append\(\))f
Fm(to)i(w)m(ork)g(on)g(lists)e(of)i(in)m(tegers,)h(but)e(cannot)300
2714 y(use)29 b(the)g(same)h Fk(append\(\))d Fm(for)i(lists)f(of)i
(other)f(t)m(yp)s(es)g(\(e.g.)42 b Fk(string)p Fm(,)28
b Fk(double)p Fm(,)g(etc.\).)42 b(This)28 b(restriction)300
2901 y(is)36 b(ro)s(oted)i(in)e(C++|in)e(C++,)39 b(a)e
Fk(virtual)e Fm(function)h(ma)m(y)i(not)g(b)s(e)e(a)i(template,)h(and)e
(our)g(imple-)300 3089 y(men)m(tation)27 b(mak)m(es)h(essen)m(tial)f
(use)f(of)h Fk(virtual)e Fm(metho)s(ds.)39 b(An)26 b(alternativ)m(e)i
(implemen)m(tation)d(stategy)300 3276 y(migh)m(t)g(enable)g(this)f
(restriction)g(to)i(b)s(e)f(lifted.)38 b(\(Regardless,)26
b(the)g(applications)d(w)m(e)j(ha)m(v)m(e)g(encoun)m(tered)300
3464 y(th)m(us)31 b(far)h(do)f(not)h(require)f(parametric)g(p)s
(olymorphism|see)e(Section)i(3.3.)46 b(Note)33 b(also)f(that)g(this)f
(re-)300 3651 y(striction)d(and)h(the)h(monomorphic)e(restrictions)g
(of)i(F)m(C++)f(indirect)e(functoids)h(\(Section)i(2.2.3\))i(and)300
3839 y(v)-5 b(ariables)29 b(\(Section)i(2.5.3\))h(all)d(ha)m(v)m(e)j
(the)f(same)f(ro)s(ot)h(cause.\))441 4026 y Fi(Performanc)-5
b(e.)67 b Fm(LC++)38 b(allo)m(ws)g(clien)m(ts)h(to)h(up)s(date)e(the)h
(database)h(of)f(facts)g(and)g(implications)300 4213
y(with)31 b(calls)g(to)i Fk(lassert\(\))c Fm(at)k(an)m(y)g(time|ev)m
(en)f(during)e(the)i(execution)g(of)h(a)f(query)-8 b(.)46
b(This)30 b(freedom)300 4401 y(allo)m(ws)38 b(for)h(m)m(uc)m(h)g
(dynamicit)m(y)e(\(e.g.)68 b(the)39 b(facts)h(and)e(rules)f(can)j(b)s
(e)e(read)h(in)e(at)j(run-time)d(from)i(a)300 4588 y(\014le\),)g(but)f
(it)f(e\013ectiv)m(ely)i(limits)d(LC++)g(to)j(executing)f(queries)f
(lik)m(e)g(an)h(in)m(terpreter,)h(with)e(all)g(the)300
4776 y(asso)s(ciated)31 b(p)s(erformance)f(limitations)e(of)i(that)h
(approac)m(h.)441 4963 y(In)k(addition,)h(our)g(curren)m(t)g(implemen)m
(tation)f(is)g(somewhat)h(naiv)m(e.)58 b(Eac)m(h)37 b(time)f(a)g
(predicate)g(is)300 5151 y(in)m(v)m(ok)m(ed,)27 b(the)f(w)m(ork)g(to)h
(con)m(v)m(ert)g(the)g Fk(Rep)d Fm(ob)5 b(jects)27 b(to)g(the)f
(corresp)s(onding)e Fk(Impl)g Fm(ob)5 b(jects)27 b(\(Section)f(3.2)2032
5700 y(118)p eop
%%Page: 119 128
119 127 bop 300 91 a Fm(describ)s(es)32 b(the)i Fk(Rep)f
Fm(and)g Fk(Impl)g Fm(ob)5 b(jects)35 b(in)d(the)i(implemen)m(tation\))
f(is)g(re-done;)j(with)d(a)h(sligh)m(tly)e(dif-)300 279
y(feren)m(t)38 b(arc)m(hitecture,)i(the)d Fk(Impl)g Fm(ob)5
b(jects)38 b(for)f(eac)m(h)i(rule)d(could)g(b)s(e)h(cac)m(hed)h(and)f
(reused.)61 b(Also,)39 b(all)300 466 y(predicates)33
b(and)f(functors)h(are)h(in)m(ternally)d(represen)m(ted)i(as)g(ternary)
g(functors)g(\(p)s(erhaps)f(with)g(some)300 654 y(slots)c(\014lled)e
(with)h(\\dumm)m(y")h(ob)5 b(jects\))29 b(ev)m(en)g(if)e(the)i(actual)f
(predicate)h(or)f(functor)g(has)g(a)g(lo)m(w)m(er)h(arit)m(y;)300
841 y(this)40 b(w)m(astes)j(some)e(memory)h(and)e(causes)i(some)g
(extra)g(w)m(ork)f(to)h(b)s(e)f(done)g(during)e(uni\014cation)h(of)300
1028 y(functors)d(with)f(lo)m(w)h(arities.)61 b(These)37
b(w)m(eaknesses)h(mak)m(e)g(our)f(curren)m(t)g(implemen)m(tation)f(run)
g(a)i(few)300 1216 y(times)30 b(slo)m(w)m(er)g(than)h(a)f(Prolog)h(in)m
(terpreter)e(on)i(comparable)f(co)s(de.)441 1403 y Fi(Static)i
(analyses)i(and)e(tr)-5 b(ansforms.)43 b Fm(A)m(t)30
b(the)g(end)f(of)g(Section)h(3.2.2,)h(w)m(e)f(ga)m(v)m(e)i(an)d
(example)g(of)h(one)300 1591 y(t)m(yp)s(e)f(of)f(sp)s(ecialized)f
(seman)m(tic)h(analysis)f(that)i(LC++)e(can)i(p)s(erform)e(at)i
(compile-time.)39 b(It)28 b(w)m(ould)g(b)s(e)300 1778
y(in)m(teresting)f(to)i(in)m(v)m(estigate)h(if)d(w)m(e)h(can)h(use)e
(static)i(t)m(yp)s(e)g(information)d(to)j(enable)e(some)i(compile-time)
300 1966 y(optimizations,)g(suc)m(h)h(as)h(re-structuring)e(query)h
(trees,)h(but)f(w)m(e)h(ha)m(v)m(e)g(not)g(done)f(this.)441
2153 y Fi(Par)-5 b(ameter)25 b(mo)-5 b(des.)39 b Fm(Some)20
b(logic)g(programming)f(languages,)k(suc)m(h)d(as)g(Mercury[53)q(])h
(and)e(HAL[18)r(],)300 2340 y(enable)45 b(the)h(programmer)f(to)h
(annotate)h(functors)e(with)g(mo)s(de)g(and)g(determinism)e
(declarations.)300 2528 y(These)33 b(declarations)g(enable)g(more)h
(static)g(c)m(hec)m(king)h(and)e(can)h(help)e(pro)m(vide)h(b)s(etter)g
(run-time)g(p)s(er-)300 2715 y(formance.)43 b(It)31 b(w)m(ould)f(b)s(e)
g(in)m(teresting)g(to)i(extend)f(LC++'s)f(static)h(t)m(yp)s(e)h(system)
f(so)g(that)g(parameter)300 2903 y(mo)s(des)f(could)f(b)s(e)h
(expressed.)300 3174 y Fj(3.2)140 b(Bene)-7 b(ath)48
b(the)h(Surfac)-7 b(e)300 3420 y Fm(In)23 b(this)f(section)i(w)m(e)g
(describ)s(e)d(t)m(w)m(o)k(of)f(the)f(most)h(in)m(teresting)f(asp)s
(ects)h(of)f(the)h(LC++)e(implemen)m(tation.)300 3607
y(First,)j(w)m(e)g(discuss)e(ho)m(w)i(LC++)e(implemen)m(ts)g(its)h(con)
m(trol)i(\015o)m(w,)g(using)d(F)m(C++)h(lazy)h(lists)e(as)i(a)g
(natural)300 3795 y(w)m(a)m(y)33 b(to)f(return)f(query)g(results)g
(one-at-a-time)j(on)d(demand.)44 b(Second,)32 b(w)m(e)h(discuss)d(the)i
(use)f(of)h(C++)300 3982 y(\\expression)22 b(templates")i(to)g(p)s
(erform)e(compile-time)g(computation,)j(enabling)c(LC++)h(clien)m(ts)g
(to)i(use)300 4170 y(Prolog-lik)m(e)k(syn)m(tax)i(but)e(ha)m(v)m(e)i
(the)f(C++)e(compiler)h(parse,)h(t)m(yp)s(e-c)m(hec)m(k,)i(and)d(seman)
m(tically)h(analyze)300 4357 y(this)g(co)s(de.)300 4592
y Fl(3.2.1)105 b(Query)35 b(execution)h(and)e(C++)h(in)m(terfacing)300
4838 y Fm(LC++)c(represen)m(ts)g(query)g(results)g(as)h(an)f
Fk(Environment)e Fm(ob)5 b(ject,)33 b(whic)m(h)e(maps)g(eac)m(h)i
(logic)e(v)-5 b(ariable)300 5025 y(to)41 b(its)e(binding)e
(information.)69 b(Since)39 b(this)g(is)g(C++,)j(w)m(e)e(use)g
(e\013ects)h(to)g(obtain)f(a)g(more)g(e\016cien)m(t)300
5213 y(implemen)m(tation.)e(That)26 b(is,)g(w)m(e)h(use)f(destructiv)m
(e)g(up)s(date)f(to)i(mo)s(dify)d(the)j(en)m(vironmen)m(t:)38
b(uni\014cation)300 5400 y(causes)31 b(bindings)c(to)k(b)s(e)f(added;)g
(bac)m(ktrac)m(king)h(causes)g(bindings)c(to)k(b)s(e)f(remo)m(v)m(ed.)
2032 5700 y(119)p eop
%%Page: 120 129
120 128 bop 441 91 a Fm(One)35 b(common)h(w)m(a)m(y)h(to)f(implemen)m
(t)e(Prolog)i(queries)f(is)f(to)j(mimic)d(con)m(tin)m(uation)h(passing)
g(st)m(yle)300 279 y(\(CPS\).)e(A)g(con)m(tin)m(uation)g(is)g(a)g
(function)f(whic)m(h)g(em)m(b)s(o)s(dies)g(\\what)h(to)h(do)f(next")h
(\(after)g(the)f(curren)m(t)300 466 y(action)44 b(is)e(completed\).)80
b(Using)43 b(CPS)f(mak)m(es)i(it)f(easy)h(to)h(implemen)m(t)d(Prolog's)
h(un)m(usual)e(con)m(trol)300 654 y(\015o)m(w;)k(an)m(y)40
b(particular)e(term)h(can)h(either)g(con)m(tin)m(ue)f(forw)m(ard)h
(through)f(the)h(query)f(\(b)m(y)h(calling)e(the)300
841 y(next)d(con)m(tin)m(uation)f(when)g(this)f(p)s(ortion)g(of)i(the)g
(query)f(succeeds\))h(or)f(bac)m(ktrac)m(k)j(\(b)m(y)e(returning)d(to)
300 1028 y(its)42 b(caller)g(when)g(this)g(p)s(ortion)f(of)i(the)g
(query)f(fails\).)76 b(The)43 b(activ)-5 b(ation)43 b(stac)m(k)h(holds)
d(the)i(\\undo")300 1216 y(information)28 b(used)g(for)h(bac)m(ktrac)m
(king,)i(and)e(the)h(con)m(tin)m(uation)f(parameter)h(holds)e(the)h
(\\future")g(\(the)300 1403 y(rest)i(of)g(the)g(query)g(to)g(b)s(e)g
(ev)-5 b(aluated\).)42 b(Other)31 b(logic)g(programming)e(approac)m
(hes,)j(lik)m(e)e(MPC++[19)q(])300 1591 y(and)21 b(J/MP[10)r(],)j(use)d
(explicit)f(CPS)h(to)i(express)e(the)h(logical)f(con)m(trol)i(\015o)m
(w)e(in)g(an)h(imp)s(erativ)m(e)e(language.)441 1778
y(The)41 b(problem)e(with)h(this)g(approac)m(h)i(is)e(that)i(the)f
(action)h(describing)c(\\what)k(to)g(do)f(with)f(the)300
1966 y(query)e(results")g(m)m(ust)g(itself)f(b)s(e)h(passed)g(in)m(to)h
(the)g(query)f(as)g(the)h(\014nal)e(con)m(tin)m(uation.)65
b(In)38 b(sp)s(eci\014c)300 2153 y(cases,)c(this)e(is)f(not)i(a)g
(problem:)44 b(for)32 b(example,)h(if)f(all)f(y)m(ou)i(w)m(an)m(t)g(to)
h(do)e(is)g(prin)m(t)f(out)i(all)e(the)i(results,)300
2340 y(then)26 b(it)f(w)m(ould)g(b)s(e)h(easy)g(to)h(create)h(a)e(con)m
(tin)m(uation)g(function)f(whic)m(h)g(just)g(prin)m(ts)g(the)h(con)m
(ten)m(ts)i(of)e(the)300 2528 y Fk(Environment)p Fm(,)k(and)h(to)i
(pass)e(this)g(con)m(tin)m(uation)h(in)m(to)g Fk(query\(\))p
Fm(.)44 b(In)31 b(the)i(general)f(case,)h(ho)m(w)m(ev)m(er,)i(a)300
2715 y(clien)m(t)c(of)h Fk(query\(\))d Fm(ma)m(y)j(w)m(an)m(t)h(to)f
(use)f(the)h(results)e(in)g(some)i(arbitrary)e(w)m(a)m(y)j(using)d
(arbitrary)g(C++)300 2903 y(co)s(de,)e(and)e(there)h(is)f(no)h(general)
f(mec)m(hanism)g(for)h(creating)g(a)g(con)m(tin)m(uation)g(out)g(of)g
(\\the)g(rest)g(of)g(y)m(our)300 3090 y(C++)i(program".)441
3278 y(Put)d(another)h(w)m(a)m(y)-8 b(,)29 b(the)e(problem)e(is)h(the)h
(imp)s(edence)e(mismatc)m(h)h(b)s(et)m(w)m(een)h(normal)f(C++)f(con)m
(trol)300 3465 y(\015o)m(w)35 b(\(whic)m(h)f(uses)h(an)f(activiation)h
(stac)m(k\))i(and)d(LC++)g(con)m(trol)h(\015o)m(w)g(\(whic)m(h)f(is)h
(e\013ectiv)m(ely)g(CPS\).)300 3653 y(In)h(simple)e(cases)k(where)e(w)m
(e)h(are)g(prepared)f(to)h(pro)s(cess)f(all)g(of)g(the)h(results)e(at)j
(once,)h(w)m(e)e(can)g(treat)300 3840 y(the)31 b Fk(query\(\))d
Fm(function)i(as)g(a)h(\\stop)g(the)g(w)m(orld")f(pro)s(cess,)g(whic)m
(h)g(uses)g(CPS)f(to)j(run)d(the)i(query)f(and)300 4027
y(pro)s(cess)39 b(all)f(the)i(results)e(\()p Fk(query\(\))g
Fm(w)m(ould)g(not)i(return)e(un)m(til)g(all)g(of)h(the)h(results)e(are)
i(pro)s(cessed\).)300 4215 y(Ho)m(w)m(ev)m(er)j(in)d(the)i(general)f
(case,)k(a)d(clien)m(t)f(ma)m(y)h(not)f(b)s(e)g(prepared)f(to)i(pro)s
(cess)f(all)f(the)h(results)f(at)300 4402 y(once;)35
b(the)d(clien)m(t)g(needs)g Fk(query\(\))f Fm(to)i(return)e(the)i
(results)e(\(lazily\))h(in)f(a)i(data)g(structure)f(whic)m(h)g(can)300
4590 y(b)s(e)j(pro)s(cessed)g(later.)56 b(F)m(C++)35
b(lazy)h(lists)e(solv)m(e)i(the)g(problem;)g(represen)m(ting)f(the)h
(results)e(as)i(a)g(lazy)300 4777 y(list)d(e\013ectiv)m(ely)i(enables)f
(arbitrary)f(C++)h(co)s(de)g(to)h(call)f Fk(query\(\))f
Fm(and)g(then)h(con)m(tin)m(ue)h(on)f(its)g(w)m(a)m(y)-8
b(,)300 4965 y(co-routining)37 b(with)h(the)g(CPS)g(query)f
(functionalit)m(y)g(whenev)m(er)i(the)f(next)h(result)e(is)h(demanded)f
(b)m(y)300 5152 y(the)44 b(clien)m(t.)79 b(F)m(C++)43
b(pla)m(ys)g(a)h(role)f(with)f(dual)g(signi\014cance)g(here:)67
b(F)m(C++)43 b(lazy)g(lists)f(pro)m(vide)h(a)300 5339
y(smo)s(oth)c(w)m(a)m(y)g(to)h(create)g(the)f Fi(interfac)-5
b(e)46 b Fm(to)40 b(LC++)d(queries,)j(and)e(the)h(F)m(C++)g(library)d
(mak)m(es)k(the)2032 5700 y(120)p eop
%%Page: 121 130
121 129 bop 300 91 a Fi(implementation)40 b Fm(m)m(uc)m(h)30
b(easier.)441 279 y(W)-8 b(e)41 b(no)m(w)f(describ)s(e)f(the)h(actual)g
(implemen)m(tation.)68 b(A)m(t)41 b(the)f(lo)m(w)m(est)h(lev)m(el,)h
(the)e(main)f Fk(query\(\))300 466 y Fm(function)d(returns)h(a)h
Fk(std::pair)d Fm(\(standard)i(C++)g(2-tuple\))h(whose)f(\014rst)g
(elemen)m(t)i(is)d(a)i(reference)300 654 y(to)32 b(an)e
Fk(Environment)e Fm(ob)5 b(ject)32 b(and)e(whose)g(second)h(elemen)m(t)
g(is)f(a)h Fk(List<Empty>)p Fm(.)39 b Fk(Empty)29 b Fm(is)h(a)h
(\\noth-)300 841 y(ing")k(data)h(t)m(yp)s(e|a)g(struct)f(with)f(no)h
(mem)m(b)s(ers.)55 b Fk(List<Empty>)32 b Fm(signi\014es)i(that)h(the)h
(lazy)f(list)f(do)s(es)300 1028 y(not)e(con)m(tain)h(real)f(v)-5
b(alues|it)31 b(is)g(only)h(useful)e(b)s(ecause)i(tra)m(v)m(ersing)h
(it)f(pro)s(duces)f(side-e\013ects)i(on)f(the)300 1216
y Fk(Environment)p Fm(.)441 1403 y(The)24 b(purp)s(ose)e(of)i(the)g
Fk(List)f Fm(is)g(to)i(giv)m(e)g(clien)m(ts)e(con)m(trol)h(o)m(v)m(er)i
(query)d(ev)-5 b(aluation.)38 b(As)24 b(eac)m(h)h(elemen)m(t)300
1591 y(of)i(the)g Fk(List)f Fm(is)g(demanded,)h(the)g(LC++)f(query)h
(runs)e(to)j(pro)s(duce)e(the)h(next)g(result)f(b)m(y)h
(side-e\013ecting)300 1778 y(the)h Fk(Environment)c Fm(ob)5
b(ject.)41 b(When)27 b(the)g Fk(List)g Fm(\014nally)e(b)s(ecomes)j
Fk(NIL)e Fm(this)h(means)g(there)h(are)f(no)h(more)300
1966 y(query)i(results.)39 b(Th)m(us)30 b(a)g(clien)m(t)g(calls)g
Fk(query\(\))e Fm(lik)m(e)i(this:)443 2228 y Fk(typedef)46
b(QRT<Anc_TYPE,X_TYPE>::IE)41 b(IE;)443 2415 y
(std::pair<IE,List<Empty>)g(>)48 b(p)f(=)h(query\()e
(ancestor\(Anc,bart,X\))c(\);)443 2603 y(IE)47 b(env)g(=)h(p.first;)443
2790 y(List<Empty>)d(l)i(=)h(p.second;)443 2978 y(while\()e(!null\(l\))
g(\))h({)586 3165 y(std::cout)f(<<)h("X)g(is)g(")h(<<)f(*env->at\(X\))e
(<<)i(")g(and)g(Anc)g(is)g(")1064 3352 y(<<)g(*env->at\(Anc\))d(<<)j
(std::endl;)586 3540 y(l)h(=)f(tail\(l\);)443 3727 y(})300
3989 y Fm(The)27 b Fk(lquery\(\))f Fm(and)h Fk(iquery\(\))e
Fm(functions)i(\(presen)m(ted)h(bac)m(k)g(in)f(Section)g(3.1.5\))j(are)
e(built)e(atop)i(this)300 4177 y(in)m(terface.)441 4364
y(W)-8 b(e)29 b(no)m(w)f(illustrate)e(ho)m(w)i Fk(query\(\))e
Fm(is)h(implemen)m(ted)g(with)f(some)j(co)s(de.)40 b(A)28
b(query)f(is)g(represen)m(ted)300 4552 y(as)f(a)g Fk(Term)f
Fm(ob)5 b(ject.)40 b Fk(Term)p Fm(s)25 b(can)h(b)s(e)f(conjunction)g
(terms,)i(disjunction)c(terms,)k(uni\014cation)d(terms,)j(etc.)300
4739 y(All)i(of)i(them)f(supp)s(ort)e(a)j Fk(run)f Fm(metho)s(d)g(with)
f(the)h(follo)m(wing)f(in)m(terface:)443 5001 y Fk(struct)46
b(Term)h({)586 5189 y(virtual)f(List<Empty>)f(run\()i(IRef<Term>)e
(future)h(\))h(=)h(0;)443 5376 y(};)2032 5700 y Fm(121)p
eop
%%Page: 122 131
122 130 bop 300 91 a Fm(CPS)35 b(is)h(eviden)m(t;)k(in)35
b(order)h(to)h(run)e(a)i(p)s(ortion)e(of)i(a)g(query)-8
b(,)38 b(w)m(e)f(m)m(ust)f(pass)g(the)h(remainder)e(of)i(the)300
279 y(query)30 b(\(the)h(con)m(tin)m(uation\))g(as)f(the)h
Fk(future)e Fm(parameter.)41 b(\(Recall)30 b(that)h Fk(IRef<Term>)d
Fm(is)i(lik)m(e)f(a)i Fk(Term)300 466 y Fm(p)s(oin)m(ter;)j(F)m(C++)f
(pro)m(vides)f(the)h Fk(IRef)f Fm(class)h(as)g(a)g(reference-coun)m
(ted)i(smart)e(p)s(oin)m(ter.\))48 b(The)32 b Fk(run\(\))300
654 y Fm(metho)s(d)e(in)f Fk(Term)g Fm(returns)g(a)i
Fk(List<Empty>)p Fm(.)441 841 y(The)f(b)s(o)s(dy)f(of)h(the)h
Fk(query\(\))d Fm(function)h(ends)h(with)f(this)g(co)s(de:)443
1091 y Fk(//)47 b("t")g(is)g(a)h(reference)d(to)i(the)g(current)f(Term)
443 1278 y(//)h("env")g(is)g(a)g(reference)f(to)h(the)g(current)f
(Environment)443 1466 y(List<Empty>)f(l)i(=)h(thunk2\()e
(ptr_to_fun\(&Term::run\),)41 b(t,)47 b(end_of_query)e(\);)443
1653 y(return)h(std::make_pair\()e(env,)j(l)g(\);)300
1903 y Fm(The)30 b Fk(end_of_query)d Fm(ob)5 b(ject)31
b(is)f(just)f(an)i(instance)f(of)g(a)h Fk(Term)e Fm(whose)h
Fk(run\(\))f Fm(b)s(o)s(dy)g(sa)m(ys)443 2152 y Fk(return)46
b(cons\()h(Empty\(\),)e(NIL)i(\);)300 2402 y Fm(In)42
b(other)i(w)m(ords,)i(when)c(w)m(e)i(reac)m(h)g(the)f(end)f(of)i(the)f
(query)-8 b(,)47 b(w)m(e)c(should)e(indicate)i(one)g(result)f(b)m(y)300
2589 y(returning)28 b(a)j(one-elemen)m(t)h Fk(List)p
Fm(.)441 2777 y(F)-8 b(urther)31 b(examples)f(help)f(illuminate)f(what)
j(is)f(going)g(on.)42 b(Consider)29 b Fk(DisjunctImpl)p
Fm(s)f(\(the)j(\\or")300 2964 y(terms)41 b(created)h(with)e
Fk(||)p Fm(\).)73 b(Here)42 b(is)e(the)i(implemen)m(tation,)h(whic)m(h)
c(just)i(uses)g(the)g(F)m(C++)g Fk(cat\(\))300 3152 y
Fm(function)29 b(to)i(concatenate)i(t)m(w)m(o)f(lists:)443
3401 y Fk(struct)46 b(DisjunctImpl)f(:)i(public)f(Term)h({)586
3589 y(IRef<Term>)e(lhs,)i(rhs;)586 3776 y(List<Empty>)e(run\()i
(IRef<Term>)e(future)h(\))h({)730 3964 y(return)f(cat\()g
(lhs->run\(future\),)1302 4151 y(thunk2\()g(ptr_to_fun\(&Term::run\),)c
(rhs,)k(future)g(\))i(\);)586 4338 y(})443 4526 y(};)300
4775 y Fm(and)30 b(here)g(is)f(the)i(co)s(de)g(for)f(conjuncts)g(\()p
Fk(&&)p Fm(\):)443 5025 y Fk(struct)46 b(ConjunctImpl)f(:)i(public)f
(Term)h({)586 5213 y(IRef<Term>)e(lhs,)i(rhs;)586 5400
y(List<Empty>)e(run\()i(IRef<Term>)e(future)h(\))h({)2032
5700 y Fm(122)p eop
%%Page: 123 132
123 131 bop 730 91 a Fk(IRef<Term>)45 b(newfuture)g(=)i(new)g
(ConjunctImpl\()d(rhs,)j(future)f(\);)730 279 y(return)g(lhs->run\()f
(newfuture)g(\);)586 466 y(})443 654 y(};)300 902 y Fm(That)22
b(is,)h(giv)m(en)g Fk(term1&&term2)c Fm(and)i(a)i Fk(future)p
Fm(,)f(w)m(e)h(run)e Fk(term1)g Fm(with)g Fk(term2&&future)d
Fm(as)23 b(its)f(future.)441 1089 y(Finally)-8 b(,)32
b(consider)f(uni\014cation.)46 b(LC++)31 b(v)-5 b(alues)32
b(can)h(b)s(e)f(uni\014ed)e(using)i(the)g Fk(unify\(\))f
Fm(function,)300 1277 y(whic)m(h)e(returns)g(a)i(result)e(of)i(t)m(yp)s
(e)f Fk(UnRes)p Fm(.)40 b(This)28 b(is)i(a)g(t)m(w)m(o-elemen)m(t)j
(structure:)443 1525 y Fk(struct)46 b(UnRes)h({)286 b(//)47
b(UnRes)f(means)h("Unification)d(Result")586 1713 y(bool)j(ok;)586
1900 y(Fun0<void>)e(undo;)443 2087 y(};)300 2336 y Fm(If)25
b(a)g(uni\014cation)f(fails,)h(the)g Fk(ok)g Fm(\014eld)e(is)i(set)g
(to)h Fk(false)e Fm(and)g(the)i Fk(undo)e Fm(\014eld)g(is)g(un)m(used.)
38 b(If)24 b(a)i(uni\014cation)300 2523 y(succeeds,)k(the)f(en)m
(vironmen)m(t)g(is)f(side-e\013ected)i(with)e(the)h(new)g(binding,)d
(the)k Fk(ok)e Fm(\014eld)g(is)g(set)i(to)g Fk(true)p
Fm(,)300 2711 y(and)j(the)h Fk(undo)f Fm(\014eld)f(is)h(set)i(to)f(a)h
(th)m(unk)e(whic)m(h,)g(when)g(executed,)j(will)31 b(remo)m(v)m(e)36
b(the)e(newly-created)300 2898 y(binding)18 b(from)j(the)h(en)m
(vironmen)m(t.)37 b(This)20 b(is)g(imp)s(ortan)m(t)h(to)h(the)g
Fk(run\(\))e Fm(metho)s(d)h(in)f Fk(UnificationImpl)p
Fm(,)300 3085 y(whic)m(h)29 b(lo)s(oks)h(lik)m(e)g(this:)443
3334 y Fk(UnRes)47 b(ur)g(=)g(lhs->unify\(rhs\);)443
3521 y(if\()g(!ur.ok)f(\))586 3709 y(return)g(NIL;)443
3896 y(else)586 4083 y(return)g(cat\()h(future->run\()e(dummy_term)g
(\),)1159 4271 y(before\()h(ur.undo,)f(lambda\(\)[)h(NIL)h(])g(\))h
(\);)300 4519 y Fm(The)33 b(logic)h(of)g Fk(UnificationImpl::run\(\))28
b Fm(reads)34 b(as)g(follo)m(ws.)51 b(First,)34 b(try)g(to)h(unify)c
(the)k(left-hand-)300 4707 y(side)40 b(with)g(the)h(righ)m
(t-hand-side.)72 b(If)40 b(this)h(fails,)h(return)e(the)i(empt)m(y)f
(list)f(\(there)i(are)f(no)h(results\).)300 4894 y(Otherwise,)29
b(the)h(result)f(is)g(the)h(caten)m(tation)i(of)e(\(1\))h(the)g
(results)d(from)i(running)d(the)j(future)f(\(the)i(rest)300
5081 y(of)k(the)f(query\))826 5048 y Fg(1)900 5081 y
Fm(and)g(\(2\))h(an)f(empt)m(y)h(list)e(with)h(the)g(undo)f(th)m(unk)h
(prep)s(ended.)51 b(This)32 b(results)i(in)f(the)p 300
5223 1440 4 v 404 5277 a Ff(1)438 5309 y Fe(The)26 b
Fd(dummy)p 796 5309 24 4 v 29 w(term)g Fe(passed)g(to)f
Fd(future)p Fe('s)i Fd(run\(\))f Fe(metho)r(d)e(is)i(a)g(just)f(a)h
(meaningless)f(placeholder;)i Fd(query\(\))g Fe(ensures)300
5400 y(that)e(all)i Fd(Term)p Fe(s)g(end)e(with)h(an)g
Fd(end)p 1335 5400 V 28 w(of)p 1441 5400 V 29 w(query)h
Fe(ob)t(ject,)g(whic)n(h)e(nev)n(er)g(uses)h(its)h Fd(future)g
Fe(parameter.)2032 5700 y Fm(123)p eop
%%Page: 124 133
124 132 bop 300 91 a Fm(e\013ects)26 b(happ)s(ening)c(at)k(the)e(righ)m
(t)h(time.)38 b(Since)24 b(uni\014cation)e(succeeded,)27
b(w)m(e)e(ha)m(v)m(e)h(added)e(a)h(binding)c(to)300 279
y(the)31 b(en)m(vironmen)m(t.)42 b(W)-8 b(e)32 b(run)e(the)h(rest)g(of)
g(the)h(query)e(with)g(that)h(binding)d(in)m(tact.)43
b(After)31 b(all)f(of)h(those)300 466 y(results)j(ha)m(v)m(e)i(b)s(een)
e(pro)s(cessed)g(\(that)i(is,)g(when)e(the)h(clien)m(t)f(demands)g(the)
h(next)g(result)f Fi(after)45 b Fm(those)300 654 y(results)34
b(created)i(do)m(wnstream)f(from)g(this)f(p)s(ortion)g(of)h(the)g
(query\),)i(w)m(e)e(undo)f(the)i(binding)c(created)300
841 y(b)m(y)e(this)g(uni\014cation)e(\(to)j(e\013ect)h(bac)m(ktrac)m
(king\).)300 1081 y Fl(3.2.2)105 b(P)m(arsing)36 b(and)f(seman)m(tic)f
(analysis)300 1327 y Fm(In)25 b(this)f(subsection,)i(w)m(e)g(discuss)d
(the)j(C++-sp)s(eci\014c)e(implemen)m(tation)g(tec)m(hniques)h(that)h
(LC++)e(uses)300 1515 y(to)34 b(enable)f(clien)m(ts)f(to)i(express)f
(logic)g(programs)g(in)f(C++)g(using)g(the)h(simple)e(declarativ)m(e)j
(syn)m(tax)g(of)300 1702 y(the)g(library)e(in)m(terface.)53
b(Expression)33 b(templates[66)q(])h(are)h(used)f(to)h(parse)f(LC++)f
(rules)f(and)i(queries)300 1890 y(as)f(C++)f(expressions,)g(and)g
(template)i(meta-programming[14)q(])f(tec)m(hniques)f(are)h(used)f(to)i
(do)f(basic)300 2077 y(analysis)28 b(of)h(LC++)f(expressions)g(so)i
(that)f(LC++)g(co)s(de)g(w)m(orks)g(within)e(C++'s)h(static)i(t)m(yp)s
(e)g(system.)450 2317 y Fi(3.2.2.1)94 b(Parsing)33 b(and)h(R)-5
b(epr)g(esentation)300 2563 y Fm(The)42 b(syn)m(tax)h(of)f(LC++)g(is)f
(implemen)m(ted)g(b)m(y)h(o)m(v)m(erloading)h(the)g(C++)e(language)i
(op)s(erators)f(that)300 2751 y(app)s(ear)30 b(in)f(T)-8
b(able)30 b(11)i(\(Section)f(3.1.1\).)43 b(These)30 b(o)m(v)m(erloaded)
i(op)s(erators)f(return)e(v)-5 b(alues)30 b(of)h(t)m(yp)s(es)f(that)300
2938 y(re\015ect)35 b(the)f(syn)m(tax)h(tree)g(of)f(the)g(expression.)
51 b(F)-8 b(or)35 b(instance,)g(C++)e(op)s(erators)h(lik)m(e)g
Fk(-=)f Fm(and)h Fk(&&)g Fm(are)300 3126 y(o)m(v)m(erloaded)25
b(to)g(create)g(v)-5 b(alues)24 b(of)g(t)m(yp)s(e)g Fk(ImplicationRep)c
Fm(and)j Fk(ConjunctRep)p Fm(,)g(resp)s(ectiv)m(ely)-8
b(.)38 b(All)23 b(the)300 3313 y(di\013eren)m(t)k(\\)p
Fk(Rep)p Fm(")i(t)m(yp)s(es)f(serv)m(e)g(to)h(represen)m(t)f
(di\013eren)m(t)g(en)m(tities)f(of)i(the)f(syn)m(tax)g(tree.)41
b(Logic)28 b(v)-5 b(ariables)300 3500 y(corresp)s(ond)36
b(to)i(C++)e(v)-5 b(alues)36 b(of)i(t)m(yp)s(e)f Fk(LogicVariable<)p
Fi(T)12 b Fk(>)p Fm(,)35 b(where)i Fi(T)49 b Fm(is)36
b(the)h(t)m(yp)s(e)h(of)f(the)g(logic)300 3688 y(v)-5
b(ariable)29 b(\(e.g.,)j(in)m(teger,)f(string,)f(etc.\).)42
b(F)-8 b(or)32 b(example,)e(co)s(de)g(lik)m(e)443 3950
y Fk(X)48 b(==)f(3)95 b(&&)g(Y)47 b(==)h(4)300 4212 y
Fm(creates)32 b(a)f(v)-5 b(alue)29 b(whose)i(t)m(yp)s(e)f(is)g(a)g
(tree)h(with)e(a)i Fk(ConjunctRep)c Fm(at)32 b(the)e(ro)s(ot)h(and)f(t)
m(w)m(o)300 4400 y Fk(UnificationRep)p Fm(s)37 b(b)s(elo)m(w)j(it,)k
(eac)m(h)e(of)f(whic)m(h)f(has)h(a)g Fk(LogicVariable<int>)36
b Fm(c)m(hild)j(and)i(an)g Fk(int)300 4587 y Fm(c)m(hild.)450
4827 y Fi(3.2.2.2)94 b(T)-7 b(yp)i(e-Che)g(cking)33 b(and)h(Semantic)f
(Che)-5 b(cking)300 5073 y Fm(The)43 b(C++)g(t)m(yp)s(e)i(system)f(is)f
(T)-8 b(uring-complete,)47 b(and)c(C++)g(templates)h(can)g(b)s(e)g
(used)f(for)h(meta-)300 5261 y(programming)20 b(in)h(the)h(t)m(yp)s(e)g
(system.)38 b(\(The)21 b(C++)g(template)h(system)g(is)e(an)i(un)m(t)m
(yp)s(ed,)h(pure)e(functional)2032 5700 y(124)p eop
%%Page: 125 134
125 133 bop 300 91 a Fm(programming)21 b(language,)j(where)d(the)h
(atomic)h(v)-5 b(alues)21 b(are)h(C++)f(t)m(yp)s(es.\))39
b(Using)21 b(this)g(feature)h(of)g(C++)300 279 y(w)m(e)31
b(can)g(p)s(erform)d(arbitrary)i(\(but)g(v)m(ery)g(cum)m(b)s(ersome\))h
(computations)f(at)h(compile-time.)441 466 y(There)h(are)h(three)g
(main)f(high-lev)m(el)f(results)g(of)i(the)g(compile-time)e
(computation)i(p)s(erformed)e(b)m(y)300 654 y(LC++,)e(listed)g(here)i
(with)e(an)h(example)g(of)h(eac)m(h:)436 916 y Fh(\017)46
b Fm(T)m(yp)s(e)29 b(c)m(hec)m(king:)40 b(ensuring)27
b(that)j(in)d(the)i(expression)f Fk(X==1)p Fm(,)g Fk(X)h
Fm(is)e(a)j(logic)e(v)-5 b(ariable)28 b(of)h(t)m(yp)s(e)g
Fk(int)527 1103 y Fm(\(and)h(not,)h(sa)m(y)-8 b(,)32
b(one)f(of)f(t)m(yp)s(e)h Fk(string)p Fm(\).)436 1365
y Fh(\017)46 b Fm(General)38 b(seman)m(tic)f(c)m(hec)m(king:)56
b(ensuring)35 b(that)j(a)g(clien)m(t)f(cannot)h(ask)g(for)f
Fk(env->at\(X\))d Fm(from)527 1553 y(the)d(result)e(of)i(a)f(query)g
(not)h(in)m(v)m(olving)e Fk(X)p Fm(.)436 1815 y Fh(\017)46
b Fm(Sp)s(ecialized)27 b(seman)m(tic)i(c)m(hec)m(king:)41
b(ensure)28 b(that)h(the)h(named)e(logic)h(v)-5 b(ariables)27
b(app)s(earing)g(in)h(an)527 2002 y Fk(lassert\(\))g
Fm(statemen)m(t)k(alw)m(a)m(ys)f(app)s(ear)f(in)f(more)i(than)f(one)g
(lo)s(cation.)300 2265 y(W)-8 b(e)30 b(ac)m(hiev)m(e)g(these)f(results)
e(b)m(y)i(using)e(metaprogramming)h(on)h(\\t)m(yp)s(e)g(lists")f(in)f
(the)i Fk(Rep)f Fm(classes;)h(this)300 2452 y(is)g(explained)g(next.)
441 2639 y(Recall)h(that)h(clien)m(t)f(co)s(de)h(to)g(run)e(a)h(query)g
(lo)s(oks)g(lik)m(e)443 2902 y Fk(typedef)46 b
(QRT<Anc_TYPE,X_TYPE>::IE)41 b(IE;)443 3089 y(List<IE>)46
b(l)h(=)h(lquery\()d(ancestor\(Anc,bart,X\))e(\);)300
3351 y Fm(The)28 b Fk(QRT)g Fm(t)m(yp)s(e)g(computer)h(computes)f(the)h
(t)m(yp)s(e)g(of)g(an)f(en)m(vironmen)m(t)g(that)h(has)f(bindings)e
(for)i(eac)m(h)i(of)300 3539 y(the)h(logic)f(v)-5 b(ariables)1017
3506 y Fg(2)1085 3539 y Fm(named)30 b(b)m(y)g(its)g(template)h
(parameters.)441 3726 y(The)24 b(complication)g(is)g(that)h
Fk(lquery\(\))d Fm(m)m(ust)j(compute)g(a)g(v)-5 b(alue)24
b(whose)h(t)m(yp)s(e)g(is)e(compatible)h(with)300 3913
y(the)31 b(t)m(yp)s(e)g(computed)g(b)m(y)f Fk(QRT)p Fm(.)g(T)-8
b(o)32 b(do)e(this,)g(the)h(implemen)m(tation)f(of)h
Fk(lquery\(\))d Fm(m)m(ust)j(\(at)h(compile-)300 4101
y(time\))e(tra)m(v)m(erse)i(the)e(parse)g(tree)g(of)h(the)f(logic)g
(expression)e(passed)i(to)h(it)e(and)h(compute)g(the)g(set)h(of)f(all)
300 4288 y(logic)h(v)-5 b(ariables)29 b(that)i(app)s(ear)g(in)e(the)i
(term.)42 b(The)30 b(t)m(yp)s(e)h(represen)m(ting)f(this)g(set)i
(should)c(b)s(e)j(the)g(same)300 4476 y(as)36 b(that)g(computed)f(b)m
(y)g Fk(QRT)p Fm(.)g(Disco)m(v)m(ering)h(all)e(of)i(the)f(logic)g(v)-5
b(ariables)35 b(used)f(in)g(a)i(logic)f(expression)300
4663 y(is)f(done)h(using)e(the)i Fk(Rep)f Fm(classes.)54
b(F)-8 b(or)36 b(eac)m(h)g Fk(Rep)e Fm(t)m(yp)s(e)h(\(represen)m(ting)f
(an)h(LC++)f(program)g(term\),)300 4851 y(w)m(e)h(k)m(eep)g(a)h(list)d
(of)i(all)e(the)i(logic)g(v)-5 b(ariables)33 b(that)i(app)s(ear)f(in)f
(the)i(term.)54 b(This)33 b(compile-time)h(list)f(is)p
300 4987 1440 4 v 404 5041 a Ff(2)438 5073 y Fe(More)c(precisely)-6
b(,)30 b(for)e(eac)n(h)h(of)g(the)e(logic)j(v)l(ariable)f
Fc(typ)l(es)p Fe(.)43 b(The)29 b(library)f(in)n(terface)h(is)g(sp)r
(eci\014cally)g(designed)f(to)h(try)300 5164 y(to)d(ensure)g(that)f
(logic)i(v)l(ariables)g(are)f(declared)h(in)e(suc)n(h)h(a)g(w)n(a)n(y)f
(that)h(there)g(is)g(a)g(one-to-one)g(corresp)r(ondence)g(b)r(et)n(w)n
(een)300 5255 y(logic)38 b(v)l(ariables)g(and)e(logic)i(v)l(ariable)g
(t)n(yp)r(es.)67 b(Th)n(us)36 b(the)h(results)g(of)g(compile-time)f
(computations)g(\(t)n(yp)r(es\))g(can)h(b)r(e)300 5347
y(meaningfully)26 b(mapp)r(ed)e(bac)n(k)h(in)n(to)h(the)f(program)h
(\(v)l(ariables\).)2032 5700 y Fm(125)p eop
%%Page: 126 135
126 134 bop 300 91 a Fm(main)m(tained)25 b(as)h(a)g(\014eld)f(of)h(eac)
m(h)h Fk(Rep)e Fm(class)h(called)f(\\)p Fk(LVs)p Fm(".)40
b(Rather)26 b(than)g(discussing)d(here)j(the)g(details)300
279 y(of)32 b(manipulating)e(compile-time)h(lists)g(of)h(t)m(yp)s(es)g
(in)f(C++,)h(w)m(e)h(refer)f(the)g(in)m(terested)g(reader)g(to)h([14)q
(].)300 466 y(It)c(su\016ces)g(to)g(accept)i(as)e(giv)m(en)g(the)g
(list)f(primitiv)m(es:)37 b Fk(TL::NIL)p Fm(,)27 b Fk(TL::CONS)p
Fm(,)g(and)i Fk(TL::AppendList)p Fm(.)300 654 y(\(The)h(namespace)h
Fk(TL)f Fm(stands)g(for)g(\\t)m(yp)s(e)h(list".\))441
841 y(As)d(an)f(example,)h(consider)e(the)i(de\014nition)d(of)j(the)g
Fk(ConjunctRep)c Fm(class)j(\(instances)h(of)f(whic)m(h)g(are)300
1028 y(created)k(b)m(y)g(the)f(o)m(v)m(erloaded)i Fk(&&)d
Fm(op)s(erator\):)300 1291 y Fk(template)46 b(<class)g(LHS,)g(class)h
(RHS>)f(struct)g(ConjunctRep)f(:)j(public)e(HasLV)g({)443
1478 y(typedef)g(typename)g(TL::AppendList<typename)41
b(LV<LHS>::LVs,)1970 1665 y(typename)46 b(LV<RHS>::LVs>::Result)c(LVs;)
443 1853 y(LHS)47 b(lhs;)443 2040 y(RHS)g(rhs;)443 2228
y(ConjunctRep\()e(const)h(LHS&)h(l,)g(const)f(RHS&)h(r)g(\))h(:)f
(lhs\(l\),)f(rhs\(r\))g({})300 2415 y(};)300 2677 y Fm(Eac)m(h)35
b Fk(ConjunctRep)d Fm(is)i(just)g(an)g(expression)g(tree)h(no)s(de)f
(with)g(a)h(left-hand)e(side)h(and)g(a)h(righ)m(t-hand)300
2865 y(side;)29 b(a)g Fk(ConjunctRep)d Fm(computes)j(its)g(list)e(of)i
(logic)g(v)-5 b(ariables)28 b(as)h(the)g(result)f(of)h(app)s(ending)e
(the)i(logic)300 3052 y(v)-5 b(ariable)29 b(lists)g(of)i(its)e(t)m(w)m
(o)j(c)m(hildren.)441 3240 y(The)g(t)m(yp)s(e)g(expression)f
Fk(LV<Something>::LVs)d Fm(is)j(a)i(compile-time)e(function)g(used)h
(to)h(compute)300 3427 y(the)h(list)f(of)i(logic)e(v)-5
b(ariables)33 b(app)s(earing)g(in)g Fk(Something)p Fm(.)50
b(If)33 b Fk(Something)f Fm(is)h(a)i Fk(Rep)e Fm(\(whic)m(h)g(is)g
(deter-)300 3615 y(mined)21 b(b)m(y)i(seeing)g(if)f(it)g(is)g(a)i(subt)
m(yp)s(e)e(of)h Fk(HasLV)p Fm(\))f(then)g(the)i(expression)d(just)i
(means)g Fk(Something::LVs)p Fm(.)300 3802 y(Otherwise,)34
b(if)e Fk(Something)g Fm(is)g(a)i(non-)p Fk(Rep)p Fm(|lik)m(e)e
Fk(int)h Fm(\(whic)m(h)g(migh)m(t)h(app)s(ear)f(in)f(a)i
Fk(Rep)f Fm(tree)i(as)f(the)300 3989 y(righ)m(t)j(hand)g(side)f(of)i
(the)f Fk(UnificationRep)d Fm(created)39 b(b)m(y)e(the)h(LC++)e
(expression)g Fk(X==1)p Fm(\)|the)h(ex-)300 4177 y(pression)29
b Fk(LV<Something>::LVs)c Fm(reduces)30 b(to)i Fk(TL::NIL)c
Fm(whic)m(h)h(represen)m(ts)i(the)g(empt)m(y)f(list)g(of)g(logic)300
4364 y(v)-5 b(ariable)29 b(t)m(yp)s(es.)441 4552 y(The)i(t)m(yp)s(e)g
(lists)e(of)j(logic)e(v)-5 b(ariables)30 b(whic)m(h)g(comprise)g(an)h
Fk(Environment)d Fm(for)j(a)g(particular)f(query)300
4739 y(require)f(a)i(canonical)f(represen)m(tation.)41
b(T)-8 b(o)30 b(see)h(wh)m(y)-8 b(,)31 b(consider)e(again)i(this)e
(example)h(clien)m(t)g(co)s(de:)443 5001 y Fk(typedef)46
b(QRT<Anc_TYPE,X_TYPE>::IE)41 b(IE;)443 5189 y(List<IE>)46
b(l)h(=)h(lquery\()d(ancestor\(Anc,bart,X\))e(\);)2032
5700 y Fm(126)p eop
%%Page: 127 136
127 135 bop 300 91 a Fm(It)28 b(w)m(ould)e(b)s(e)h(a)h(shame)g(if)e
(the)i(clien)m(t)f(w)m(ere)h(required)e(to)j(list)d(the)i(logic)f(v)-5
b(ariable)27 b(t)m(yp)s(es)g(passed)g(to)i Fk(QRT)300
279 y Fm(in)g(the)i(same)f(order)g(that)h(they)g(app)s(ear)f(in)f(the)h
(query|w)m(e)g(w)m(ould)g(lik)m(e)443 541 y Fk(typedef)46
b(QRT<X_TYPE,Anc_TYPE>::IE)41 b(IE;)143 b(//)47 b(Note)f(reversal)g(of)
h(arguments)443 728 y(List<IE>)f(l)h(=)h(lquery\()d
(ancestor\(Anc,bart,X\))e(\);)300 990 y Fm(to)36 b(also)g(compile.)55
b(In)35 b(order)g(to)i(enable)e(this,)h Fk(QRT)f Fm(and)g
Fk(lquery\(\))e Fm(need)j(to)g(agree)h(on)e(a)h(canonical)300
1178 y(represen)m(tation)f(for)g(t)m(yp)s(e)h(lists.)53
b(It)36 b(w)m(ould)e(do)h(us)f(no)h(go)s(o)s(d)h(if)e
Fk(QRT)g Fm(created)i(an)f(en)m(vironmen)m(t)g(with)300
1365 y(C++)29 b(t)m(yp)s(e)443 1627 y Fk(Environment<TL::CONS<X_TY)o
(PE,T)o(L::)o(CONS)o(<Anc)o(_TY)o(PE,T)o(L::N)o(IL>)41
b(>)48 b(>)f(>)300 1890 y Fm(whereas)30 b Fk(lquery\(\))e
Fm(had)443 2152 y Fk(Environment<TL::CONS<Anc_)o(TYPE)o(,TL)o(::CO)o
(NS<X)o(_TY)o(PE,T)o(L::N)o(IL>)41 b(>)48 b(>)f(>)300
2414 y Fm(as)34 b(its)f(resulting)f(en)m(vironmen)m(t)h(t)m(yp)s(e.)51
b(These)33 b(t)m(w)m(o)i(t)m(yp)s(es)f(are)g(conceptually)f
(compatible,)3530 2381 y Fg(3)3604 2414 y Fm(but)g(the)300
2601 y(C++)26 b(t)m(yp)s(e)h(system)f(sees)i(them)e(as)h(t)m(w)m(o)h
(distinct)d(t)m(yp)s(es)i(whic)m(h)f(are)h(not)g(in)m(tercon)m(v)m
(ertible.)39 b(With)26 b(this)300 2789 y(issue)k(in)f(mind,)g(w)m(e)j
(can)f(no)m(w)g(appreciate)g(one)g(reason)2235 2756 y
Fg(4)2305 2789 y Fm(for)g(the)g(\\unique)e(in)m(teger")j(asso)s(ciated)
f(with)300 2976 y(eac)m(h)h(logic)e(v)-5 b(ariable.)39
b(Recall)30 b(that)h(logic)f(v)-5 b(ariables)29 b(are)i(declared)f
(using)f(co)s(de)h(lik)m(e)443 3238 y Fk(DECLARE\()46
b(X,)h(int,)g(10)g(\);)300 3501 y Fm(The)28 b(unique)f(in)m(teger)h
(constan)m(t)i(that)f(app)s(ears)f(in)f(the)i(t)m(yp)s(e)g(\()p
Fk(10)f Fm(in)f(the)i(example)f(ab)s(o)m(v)m(e\))i(pro)m(vides)e(a)300
3688 y(w)m(a)m(y)d(to)g Fi(or)-5 b(der)35 b Fm(the)24
b(logic)g(v)-5 b(ariable)23 b(t)m(yp)s(es.)38 b(This)22
b(enables)i(us)f(to)h(create)i(a)e(canonical)g(represen)m(tation)g(of)
300 3875 y(a)k(set)g(of)g(logic)g(v)-5 b(ariables)26
b(as)i(a)g(list:)38 b(the)28 b(canonical)f(list)g(alw)m(a)m(ys)h(has)f
(the)h(t)m(yp)s(es)g(app)s(ear)f(in)f(increasing)300
4063 y(order)k(of)g(their)g(unique)e(in)m(teger)j(constan)m(ts.)441
4250 y(The)f(canonicalization)g(pro)s(cess)g(also)g(\014lters)f(out)i
(duplicates,)e(so)h(that)h(queries)f(lik)m(e)443 4512
y Fk(lquery\()46 b(ancestor\(Anc,bart,X\))c(&&)47 b(X==1)g(\);)300
4775 y Fm(do)30 b(not)h(go)g(mistak)m(enly)f(creating)g(en)m(vironmen)m
(ts)g(with)f(t)m(yp)s(e)p 300 4911 1440 4 v 404 4965
a Ff(3)438 4997 y Fe(That)e(is,)g(though)f(w)n(e)h(are)f(using)h(t)n
(yp)r(e)e Fc(lists)i Fe(as)g(a)f(represen)n(tation)h(t)n(yp)r(e)e(in)i
(our)f(meta-program,)g(w)n(e)g(actually)h(only)300 5088
y(care)f(ab)r(out)g(t)n(yp)r(e)f Fc(sets)i Fe(in)f(this)f(case.)404
5148 y Ff(4)438 5179 y Fe(The)30 b(other)h(reason)f(for)h(the)f
(\\unique)f(in)n(tegers")i(is)g(to)f(create)h(the)e(one-to-one)h(t)n
(yp)r(e-to-v)l(ariable)g(mapping)f(men-)300 5271 y(tioned)d(in)f(a)h
(previous)g(fo)r(otnote.)2032 5700 y Fm(127)p eop
%%Page: 128 137
128 136 bop 443 91 a Fk(Environment<TL::CONS<Anc_)o(TYPE)o(,TL)o(::CO)o
(NS<X)o(_TY)o(PE,)41 b(//)48 b(X_TYPE)e(mistakenly)1016
279 y(TL::CONS<X_TYPE,TL::NIL>)41 b(>)48 b(>)f(>)238
b(//)48 b(duplicated)300 541 y Fm(The)38 b(end)g(result)f(of)i(the)f
(ab)s(o)m(v)m(e)i(computation)e(is)g(the)h(general)f(seman)m(tic)h(c)m
(hec)m(king)g(p)s(erformed)e(b)m(y)300 728 y(LC++.)69
b(The)40 b(t)m(yp)s(e)h(computers)f(inside)e Fk(QRT)p
Fm(,)i(the)g Fk(query\(\))e Fm(functions,)k(and)e(the)g
Fk(Rep)g Fm(classes)g(all)300 916 y(w)m(ork)f(to)h(mak)m(e)f(the)h(C++)
d(t)m(yp)s(e)i(system)h(ensure)e(that)h(LC++)f(co)s(de)h(is)f
(statically)g(c)m(hec)m(k)m(ed.)68 b(The)300 1103 y(t)m(yp)s(e)45
b(computers)h(ensure)e(that)i(the)f(en)m(vironmen)m(t)g(t)m(yp)s(es)h
(matc)m(h,)k(so)45 b(that)h(a)g(clien)m(t)f(cannot)h(ask)300
1291 y(for,)f(e.g.,)i Fk(env->at\(X\))39 b Fm(from)j(the)g(result)g(of)
g(a)h(query)e(not)i(in)m(v)m(olving)d Fk(X)p Fm(.)j(The)e(t)m(yp)s(e)i
(information)300 1478 y(main)m(tained)h(b)m(y)h(LC++)f(lets)h(the)h
(normal)e(C++)g(t)m(yp)s(e)i(rules)e(c)m(hec)m(k)j(more)e(basic)g
(requiremen)m(ts,)300 1665 y(suc)m(h)31 b(as)h(ensuring)e(that)i(in)f
(the)h(expression)e Fk(X==1)p Fm(,)h Fk(X)h Fm(is)e(a)i
Fk(LogicVariable<int>)27 b Fm(\(and)32 b(not,)g(sa)m(y)-8
b(,)34 b(a)300 1853 y Fk(LogicVariable<string>)p Fm(\).)441
2040 y(In)i(addition)f(to)i(basic)f(t)m(yp)s(ec)m(hec)m(king)i(that)f
Fk(QRT)f Fm(facilitates,)j(LC++)c(supp)s(orts)g(more)i(sophisti-)300
2228 y(cated)27 b(analyses)f(whic)m(h)f(are)h(sp)s(eci\014c)f(to)i(the)
f(domain)f(of)i(logic)e(programming.)39 b(One)25 b(example)h(of)g(suc)m
(h)300 2415 y(a)39 b(sp)s(ecialized)d(seman)m(tic)i(analysis)f(is)g
(detecting)i(one-time-use)f(v)-5 b(ariables)37 b(in)g(calls)g(to)i
Fk(lassert\(\))p Fm(.)300 2603 y(Supp)s(ose)33 b(that)i(when)e(the)i
(clien)m(t)f(wrote)h(the)g(co)s(de)f(for)h(the)f(family)f(relationship)
f(example,)k(instead)300 2790 y(of)31 b(writing)443 3052
y Fk(lassert\()46 b(child\(Kid,Par\))e(-=)j(parent\(Par,Kid\))c(\);)143
b(//)47 b(correct)300 3314 y Fm(she)30 b(acciden)m(tally)g(wrote)443
3577 y Fk(lassert\()46 b(child\(Kid,Par\))e(-=)j(parent\(Mom,Kid\))c
(\);)143 b(//)47 b(oops,)g(used)f(Mom)300 3839 y Fm(where)24
b Fk(Mom)f Fm(had)g(inadv)m(ertan)m(tly)h(b)s(een)f(used)g(in)g(place)h
(of)g Fk(Par)g Fm(on)f(the)i(righ)m(t-hand)e(side.)37
b(The)24 b(resulting)300 4026 y(co)s(de)31 b(is)e(legal)h(and)g(t)m(yp)
s(ec)m(hec)m(ks,)i(but)e(it)g(do)s(es)g(not)g(describ)s(e)f(the)i(in)m
(tended)e Fk(child\(\))f Fm(relation.)441 4214 y(This)e(t)m(yp)s(e)i
(of)g(error)f(is)g(automatically)g(statically)h(detectable)g(b)s
(ecause)g(it)f(violates)h(the)g(rule)e(that)300 4401
y(logic)d(v)-5 b(ariables)23 b(app)s(earing)f(in)g(an)i
Fk(lassert\(\))d Fm(statemen)m(t)k(should)d(alw)m(a)m(ys)i(app)s(ear)f
(in)f(more)i(than)g(one)300 4588 y(lo)s(cation.)42 b(A)31
b(logic)g(v)-5 b(ariable)29 b(that)j(is)e(used)g(only)g(once)i(can)f(b)
s(e)f(uni\014ed)f(with)g(an)m(ything;)i(if)f(the)h(clien)m(t)300
4776 y Fi(do)-5 b(es)39 b Fm(actually)29 b(in)m(tend)g(to)i(use)e(a)i
(\\don't)f(care")h(logic)f(v)-5 b(ariable,)29 b(they)h(should)e(do)i
(so)g(explicitly)d(using)300 4963 y(the)32 b(sp)s(ecial)f(v)-5
b(ariable)31 b(\\)p Fk(_)p Fm(".)46 b(W)-8 b(e)34 b(use)d
(meta-programming)i(to)f(write)g(an)g(algorithm)f(whic)m(h)g(analyzes)
300 5151 y Fk(lassert\(\))26 b Fm(calls)h(and)h(forces)h(the)f
(compiler)f(to)i(emit)f(a)h(w)m(arning)e(when)g(one-time-use)i(v)-5
b(ariables)27 b(are)300 5338 y(detected|the)k(same)f(general)f(tec)m
(hnique)g(describ)s(ed)e(in)i(Section)g(2.3.3.)42 b(\(Using)29
b(meta-programs)h(to)2032 5700 y(128)p eop
%%Page: 129 138
129 137 bop 300 91 a Fm(statically)36 b(analyze)i(co)s(de)f(and)f(emit)
h(domain-sp)s(eci\014c)e(compiler)g(diagnostics)h(is)g(a)i(tec)m
(hnique)e(that)300 279 y(has)25 b(b)s(een)f(used)h(b)m(y)g(other)g
(recen)m(t)h(C++)e(libraries[6)n(,)h(50)q(,)h(57)q(].\))39
b(Domain-sp)s(eci\014c)24 b(static)i(analyses)f(lik)m(e)300
466 y(the)i(one)h(describ)s(ed)d(here)i(sets)h(LC++)e(apart)h(from)g
(all)f(other)h(OO)g(libraries)d(for)j(logic)g(programming.)300
743 y Fj(3.3)140 b(Potential)49 b(applic)-7 b(ations)300
989 y Fm(LC++)39 b(can)i(b)s(e)f(used)g(for)g(the)h(same)f(application)
f(domains)h(for)g(whic)m(h)f(logic)h(programming)f(lan-)300
1176 y(guages)45 b(in)d(general)h(are)h(useful.)79 b(One)43
b(of)h(the)f(most)h(common)g(application)e(domains)g(is)h(that)h(of)300
1364 y(enco)s(ding)27 b(\\business)g(rules".)39 b(Business)27
b(rules)g(describ)s(e)g(the)h(logical)g(constrain)m(ts)h(that)g(m)m
(ust)f(hold)f(in)300 1551 y(a)36 b(particular)e(business)g(domain.)55
b(F)-8 b(or)37 b(example,)g(in)e(a)h(college)g(course)g(registration)f
(system,)j(there)300 1739 y(are)d(business)d(rules)h(describing)f
(course)j(prerequisites,)e(limitations)f(on)j(the)f(maxim)m(um)g(n)m
(um)m(b)s(er)f(of)300 1926 y(course)40 b(hours)e(p)s(er)h(term)h(that)g
(a)g(studen)m(t)f(ma)m(y)i(enroll)d(in,)j(and)e(so)h(on.)68
b(As)40 b(another)g(example,)i(a)300 2114 y(compan)m(y)32
b(that)h(builds)c(and)i(sells)f(p)s(ersonal)h(computers)g(ma)m(y)i(ha)m
(v)m(e)g(business)c(rules)i(whic)m(h)g(describ)s(e)300
2301 y(whic)m(h)g(pieces)i(of)f(hardw)m(are)h(and)f(soft)m(w)m(are)i
(are)f(compatible)f(with)f(one)i(another.)47 b(By)33
b(enco)s(ding)f(the)300 2488 y(business)38 b(logic)i(as)g(facts)h(and)f
(rules)e(asserted)j(in)m(to)f(the)g(LC++)f(database,)44
b(it)c(is)f(straigh)m(tforw)m(ard)300 2676 y(to)34 b(query)g(the)g
(system,)h(b)s(oth)e(to)h(ensure)f(that)h(business)e(constrain)m(ts)i
(ha)m(v)m(e)h(b)s(een)e(met)h(\(e.g.,)i(that)f(a)300
2863 y(studen)m(t)h(has)g(tak)m(en)i(the)e(necessary)h(prerequisites)d
(to)k(enroll)c(in)h(this)h(course\))g(and)g(to)h(disco)m(v)m(er)g(all)
300 3051 y(p)s(ossible)d(solutions)h(to)i(more)g(op)s(en-ended)f
(queries)f(\(e.g.,)40 b(giv)m(en)d(that)g(the)f(customer)h(w)m(an)m(ts)
h(a)e(PC)300 3238 y(with)31 b(this)g(op)s(erating)h(system)g(and)g
(this)f(particular)g(pro)s(cessor,)h(whic)m(h)f(video)h(cards)g(do)g(w)
m(e)h(ha)m(v)m(e)g(in)300 3426 y(sto)s(c)m(k)h(that)g(are)f(compatible)
g(with)f(this)g(system?\).)49 b(Man)m(y)34 b(di\013eren)m(t)f
(applications)e(dep)s(end)h(hea)m(vily)300 3613 y(on)26
b(suc)m(h)g(business)e(logic,)j(and)e(logic)h(programming)f(pro)m
(vides)g(a)i(direct)e(and)h(succinct)g(w)m(a)m(y)h(to)g(enco)s(de)300
3800 y(business)h(rules)h(so)i(they)f(are)h(amenable)f(to)h
(programmatic)f(queries.)441 3988 y(The)c(main)f(p)s(oten)m(tial)h(adv)
-5 b(an)m(tage)28 b(that)f(the)f(LC++)f(library)f(has)i(o)m(v)m(er)i
(other)e(logic)g(programming)300 4175 y(languages)f(is)f(that)i(it)f
(is)f(em)m(b)s(edded)g(in)f(C++.)38 b(As)25 b(a)h(result,)f(the)g
(capabilities)e(of)j(logic)e(languages)i(lik)m(e)300
4363 y(Prolog)h(are)g(a)m(v)-5 b(ailable)26 b(to)h(enco)s(de)g(the)g
(core)g(business)e(logic|all)g(within)f(a)j(larger)g(C++)e
(application,)300 4550 y(whic)m(h)35 b(ma)m(y)i(include)d(a)i
(graphical)g(user)f(in)m(terface,)k(net)m(w)m(orking,)f(in)m(terfacing)
d(with)g(other)i(C/C++)300 4738 y(libraries,)31 b(etc.)49
b(With)32 b(LC++,)h(an)f(application)g(program)g(can)h(exhibit)e(all)h
(the)h(usual)e(v)m(ersatilit)m(y)i(of)300 4925 y(a)e(C++)e
(application|plus)d(the)k(abilit)m(y)f(to)i(do)f(logic)g
(programming|without)e(ha)m(ving)h(to)i(sacri\014ce)300
5112 y(static)j(t)m(yp)s(e)g(safet)m(y)h(or)f(resort)g(to)h(foreign)e
(function)f(in)m(terfaces)j(in)d(order)h(to)i(gain)e(access)i(to)g(a)f
(logic)300 5300 y(programming)29 b(comp)s(onen)m(t.)2032
5700 y(129)p eop
%%Page: 130 139
130 138 bop 300 91 a Fj(3.4)140 b(Detaile)-7 b(d)48 b(c)-7
b(omp)g(arison)47 b(to)i(r)-7 b(elate)g(d)49 b(work)300
337 y Fm(Whereas)22 b(there)g(are)g(a)f(n)m(um)m(b)s(er)g(of)g(m)m
(ultiparadigm)e(languages)j(whic)m(h)e(ha)m(v)m(e)j(logic)e(comp)s
(onen)m(ts,)j(there)300 525 y(are)j(relativ)m(ely)e(few)h(pro)5
b(jects)27 b(whic)m(h)e(extend)h(existing)g(ob)5 b(ject-orien)m(ted)27
b(languages)g(with)e(supp)s(ort)f(for)300 712 y(logic)32
b(programming.)45 b(LC++)31 b(is)g(unique)f(compared)j(to)g(those)f(b)s
(ecause)g(LC++)f(cleanly)h(in)m(tegrates)300 900 y(the)i(con)m(trol)g
(\015o)m(w)g(of)g(the)g(imp)s(erativ)m(e)e(and)h(the)h(logic)g
(programming)e(language)i(constructs.)51 b(These)300
1087 y(alternativ)m(e)42 b(approac)m(hes)h(include)c(SOUL)i([11)q(])h
(\(whic)m(h)f(extends)h(Smalltalk\),)i(J/MP)e([10)q(])g(\(whic)m(h)300
1275 y(extends)36 b(Ja)m(v)-5 b(a\),)38 b(and)e(MPC++)e([19)r(])i
(\(whic)m(h)e(extends)i(C++\).)56 b(W)-8 b(e)37 b(\014rst)e(describ)s
(e)g(some)h(common)300 1462 y(asp)s(ects)k(of)h(those)g(three,)i(and)c
(then)h(discuss)e(details)i(of)g(eac)m(h)h(in)e(turn.)69
b(\(Note)42 b(that)f(Section)f(5.2)300 1649 y(describ)s(es)29
b(other)h(related)h(w)m(ork.\))441 1837 y(All)19 b(three)i(approac)m
(hes)g(\(SOUL,)f(J/MP)-8 b(,)21 b(MPC++\))f(su\013er)g(the)g(same)h(k)m
(ey)g(dra)m(wbac)m(k)g(with)e(resp)s(ect)300 2024 y(to)27
b(query)f(results:)37 b(they)27 b(do)f(not)g(lea)m(v)m(e)i(the)e(clien)
m(t)g(in)f(con)m(trol.)40 b(In)26 b(SOUL,)f(the)i(results)e(of)h(a)h
(query)f(are)300 2212 y(returned)h(as)i(a)f(Smalltalk)f
Fk(OrderedCollection)c Fm(ob)5 b(ject;)31 b(this)c(means)h(that)h
(examples)f(that)h(in)m(v)m(olv)m(e)300 2399 y(in\014nite)i(ob)5
b(jects,)34 b(lik)m(e)f Fk(nat)f Fm(from)g(Section)h(3.1.5,)i(cannot)f
(b)s(e)e(realized.)48 b(The)33 b(problem)e(is)h(similar)e(in)300
2587 y(J/MP)39 b(and)g(MPC++:)57 b(the)40 b(clien)m(t)f(passes)g(in)e
(a)j(blo)s(c)m(k)f(of)g(co)s(de)g(to)h(b)s(e)f(executed)h(for)f(eac)m
(h)h(result)300 2774 y(pro)s(duced)35 b(b)m(y)h(the)h(query)-8
b(,)39 b(and)d(the)g(query)g(executes)i(the)f(clien)m(t)f(co)s(de)h(on)
g(eac)m(h)g(and)f(ev)m(ery)i(result.)300 2961 y(In)33
b(con)m(trast,)j(LC++)d(giv)m(es)h(the)g(clien)m(t)f(con)m(trol)h(of)g
(the)g(query)f(b)m(y)h(returning)d(the)j(results)f(as)h(a)g(lazy)300
3149 y(list;)39 b(the)d(clien)m(t)g(can)h(demand)f(a)h(few)f(results,)h
(con)m(tin)m(ue)g(on)f(with)g(some)g(other)h(computation,)i(and)300
3336 y(demand)c(more)h(results)f(later)h(as)h(needed.)58
b(A)36 b(second)g(di\013erence)g(b)s(et)m(w)m(een)g(these)h(approac)m
(hes)g(and)300 3524 y(LC++)f(is)g(that)h(none)g(of)g(the)g(other)h
(three)f(approac)m(hes)g(can)h(duplicate)d(the)i(sp)s(ecialized)f
(seman)m(tic)300 3711 y(analyses)30 b(that)h(LC++)e(can)i(do)f(\(as)h
(describ)s(ed)d(in)h(Section)i(3.2.2\).)441 3899 y(SOUL,)36
b(the)h(Smalltalk)e(Op)s(en)g(Uni\014cation)h(Language)h(adds)f(logic)h
(programming)e(features)i(to)300 4086 y(Smalltalk.)46
b(The)33 b(original)e(SOUL)g(system)i(w)m(as)h(just)e(an)h(in)m
(terpreter;)g(clien)m(ts)f(w)m(ould)g(sp)s(ecify)g(asser-)300
4274 y(tions)e(and)f(queries)h(as)g(strings,)g(using)f(co)s(de)h(lik)m
(e)443 4536 y Fk(rep)47 b(:=)g(SOULRepository)d(new.)443
4723 y(rep)j(assert:)f('father\(homer,bart\).)c(father\(homer,lisa\).')
443 4911 y(results)k(:=)h(SOULEvaluator)d(eval:)j('if)g
(father\(?dad,?kid\)')42 b(in:)47 b(rep.)300 5173 y Fm(Ho)m(w)m(ev)m
(er)39 b(new)e(w)m(ork[11)q(])h(in)m(tegrates)g(SOUL)f(in)m(to)g
(Smalltalk)e(so)j(that)g(predicates)f(w)m(ork)g(lik)m(e)g(ordi-)300
5360 y(nary)f(message-sends)i(and)e(Smalltalk)f(ob)5
b(jects)38 b(can)f(participate)f(in)g(uni\014cation,)h(creating)g(a)h
(truer)2032 5700 y(130)p eop
%%Page: 131 140
131 139 bop 300 91 a Fm(em)m(b)s(edding.)53 b(Lik)m(e)35
b(LC++,)g(SOUL)f(preserv)m(es)h(the)g(declarativ)m(e)h(syn)m(tax)g
(that)f(languages)g(lik)m(e)g(Pro-)300 279 y(log)e(pro)m(vide.)47
b(SOUL)32 b(pro)m(vides)f(no)i(static)g(guaran)m(tees,)i(ho)m(w)m(ev)m
(er,)g(since)d(Smalltalk)f(is)h(dynamically)300 466 y(t)m(yp)s(ed)e
(and)g(the)g(SOUL)g(implemen)m(tation)f(w)m(orks)h(with)f(the)i
(re\015ection)f(facilities)f(of)h(Smalltalk.)441 654
y(The)35 b(J/MP)h(language[10)r(])g(is)f(a)h(Ja)m(v)-5
b(a)37 b(extension)e(supp)s(orting)e(m)m(ulti-paradigm)h(programming,)
300 841 y(including)17 b(logic)k(programming.)36 b(Logic)21
b(programming)f(in)f(J/MP)j(is)d(enabled)h(b)m(y)h(using)e(the)i
Fk(Relation)300 1028 y Fm(class)k(and)g(pass-b)m(y-name)h(parameters.)
39 b(The)25 b Fk(&&)f Fm(and)h Fk(||)g Fm(op)s(erators)g(are)h(o)m(v)m
(erloaded)h(\(as)e(in)g(LC++\),)300 1216 y(and)f(the)h(metho)s(d)f
Fk(unify\(\))f Fm(p)s(erforms)g(uni\014cation.)37 b(J/MP)25
b(has)f(a)h(w)m(eak)h(logic)e(programming)g(mo)s(del:)300
1403 y(uni\014cation)k(can)i(only)f(b)s(e)h(p)s(erformed)e(on)i(a)h(v)
-5 b(ariable)28 b(with)h(a)h(v)-5 b(alue|t)m(w)m(o)31
b(un)m(b)s(ound)d(logic)h(v)-5 b(ariables)300 1591 y(cannot)39
b(b)s(e)f(uni\014ed.)62 b(Also,)41 b(J/MP)d(de\014nes)g(relations)f
(using)g(notation)i(that)g(is)e(more)i(op)s(erational)300
1778 y(than)30 b(declarativ)m(e;)h(for)f(example)g(in)f(J/MP)i(one)g
(migh)m(t)f(write)443 2040 y Fk(public)46 b(static)g(Relation)g
(father\()g(+String)g(Dad,)g(+String)g(Kid)h(\))g({)586
2228 y(return)f(parent\(Dad,Kid\))e(&&)j(male\(Dad\);)443
2415 y(})300 2677 y Fm(to)31 b(de\014ne)f(the)g Fk(father\(\))e
Fm(relation)i(describ)s(ed)e(in)h(our)h(original)f(LC++)g(example.)441
2865 y(The)40 b(MPC++)f(library[19)o(])h(adds)f(supp)s(ort)f(for)i
(logic)f(programming)g(in)g(C++.)68 b(Lik)m(e)40 b(LC++,)300
3052 y(MPC++)30 b(is)g(build)e(atop)k(F)m(C++[48)q(,)g(49].)43
b(MPC++)31 b(has)g(b)s(een)f(used)g(in)g(a)h(graduate)h(programming)300
3240 y(languages)h(course)g(to)h(teac)m(h)g(studen)m(ts)f(ab)s(out)g
(di\013eren)m(t)f(programming)g(paradigms.)47 b(P)m(erhaps)32
b(as)i(a)300 3427 y(result)22 b(of)h(this)f(use-con)m(text,)27
b(MPC++)22 b(exp)s(oses)h(more)g(implemen)m(tation)f(details)g(to)i
(clien)m(ts,)g(resulting)300 3615 y(in)f(v)m(erb)s(ose)i(co)s(de.)39
b(When)24 b(declaring)g(an)g(MPC++)g(predicate,)i(all)d(kno)m(wn)i
(facts)g(ab)s(out)f(the)h(predicate)300 3802 y(need)e(to)h(b)s(e)f
(expressed)f(in)g(a)i(closed)f(de\014nition.)36 b(\(This)22
b(is)g(also)h(true)g(of)g(J/MP)-8 b(.\))25 b(F)-8 b(or)24
b(example,)h Fk(male\(\))300 3989 y Fm(w)m(ould)k(b)s(e)h(de\014ned)f
(lik)m(e)h(this)f(in)g(MPC++:)443 4252 y Fk(class)47
b(Male)f(:)i(public)e(Logic_Rule)f({)586 4439 y(Logic_Variable<string>)
d(person;)443 4626 y(public:)586 4814 y(Male\()47 b(const)f
(Logic_Variable<string>&)c(p)47 b(\))g(:)h(person\(p\))d({})586
5001 y(Logic_Relation)f(Rule_Definition\(\))f({)730 5189
y(return)j(\(person)f(|=)j("bart"\))d(||)j(\(person)d(|="homer"\))920
5376 y(||)j(\(person)d(|=)j("abraham"\);)2032 5700 y
Fm(131)p eop
%%Page: 132 141
132 140 bop 586 91 a Fk(})443 279 y(};)300 541 y Fm(Th)m(us,)32
b(MPC++)g(has)h(a)g(static)g(p)s(oin)m(t)f(of)h(de\014nition)d(of)j
(all)e(facts)j(p)s(ertaining)c(to)k(a)f(predicate,)g(while)300
728 y(LC++)j(allo)m(ws)g(more)g(facts)i(to)f(b)s(e)f(added)g(with)g
Fk(lassert\(\))e Fm(dynamically)-8 b(,)37 b(based)f(on)h(the)f(con)m
(trol)300 916 y(\015o)m(w)f(of)g(the)g(program.)54 b(A)35
b(static)g(approac)m(h)h(is)d(more)i(amenable)g(to)h(optimizations,)f
(but)f(MPC++)300 1103 y(do)s(es)c(not)h(attempt)g(to)g(optimize)f
(queries)f(in)g(an)m(y)i(w)m(a)m(y)g(\(nor)g(do)s(es)f(J/MP\).)441
1291 y(Finally)-8 b(,)39 b(w)m(e)f(note)h(that)g(the)f
Fk(Logic_Rule)d Fm(and)j Fk(Logic_Relation)c Fm(classes)k(of)g(MPC++)f
(serv)m(e)300 1478 y(a)c(similar)d(purp)s(ose)h(as)h(the)h
Fk(Relation)d Fm(class)j(in)e(J/MP)-8 b(,)33 b(and)f(op)s(erators)h
(are)g(o)m(v)m(erloaded)g(\(MPC++)300 1665 y(uses)g Fk(|=)f
Fm(for)h(uni\014cation\).)47 b(Indeed,)33 b(the)h(implemen)m(tation)d
(strategies)j(of)f(J/MP)h(and)e(MPC++)h(are)300 1853
y(quite)d(similar.)300 2130 y Fj(3.5)140 b(Discussion)300
2376 y Fm(LC++)33 b(demonstrates)h(that)h(logic)f(programming)f(can)h
(b)s(e)g(smo)s(othly)f(in)m(tegrated)i(in)m(to)f(C++.)50
b(The)300 2563 y(library)20 b(pro)m(vides)i(the)g(main)g(features)h(of)
f(the)h(logic)g(paradigm)e(and)h(preserv)m(es)h(the)f(declarativ)m(e)h
(syn)m(tax)300 2751 y(found)33 b(in)h(logic)g(languages.)55
b(The)34 b(C++)g(t)m(yp)s(e)h(system)f(pro)m(vides)g(\\atomic")i(logic)
f(data)g(t)m(yp)s(es,)i(and)300 2938 y(functors)28 b(can)h(b)s(e)g
(used)f(to)h(represen)m(t)g(uni\014able)d(comp)s(osite)j(structures,)g
(just)f(as)h(in)f(logic)g(languages.)300 3125 y(The)i(library)e(shares)
i(C++'s)f(static)i(t)m(yp)s(e)f(c)m(hec)m(king)h(and)f(supplies)d(its)j
(o)m(wn)g(domain-sp)s(eci\014c)e(c)m(hec)m(ks)300 3313
y(via)e(template)g(metaprogramming.)39 b(F)m(C++)25 b(lazy)h(lists)f
(are)h(used)f(to)i(mediate)f(the)g(con)m(trol)g(mismatc)m(h)300
3500 y(b)s(et)m(w)m(een)h(bac)m(ktrac)m(king)i(query)d(logic)g(and)h
(normal)e(C++)h(function)g(calls,)h(enabling)e(paradigms)g(with)300
3688 y(di\013eren)m(t)30 b(views)f(of)i(con)m(trol)g(\015o)m(w)f(to)h
(p)s(eacefully)e(co)s(exist.)441 3875 y(W)-8 b(e)23 b(utilized)d(a)i(n)
m(um)m(b)s(er)f(of)h(adv)-5 b(anced)22 b(features)g(of)h(C++)e(to)h
(implemen)m(t)f(b)s(oth)g(LC++)g(and)g(F)m(C++)300 4063
y(in)34 b(a)i(w)m(a)m(y)h(that)f(enables)f(a)h(smo)s(oth)g(in)m
(tegration)f(of)h(m)m(ultiple)d(paradigms.)56 b(Whereas)36
b(this)e(c)m(hapter)300 4250 y(and)d(the)i(previous)d(one)i(describ)s
(ed)e(a)j(n)m(um)m(b)s(er)e(of)h(the)g(nitt)m(y-gritt)m(y)h(details)e
(of)h(our)f(implemen)m(tation)300 4437 y(in)37 b(C++,)j(in)d(the)i
(next)f(c)m(hapter)h(w)m(e)g(shall)e(tak)m(e)j(a)f(step)f(bac)m(k,)j
(generalizing)d(our)g(main)f(strategies)300 4625 y(and)f(lo)s(oking)f
(at)i(whic)m(h)d(programming)h(language)i(features)g(are)f(most)h
(useful)d(for)i(m)m(ulti-paradigm)300 4812 y(extensibilit)m(y)-8
b(.)2032 5700 y(132)p eop
%%Page: 133 142
133 141 bop 1663 91 a Fn(CHAPTER)45 b(IV)1165 588 y(GENERALIZING)h(FR)l
(OM)e(C++)300 1025 y Fm(The)20 b(previous)g(t)m(w)m(o)i(c)m(hapters)g
(describ)s(e)d(ho)m(w)i(w)m(e)g(added)g(functional)e(and)h(logic)h
(programming)f(features)300 1212 y(to)37 b(C++.)56 b(Whereas)37
b(C++)e(is)g(a)h(ric)m(h)g(language)g(with)f(a)h(v)-5
b(ariet)m(y)37 b(of)f(extensibilit)m(y)e(mec)m(hanisms,)i(it)300
1400 y(is)i(nonetheless)g(not)i(an)f(ob)m(vious)f(ideal)g(candidate)g
(as)i(a)f(base)g(language)h(to)f(supp)s(ort)e(these)j(kinds)300
1587 y(of)f(extensions.)68 b(Nev)m(ertheless,)42 b(b)m(y)d(\\hijac)m
(king")g(a)h(n)m(um)m(b)s(er)e(of)i(the)f(language's)h(more)g(in)m
(teresting)300 1775 y(features,)34 b(w)m(e)g(ha)m(v)m(e)g(added)f
(functional)e(and)i(logic)g(programming)f(supp)s(ort)f(to)j(C++,)f
(with)f(v)-5 b(arying)300 1962 y(degrees)31 b(of)f(seamlessness.)441
2150 y(Whereas)45 b(our)f(w)m(ork)g(in)f(the)i(previous)e(c)m(hapters)h
(ma)m(y)h(b)s(e)f(describ)s(ed)e(as)j(\\no)m(v)m(el)g(devices)f(for)300
2337 y(implemen)m(ting)36 b(functional)h(and)h(logic)h(programming)e
(constructs)i(in)e(C++",)j(in)e(this)f(c)m(hapter)i(w)m(e)300
2524 y(try)h(to)h(remo)m(v)m(e)g(the)f(quali\014cation)f(\\in)g(C++".)
69 b(W)-8 b(e)42 b(discuss)c(our)h(k)m(ey)i(implemen)m(tation)e(ideas)g
(in)300 2712 y(more)31 b(general)g(terms,)f(making)h(explicit)e(what)h
(language)h(features)g(\(e.g.)43 b(\\o)m(v)m(erloading"\))33
b(eac)m(h)e(idea)300 2899 y(dep)s(ends)25 b(on.)39 b(W)-8
b(e)28 b(also)f(describ)s(e)f(some)h(strategies)h(in)d(terms)i(of)g
(language)g(features)g(that)h(C++)e(lac)m(ks)300 3087
y(\(suc)m(h)37 b(as)h(algebraic)f(datat)m(yp)s(es,)k(t)m(yp)s
(eclasses,)e(or)f Fk(call/cc)p Fm(\).)60 b(W)-8 b(e)39
b(conclude)e(with)f(a)h(summary)g(of)300 3274 y(the)26
b(main)f(limitations)f(that)j(C++)e(imp)s(oses)f(and)i(what)g(could)f
(b)s(e)g(done)h(di\013eren)m(tly)f(if)g(those)i(barriers)300
3462 y(w)m(ere)k(lifted.)300 3738 y Fj(4.1)140 b(R)-7
b(eusable)49 b(lessons)300 3984 y Fm(Here)c(w)m(e)g(describ)s(e)e(our)h
(k)m(ey)i(tec)m(hniques)e(from)g(a)h(more)g(language-indep)s(enden)m(t)
e(p)s(oin)m(t)h(of)g(view,)300 4172 y(pa)m(ying)21 b(sp)s(ecial)f
(atten)m(tion)i(to)g(particular)e(language)i(features)g(whic)m(h)e(mak)
m(e)i(some)g(of)g(these)f(tec)m(hniques)300 4359 y(feasible.)441
4547 y(Throughout)30 b(this)h(section)g(w)m(e)h(will)c(assume)j(a)h
(language)g(that)g(supp)s(orts)d(parametric)i(p)s(olymor-)300
4734 y(phism,)k(as)i(practically)e(ev)m(ery)h(one)h(of)f(our)f(devices)
h(dep)s(ends)e(on)i(this)f(language)h(feature.)58 b(W)-8
b(e)38 b(will)300 4922 y(also)25 b(assume)f(a)h(language)g(that)g(has)g
(some)g(kind)e(of)h(w)m(a)m(y)i(to)f(represen)m(t)g(\014rst-class)f
(functions.)37 b(Regard-)300 5109 y(less)g(of)g(whether)g
(\014rst-class)g(functions)f(are)i(built-in)c(to)k(a)g(particular)e
(programming)g(language)i(or)300 5296 y(merely)31 b(represen)m(table)h
(using)f(other)h(mec)m(hanisms)g(\(e.g.)47 b(as)33 b(classes)f(with)f
(o)m(v)m(erloaded)i Fk(operator\(\))2032 5700 y Fm(133)p
eop
%%Page: 134 143
134 142 bop 300 91 a Fm(in)34 b(C++\),)i(w)m(e)f(shall)e(refer)i(to)h
(them)f(as)g(\\functoids")g(throughout)f(this)g(section,)j(so)e(as)h
(to)f(simplify)300 279 y(the)c(exp)s(osition.)300 519
y Fl(4.1.1)105 b(T)m(yp)s(e)41 b(system)g(for)g(higher-order)h(p)s
(olymorphic)g(functions)f(\(using)h(C++-st)m(yle)619
632 y(t)m(yp)s(e)35 b(inference)g(and)g(template)e(computation\))300
878 y Fm(This)e(is)h(easily)g(the)h(most)h(C++-sp)s(eci\014c)d(asp)s
(ect)i(of)g(our)g(w)m(ork.)49 b(Giv)m(en)32 b(that)i(C++)e(supp)s(orts)
f(p)s(oly-)300 1065 y(morphism)g(only)h(indirectly)f(\(via)j
(templates,)g(whic)m(h)e(are)i(not)g(themselv)m(es)f(\014rst-class)g
(en)m(tities\),)h(w)m(e)300 1253 y(represen)m(t)g(p)s(olymorphic)e
(functions)g(via)i(functoids.)51 b(F)-8 b(unctoids)33
b(are)i(\014rst-class)e(ob)5 b(jects)35 b(with)e(tem-)300
1440 y(plates)24 b(as)g(mem)m(b)s(ers,)g(and)g(our)f
Fk(Sig)p Fm(s)g(are)h(t)m(yp)s(e-computers)g(whic)m(h)f(enable)g(the)h
(description)e(of)i(en)m(tities)300 1628 y(suc)m(h)36
b(as)g(\\the)h(result)e(t)m(yp)s(e)h(when)f(function)g
Fk(F)h Fm(is)f(called)h(with)e(an)i(argumen)m(t)h(of)f(t)m(yp)s(e)h
Fk(X)p Fm(".)f(The)g(de-)300 1815 y(scription)28 b(of)j(ho)m(w)f(this)g
(is)f(implemen)m(ted)g(has)h(already)g(b)s(een)g(describ)s(ed)e(in)h
(Section)h(2.2.2.)441 2003 y(W)-8 b(e)33 b(men)m(tion)f(this)f(asp)s
(ect)i(here)f(only)f(b)s(ecause)h(so)h(man)m(y)f(of)g(the)g(other)h
(tec)m(hniques)e(rely)h(on)g(the)300 2190 y(abilit)m(y)37
b(to)i(describ)s(e)d(the)i(t)m(yp)s(es)h(of)f(comp)s(osing)f(p)s
(olymorphic)f(functoids.)62 b(Whereas)39 b(C++)e(mak)m(es)300
2377 y(this)26 b(complicated)h(\(b)m(y)h(virtue)e(of)i(not)f(b)s(eing)f
(able)h(to)h(represen)m(t)g(p)s(olymorphic)c(functions)i(directly)g(in)
300 2565 y(the)i(t)m(yp)s(e)g(system,)h(and)e(the)h(lac)m(k)g(of)g(a)h
Fk(typeof)d Fm(op)s(erator)i(or)g(other)g(general)g(t)m(yp)s
(e-inferencing)e(mec)m(h-)300 2752 y(anism\),)36 b(most)g(other)g
(languages)g(with)e(parametric)h(p)s(olymorphism)d(either)j(supp)s(ort)
f(p)s(olymorphic)300 2940 y(t)m(yp)s(es)c(directly)f(in)h(the)g(t)m(yp)
s(e)h(system)f(or)h(pro)m(vide)e(t)m(yp)s(e)i(inference)e(\(or)i(b)s
(oth\).)300 3180 y Fl(4.1.2)105 b(Currying)300 3426 y
Fm(Currying)38 b(can)k(b)s(e)e(sim)m(ulated)g(in)f(an)m(y)j(language)f
(whic)m(h)f(allo)m(ws)g(the)h(function)f(call)g(syn)m(tax)i(to)g(b)s(e)
300 3613 y(o)m(v)m(erloaded.)d(\\Implicit)19 b(currying",)j(where)f(a)g
(functoid)f(can)i(b)s(e)e(called)h(with)f(few)m(er)h(than)g(the)h(exp)s
(ected)300 3801 y(n)m(um)m(b)s(er)h(of)h(argumen)m(ts,)j(only)c
(requires)g(that)i(function)e(call)g(b)s(e)h(o)m(v)m(erloaded)h(for)f
(di\013eren)m(t)g(n)m(um)m(b)s(ers)f(of)300 3988 y(argumen)m(ts.)39
b(\\Explicit)24 b(currying",)h(where)g(a)g(functoid)f(can)i(b)s(e)e
(called)g(with)g(\\dumm)m(y")h(placeholders)300 4176
y(in)g(the)i(place)f(of)h(real)f(argumen)m(ts)g(requires)f(ad-ho)s(c)i
(o)m(v)m(erloading)f(based)g(on)h(the)f(t)m(yp)s(es)h(of)f(argumen)m
(ts.)441 4363 y(Implicit)35 b(currying)h(is)h(b)s(est)g(expressed)g(as)
h(a)g(reusable)e(com)m(binator)i(whic)m(h)e(can)i(b)s(e)f(applied)e(to)
300 4551 y(a)h(normal)e(\(uncurry)m(able\))h(function.)55
b(Giv)m(en)35 b(an)g(N-argumen)m(t)i(function)d Fk(f)p
Fm(,)j(applying)c(the)j(implicit)300 4738 y(currying)23
b(com)m(binator)h(\()p Fk(icc)p Fm(\))g(to)h Fk(f)f Fm(results)g(in)f
(a)h(new)g(functoid)f(whic)m(h)g(con)m(tains)i(a)g(reference)f(to)i
Fk(f)e Fm(and)300 4925 y(has)33 b(N)g(di\013eren)m(t)f(function)g(call)
h(o)m(v)m(erloads,)h(eac)m(h)h(of)e(whic)m(h)f(dispatc)m(hes)g(to)i(a)f
(di\013eren)m(t,)h(sp)s(ecialized)300 5113 y(function)d(for)i(binding)c
(that)k(man)m(y)g(argumen)m(ts.)47 b(F)-8 b(or)34 b(example,)f(if)e
Fk(f)i Fm(tak)m(es)h Fk(3)e Fm(argumen)m(ts,)h(then)g(the)300
5300 y(implicitly)28 b(curry)m(able)j(v)m(ersion)h(of)g(f)g(\()p
Fk(icf)47 b(=)h(icc\(f\))p Fm(\))30 b(de\014nes)i(o)m(v)m(erloads)h
(for)e(m)m(ultiple)f(n)m(um)m(b)s(ers)h(of)2032 5700
y(134)p eop
%%Page: 135 144
135 143 bop 300 91 a Fm(argumen)m(ts,)31 b(so)g(that)443
333 y Fk(icf\()47 b(x)g(\))443 521 y(icf\()g(x,)g(y)g(\))443
708 y(icf\()g(x,)g(y,)g(z)h(\))300 950 y Fm(are)31 b(all)e(legal)h
(calls,)g(resulting)e(in)443 1192 y Fk(bind1of3\()45
b(f,)j(x)f(\))443 1379 y(bind1and2of3\()d(f,)k(x,)f(y)g(\))443
1567 y(f\()g(x,)h(y,)f(z)g(\))300 1809 y Fm(resp)s(ectiv)m(ely)-8
b(.)43 b(The)30 b(v)-5 b(arious)31 b Fk(bindMofN)d Fm(functions)i(m)m
(ust)h(b)s(e)g(de\014ned)e(\\b)m(y)j(hand",)f(but)f(their)h(imple-)300
1996 y(men)m(tations)36 b(are)f(straighforw)m(ard.)55
b(\(Indeed,)36 b(in)e(a)h(language)h(with)e Fk(lambda)p
Fm(,)h(the)g(implemen)m(tations)300 2183 y(are)c(trivial.\))441
2371 y(Explicit)d(currying)g(is)i(also)g(b)s(est)f(expressed)h(as)g(a)h
(reusable)e(com)m(binator.)40 b(F)-8 b(or)31 b(example,)f(giv)m(en)h(a)
300 2558 y(t)m(w)m(o-argumen)m(t)g(function)c Fk(f)p
Fm(,)j(the)f(result)e(of)i(applying)e(the)i(explicit)e(currying)g(com)m
(binator)i(\()p Fk(ecc)p Fm(\))g(is)f(a)300 2746 y(functoid)h
Fk(ecf)h Fm(whic)m(h)f(has)h(these)h(o)m(v)m(erloads:)443
2988 y Fk(ecf\()47 b(PlaceholderType)c(x,)48 b(Any2)e(y)i(\))143
b(//)47 b(ecf\(_,y\))443 3175 y(ecf\()g(Any1)f(x,)i(PlaceholderType)43
b(y)48 b(\))143 b(//)47 b(ecf\(x,_\))443 3362 y(ecf\()g(Any1)f(x,)i
(Any2)e(y)i(\))668 b(//)47 b(ecf\(x,y\))e(\(normal)h(call\))300
3604 y Fm(The)33 b(t)m(yp)s(es)g Fk(Any1)f Fm(and)g Fk(Any2)g
Fm(represen)m(t)h(the)h(t)m(yp)s(es)f(of)g(the)g(actual)h(argumen)m(ts)
f(to)h Fk(f)f Fm(\(whic)m(h)f(can)i(b)s(e)300 3792 y(generalized)23
b(in)m(to)g(univ)m(ersal)e(t)m(yp)s(es)i(for)f(simplicit)m(y\),)h
(whereas)g Fk(PlaceholderType)18 b Fm(is)k(a)i(distinguished)300
3979 y(t)m(yp)s(e)32 b(whic)m(h)f(just)g(has)h(one)g(instance)g(named)f
(\\)p Fk(_)p Fm(".)46 b(Just)32 b(as)g(with)e(implicit)f(currying,)i
(eac)m(h)i(of)f(these)300 4167 y(o)m(v)m(erloads)f(dispatc)m(hes)e(to)i
(the)f(appropriate)f(implemen)m(tation;)g(in)g(the)h(cases)h(ab)s(o)m
(v)m(e,)h(they)e(w)m(ould)f(b)s(e)443 4408 y Fk(bind2of2\()45
b(f,)j(y)f(\))443 4596 y(bind1of2\()e(f,)j(x)f(\))443
4783 y(f\()g(x,)h(y)f(\))300 5025 y Fm(resp)s(ectiv)m(ely)-8
b(.)441 5213 y(In)22 b(a)i(language)f(lik)m(e)f(C++,)i(where)e
(return-t)m(yp)s(e-deduction)g(for)g(user-de\014ned)f(p)s(olymorphic)g
(func-)300 5400 y(toids)34 b(m)m(ust)h(b)s(e)f(sp)s(eci\014ed)f(\\b)m
(y)i(hand",)h(w)m(e)f(m)m(ust)g(also)g(\\o)m(v)m(erload")h(the)f
(return)f(t)m(yp)s(e)h(computation)2032 5700 y(135)p
eop
%%Page: 136 145
136 144 bop 300 91 a Fm(mec)m(hanism.)43 b(In)31 b(F)m(C++,)h(b)s(oth)f
(\\implicit)e(currying")h(and)h(\\explicit)f(currying")g(are)i
(de\014ned)f(in)f(the)300 279 y(same)h(com)m(binator)f(class)g(\()p
Fk(FullN)p Fm(\).)g(The)g Fk(Sig)g Fm(template)g(in)g(this)f(class)h
(has)g(default)g(parameters:)443 536 y Fk(template)46
b(<class)g(F>)h(struct)f(Full3)g({)i(...)586 724 y(template)e(<class)g
(X,)1064 911 y(class)g(Y)h(=)h(PlaceholderType,)1064
1098 y(class)e(Z)h(=)h(PlaceholderType>)586 1286 y(struct)e(Sig)h(...)
300 1543 y Fm(so)39 b(that)g(w)m(e)g(can)f(use)g(it)g(in)f(t)m(yp)s(e)i
(expressions)e(with)g(di\013ering)f(arities)i(\(e.g.)66
b Fk(Sig<int,int,int>)p Fm(,)300 1731 y Fk(Sig<int,int>)p
Fm(,)25 b Fk(Sig<int>)p Fm(\).)37 b(The)27 b Fk(Sig)f
Fm(is)g(partially)g(sp)s(ecialized)f(for)i(all)f(di\013eren)m(t)g(com)m
(binations)h(of)300 1918 y Fk(PlaceholderType)f Fm(argumen)m(ts,)31
b(so)g(for)f(example)443 2176 y Fk(template)46 b(<class)g(X,)h(class)f
(Z>)443 2363 y(struct)g(Sig<X,PlaceholderType,Z>)41 b(...)300
2620 y Fm(has)30 b(a)h Fk(result_type)c Fm(that)k(is)f(represen)m
(tativ)m(e)h(of)f(the)h(call)443 2878 y Fk(f\(x,_,z\))300
3135 y Fm(|that)g(is,)f(the)g(t)m(yp)s(e)h(of)f(the)h(expression)443
3393 y Fk(bind1and3of3\()44 b(f,)k(x,)f(z)g(\))300 3650
y Fm(Note)31 b(that)g(partial)d(sp)s(ecialization)h(of)h(a)g(class)g
(template)g(in)f(C++)f(is)h(directly)g(analogous)h(to)h(ad-ho)s(c)300
3838 y(o)m(v)m(erloading)g(of)f(a)h(function)e(based)h(on)g(argumen)m
(t)h(t)m(yp)s(es.)300 4077 y Fl(4.1.3)105 b(In\014x)35
b(function)h(syn)m(tax)300 4323 y Fm(In\014x)d(function)f(syn)m(tax)j
(can)f(b)s(e)f(sim)m(ulated)f(in)h(an)m(y)h(language)g(whic)m(h)f(has)h
(an)f(ad-ho)s(c)h(o)m(v)m(erloadable)300 4510 y(in\014x)41
b(binary)g(op)s(erator.)79 b(In\014x)42 b(can)h(also)g(b)s(e)f(sim)m
(ulated)g(with)g Fi(two)50 b Fm(o)m(v)m(erloaded)43 b(in\014x)f(op)s
(erators,)300 4698 y(without)29 b(ha)m(ving)h(to)h(resort)g(to)g(ad-ho)
s(c-ery)-8 b(.)441 4885 y(Recall)30 b(that)h(in)e(F)m(C++,)i(the)f
(expression)443 5143 y Fk(x)48 b(^f^)f(y)300 5400 y Fm(means)30
b(the)h(same)g(as)2032 5700 y(136)p eop
%%Page: 137 146
137 145 bop 443 91 a Fk(f\(x,y\))300 341 y Fm(when)32
b Fk(f)h Fm(is)f(a)i(full)d(functoid.)48 b(The)33 b Fk(^)g
Fm(op)s(erator)g(has)g(b)s(een)g(o)m(v)m(erloaded)h(in)e(t)m(w)m(o)j
(di\013eren)m(t)d(w)m(a)m(ys.)50 b(The)300 528 y(expression)443
778 y Fk(x)e(^f^)f(y)300 1028 y Fm(actually)30 b(parses)g(as)443
1277 y Fk(\(x)47 b(^)h(f\))f(^)g(y)300 1527 y Fm(in)c(C++.)80
b(The)44 b(\014rst)f Fk(operator^)e Fm(o)m(v)m(erload)k(accepts)g(an)m
(y)g(t)m(yp)s(e)f(as)g(a)g(left-hand)f(argumen)m(t)i(and)300
1714 y(a)39 b(functoid)f(as)h(a)g(righ)m(t-hand)f(argumen)m(t,)k(and)c
(returns)g(a)h(new)g(ob)5 b(ject)40 b(of)f(some)g(temp)s(orary)g(t)m
(yp)s(e)300 1902 y Fk(Tmp)31 b Fm(whic)m(h)g(stores)h(these)g(t)m(w)m
(o)i(ob)5 b(jects)32 b(in)f(a)h(temp)s(orary)g(data)g(structure.)45
b(The)31 b(second)h Fk(operator^)300 2089 y Fm(o)m(v)m(erload)39
b(accepts)g(a)f Fk(Tmp)g Fm(as)g(a)g(left-hand)f(argumen)m(t)h(and)g
(an)m(ything)f(as)h(a)g(righ)m(t-hand)f(argumen)m(t,)300
2277 y(fetc)m(hes)24 b(the)f(functoid)e(and)h(\014rst)g(argumen)m(t)h
(stored)f(inside)f(the)i Fk(Tmp)e Fm(ob)5 b(ject,)26
b(and)c(applies)e(the)j(functoid)300 2464 y(to)e(b)s(oth)f(of)h(its)g
(argumen)m(ts.)37 b(\(Note)23 b(that)e(in)f(C++,)h(b)m(y)g(de\014ning)e
(the)i Fk(operator^)d Fm(o)m(v)m(erloads)k(as)f Fk(inline)300
2652 y Fm(functions)h(and)g(ha)m(ving)g(the)i Fk(Tmp)e
Fm(t)m(yp)s(e)h(store)h(references)f(rather)g(than)f(copies,)j(this)d
(syn)m(tax)h(sugar)g(do)s(es)300 2839 y(not)31 b(imply)d(an)m(y)i
(extra)h(cost)h(at)f(run)m(time.\))441 3026 y(The)36
b(reader)g(ma)m(y)g(ha)m(v)m(e)i(noticed)d(a)i(p)s(oten)m(tial)e(am)m
(biguit)m(y)h(b)s(et)m(w)m(een)g(the)h(t)m(w)m(o)g(o)m(v)m(erloads)g
(in)e(the)300 3214 y(previous)26 b(paragraph.)40 b(What)28
b(if)f(the)h(righ)m(t-hand)f(argumen)m(t)h(is)f(a)i(functoid?)38
b(F)-8 b(or)29 b(example,)f(consider)300 3401 y(this)h(example:)443
3651 y Fk(negate)46 b(^compose^)g(inc)190 b(//)47 b(f\(x\))f(=)i
(-\(x+1\))300 3901 y Fm(The)37 b(expression)f Fk(negate^compose)d
Fm(matc)m(hes)39 b(the)e(\014rst)g(o)m(v)m(erload,)j(resulting)c(in)g
(some)h(temp)s(orary)300 4088 y(ob)5 b(ject.)49 b(But)33
b(then)f Fk(tmp^inc)f Fm(matc)m(hes)j(b)s(oth)e(o)m(v)m(erloads:)46
b(the)33 b(righ)m(t-hand)e(argumen)m(t)i(is)f(a)h(functoid)300
4275 y(\(\014rst)c(o)m(v)m(erload\),)i(and)d(the)h(left-hand)f(argumen)
m(t)i(is)e(a)h Fk(Tmp)f Fm(ob)5 b(ject)30 b(\(second)g(o)m(v)m
(erload\).)41 b(Indeed,)29 b(this)300 4463 y(am)m(biguit)m(y)h(m)m(ust)
g(b)s(e)g(dealt)g(with;)g(in)f(our)h(original)e(implemen)m(tation,)i
(this)f(expression)g(w)m(ould)g(cause)300 4650 y(a)34
b(compile-time)e(am)m(biguit)m(y)g(error.)49 b(The)32
b(desired)g(b)s(eha)m(vior)g(is)g(to)i(ha)m(v)m(e)h(the)e(second)g(o)m
(v)m(erload)h(tak)m(e)300 4838 y(precedence;)44 b(if)39
b(the)g(left-hand)f(argumen)m(t)i(is)e(a)i Fk(Tmp)e Fm(ob)5
b(ject,)43 b(then)c(w)m(e)h(should)d(prefer)h(the)i(second)300
5025 y(o)m(v)m(erload,)28 b(ev)m(en)e(when)f(the)h(righ)m(t-hand)f
(argumen)m(t)h(is)f(a)h(functoid.)38 b(In)25 b(C++)g(the)h(am)m(biguit)
m(y)f(b)s(et)m(w)m(een)300 5213 y(the)i(t)m(w)m(o)i(o)m(v)m(erloads)f
(can)g(b)s(e)f(brok)m(en)g(in)f(a)h(n)m(um)m(b)s(er)f(of)i(w)m(a)m(ys;)
h(w)m(e)f(use)f Fk(boost::enable_if)c Fm(to)28 b(disable)300
5400 y(the)j(\014rst)e(o)m(v)m(erload)j(if)d(the)h(left-hand)g(argumen)
m(t)h(is)e(a)i Fk(Tmp)e Fm(ob)5 b(ject.)2032 5700 y(137)p
eop
%%Page: 138 147
138 146 bop 441 91 a Fm(It)27 b(is)e(w)m(orth)h(noting)g(that,)i(if)d
Fi(two)33 b Fm(suitable)25 b(o)m(v)m(erloadable)i(in\014x)d(op)s
(erators)j(are)g(a)m(v)-5 b(ailable,)26 b(the)h(ad-)300
279 y(ho)s(c-ed-ness)j(and)g(p)s(oten)m(tial)g(am)m(biguit)m(y)f(can)i
(b)s(e)e(a)m(v)m(oided)i(en)m(tirely)-8 b(.)40 b(F)-8
b(or)31 b(example,)g(w)m(e)f(can)h(imagine)300 466 y(using)e(t)m(w)m(o)
j(di\013eren)m(t)d(single)g(quotes)i(or)g(t)m(w)m(o)g(di\013eren)m(t)f
(slashes)g(as)g(the)h(in\014x)d(op)s(erators:)443 728
y Fk(x)48 b(`f')f(y)333 b(or)286 b(x)48 b(\\f/)f(y)300
990 y Fm(This)20 b(also)i(yields)e(the)i(desired)e(facade)j(of)f
(in\014x)e(functions)g(without)h(an)m(y)h(app)s(eal)f(to)h(exotic)h(o)m
(v)m(erloading)300 1178 y(mec)m(hanisms;)33 b(to)f(enable)g(the)g
Fk(x)48 b(\\f/)f(y)32 b Fm(syn)m(tax,)h(w)m(e)g(can)f(just)g(de\014ne)f
(the)i Fk(/)e Fm(and)h Fk(\\)g Fm(op)s(erators)g(with)300
1365 y(the)27 b(appropriate)f(signatures.)38 b(This)25
b(is)h(summarized)f(here)i(using)e(Hask)m(ell)i(\(since)f(Hask)m(ell's)
h(notation)300 1553 y(describ)s(es)i(things)g(most)i(succinctly\):)443
1815 y Fk(--)47 b(using)g(Haskell)f(notation)443 2002
y(data)h(Tmp)g(x)g(f)h(=)f(Tmp)g(x)g(f)443 2377 y(\(\\\))g(::)g(x)h(->)
f(\(x->y->r\))e(->)i(Tmp)g(x)h(\(x->y->r\))443 2565 y(x)g(\\)f(f)h(=)f
(Tmp)g(x)g(f)443 2940 y(\(/\))g(::)g(Tmp)g(x)h(\(x->y->r\))d(->)i(y)h
(->)f(r)443 3127 y(\(Tmp)g(x)g(f\))g(/)h(y)f(=)h(f)f(x)h(y)441
3389 y Fm(Finally)-8 b(,)22 b(also)e(note)i(that)f(\(despite)g(the)g
(title)f(of)h(this)f(subsection\))h(the)g(implemen)m(tations)e(describ)
s(ed)300 3577 y(in)k(this)g(section)i(yield)e(an)h(in\014x)e
Fi(expr)-5 b(ession)33 b Fm(syn)m(tax.)40 b(In)23 b(F)m(C++,)j(in)d
(addition)f(to)k(b)s(eing)c(able)i(to)h(write:)443 3839
y Fk(x)48 b(^f^)f(y)300 4101 y Fm(one)31 b(ma)m(y)g(also)f(write,)g
(for)g(example:)443 4363 y Fk(x)48 b(^g\(z\)^)e(y)300
4625 y Fm(where)31 b Fk(g\(z\))f Fm(is)g(an)i(expression)e(that)i
(reduces)f(to)h(a)g(t)m(w)m(o-argumen)m(t)h(function.)42
b(The)31 b(en)m(tit)m(y)h(b)s(et)m(w)m(een)300 4813 y(the)h
Fk(operator^)p Fm(s)c(need)j(not)h(b)s(e)f(just)g(a)h(function)e(name;)
i(an)m(y)g(expression)e(with)g(the)i(righ)m(t)f(t)m(yp)s(e)h(will)300
5000 y(w)m(ork)d(there.)2032 5700 y(138)p eop
%%Page: 139 148
139 147 bop 300 91 a Fl(4.1.4)105 b(Ov)m(erloaded)35
b(list)g(in)m(terface)300 337 y Fm(As)27 b(describ)s(ed)f(in)g
(Sections)h(2.3.4)i(&)e(2.3.5,)j(F)m(C++)e(supp)s(orts)d(three)j
(di\013eren)m(t)f(list)f(datat)m(yp)s(es:)40 b Fk(List)p
Fm(,)300 525 y Fk(OddList)p Fm(,)27 b(and)i Fk(StrictList)p
Fm(.)37 b(All)27 b(three)i(supp)s(ort)e(the)i(same)g(kind)e(of)i(in)m
(terface,)h(whic)m(h)e(means)g(that)300 712 y(list)h(functions)g(\(lik)
m(e)h Fk(map)f Fm(and)h Fk(filter)p Fm(\))f(can)i(b)s(e)f(applied)e(to)
j(an)m(y)g(kind)d(of)j(list.)441 900 y(In)g(F)m(C++,)h(the)g(common)f
(in)m(terface)h(to)h(all)d(of)i(the)g(list)e(t)m(yp)s(es)h(is)g(supp)s
(orted)f(via)h(templates)h(and)300 1087 y(ad-ho)s(c)c(o)m(v)m
(erloading.)40 b(Ho)m(w)m(ev)m(er)30 b(the)e(general)f(list)g(in)m
(terface)h(can)g(actually)g(b)s(e)f(expressed)g(using)f(non-)300
1275 y(ad-ho)s(c)34 b(metho)s(ds.)51 b(Here)35 b(is)e(a)h(summary)f(of)
h(what)g(the)g(in)m(terface)h(to)g Fk(ListLike)c Fm(en)m(tities)j(lo)s
(oks)g(lik)m(e)300 1462 y(when)29 b(expressed)h(via)g(Hask)m(ell)g(t)m
(yp)s(eclasses:)300 1724 y Fk(--)47 b(list,)g(even,)f(odd)95
b(type)46 b(constructors;)e(v=value)i(type)300 1912 y(class)g(ListLike)
g(l)h(e)h(o)f(|)h(l)f(->)g(e)h(o)f(where)443 2099 y(nil)190
b(::)47 b(l)h(v)443 2286 y(make1)94 b(::)47 b(\()h(\(\)->e)e(v)i(\))f
(->)g(l)h(v)443 2474 y(make2)94 b(::)47 b(\()h(\(\)->o)e(v)i(\))f(->)g
(l)h(v)443 2661 y(cons1)94 b(::)47 b(v)h(->)f(e)h(v)f(->)g(o)h(v)443
2849 y(cons2)94 b(::)47 b(v)h(->)f(o)h(v)f(->)g(o)h(v)443
3036 y(cons3)94 b(::)47 b(v)h(->)f(\()h(\(\)->e)e(v)h(\))h(->)f(o)g(v)
443 3224 y(cons4)94 b(::)47 b(v)h(->)f(\()h(\(\)->o)e(v)h(\))h(->)f(o)g
(v)443 3411 y(head)142 b(::)47 b(l)h(v)f(->)h(v)443 3599
y(tail)142 b(::)47 b(l)h(v)f(->)h(e)f(v)443 3786 y(null)142
b(::)47 b(l)h(v)f(->)h(Bool)443 3973 y(force)94 b(::)47
b(l)h(v)f(->)h(o)f(v)443 4161 y(delay)94 b(::)47 b(l)h(v)f(->)h(e)f(v)
300 4348 y(instance)f(ListLike)f(List)190 b(List)47 b(OddList)e(List)i
(where)f(...)300 4536 y(instance)g(ListLike)f(OddList)h(List)h(OddList)
e(List)i(where)f(...)300 4723 y(instance)g(ListLike)f(StrictList)g
(StrictList)g(StrictList)g(StrictList)g(where)h(...)300
4985 y Fm(Eac)m(h)33 b Fk(ListLike)c Fm(t)m(yp)s(e)j(constructor)h(\()p
Fk(l)p Fm(\))f(has)g(t)m(w)m(o)h(asso)s(ciated)g(t)m(yp)s(e)f
(constructors)g(whic)m(h)f(represen)m(t)300 5173 y(the)j(\\ev)m(en")i
(and)e(\\o)s(dd")g(v)m(ersions)f(of)h(the)h(list)d(\()p
Fk(e)j Fm(and)e Fk(o)p Fm(\).)52 b(Note)36 b(that)e(b)s(oth)g
Fk(List)p Fm(s)f(and)g Fk(OddList)p Fm(s)300 5360 y(ha)m(v)m(e)h(\\ev)m
(en")g(tails.)45 b Fk(StrictList)p Fm(s)30 b(pla)m(y)i(b)s(oth)f(the)i
(\\ev)m(en")h(and)e(\\o)s(dd")g(roles;)h(since)f Fk(StrictList)p
Fm(s)2032 5700 y(139)p eop
%%Page: 140 149
140 148 bop 300 91 a Fm(do)26 b(not)g(do)g(lazy)g(ev)-5
b(aluation,)27 b(there)f(is)f(no)h(need)g(for)g(a)g(distinction.)37
b(The)26 b Fk(make)f Fm(functions)f(corresp)s(ond)300
279 y(to)j(C++)e(constructors.)39 b(In)25 b(the)i(cases)g(of)f(b)s(oth)
f(the)h Fk(make)f Fm(and)g Fk(cons)g Fm(functions,)h(ad-ho)s(c)g(o)m(v)
m(erloading)300 466 y(in)32 b(C++)g(allo)m(ws)g(all)g(of)i(the)f
(related)g(functions)f(to)h(ha)m(v)m(e)i(the)e(same)h(name,)g(despite)e
(ha)m(ving)h(sligh)m(tly)300 654 y(di\013eren)m(t)e(signatures.)43
b(\(That)31 b(is,)g(in)f(C++)h(w)m(e)g(don't)h(ha)m(v)m(e)g(four)f
(functoids)f(named)h Fk(cons1)f Fm(through)300 841 y
Fk(cons4)p Fm(|w)m(e)25 b(just)h(ha)m(v)m(e)h(one)g(functoid)e(named)g
Fk(cons)h Fm(whic)m(h)e(is)i(o)m(v)m(erloaded)h(with)e(all)g(four)g(b)s
(eha)m(viors.\))300 1028 y(Note)i(that)f(w)m(e)g(are)g(using)e(the)i
(notation)f(\\)p Fk(\(\)->a)p Fm(")g(to)i(represen)m(t)e(the)h(t)m(yp)s
(e)g(\\th)m(unk)f(returning)f(a)h(v)-5 b(alue)300 1216
y(of)41 b(t)m(yp)s(e)g Fk(a)p Fm(",)j(a)e(notion)e(that)i(is)e(only)g
(necessary)h(in)f(eager)i(languages)f(\(lik)m(e)g(C++\).)72
b(In)40 b(the)h(case)300 1403 y(of)30 b Fk(List)f Fm(and)g
Fk(OddList)p Fm(,)g(the)h(implemen)m(tations)e(of)i Fk({make1)p
Fm(,)p Fk(make2)p Fm(,)p Fk(cons3)p Fm(,)p Fk(cons4})25
b Fm(store)31 b(the)f(th)m(unk)300 1591 y(argumen)m(t)c(to)h(b)s(e)e
(later)h(ev)-5 b(aluated)27 b(b)m(y-need,)g(whereas)e(the)i
Fk(StrictList)c Fm(implemen)m(tation)h(ev)-5 b(aluates)300
1778 y(the)31 b(th)m(unk)e(immediately)-8 b(.)441 1966
y(Giv)m(en)26 b(suc)m(h)f(a)i(de\014nition,)d(it)i(is)e(easy)j(to)f
(write)g(functions)e(lik)m(e)h Fk(map)g Fm(that)h(w)m(ork)g(on)g(an)m
(y)g Fk(ListLike)300 2153 y Fm(t)m(yp)s(e:)443 2415 y
Fk(--)47 b(using)g(Haskell)f(notation,)f(but)i(imagine)f(a)h(strict)f
(evaluation)f(semantics)443 2603 y(map)i(::)g(\(ListLike)f(l)h(e)g
(o\)=>)95 b(\(a)47 b(->)g(b\))g(->)h(l)f(a)g(->)h(o)f(b)443
2790 y(map)g(f)h(l)f(=)g(if)h(null)e(l)920 2978 y(then)h(nil)920
3165 y(else)g(cons4)f(\(f)i(\(head)e(l\)\))1445 3352
y(\(thunk2)g(map)h(f)h(\(tail)e(l\)\))300 3615 y Fm(If)24
b Fk(map)f Fm(is)h(passed)f(a)i Fk(List)e Fm(or)h(an)h
Fk(OddList)p Fm(,)e(the)i(result)e(is)g(an)i Fk(OddList)d
Fm(\(where)i(only)f(the)i(\014rst)e(elemen)m(t)300 3802
y(has)31 b(b)s(een)g(ev)-5 b(aluated\).)45 b(If)31 b
Fk(map)f Fm(is)h(passed)g(a)g Fk(StrictList)p Fm(,)f(the)h(result)g(is)
f(a)i Fk(StrictList)d Fm(where)i(the)300 3989 y(en)m(tire)f(list)f(is)h
(ev)-5 b(aluated.)300 4230 y Fl(4.1.5)105 b(List)35 b(optimizations)300
4476 y Fm(Section)g(2.5.2)i(discusses)d(a)i(n)m(um)m(b)s(er)e(of)h
(optimizations)f(w)m(e)i(ha)m(v)m(e)h(applied)c(to)j(the)f(implemen)m
(tation)300 4663 y(of)29 b(lists)e(and)h(the)g(functions)f(that)j
(manipulate)c(them.)40 b(Here)30 b(w)m(e)f(generalize)f(ho)m(w)h(a)g(n)
m(um)m(b)s(er)e(of)h(these)300 4851 y(optimizations)h(can)i(b)s(e)f
(applied)e(in)h(other)h(languages.)2032 5700 y(140)p
eop
%%Page: 141 150
141 149 bop 450 91 a Fi(4.1.5.1)94 b(Caching)300 337
y Fm(W)-8 b(e)38 b(use)e(\\cac)m(hing")i(to)g(store)f(lazy)g(list)e
(tails)h(so)h(that)g(they)g(ma)m(y)h(b)s(e)e(ev)-5 b(aluated)37
b(\\b)m(y)g(need".)60 b(This)300 525 y(tec)m(hnique)33
b(is)g(easy)h(to)g(use)f(in)g(an)m(y)h(language)g(with)e(m)m(utable)h
(v)-5 b(ariables.)49 b(F)-8 b(or)34 b(example,)g(in)f(ML,)g(w)m(e)300
712 y(w)m(ould)c(describ)s(e)g(the)h(t)m(yp)s(e)h(of)g
Fk(Cache)p Fm(s)d(as)443 974 y Fk(datatype)46 b('a)h(Cache)f(=)i(Value)
e(of)h('a)g(|)h(Thunk)e(of)h(unit->'a)300 1237 y Fm(and)30
b(the)g(main)g(op)s(eration)f(a)m(v)-5 b(ailable)30 b(on)g(references)h
(to)g(this)e(data)j(is)443 1499 y Fk(fun)47 b(get)g(cr)g(=)586
1686 y(case)g(!cr)g(of)730 1874 y(Value)f(x)h(=>)h(x)730
2061 y(|)f(Thunk)f(f)i(=>)f(let)g(val)g(y)g(=)h(f)f(\(\))g(in)1541
2249 y(cr)g(:=)g(Value)g(y;)g(y)g(end)300 2511 y Fm(That)33
b(is,)h(if)e(w)m(e)i(ha)m(v)m(e)h(a)f(reference)g(to)g(a)g(v)-5
b(alue,)34 b(just)f(return)f(the)i(v)-5 b(alue.)50 b(If)33
b(w)m(e)h(ha)m(v)m(e)g(a)g(reference)g(to)300 2698 y(a)j(th)m(unk,)i
(call)d(the)h(th)m(unk,)h(up)s(date)f(the)g(reference)g(so)h(that)f(it)
g(stores)g(the)g(v)-5 b(alue)37 b(returned)f(b)m(y)h(the)300
2886 y(th)m(unk,)30 b(and)g(return)f(the)h(v)-5 b(alue.)441
3073 y(This)42 b(tec)m(hnique)h(\(cac)m(hing)h(v)-5 b(alues)43
b(so)h(they)g(are)f(computed)h(b)m(y-need\))g(is)e(useful)g(outside)h
(the)300 3260 y(con)m(text)i(of)f(lists,)i(so)e(w)m(as)g(ha)m(v)m(e)h
(encapsulated)e(it)g(in)f(its)h(o)m(wn)h Fk(ByNeed)e
Fm(datat)m(yp)s(e)i(in)f(F)m(C++,)k(as)300 3448 y(describ)s(ed)28
b(in)h(Section)i(2.3.2.5.)450 3688 y Fi(4.1.5.2)94 b(R)-5
b(eusing)33 b(functoids')g(he)-5 b(ap)34 b(thunks)300
3934 y Fm(F)-8 b(or)30 b(languages)f(whic)m(h)e(pro)m(vide)h(up)s(date)
h(access)h(to)f(the)g(represen)m(tation)g(of)h(those)f(th)m(unks)f
(whic)m(h)g(are)300 4122 y(created)d(b)m(y)f(binding)d(all)i(of)h(the)g
(argumen)m(ts)h(of)f(a)g(functoid,)h(the)f(\\reuser")g(optimization)f
(describ)s(ed)f(in)300 4309 y(Section)h(2.5.2.4)i(is)d(lik)m(ely)f(to)i
(b)s(e)f(v)-5 b(aluable.)37 b(Our)22 b(implemen)m(tation)f(in)g(C++)h
(uses)g(an)h(extra)g(parameter)300 4496 y(with)42 b(a)h(default)f(v)-5
b(alue)43 b(as)g(syn)m(tactic)h(sugar,)i(but)d(for)f(languages)i
(without)e(a)h(default)f(parameter)300 4684 y(mec)m(hanism,)29
b(it)h(is)f(easy)h(to)h(rewrite)e(the)h(recursiv)m(e)f(function)f(as)i
(t)m(w)m(o)i(functions:)39 b(the)30 b(main)e(function)300
4871 y(whic)m(h)33 b(creates)k(and)d(initializes)e(the)j(m)m(utable)f
(th)m(unk)g(and)g(then)h(calls)f(the)g(help)s(er,)h(and)f(the)h(help)s
(er)300 5059 y(function)i(whic)m(h)h(tak)m(es)i(the)e(extra)i
(\\reuser")e(parameter)i(and)e(do)s(es)g(the)h(w)m(ork)f(\(making)h
(recursiv)m(e)300 5246 y(calls)30 b(to)h(itself)7 b(\).)2032
5700 y(141)p eop
%%Page: 142 151
142 150 bop 441 91 a Fm(F)-8 b(or)37 b(languages)g(with)f(builtin)d
(function)i(t)m(yp)s(es)h(that)i(do)e(not)h(pro)m(vide)f(access)h(to)h
(the)e(represen-)300 279 y(tation)i(of)f(th)m(unks,)i(it)e(migh)m(t)g
(b)s(e)g(w)m(orth)m(while)e(to)k(create)g(a)e(\(m)m(utable\))h
(user-de\014ned)e(datat)m(yp)s(e)i(for)300 466 y(represen)m(ting)43
b(th)m(unks.)80 b(Then)42 b(the)i(reuser)f(strategy)i(can)f(b)s(e)f
(used)g(to)i(m)m(utate)g(the)e(user-de\014ned)300 654
y(th)m(unks,)30 b(th)m(us)g(a)m(v)m(oiding)g(creating)h(new)e
(\(builtin\))f(function)h(ob)5 b(jects)31 b(during)d(ev)m(ery)k
(recursiv)m(e)d(call.)441 841 y(Since)k(this)g(optimization)f(a)m(v)m
(oids)j(rep)s(eatedly)e(allo)s(cating)g(and)g(freeing)g(small)f(ob)5
b(jects,)36 b(is)d(esp)s(e-)300 1028 y(cially)22 b(imp)s(ortan)m(t)i
(for)f(C++.)38 b(The)23 b(impro)m(v)m(emen)m(t)i(is)e(lik)m(ely)f(to)j
(b)s(e)e(less)g(impressiv)m(e)f(in)h(languages)h(with)300
1216 y(sophisticated)35 b(run)m(times)f(that)j(ha)m(v)m(e)g(garbage)g
(collection)e(and)g(fast)h(small-ob)5 b(ject)36 b(allo)s(cators.)57
b(But)300 1403 y(this)24 b(optimization)h(will)e(still)g(probably)h(b)s
(e)h(a)g(win)f(on)i(most)g(systems,)g(as)g(it)f(tak)m(es)i(v)m(ery)f
(sophisticated)300 1591 y(lifetime)j(analysis)g(for)i(compilers)e(to)j
(automatically)e(deduce)h(that)g(it)f(is)g(safe)h(to)h(recycle)f(the)g
(th)m(unks)300 1778 y(in)e(the)i(manner)e(done)h(b)m(y)h(the)f
(reusers.)450 2018 y Fi(4.1.5.3)94 b(Misc)-5 b(el)5 b(lane)-5
b(ous)300 2264 y Fm(F)d(or)42 b(systems)f(without)g(automatic)h(memory)
f(managemen)m(t,)46 b(using)39 b(in)m(trusiv)m(e)h(reference-coun)m
(ting)300 2452 y(\(rather)31 b(than)f(non-in)m(trusiv)m(e\))f(will)f
(almost)i(certainly)f(b)s(e)h(a)h(win.)441 2639 y(F)-8
b(or)26 b(languages)g(whic)m(h)d(are)j(not)f(go)s(o)s(d)g(at)h
(recursion)e(\(e.g.)41 b(do)25 b(not)g(optimize)g(tail)f(calls\),)i
(rewriting)300 2827 y(recursiv)m(e)k(functions)f(to)i(use)f(iteration)g
(instead)f(is)h(lik)m(ely)f(to)i(b)s(e)f(a)g(win.)300
3067 y Fl(4.1.6)105 b(Subt)m(yping)36 b(for)f(functoids)300
3313 y Fm(A)c(n)m(um)m(b)s(er)f(of)h(languages)g(with)f(primitiv)m(e)e
(supp)s(ort)i(for)g(b)s(oth)g(\014rst-class)h(functions)e(and)i(subt)m
(yping)300 3500 y(ha)m(v)m(e)43 b(function-subt)m(yping)38
b(built)h(in.)73 b(F)-8 b(or)42 b(languages)f(with)f(functoids)g(that)i
(don't)g(ha)m(v)m(e)g(built-in)300 3688 y(supp)s(ort)22
b(for)h(subt)m(yping,)g(this)f(supp)s(ort)f(can)j(often)g(b)s(e)e(sim)m
(ulated)g(via)h(co)s(ercion)g(functions/op)s(erators.)300
3875 y(Th)m(us)k Fk(coerce)f Fm(can)j(serv)m(e)g(as)f(an)g(\\up)s
(cast")g(op)s(eration,)h(whic)m(h)d(enables)i(more)g(sp)s(eci\014c)f
(ob)5 b(jects)29 b(to)g(b)s(e)300 4063 y(used)h(in)f(place)h(of)g(more)
h(general)f(ones.)441 4250 y(F)-8 b(or)31 b(example,)g(if)e(one)i(can)f
(o)m(v)m(erload)i(a)e(function)f(named)h Fk(coerce\(\))e
Fm(lik)m(e)i(so:)443 4512 y Fk(coerce<Base>\()44 b(a_derived_obj)h(\))
95 b(//)47 b(legal)f(iff)h(a_derived_obj)d(<:)k(Base)300
4774 y Fm(then,)h(for)c(example,)j(giv)m(en)e(some)f(represen)m(tation)
g(of)h(a)f(function)f(from)g Fk(Animal)p Fm(s)g(to)i
Fk(Car)p Fm(s,)i(e.g.)300 4962 y Fk(Fun1<Animal,Car>)p
Fm(,)35 b(w)m(e)j(can)f(pro)m(vide)f(a)i(general)f(de\014nition)e(for)i
Fk(coerce)f Fm(on)h(functoids,)h(so)f(that)300 5149 y(the)d(original)d
(functoid)i(ma)m(y)h(b)s(e)e(co)s(erced)j(in)m(to)e(a)h
Fk(Fun1<Dog,Vehicle>)29 b Fm(\(assuming)j(that)i Fk(Dog)p
Fm(s)f(can)300 5337 y(b)s(e)d(co)s(erced)h(in)m(to)f
Fk(Animal)p Fm(s)f(and)g Fk(Car)p Fm(s)h(in)m(to)g Fk(Vehicle)p
Fm(s\).)2032 5700 y(142)p eop
%%Page: 143 152
143 151 bop 441 91 a Fm(This)27 b(can)h(b)s(e)g(ac)m(hiev)m(ed)h(in)e
(an)m(y)i(language)g(with)e(just)h(a)h(t)m(yp)s(eclass-lik)m(e)f(o)m(v)
m(erloading)g(mec)m(hanism.)300 279 y(F)-8 b(or)31 b(instance,)f(in)f
(Hask)m(ell,)i(w)m(e)g(migh)m(t)f(write)443 541 y Fk(data)47
b(Car)238 b(=)47 b(...)443 728 y(data)g(Vehicle)f(=)h(...)443
916 y(data)g(Animal)94 b(=)47 b(...)443 1103 y(data)g(Dog)238
b(=)47 b(...)443 1478 y(class)g(Coercable)e(from)h(to)i(where)586
1665 y(coerce)e(::)i(from)e(->)h(to)443 2040 y(--)g(coercion)443
2228 y(instance)f(\(Coercable)f(d)i(a,)g(Coercable)f(c)h(v\)=>)g
(Coercable)e(\(a->c\))h(\(d->v\))g(where)586 2415 y(coerce)g(f)i(=)f
(\\x)h(->)f(coerce)f(\(f)h(\(coerce)f(x\))h(\))443 2790
y(--)g(explicitly)e(define)h(the)h(subtype)f(hierarchies)f(of)i
(interest)443 2978 y(instance)f(Coercable)f(Car)i(Vehicle)f(where)g
(...)443 3165 y(instance)g(Coercable)f(Dog)i(Animal)f(where)g(...)443
3540 y(ac)h(::)h(Animal)e(->)h(Car)443 3727 y(ac)g(=)h(...)443
4102 y(dv)f(::)h(Dog)e(->)i(Vehicle)443 4290 y(dv)f(=)h(coerce)e(ac)333
b(--)48 b(demonstration)c(of)j("upcasting")e(a)i(function)443
4664 y(v)h(::)f(Vehicle)443 4852 y(v)h(=)f(dv)g(Dog)524
b(--)48 b(calls)e("ac")300 5114 y Fm(The)31 b(instance)g(declaration)g
Fk(Coercable)45 b(Foo)i(Bar)30 b Fm(can)i(b)s(e)f(used)f(to)j
(explicitly)28 b(sp)s(ecify)i(that)i Fk(Foo)f Fm(is)300
5301 y(a)i(subt)m(yp)s(e)f(of)h Fk(Bar)p Fm(;)g(the)g(instance)f
(declaration)h(in)m(v)m(olving)e(function)g(t)m(yp)s(es)i(generalizes)g
(this)e(notion)2032 5700 y(143)p eop
%%Page: 144 153
144 152 bop 300 91 a Fm(to)31 b(functions.)300 330 y
Fl(4.1.7)105 b(Lazy)36 b(lists)f(as)g(an)f(in)m(terface)h(to)g(logic)h
(query)f(results)300 576 y Fm(As)27 b(describ)s(ed)d(in)i(Section)g
(3.2.1,)k(lazy)c(lists)g(are)h(useful)e(as)h(the)h(in)m(terface)h(to)f
(results)e(of)i(a)g(logic)g(query)-8 b(.)300 764 y(The)33
b(lazy)g(list)f(in)m(terface)i(lea)m(v)m(es)g(the)f(clien)m(t)g
(algorithm)f(in)g(con)m(trol,)j(b)s(oth)d(of)i(the)f
Fi(evaluation)41 b Fm(of)34 b(the)300 951 y(query)g(\(e.g.)56
b(the)35 b(clien)m(t)f(ma)m(y)i(just)e(ask)h(for)g(t)m(w)m(o)h
(results,)f(and)g(then)f(stop\))h(and)g(of)g Fi(how)j(the)f(r)-5
b(esults)300 1139 y(ar)g(e)33 b(use)-5 b(d)41 b Fm(\(e.g.)h(the)30
b(clien)m(t)g(ma)m(y)h(prin)m(t)e(them,)i(store)g(them)f(in)f(a)i(data)
g(structure,)f(whatev)m(er\).)441 1326 y(F)-8 b(rom)46
b(an)e(implemen)m(tation)g(p)s(oin)m(t-of-view,)k(lazy)c(lists)g
(nicely)f(encapsulate)i(the)g(fact)h(that)g(a)300 1514
y(natural)28 b(implemen)m(tation)g(of)i(logic)f(queries)f(uses)h(con)m
(tin)m(uation-passing)g(st)m(yle)h(\(CPS\).)f(Logic)h(query)300
1701 y(terms)h(all)f(tak)m(e)j(a)e Fk(future)e Fm(parameter)j
(describing)d(\\the)i(rest)h(of)f(the)g(query")g(to)h(run,)e(but)g
(lazy)h(lists)300 1888 y(enable)g(these)h(computations)f(to)i(actually)
e Fk(return)p Fm(.)42 b(When)32 b(a)g(query)f(succeeds)g(in)g
(\014nding)e(a)j(result,)300 2076 y(a)27 b(one-elemen)m(t)h(lazy)f
(list)f(is)g(returned;)h(when)f(a)h(query)g(fails,)f(an)h(empt)m(y)g
(lazy)g(list)f(is)g(returned;)h(at)h(the)300 2263 y(\\c)m(hoice)34
b(p)s(oin)m(ts")e(\(disjunct)g(terms\),)i(the)f(results)f(of)h(all)f(p)
s(ossible)e(futures)i(for)h(the)g(query)f(are)h(lazily)300
2451 y(concatenated|th)m(us)j(eac)m(h)g(future)d(will)f(only)i(b)s(e)g
(run)f(as)h(the)h(next)f(solution)f(is)h(demanded)f(b)m(y)i(the)300
2638 y(clien)m(t.)k(The)27 b(implemen)m(tation)f(strategy)j(describ)s
(ed)d(in)g(Section)h(3.2.1)i(can)f(b)s(e)f(used)g(in)f(an)m(y)i
(language)300 2826 y(whic)m(h)h(supp)s(orts)g(an)h(implemen)m(tation)f
(of)h(lazy)h(lists.)441 3013 y(It)c(should)e(b)s(e)h(noted)i(that)f
(for)g(languages)g(whic)m(h)f(pro)m(vide)g(a)h Fk(call/cc)e
Fm(primitiv)m(e,)h(an)h(alternativ)m(e)300 3201 y(implemen)m(tation)i
(is)g(straigh)m(tforw)m(ard)i(to)g(pro)m(vide.)40 b(A)30
b(query)g(result)f(can)i(just)f(b)s(e)f(represen)m(ted)i(as)f(a)443
3457 y Fk(Maybe<)46 b(pair<)h(Answer,)e(Continuation)g(>)i(>)300
3713 y Fm(When)41 b Fk(query\(\))e Fm(is)i(called)f(b)m(y)h(some)h
(clien)m(t,)i(the)e(clien)m(t's)f(curren)m(t)g(con)m(tin)m(uation)g(is)
f(passed)h(as)h(a)300 3901 y(the)34 b(original)e Fk(future)g
Fm(parameter)i(to)g(the)g(query)f(ob)5 b(ject.)52 b(Eac)m(h)34
b(time)g(the)g(query)f(\014nds)f(a)i(result,)f(it)300
4088 y(in)m(v)m(ok)m(es)23 b(the)e(clien)m(t)h(con)m(tin)m(uation)f
(with)g(a)h Fk(pair)e Fm(con)m(taining)i(the)g(result)e(and)h(the)h
(query's)f(o)m(wn)h(curren)m(t)300 4275 y(con)m(tin)m(uation.)39
b(This)23 b(passes)i(con)m(trol)h(bac)m(k)g(to)f(the)h(clien)m(t,)g
(who)e(uses)h(the)g(answ)m(er)g(ho)m(w)m(ev)m(er)i(it)d(sees)i(\014t.)
300 4463 y(When)i(the)g(clien)m(t)g(w)m(an)m(ts)g(the)g(next)h(result,)
e(the)h(clien)m(t)g(passes)g(its)f(o)m(wn)h(curren)m(t)g(con)m(tin)m
(uation)g(to)h(the)300 4650 y(second)h(elemen)m(t)g(of)g(the)g
Fk(pair)p Fm(;)g(this)e(transfers)i(con)m(trol)g(bac)m(k)h(to)f(the)g
(query)-8 b(,)30 b(whic)m(h)f(pro)s(ceeds)g(where)300
4838 y(it)j(left)h(o\013.)47 b(When)33 b(the)g(query)f(has)g(no)h
(results)e(left)h(to)i(pro)s(duce,)e(it)g(calls)g(the)h(clien)m(t's)f
(con)m(tin)m(uation)300 5025 y(with)d Fk(Nothing)p Fm(,)g(to)i(signify)
d(that)j(it)f(is)g(done.)441 5213 y(The)j(analogy)g(b)s(et)m(w)m(een)h
(the)f(lazy)h(list)d(implemen)m(tation)h(and)h(the)g
Fk(call/cc)e Fm(implemen)m(tation)h(is)300 5400 y(striking.)37
b(Both)25 b(implemen)m(tations)f(pro)m(vide)f(a)j(w)m(a)m(y)f(for)g
(the)g(clien)m(t)f(and)g(the)h(query)f(to)i(coroutine)e(with)2032
5700 y(144)p eop
%%Page: 145 154
145 153 bop 300 91 a Fm(one)31 b(another.)41 b(When)30
b(the)g(t)m(w)m(o)i(datat)m(yp)s(e)f(implemen)m(tations:)443
352 y Fk(Maybe<)46 b(pair<)h(Answer,)e(Continuation)g(>)i(>)h(//)f
(call/cc)f(implementation)443 540 y(List<Answer>)1238
b(//)47 b(lazy)g(list)f(implementation)300 801 y Fm(are)31
b(expanded)e(one)i(lev)m(el)f(in)m(to)g(their)g(algebraic)g(equiv)-5
b(alen)m(ts:)443 1062 y Fk(Just)47 b(pair<)f(Answer,)g(Continuation)e
(>)96 b(|)47 b(Nothing)443 1249 y(Cons)333 b(Answer)94
b(Thunk)524 b(|)47 b(Nil)300 1510 y Fm(the)29 b(similarit)m(y)c(is)j
(more)g(ob)m(vious.)40 b(The)28 b(main)f(di\013erence)h(is)f(that)i(in)
e(the)i Fk(call/cc)d Fm(implemen)m(tation,)300 1697 y(the)41
b(query)e(\\calls")i(bac)m(k)g(to)g(the)g(clien)m(t,)i(whereas)d(in)f
(the)i(lazy)f(list)f(implemen)m(tation,)j(the)f(query)300
1885 y(\\returns")30 b(to)h(the)g(clien)m(t.)300 2125
y Fl(4.1.8)105 b(F)-9 b(unctoids)36 b(as)f(mec)m(hanism)f(for)h(logic)h
(co)s(de)g(to)e(\\call)h(out")300 2371 y Fm(An)m(y)25
b(language)g(whic)m(h)f(supp)s(orts)f(functoids)h(can)h(pro)m(vide)f(a)
h(natural)f(mec)m(hanism)g(for)h(logic)g(program-)300
2558 y(ming)k(co)s(de)i(to)g(mak)m(e)g(function)e(calls)h(bac)m(k)h
(out)g(to)g(the)f(host)h(language.)41 b(In)30 b(LC++,)443
2819 y Fk(SomeLogVar.is\()44 b(SomeFunctoid,)g(Arg1,)j(...,)f(ArgN)h
(\))300 3080 y Fm(creates)32 b(a)f(logic)f(term)g(whic)m(h,)f(when)h
(run,)f(calls)443 3341 y Fk(SomeFunctoid\()44 b(Arg1,)j(...,)f(ArgN)h
(\))300 3602 y Fm(\(using)30 b(the)i(v)-5 b(alues)31
b(of)g(the)h(curren)m(t)f(query)g(en)m(vironmen)m(t)g(for)g(an)m(y)h
(argumen)m(ts)f(in)m(v)m(olving)f(logic)h(v)-5 b(ari-)300
3789 y(ables\))30 b(and)g(uni\014es)e(the)j(result)e(with)g
Fk(SomeLogVar)p Fm(.)300 4029 y Fl(4.1.9)105 b(Domain-sp)s(eci\014c)36
b(static)f(analyses)300 4275 y Fm(Both)40 b(F)m(C++'s)f(\\lam)m(b)s
(da")h(and)e(LC++)h(use)g(the)g(C++)g(tec)m(hnique)g(kno)m(wn)g(as)h
(\\expression)e(tem-)300 4463 y(plates")33 b(to)g(create)h(a)f
(domain-sp)s(eci\014c)e(em)m(b)s(edded)g(language.)48
b(Supp)s(orting)30 b(domain-sp)s(eci\014c)g(static)300
4650 y(analyses)j(helps)e(fortify)h(b)s(oth)g(F)m(C++)h(and)f(LC++)g
(as)h(\\em)m(b)s(edded)g(languages")g(rather)g(than)g(mere)300
4838 y(\\libraries".)441 5025 y(Creating)39 b(domain-sp)s(eci\014c)f
(static)j(analyses)e(t)m(ypically)g(requires)f(the)i(abilit)m(y)e(to)j
(do)e(arbitrary)300 5213 y(computation)k(at)g(compile-time.)77
b(As)43 b(a)h(result,)h(mec)m(hanisms)d(lik)m(e)g(C++)g(templates)h(or)
g(Sc)m(heme)300 5400 y(macros)32 b(are)g(probably)d(a)j(necessit)m(y)g
(to)g(do)g(this)e(w)m(ell.)43 b(F)-8 b(or)32 b(example,)g(w)m(arning)e
(ab)s(out)h(one-time-use)2032 5700 y(145)p eop
%%Page: 146 155
146 154 bop 300 91 a Fm(v)-5 b(ariables)35 b(in)h Fk(lassert\(\))p
Fm(s)e(\(Section)j(3.2.2\))i(requires)c(the)i(abilit)m(y)e(to)j(w)m
(alk)e(an)h(expression)f(tree)h(at)300 279 y(compile-time)i(and)g(coun)
m(t)i(the)f(n)m(um)m(b)s(er)e(of)i(o)s(ccurances)g(of)g(eac)m(h)h
(logic)f(v)-5 b(ariable.)68 b(W)-8 b(e)41 b(do)f(this)e(in)300
466 y(C++)f(b)m(y)i(represen)m(ting)e(the)i(en)m(tire)f(structure)g(of)
g(the)h(expression)e(within)f(the)i(t)m(yp)s(e)h(system,)i(and)300
654 y(insp)s(ecting)28 b(and)i(doing)g(computations)g(on)g(this)f(t)m
(yp)s(e)i(at)g(compile-time.)441 841 y(In)40 b(addition)f(to)i(a)g(T)-8
b(uring-complete)40 b(macro)h(system)f(of)h(some)g(sort,)j(a)d
(language)f(supp)s(orting)300 1028 y(domain-sp)s(eci\014c)d(static)j
(analyses)e(w)m(ould)g(ideally)f(ha)m(v)m(e)k(a)e(nice)g(mec)m(hanism)f
(for)h(rep)s(orting)e(errors)300 1216 y(or)31 b(w)m(arnings)e(when)h
(they)h(are)g(detected.)43 b(C++)30 b(has)h(no)f(suc)m(h)h(mec)m
(hanism|to)f(rep)s(ort)h(information)300 1403 y(at)j(compile-time,)e
(one)i(m)m(ust)e(hijac)m(k)h(the)g(existing)f(compiler)g(diagnostic)g
(mec)m(hanisms.)47 b(Often)33 b(this)300 1591 y(tak)m(es)40
b(the)e(form)f(of)i(instan)m(tiating)e(a)h(\\brok)m(en")h(template)g
(with)d(a)j(t)m(yp)s(e)f(named)g(b)m(y)g(a)g(really)f(long)300
1778 y(iden)m(ti\014er)25 b(whic)m(h)g(describ)s(es)g(the)i(error:)38
b(the)27 b(compiler)e(then)h(rep)s(orts)g(an)g(error)h(in)e(the)i
(template,)h(and)300 1966 y(hop)s(efully)k(includes)h(the)i(long)g
(iden)m(ti\014er)e(in)h(part)h(of)g(its)g(diagnostic)f(message)j(as)e
(the)g(only)g(clue)f(to)300 2153 y(the)e(user)f(as)h(to)g(what)g
(really)e(w)m(en)m(t)j(wrong.)44 b(This)30 b(mec)m(hanism)h(is)g
(adequate,)i(and)e(v)-5 b(ariations)31 b(of)h(the)300
2340 y(basic)g(theme)h(can)g(probably)e(b)s(e)i(used)f(in)f(an)m(y)i
(language)g(with)f(a)h(T)-8 b(uring-complete)32 b(macro)i(system.)300
2528 y(The)28 b(wise)f(language)h(designer)f(w)m(ould)g(do)h(w)m(ell)f
(to)i(pro)m(vide)e(a)i(sp)s(ecial)d(mec)m(hanism)i(b)m(y)g(whic)m(h)e
(macros)300 2715 y(can)36 b(create)i(w)m(ell-formatted)e(w)m
(arning/error)e(messages)j(that)g(can)f(refer)g(to)g(t)m(yp)s(e)g
(information)f(and)300 2903 y(\014le/line)28 b(n)m(um)m(b)s(ers.)300
3179 y Fj(4.2)140 b(Cap)-7 b(abilities)57 b(of)i(C++)g(and)g(overview)e
(of)i(useful)h(language)625 3329 y(fe)-7 b(atur)g(es)300
3575 y Fm(Our)26 b(w)m(ork)h(sho)m(ws)g(that)h(C++)e(is)g(an)h
(expressiv)m(e)g(and)g(extensible)f(language.)40 b(W)-8
b(e)28 b(ha)m(v)m(e)h(tak)m(en)f(adv)-5 b(an-)300 3762
y(tage)28 b(of)e(a)g(n)m(um)m(b)s(er)f(of)i(features)f(that)h(are)f
(relativ)m(ely)g(unique)e(to)j(C++)e(in)g(our)g(libraries.)37
b(Notably)-8 b(,)27 b(w)m(e)300 3950 y(ha)m(v)m(e)i(utilized)e(C++'s)g
(un)m(usual)f(\(and)i(T)-8 b(uring-complete\))28 b(t)m(yp)s(e)g(system)
h(to)g(do)f(meta-programming,)300 4137 y(enabling)19
b(b)s(oth)h(return-t)m(yp)s(e)g(deduction)g(and)g(v)-5
b(arious)20 b(kinds)f(of)i(static)g(analyses.)37 b(W)-8
b(e)22 b(ha)m(v)m(e)g(also)f(tak)m(en)300 4325 y(adv)-5
b(an)m(tage)36 b(of)e(the)f(o)m(v)m(erloading)h(capabilities)e(of)i
(the)g(language,)h(using)d(ad-ho)s(c)i(function)f(o)m(v)m(erload-)300
4512 y(ing)25 b(to)h(implemen)m(t)e(features)i(lik)m(e)f(currying,)g
(and)h(using)e(op)s(erator)i(o)m(v)m(erloading)g(to)g(create)h
(expression)300 4700 y(template)d(syn)m(tax)g(for)f(lam)m(b)s(da)f(and)
h(monads.)38 b(Utilizing)21 b(these)j(p)s(o)m(w)m(erful)e(features)i
(has)f(enabled)f(us)h(to)300 4887 y(o)m(v)m(ercome)i(man)m(y)e(w)m
(eaknesses)g(of)g(\\v)-5 b(anilla)21 b(C++")h(when)g(it)g(comes)i(to)f
(m)m(ultiparadigm)d(programming)300 5074 y(supp)s(ort.)441
5262 y(Though)43 b(w)m(e)i(rely)e(up)s(on)f(man)m(y)i(of)g(the)h(most)f
(p)s(o)m(w)m(erful)f(features)h(of)g(C++|features)f(whic)m(h)2032
5700 y(146)p eop
%%Page: 147 156
147 155 bop 300 91 a Fm(aren't)31 b(t)m(ypically)e(found)h(in)f(other)i
(languages|throughout)f(our)g(implemen)m(tation)f(of)i(the)g
(libraries,)300 279 y(Section)39 b(4.1)i(describ)s(es)c(ho)m(w)j(man)m
(y)f(of)h(our)f(ideas)g(can)g(b)s(e)g(implemen)m(ted)f(using)g(more)h
(commonly)300 466 y(a)m(v)-5 b(ailable)37 b(language)h(features.)64
b(F)-8 b(or)38 b(instance,)i(in)c(man)m(y)i(cases)h(where)e(w)m(e)i(ha)
m(v)m(e)g(utilized)c(\\ad-ho)s(c)300 654 y(o)m(v)m(erloading")c(in)e
(C++,)h(in)f(fact)j(the)f(similar,)d(but)i(more)g(constrained)g
(feature)h(of)g(\\t)m(yp)s(e)g(classes")g(is)300 841
y(su\016cien)m(tly)e(p)s(o)m(w)m(erful.)441 1028 y(T)-8
b(able)42 b(12)g(summarizes)f(some)h(of)g(the)g(information)f(in)f
(Section)i(4.1.)76 b(Sp)s(eci\014cally)-8 b(,)43 b(the)f(table)300
1216 y(illustrates)28 b(the)i(\\minim)m(um)d(language)j(feature)g(set")
h(required)d(to)i(implemen)m(t)e(the)i(v)-5 b(arious)29
b(reusable)300 1403 y(ideas.)37 b(Note)24 b(that)e(the)h(language)f
(feature)h(listed)d(across)j(the)f(top)g(of)g(the)h(table)f(are)g(not)g
(all)f(orthogonal:)300 1591 y(ad-ho)s(c)i(o)m(v)m(erloading)h(based)e
(on)h(argumen)m(t)h(t)m(yp)s(es)f(\(OT\))g(is)g(strictly)f(more)h(p)s
(o)m(w)m(erful)f(than)h(t)m(yp)s(eclasses)300 1778 y(\(TC\),)37
b(and)f(there)h(is)f(no)g(v)-5 b(alue)36 b(in)g(access)i(to)f(the)g
(represen)m(tation)g(of)g(th)m(unks)f(\(R)-8 b(T\))37
b(without)f(side-)300 1966 y(e\013ects)c(\(SE\).)441
2153 y(Note)45 b(also)e(that)g(w)m(e)h(think)e(some)h(of)g(the)h(ideas)
e(are)i(implemen)m(ted)d(most)j(con)m(v)m(enien)m(tly)f(as)h(a)300
2340 y(nativ)m(e)35 b(programming)f(language)h(feature;)j(when)c(true,)
i(this)e(is)g(noted)h(in)f(the)h(\014nal)f(column)g(of)h(the)300
2528 y(table)c(as)g(w)m(ell.)42 b(Sp)s(eci\014cally)-8
b(,)30 b(subt)m(yping)f(for)i(function)f(t)m(yp)s(es)h(can)g(b)s(e)g
(built)e(in)m(to)i(a)g(language's)h(t)m(yp)s(e)300 2715
y(system,)45 b(and)d(b)s(oth)f(currying)f(and)i(in\014x)e(syn)m(tax)i
(can)h(b)s(e)e(straigh)m(tfordw)m(ardly)g(transformed)g(in)m(to)300
2903 y(other)f(constructs)h(b)m(y)f(a)h(compiler.)68
b(Section)40 b(4.3.2)i(discusses)d(the)h(merits)g(of)g(nativ)m(e)h
(supp)s(ort)d(for)300 3090 y(some)31 b(features)f(in)g(more)g(depth.)
300 3367 y Fj(4.3)140 b(Limitations)48 b(of)h(C++)g(and)g(advic)-7
b(e)47 b(to)i(language)f(designers)300 3613 y Fm(Despite)37
b(what)g(w)m(e)h(ha)m(v)m(e)g(ac)m(hiev)m(ed)g(with)e(the)h(F)m(C++)g
(and)g(LC++)f(libraries,)g(the)h(C++)g(language)300 3800
y(has)26 b(man)m(y)g(limitations)e(that)i(hindered)e(our)h(w)m(ork)i
(in)d(v)-5 b(arious)25 b(w)m(a)m(ys.)40 b(Indeed,)27
b(when)e(considering)f(the)300 3988 y(o)m(v)m(erview)31
b(of)g(our)e(w)m(ork,)i(one)g(ma)m(y)g(b)s(e)e(reminded)g(of)h(that)h
(old)f(sa)m(ying)g(ab)s(out)g(the)h(dancing)e(b)s(ear:)664
4250 y(It's)h(not)h(ho)m(w)f(w)m(ell)g(the)g(b)s(ear)g(can)h(dance...)
41 b(it's)30 b(that)h(the)g(b)s(ear)e(can)i(dance)g(at)g(all!)300
4512 y(A)m(t)38 b(times,)h(C++)d(has)h(b)s(een)f(quite)h(a)h(b)s(ear.)
1869 4479 y Fg(1)1969 4512 y Fm(Indeed,)g(the)f(initial)e(reaction)i
(to)h(our)f(w)m(ork)g(is)g(often)300 4700 y(surprise)28
b(\(that)j(suc)m(h)f(things)g(are)g(p)s(ossible)e(within)g(C++\).)441
4887 y(In)h(this)g(section)h(w)m(e)g(discuss)e(the)i(main)f
(limitations)e(imp)s(osed)h(b)m(y)i(C++)f(and)g(their)g(implications)
300 5074 y(for)36 b(our)f(libraries.)54 b(W)-8 b(e)38
b(also)d(o\013er)i(some)f(advice)g(to)g(designers)f(of)h(future)f
(languages,)j(in)d(the)h(hop)s(e)p 300 5211 1440 4 v
404 5265 a Ff(1)438 5297 y Fe(Or)26 b(p)r(erhaps)f(\\quite)h(a)g(b)r
(ear)g(to)g(b)r(ear"...?)2032 5700 y Fm(147)p eop
%%Page: 148 157
148 156 bop 391 1066 3419 4 v 389 1179 4 113 v 708 1145
a Fm(Reusable)29 b(idea)p 1570 1179 V 366 w(PP)p 1793
1179 V 100 w(1F)p 1998 1179 V 100 w(ON)p 2236 1179 V
100 w(OT)p 2472 1179 V 99 w(TC)p 2703 1179 V 99 w(EF)p
2924 1179 V 100 w(R)-8 b(T)p 3149 1179 V 99 w(TT)p 3380
1179 V 99 w(SE)p 3592 1179 V 99 w(LF)p 3807 1179 V 391
1183 3419 4 v 391 1199 V 389 1312 4 113 v 645 1278 a(Implicit)28
b(currying)p 1570 1312 V 340 w(x)p 1793 1312 V 166 w(x)p
1998 1312 V 174 w(x)p 2236 1312 V 2472 1312 V 2703 1312
V 2924 1312 V 3149 1312 V 3380 1312 V 3592 1312 V 1534
w(x)p 3807 1312 V 391 1315 3419 4 v 389 1428 4 113 v
645 1395 a(Explicit)g(currying)p 1570 1428 V 339 w(x)p
1793 1428 V 166 w(x)p 1998 1428 V 2236 1428 V 411 w(x)p
2472 1428 V 2703 1428 V 2924 1428 V 3149 1428 V 3380
1428 V 3592 1428 V 1297 w(x)p 3807 1428 V 391 1432 3419
4 v 389 1545 4 113 v 709 1511 a(In\014x)h(\(one-op\))p
1570 1545 V 406 w(x)p 1793 1545 V 166 w(x)p 1998 1545
V 2236 1545 V 411 w(x)p 2472 1545 V 2703 1545 V 2924
1545 V 3149 1545 V 3380 1545 V 3592 1545 V 1297 w(x)p
3807 1545 V 391 1548 3419 4 v 389 1661 4 113 v 706 1627
a(In\014x)g(\(t)m(w)m(o-op\))p 1570 1661 V 405 w(x)p
1793 1661 V 166 w(x)p 1998 1661 V 2236 1661 V 2472 1661
V 644 w(x)p 2703 1661 V 2924 1661 V 3149 1661 V 3380
1661 V 3592 1661 V 1064 w(x)p 3807 1661 V 391 1664 3419
4 v 389 1777 4 113 v 542 1743 a(Common)g(list)g(in)m(terface)p
1570 1777 V 239 w(x)p 1793 1777 V 166 w(x)p 1998 1777
V 2236 1777 V 2472 1777 V 644 w(x)p 2703 1777 V 2924
1777 V 3149 1777 V 3380 1777 V 3592 1777 V 3807 1777
V 391 1780 3419 4 v 389 1893 4 113 v 597 1859 a(F)-8
b(unction)30 b(subt)m(yping)p 1570 1893 V 291 w(x)p 1793
1893 V 166 w(x)p 1998 1893 V 2236 1893 V 2472 1893 V
644 w(x)p 2703 1893 V 2924 1893 V 3149 1893 V 3380 1893
V 3592 1893 V 1064 w(x)p 3807 1893 V 391 1897 3419 4
v 389 2010 4 113 v 517 1976 a(List)g(cac)m(he)i(optimization)p
1570 2010 V 1793 2010 V 1998 2010 V 2236 2010 V 2472
2010 V 2703 2010 V 1344 w(x)p 2924 2010 V 3149 2010 V
3380 2010 V 3592 2010 V 3807 2010 V 391 2013 3419 4 v
389 2126 4 113 v 581 2092 a(Reuser)e(optimization)p 1570
2126 V 277 w(x)p 1793 2126 V 166 w(x)p 1998 2126 V 2236
2126 V 2472 2126 V 2703 2126 V 870 w(x)p 2924 2126 V
175 w(x)p 3149 2126 V 3380 2126 V 3592 2126 V 3807 2126
V 391 2129 3419 4 v 389 2242 4 113 v 543 2208 a(Iteration)h
(optimization)p 1570 2242 V 1793 2242 V 1998 2242 V 2236
2242 V 2472 2242 V 2703 2242 V 1370 w(x)p 2924 2242 V
3149 2242 V 3380 2242 V 3592 2242 V 3807 2242 V 391 2245
3419 4 v 389 2358 4 113 v 524 2324 a(Ref-coun)m(t)g(optimization)p
1570 2358 V 1793 2358 V 1998 2358 V 2236 2358 V 2472
2358 V 2703 2358 V 1351 w(x)p 2924 2358 V 3149 2358 V
3380 2358 V 3592 2358 V 3807 2358 V 391 2362 3419 4 v
389 2474 4 113 v 504 2441 a(Logic)f(results)f(as)i(lazy)f(list)p
1570 2474 V 199 w(x)p 1793 2474 V 166 w(x)p 1998 2474
V 2236 2474 V 2472 2474 V 2703 2474 V 2924 2474 V 3149
2474 V 3380 2474 V 3592 2474 V 3807 2474 V 391 2478 3419
4 v 389 2591 4 113 v 441 2557 a(Calling)e(out)j(from)e(logic)i(co)s(de)
p 1570 2591 V 1793 2591 V 351 w(x)p 1998 2591 V 2236
2591 V 2472 2591 V 2703 2591 V 2924 2591 V 3149 2591
V 3380 2591 V 3592 2591 V 3807 2591 V 391 2594 3419 4
v 389 2707 4 113 v 687 2673 a(Static)f(analyses)p 1570
2707 V 1793 2707 V 1998 2707 V 2236 2707 V 2472 2707
V 2703 2707 V 2924 2707 V 3149 2707 V 1966 w(x)p 3380
2707 V 173 w(x)p 3592 2707 V 3807 2707 V 391 2710 3419
4 v 300 2964 a Fl(T)-9 b(able)35 b(12:)47 b Fm(Minim)m(um)28
b(features)j(required)d(for)i(v)-5 b(arious)30 b(reusable)f(ideas.)300
3190 y(Legend:)300 3303 y(PP)h(-)h(P)m(arametric)g(P)m(olymorphism)300
3416 y(1F)g(-)g(1st-class)g(F)-8 b(unctions)300 3529
y(ON)30 b(-)h(Ov)m(erloading)e(based)h(on)g(Num)m(b)s(er)g(of)g
(argumen)m(ts)300 3642 y(OT)g(-)g(Ov)m(erloading)g(based)g(on)g(T)m(yp)
s(e)g(of)g(argumen)m(ts)300 3755 y(TC)g(-)g(T)m(yp)s(e)g(Classes)300
3868 y(EF)h(-)f(E\013ects)300 3981 y(R)-8 b(T)30 b(-)h(Access)g(to)g
(Represen)m(tation)g(of)g(Th)m(unks)300 4093 y(TT)f(-)g(T)-8
b(uring-complete)30 b(T)m(yp)s(e)g(system)300 4206 y(SE)g(-)g(Abilit)m
(y)f(to)i(Statically)f(rep)s(ort)f(Errors)300 4319 y(LF)h(-)h(Implemen)
m(table)e(as)i(a)g(nativ)m(e)f(Language)i(F)-8 b(eature)2032
5700 y(148)p eop
%%Page: 149 158
149 157 bop 300 91 a Fm(that)36 b(new)g(languages)g(will)d(exhibit)g
(the)j(expressiv)m(e)g(p)s(o)m(w)m(er)g(and)f(extensible)f
(capabilities)g(of)i(C++,)300 279 y(without)29 b(all)h(of)g(its)g(asso)
s(ciated)h(baggage.)300 519 y Fl(4.3.1)105 b(C++)35 b(limitations)300
765 y Fm(The)22 b(C++)f(t)m(yp)s(e)h(system)g(has)g(b)s(een)f(b)s(oth)h
(a)g(blessing)e(and)i(a)g(curse.)38 b(Though)21 b(templates)h(pro)m
(vide)g(b)s(oth)300 952 y(T)-8 b(uring-completeness)20
b(\(enabling)f(meta-programming\))i(and)f(arbitrary-rank)g(parametric)g
(p)s(olymor-)300 1140 y(phism,)28 b(the)j(design)e(of)i(templates)f(in)
g(C++)f(creates)j(man)m(y)e(limitations.)441 1327 y(First)j(among)g
(the)h(limitations)c(with)i(templates)i(is)e(the)h(fact)h(that)g(they)f
(e\013ectiv)m(ely)h(exist)f(\\out-)300 1515 y(side")e(the)h(t)m(yp)s(e)
h(system)f(of)g(the)g(language.)46 b(The)31 b(C++)g(t)m(yp)s(e)h
(system)g(is)f(e\013ectiv)m(ely)i(monomorphic;)300 1702
y(templates)27 b(e\013ectiv)m(ely)g(w)m(ork)g(as)f(macros)h(to)h
(create)g(m)m(ultiple)c(instances)i(of)g(monomorphic)f(functions)300
1890 y(and)36 b(classes)h(based)g(on)g(a)g(single)f(piece)h(of)g(co)s
(okie-cutter)h(co)s(de.)61 b(As)36 b(a)i(result,)g(one)f(cannot)g
(create)300 2077 y(run-time)30 b(v)-5 b(ariables)30 b(with)g(p)s
(olymorphic)f(t)m(yp)s(es.)44 b(As)31 b(describ)s(ed)f(in)g(Section)h
(2.5.3,)j(this)c(means)h(that)300 2264 y(some)g(v)m(ery)g(simple)d
(examples)i(in)m(v)m(olving)f(p)s(olymorphic)e(data)k(t)m(yp)s(es,)g
(suc)m(h)f(as)443 2527 y Fk(--)47 b(Haskell)f(code:)h(a)g(list)g(of)g
(polymorphic)e(functions)443 2714 y(some_list_fxns)f(::)j([)h([a])f(->)
g([a])g(])443 2901 y(some_list_fxns)d(=)k([)f(tail,)f(init)h(])300
3164 y Fm(cannot)28 b(b)s(e)e(realized)g(in)g(C++.)39
b(What)27 b(is)g(p)s(erhaps)e(most)i(surprising)d(is)i(that)h(this)f
(limitation|whic)m(h)300 3351 y(on)e(its)f(face)i(app)s(ears)e(to)i(b)s
(e)f(crippling|has)c(b)s(een)j(only)g(a)i(minor)d(anno)m(y)m(ance.)40
b(F)-8 b(or)25 b(the)f(v)-5 b(ast)25 b(ma)5 b(jorit)m(y)300
3538 y(of)26 b(programs)g(w)m(e)h(ha)m(v)m(e)g(encoun)m(tered,)h(the)e
(\\macro)h(approac)m(h")g(to)g(represen)m(ting)f(p)s(olymorphism)c(has)
300 3726 y(b)s(een)30 b(su\016cien)m(t.)441 3913 y(A)24
b(related)g(limitation)e(in)h(the)h(C++)f(t)m(yp)s(e)i(system)f(is)f
(the)h(lac)m(k)h(of)f(return-t)m(yp)s(e)g(deduction)f(or)h(t)m(yp)s(e)
300 4101 y(inference.)39 b(This)25 b(lac)m(k)j(necessitates)g(our)f
Fk(Sig)p Fm(s)f(in)g(F)m(C++;)i(though)f Fk(Sig)p Fm(s)f(accomplish)g
(what)h(is)f(neces-)300 4288 y(sary)-8 b(,)26 b(it)d(is)g(anno)m(ying)g
(and)h(p)s(oten)m(tially)e(error-prone)h(to)i(ha)m(v)m(e)g(to)f(add)g
(those)g(t)m(yp)s(e)g(annotations)g(man)m(u-)300 4476
y(ally)-8 b(.)39 b(F)-8 b(ortunately)g(,)28 b(this)d(limitation)f(of)i
(C++)g(is)f(w)m(ell-ac)m(kno)m(wledged.)39 b(As)27 b(a)f(result,)g(the)
h(Bo)s(ost)g(C++)300 4663 y(library)c(comm)m(unit)m(y)i(has)g(created)h
(an)f(\\ad-ho)s(c)g(standard")g(v)m(ersion)g(of)g(our)g
Fk(Sig)p Fm(s,)g(called)f Fk(result_of)p Fm(,)300 4851
y(to)38 b(deal)g(with)e(this)h(issue)f(in)h(the)h(short)f(term)h([65)q
(].)63 b(F)-8 b(uture)38 b(v)m(ersions)f(of)h(C++)e(will)g(undoubtedly)
300 5038 y(ha)m(v)m(e)d(some)g(kind)d(of)j Fk(typeof)d
Fm(op)s(erator,)j(so)g(that)f(one)h(ma)m(y)f(just)g(sa)m(y)h
Fk(typeof\(an_expression\))26 b Fm(to)300 5225 y(ha)m(v)m(e)32
b(the)e(t)m(yp)s(e)h(deduced)e(automatically)-8 b(.)2032
5700 y(149)p eop
%%Page: 150 159
150 158 bop 441 91 a Fm(One)32 b(minor)f(limitation)f(that)j(also)g
(relates)g(to)g(the)f(t)m(yp)s(e)h(system)g(deals)f(with)f(the)h(arit)m
(y)h(of)g(func-)300 279 y(tions)e(and)g(templates.)45
b(C++,)31 b(lik)m(e)g(man)m(y)h(languages,)g(allo)m(ws)f(functions)g
(\(and)g(templates\))h(to)h(ha)m(v)m(e)300 466 y(m)m(ultiple)39
b(argumen)m(ts.)72 b(\(Compare)41 b(this)f(to)i(languages)f(lik)m(e)f
(Hask)m(ell,)k(where)c(ev)m(ery)i(function)d(has)300
654 y(exactly)31 b(one)f(argumen)m(t,)h(and)f(a)g(\\t)m(w)m(o-argumen)m
(t)j(function")c(is)h(actually)f(a)i(one-argumen)m(t)g(function)300
841 y(that)24 b(returns)e(another)h(one-argumen)m(t)h(function.\))37
b(As)23 b(a)h(result,)g(one)f(m)m(ust)g(explicitly)e(write)h(separate)
300 1028 y(classes)30 b(or)g(function)f(o)m(v)m(erloads)i(to)g(deal)e
(with)g(m)m(ultiple)f(arities.)40 b(Witnesses)29 b(to)i(this)e(ab)s
(ound)g(in)f(our)300 1216 y(libraries;)37 b(see)h(for)e(example)h(the)g
Fk(Fun)p Fi(N)50 b Fm(indirect)35 b(functoids)h(in)f(F)m(C++)i(or)g
(the)g Fk(FUN)p Fi(N)50 b Fm(functors)36 b(in)300 1403
y(LC++.)47 b(Since)32 b(a)i(di\013eren)m(t)e(function)g(\(or)h(class,)h
(or)f(template\))g(m)m(ust)g(b)s(e)g(written)f(for)g(eac)m(h)i(desired)
300 1591 y Fi(N)p Fm(,)39 b(this)e(creates)j(a)f(\014xed)g(b)s(ound)d
(on)j(the)g(n)m(um)m(b)s(er)e(of)i(argumen)m(ts)g(supp)s(orted)e(b)m(y)
i(the)g(library)-8 b(.)64 b(In)300 1778 y(b)s(oth)36
b(F)m(C++)g(and)g(LC++,)i(w)m(e)f(ha)m(v)m(e)h(pro)m(vided)d(eac)m(h)j
(suc)m(h)e(en)m(tit)m(y)h(up)f(to)h(arit)m(y)g(3,)i(whic)m(h)c(is)h
(large)300 1966 y(enough)h(for)g(most)g(programs,)i(but)e(creates)h(ma)
5 b(jor)37 b(problems)f(for)h(programs)g(whic)m(h)f(need)g(to)i(deal)
300 2153 y(with)29 b(higher-arit)m(y)h(en)m(tities.)441
2340 y(It)f(should)f(b)s(e)g(noted)i(that)g(there)f(is)f(no)h(w)m(a)m
(y)i(to)f(use)f(template)g(meta-programming)g(to)h(generate)300
2528 y(functions)23 b(with)g(arbitrary)g(arities.)38
b(It)24 b(is)g(p)s(ossible)e(to)j(use)f(a)h(com)m(bination)e(of)i(the)f
(C++)g(prepro)s(cessor)300 2715 y(and)30 b(template)h
(meta-programming,)f(so)h(that)g(one)f(can)h(c)m(hange)h(the)e(upp)s
(er)f(limit)f(just)i(b)m(y)g(sa)m(ying)443 2978 y Fk(#define)46
b(MAX_ARITY)f(10)300 3240 y Fm(Indeed,)39 b(this)e(approac)m(h)i(is)e
(used)g(b)m(y)h(some)h(of)f(the)g(Bo)s(ost)h(libraries.)62
b(Ho)m(w)m(ev)m(er)40 b(this)d(strategy)i(has)300 3427
y(w)m(eaknesses)g(as)f(w)m(ell:)55 b(it)37 b(requires)g(main)m(taining)
f(some)i(truly)f(a)m(wful-lo)s(oking)f(co)s(de)i(in)f(the)h(library)-8
b(,)300 3615 y(and)30 b(it)g(can)g(also)h(signi\014can)m(tly)d
(lengthen)i(compile-times.)441 3802 y(The)23 b(lac)m(k)i(of)e(a)h(true)
g(lam)m(b)s(da)f(in)f(C++)h(is)f(an)i(ob)m(vious)f(imp)s(edimen)m(t)e
(to)k(functional)d(programming.)300 3989 y(V)-8 b(arious)30
b(lam)m(b)s(da)f(libraries)f(address)h(this)h(w)m(eakness,)h(but)f(as)g
(describ)s(ed)f(in)g(Section)h(2.3.1,)j(all)c(C++)300
4177 y(lam)m(b)s(da)20 b(libraries)f(ha)m(v)m(e)j(imp)s(ortan)m(t)f
(limitations.)35 b(A)22 b(language)g(that)g(seamlessly)e(supp)s(orts)g
(functional)300 4364 y(programming)29 b(needs)h(to)h(ha)m(v)m(e)h(a)f
(nativ)m(e)f(lam)m(b)s(da)g(mec)m(hanism.)441 4552 y(C++)24
b(has)g(a)h(great)g(man)m(y)g(op)s(erators,)h(most)f(of)g(whic)m(h)e
(are)i(o)m(v)m(erloadable.)39 b(Nonetheless,)26 b(it)e(w)m(ould)300
4739 y(b)s(e)34 b(nice)f(if)h(C++)f(supp)s(orted)f(user-de\014ned)h(op)
s(erators.)52 b(When)34 b(creating)h(our)f(lam)m(b)s(da)f(and)g(monad)
300 4927 y(syn)m(tax)24 b(extensions,)g(only)f(a)h(limited)d(n)m(um)m
(b)s(er)h(of)h(c)m(hoices)h(w)m(ere)g(a)m(v)-5 b(ailable)23
b(based)g(on)g(the)g(o)m(v)m(erloadable)300 5114 y(op)s(erators.)39
b(Despite)24 b(the)g(limitations)d(C++)i(has)h(on)f(o)m(v)m(erloading)h
(op)s(erators,)i(w)m(e)e(note)h(that)f(the)g(non-)300
5301 y(in\014x)f(binary)g(op)s(erators,)k(namely)d Fk(operator\(\))e
Fm(and)j Fk(operator[])p Fm(,)e(w)m(ere)j(v)m(ery)f(useful.)37
b(A)25 b(n)m(um)m(b)s(er)f(of)2032 5700 y(150)p eop
%%Page: 151 160
151 159 bop 300 91 a Fm(languages)25 b(supp)s(ort)e(the)j(de\014nition)
c(of)j(arbitrary)f(in\014x)f(op)s(erators,)k(but)d(\\brac)m(k)m(eting")
i(op)s(erators)g(are)300 279 y(also)k(useful)f(to)i(ha)m(v)m(e)h(at)f
(one's)g(disp)s(osal)c(when)j(designing)e(syn)m(tactic)k(extensions)e
(within)d(a)k(library)-8 b(.)441 466 y(Though)32 b(the)i(C++)e(t)m(yp)s
(e)h(system)g(is)g(T)-8 b(uring-complete)32 b(\(thanks)h(to)h
(templates\),)g(C++)f(is)f(nev-)300 654 y(ertheless)44
b(a)h(p)s(o)s(or)f(language)g(for)h(meta-programming.)83
b(C++)43 b(meta-programs)j(are)f(di\016cult)d(to)300
841 y(write,)32 b(more)h(di\016cult)d(to)j(read,)g(and)f(often)h(slo)m
(w)f(do)m(wn)g(compile-times)f(considerably)-8 b(.)46
b(The)31 b(abilit)m(y)300 1028 y(to)36 b(do)f(meta-programming)h(has)f
(b)s(een)f(indisp)s(ensable)d(for)k(v)-5 b(arious)34
b(asp)s(ects)i(of)f(our)g(w)m(ork,)i(but)e(the)300 1216
y(meta-programming)26 b(facilit)m(y)g(pro)m(vided)e(b)m(y)j(C++)e
(discourages)h(programmers)f(from)h(using)f(it)h(unless)300
1403 y(absolutely)j(necessary)-8 b(.)441 1591 y(A)26
b(related)g(problem)e(is)h(that)i(of)f(diagnosing)e(errors)h(in)g
(template)h(meta-programs.)40 b(There)26 b(are)g(no)300
1778 y(go)s(o)s(d)c(to)s(ols)f(to)i(help)d(debug)h(C++)g(template)h
(meta-programs.)39 b(F)-8 b(urthermore,)24 b(ev)m(en)e(after)g(a)h
(template)300 1966 y(meta-program)30 b(is)d(debugged)i(and)f(made)g(a)m
(v)-5 b(ailable)28 b(within)e(a)j(library)-8 b(,)28 b(it)g(is)f(hard)h
(to)h(get)h(reasonable)300 2153 y(diagnostic)j(error)h(messages)h(when)
e(clien)m(ts)h(try)g(to)g(instan)m(tiate)h(templates)f(with)f(the)h
(wrong)g(t)m(yp)s(es.)300 2340 y(Though)27 b(p)s(o)s(or)f(diagnostic)h
(messages)i(in)d(the)i(face)h(of)f(t)m(yp)s(e)f(errors)h(are)g(common)g
(to)g(man)m(y)g(languages)300 2528 y(with)e(complicated)g(t)m(yp)s(e)i
(systems,)g(in)d(C++)h(the)i(only)e(w)m(a)m(y)i(to)f
(\(meta-\)programmatically)h(generate)300 2715 y(error)33
b(messages)i(at)g(compile-time)e(is)f(to)j(hijac)m(k)e(the)h(existing)f
(compiler)g(diagnostics.)50 b(As)34 b(a)g(result,)300
2903 y(when)f(it)h(comes)g(to)h(error)f(messages,)i(library)c(clien)m
(ts)h(often)h(cannot)h(b)s(e)f(shielded)d(from)j(the)g(details)300
3090 y(going)44 b(on)f(\\under)f(the)i(ho)s(o)s(d".)79
b(Both)45 b(this)d(problem)g(and)h(the)g(one)h(describ)s(ed)e(in)g(the)
h(previous)300 3278 y(paragraph)h(stem)h(from)g(the)g(fact)g(that)h
(template)f(meta-programming)g(in)e(C++)h(w)m(as)h(largely)g(a)300
3465 y(historical)32 b(acciden)m(t.)50 b(Man)m(y)34 b(problems)d(could)
i(b)s(e)f(solv)m(ed)i(w)m(ere)f(C++)g(templates)g(redesigned)f(from)300
3653 y(scratc)m(h,)c(but)e(giv)m(en)g(the)g(existing)f(design)g
(enshrined)f(in)h(the)h(language)g(standard,)h(it)f(is)f(unlik)m(ely)e
(that)300 3840 y(meta-programming)30 b(facilities)f(will)f
(signi\014can)m(tly)g(impro)m(v)m(e)i(in)f(the)i(foreseeable)g(future.)
300 4080 y Fl(4.3.2)105 b(Advice)36 b(to)f(language)g(designers)300
4326 y Fm(Our)28 b(exp)s(erience)g(extending)g(C++)g(to)i(supp)s(ort)d
(functional)g(and)h(logic)h(programming)f(has)g(pro)m(vided)300
4514 y(some)g(insigh)m(ts)e(in)m(to)h(the)h(design)e(of)i(extensible)f
(languages.)40 b(W)-8 b(e)28 b(summarize)f(some)h(of)f(what)h(w)m(e)g
(ha)m(v)m(e)300 4701 y(learned)h(and)h(mak)m(e)i(suggestions)e(for)g
(ho)m(w)g(an)h(ideal)e(extensible)g(language)i(should)d(b)s(e)i
(designed.)441 4888 y(F)-8 b(or)33 b(statically-t)m(yp)s(ed)e
(languages,)i(an)e(expressiv)m(e)h(nativ)m(e)g(t)m(yp)s(e)g(system)f
(pro)m(vides)g(a)h(foundation)300 5076 y(on)21 b(whic)m(h)f(to)i
(build.)35 b(Bounded)20 b(p)s(olymorphism|b)s(oth)d(parametric)k(and)f
(existen)m(tial|are)i(necessary)300 5263 y(to)28 b(realize)e(a)h(v)-5
b(ariet)m(y)27 b(of)g(\015exible)e(designs)h(for)g(v)-5
b(arious)26 b(applications.)38 b(P)m(olymorphic)25 b(t)m(yp)s(es)i
(should)e(b)s(e)2032 5700 y(151)p eop
%%Page: 152 161
152 160 bop 300 91 a Fm(expressible)22 b(directly)g(within)f(the)j(t)m
(yp)s(e)g(system)g(\(as)g(opp)s(osed)f(to)i(C++,)f(where)f(templates)h
(e\013ectiv)m(ely)300 279 y(b)s(eha)m(v)m(e)31 b(as)g(macros)f(for)h
(de\014ning)d(sets)j(of)f(monomorphic)f(t)m(yp)s(es\))i(to)g(obtain)f
(the)h(most)f(\015exibilit)m(y)-8 b(.)441 466 y(An)31
b(extensible)e(language)j(should)d(pro)m(vide)h(a)h(nativ)m(e)g(lam)m
(b)s(da)f(facilit)m(y)-8 b(.)42 b(Lam)m(b)s(da)31 b(is)f(essen)m(tial)g
(to)300 654 y(functional)j(programming,)i(and)f(has)h(great)h(utilit)m
(y)d(in)g(a)j(v)-5 b(ariet)m(y)35 b(of)g(other)g(con)m(texts)h(as)f(w)m
(ell.)53 b(Our)300 841 y(exp)s(erience)21 b(sho)m(ws)g(that)h(lam)m(b)s
(da)f(is)f(extremely)i(di\016cult)d(to)k(mimic)c(w)m(ell)i(via)g(a)h
(library)-8 b(.)36 b(F)-8 b(urthermore,)300 1028 y(compilers)35
b(are)i(more)g(lik)m(ely)f(to)h(optimize)f(a)h(nativ)m(e)h(lam)m(b)s
(da,)f(and)f(p)s(erformance)g(is)g(an)h(imp)s(ortan)m(t)300
1216 y(consideration)29 b(for)h(suc)m(h)h(a)f(useful)f(feature.)441
1403 y(Currying)h(is)i(useful,)g(b)s(oth)g(in)f(its)i(implicit)c(and)j
(explicit)g(forms)g(\(as)h(de\014ned)f(in)f(Section)i(4.1.2\).)300
1591 y(Some)38 b(languages)g(do)f(pro)m(vide)g(implicit)e(currying)h
(\\for)h(free")i(\(b)m(y)f(virtue)e(of)i(all)f(functions)f(taking)300
1778 y(a)i(single)f(argumen)m(t\).)64 b(W)-8 b(e)40 b(think)c(that)j
(an)f(extensible)e(language)j(should)d(pro)m(vide)h(b)s(oth)g(forms)h
(as)300 1966 y(a)33 b(nativ)m(e)f(feature.)47 b(Though)31
b(w)m(e)h(ha)m(v)m(e)i(demonstrated)e(ho)m(w)g(currying)f(can)h(b)s(e)g
(implemen)m(ted)e(within)300 2153 y(libraries,)37 b(pro)m(viding)f(it)i
(as)g(a)h(nativ)m(e)f(language)g(feature)h(is)e(relativ)m(ely)g(lo)m
(w-cost)i(for)f(the)h(language)300 2340 y(implemen)m(ter)34
b(\(curried)h(function)g(calls)g(can)h(easily)f(b)s(e)g(rewritten)g(as)
h(lam)m(b)s(das\))f(and)g(ma)m(y)i(pro)m(vide)300 2528
y(more)31 b(opp)s(ortunities)c(for)k(optimizations)e(within)e(the)k
(nativ)m(e)g(language)g(compiler.)441 2715 y(Though)24
b(w)m(e)h(ha)m(v)m(e)h(utilized)d(ad-ho)s(c)i(o)m(v)m(erloading)f
(throughout)h(our)f(libraries,)f(w)m(e)j(hesitate)f(to)g(rec-)300
2903 y(ommend)i(this)f(feature)i(for)f(extensible)g(languages.)40
b(Ad-ho)s(c)27 b(o)m(v)m(erloading)h(pro)m(vides)e(great)j(p)s(o)m(w)m
(er)e(for)300 3090 y(library)k(implemen)m(ters,)j(but)f(it)g(comes)i
(with)d(a)j(trade-o\013.)52 b(Ad-ho)s(c)33 b(o)m(v)m(erloading)h(tends)
g(to)g(in)m(teract)300 3278 y(with)e(other)h(language)h(features;)h
(most)e(notably)f(it)h(complicates)g(a)h(language's)f(name-lo)s(okup)f
(rules)300 3465 y(and)38 b(it)g(can)h(easily)f(lead)g(to)i(subtle)d(am)
m(biguities.)64 b(W)-8 b(e)40 b(think)d(that)j(a)f(com)m(bination)f(of)
h(more)f(con-)300 3653 y(strained)30 b(mec)m(hanisms,)h(suc)m(h)g(as)h
(t)m(yp)s(e)g(classes)f(\(whic)m(h)f(enable)h(a)h(single)e(function)g
(to)i(b)s(e)f(applied)e(to)300 3840 y(di\013eren)m(t)i(t)m(yp)s(es)g
(of)g(argumen)m(ts\))h(and)f(namespaces)g(\(whic)m(h)g(enable)f(a)i
(function)e(name)h(to)h(b)s(e)f(reused)300 4027 y(with)22
b(a)i(di\013eren)m(t)e(meaning)h(in)f(another)h(mo)s(dule/con)m
(text\),)j(is)d(lik)m(ely)f(to)i(pro)m(vide)e(su\016cien)m(t)h
(\015exibilit)m(y)300 4215 y(to)31 b(library)d(designers,)h(all)h(with)
f(far)h(less)g(complexit)m(y)-8 b(.)441 4402 y(A)23 b(related)f(topic)h
(in)m(v)m(olv)m(es)g(op)s(erators.)38 b(Though)22 b(the)g(previous)g
(paragraph)g(do)s(es)g(not)h(condone)g(ad-)300 4590 y(ho)s(c)28
b(o)m(v)m(erloading,)i(w)m(e)f(do)f(think)g(that)h(user-de\014nable)e
(op)s(erators)h(are)h(extremely)g(useful.)39 b(Op)s(erators)300
4777 y(enable)30 b(library)e(authors)i(to)h(exp)s(ort)f(functionalit)m
(y)f(with)g(syn)m(tactic)j(concision,)d(and)h(concision)g(is)f(an)300
4965 y(imp)s(ortan)m(t)23 b(design)g(goal)h(for)f(creators)i(of)f(b)s
(oth)f(languages)h(and)f(libraries.)36 b(Built-in)21
b(op)s(erators)j(should)300 5152 y(b)s(e)37 b(able)g(to)i(b)s(e)e
(rede\014ned)f(\(in)h(other)h(mo)s(dules/namespaces)f(of)h(course,)i
(to)e(a)m(v)m(oid)h(con\015icts\),)h(and)300 5339 y(new)30
b(op)s(erators)g(should)f(b)s(e)h(de\014nable)e(just)i(as)h(new)f
(function)f(names)h(are.)2032 5700 y(152)p eop
%%Page: 153 162
153 161 bop 441 91 a Fm(In\014x)40 b(function)g(syn)m(tax)h(can)g(b)s
(e)g(pro)m(vided)e(in)h(a)h(library)e(\(giv)m(en)i(suitable)f(other)h
(features,)j(al-)300 279 y(ready)33 b(describ)s(ed\),)g(but)g(w)m(e)h
(think)e(that)j(in\014x)c(is)i(b)s(est)g(implemen)m(ted)f(nativ)m(ely)
-8 b(.)51 b(As)33 b(with)f(currying,)300 466 y(transforming)26
b(in\014x)f(syn)m(tax)j(in)m(to)f(the)g(corresp)s(onding)e(pre\014x)i
(function)e(call)i(is)f(a)i(trivial)d(transforma-)300
654 y(tion)35 b(for)h(a)g(compiler,)g(and)f(doing)f(the)i
(transformation)f(nativ)m(ely)h(ma)m(y)g(create)h(more)f(optimization)
300 841 y(opp)s(ortunities.)441 1028 y(Though)25 b Fk(call/cc)f
Fm(and)i(uni\014able)d(logic)j(v)-5 b(ariables)25 b(w)m(ould)g(b)s(e)g
(useful)g(features)h(for)g(implemen)m(ting)300 1216 y(logic)35
b(programming,)i(w)m(e)f(do)f(not)h(see)h(them)e(as)h(required)e(nativ)
m(e)i(features)g(in)f(an)h(ideal)e(extensible)300 1403
y(language.)66 b(Other)38 b(researc)m(hers)h(exp)s(erience)f(suggests)i
(that)f Fk(call/cc)e Fm(cannot)i(easily)f(b)s(e)g(\\grafted)300
1591 y(on")28 b(to)g(an)g(existing)e(language)i(in)f(an)g(e\016cien)m
(t)h(manner.)39 b(Since)27 b(this)f(mec)m(hanism)h(is)g(seldomly)f
(useful)300 1778 y(an)m(yw)m(a)m(y|esp)s(ecially)k(in)f(ligh)m(t)h(of)g
(our)g(demonstration)g(that)h(lazy)g(lists)e(pro)m(vide)g(a)i(go)s(o)s
(d)g(alternativ)m(e)300 1966 y(for)i(pro)s(cessing)f(logic)i(query)f
(results|w)m(e)f(don't)i(think)e(it)h(merits)f(b)s(eing)g(lab)s(elled)f
(an)j(indisp)s(osable)300 2153 y(feature.)41 b(Similarly)-8
b(,)27 b(uni\014able)h(logic)i(v)-5 b(ariables)29 b(can)i(b)s(e)f(pro)m
(vided)f(adequately)h(b)m(y)h(a)f(library)-8 b(.)441
2340 y(An)43 b(e\016cien)m(t)h(meta-programming)g(facilit)m(y)e(of)i
(some)g(sort)g(is)e(essen)m(tial.)80 b(F)-8 b(or)44 b(a)g(language)g
(to)300 2528 y(b)s(e)h(truly)f(extensible,)k(it)e(should)d(b)s(e)i(p)s
(ossible)e(to)j(programmatically)f(analyze)h(and)f(manipulate)300
2715 y(co)s(de)36 b(at)g(compile-time,)g(and)f(to)h(issue)f
(diagnostics)f(based)i(on)f(programmed)g(analyses.)56
b(T)m(ypically)300 2903 y(meta-programming)36 b(is)e(pro)m(vided)h(via)
g(a)h(macro)g(system;)j(C++)c(is)f(relativ)m(ely)h(unique)f(in)g(that)j
(the)300 3090 y(t)m(yp)s(e)i(system)g(itself)f(is)g(a)h
(pure-functional)e(T)-8 b(uring-complete)38 b(language,)k(with)37
b(t)m(yp)s(es)i(as)h(compile-)300 3278 y(time)i(v)-5
b(alues)42 b(and)h(templates)g(as)f(compile-time)g(functions.)76
b(Despite)43 b(man)m(y)g(shortcomings)f(with)300 3465
y(C++'s)21 b(\(lac)m(k)j(of)7 b(\))22 b(design)g(for)g
(meta-programming,)i(w)m(e)f(do)f(think)f(that)i(\\computing)f(within)d
(the)k(t)m(yp)s(e)300 3653 y(system")28 b(is)e(an)g(in)m(teresting)h
(and)f(tenable)h(approac)m(h.)40 b(It)27 b(w)m(ould)e(b)s(e)i(in)m
(teresting)f(to)i(see)f(an)g(extensible)300 3840 y(language)e(that)g
(pro)m(vided)f(a)h(w)m(ell-designed)e(T)-8 b(uring-complete)24
b(t)m(yp)s(e)h(system,)h(where)e(meta-programs)300 4027
y(w)m(ere)29 b(more)h(straigh)m(tforw)m(ard)e(to)i(read)f(and)f(write,)
h(and)f(where)h(there)g(w)m(as)h(a)f(nativ)m(e)g(facilit)m(y)f(to)i
(issue)300 4215 y(compile-time)f(error)h(diagnostics)g(from)g(within)e
(a)j(meta-program.)441 4402 y(\(A)g(closer)g(lo)s(ok)f(at)i(T)-8
b(able)30 b(12)i(helps)d(summarizes)g(some)j(of)e(our)h(advice.)41
b(While)30 b(w)m(e)h(recommend)300 4590 y(that)h(a)g(n)m(um)m(b)s(er)f
(of)h(the)g(more)g(\\syn)m(tactic")h(features)f(b)s(e)f(implemen)m(ted)
g(nativ)m(ely)-8 b(,)32 b(one)g(can)g(see)g(that)300
4777 y(three)27 b(nativ)m(e)h(features|parametric)f(p)s(olymorphism,)d
(\014rst)j(class)g(functions,)f(and)h(side-e\013ects|are)300
4965 y(su\016cien)m(t)j(to)h(implemen)m(t)e(most)i(of)f(our)g(other)h
(reusable)e(ideas.\))441 5152 y(Language)42 b(design)e(is)g(an)h
(exercise)g(in)e(trade-o\013s,)45 b(and)c(language)g(designers)f(m)m
(ust)g(exercise)i(a)300 5339 y(go)s(o)s(d)29 b(engineering)f(aesthetic)
i(to)g(succeed.)41 b(W)-8 b(e)30 b(ha)m(v)m(e)g(outlined)e(our)g
(recommendations)h(for)g(an)g(ideal)2032 5700 y(153)p
eop
%%Page: 154 163
154 162 bop 300 91 a Fm(extensible)22 b(language)h(based)g(on)g(our)f
(exp)s(erience)g(extending)h(C++,)g(so)h(that)f(this)f(w)m(ork)h(migh)m
(t)g(inform)300 279 y(future)29 b(language)i(designers.)2032
5700 y(154)p eop
%%Page: 155 164
155 163 bop 1688 91 a Fn(CHAPTER)45 b(V)1534 588 y(RELA)-11
b(TED)45 b(W)l(ORK)300 1025 y Fm(Muc)m(h)28 b(has)g(b)s(een)f(written)h
(ab)s(out)f(m)m(ulti-paradigm)f(programming)h(within)f(a)i(single)f
(language.)40 b(Here)300 1212 y(w)m(e)31 b(summarize)e(some)i(of)f(the)
h(most)g(relev)-5 b(an)m(t)30 b(related)h(w)m(ork,)f(brok)m(en)h(in)m
(to)f(subsections)f(b)m(y)i(topic.)300 1489 y Fj(5.1)140
b(Work)48 b(adding)f(functional)g(c)-7 b(omp)g(onents)47
b(to)i(obje)-7 b(ct-oriente)g(d)625 1638 y(languages)300
1885 y Fm(Man)m(y)21 b(researc)m(hers)g(ha)m(v)m(e)g(w)m(ork)m(ed)g(on)
f(adding)f(functional)g(paradigm)g(comp)s(onen)m(ts)h(to)h(ob)5
b(ject-orien)m(ted)300 2072 y(languages,)34 b(esp)s(ecially)d(C++.)47
b(Their)31 b(w)m(ork)i(can)g(b)s(e)f(roughly)f(divided)f(in)m(to)j
(three)g(categories:)47 b(rep-)300 2259 y(resen)m(ting)30
b(functions,)f(lam)m(b)s(da,)h(and)g(applications)e(of)j(functional)d
(tec)m(hniques.)300 2500 y Fl(5.1.1)105 b(Represen)m(ting)36
b(functions)g(in)f(C++)300 2746 y Fm(Represen)m(ting)41
b(functions)f(as)i(\014rst-class)f(ob)5 b(jects)42 b(in)e(C++)h(has)g
(b)s(een)g(a)g(p)s(opular)f(researc)m(h)i(topic.)300
2933 y(L\177)-45 b(aufer's)22 b(pap)s(er)f([45)q(])i(con)m(tains)f(a)h
(go)s(o)s(d)f(surv)m(ey)g(of)g(the)h(1995)h(state)f(of)g(the)f(art)h
(regarding)e(functionally-)300 3121 y(inspired)27 b(C++)j(constructs.)
41 b(Here)31 b(w)m(e)g(will)d(only)i(review)f(more)i(recen)m(t)h(or)e
(closely)g(related)h(pieces)f(of)300 3308 y(w)m(ork.)441
3495 y(Dami)24 b([17)q(])h(implemen)m(ts)e(currying)f(in)h(C/C++/Ob)5
b(jectiv)m(e-C)24 b(and)g(sho)m(ws)g(the)g(utilit)m(y)f(in)g(applica-)
300 3683 y(tions.)39 b(His)27 b(implemen)m(tation)f(requires)g(mo)s
(di\014cation)g(of)i(the)g(compiler,)f(though.)39 b(The)27
b(utilit)m(y)f(comes)300 3870 y(mostly)33 b(in)f(C;)i(in)e(C++,)h(more)
h(sophisticated)f(approac)m(hes)h(\(suc)m(h)f(as)h(ours\))f(can)h(ac)m
(hiev)m(e)h(the)f(same)300 4058 y(goals)d(and)f(more.)441
4245 y(Kisely)m(o)m(v)47 b([42)q(])g(implemen)m(ts)f(some)h(macros)h
(that)g(allo)m(w)e(for)h(the)g(creation)h(of)f(simple)e(mo)s(c)m(k-)300
4433 y(closures)39 b(in)g(C++.)69 b(These)40 b(merely)g(pro)m(vide)f
(syn)m(tactic)i(sugar)f(for)g(C++'s)f(in)m(trinsic)f(supp)s(ort)g(for)
300 4620 y(basic)g(function-ob)5 b(jects.)63 b(F)m(C++'s)38
b(lam)m(b)s(da)f(uses)h(expression)f(templates)h(to)h(pro)m(vide)e(suc)
m(h)h(sugar)300 4807 y(without)29 b(resorting)h(to)h(macros.)441
4995 y(The)24 b(C++)g(Standard)g(T)-8 b(emplate)25 b(Library)e(\(STL\))
h([59)r(])h(includes)d(a)j(library)e(called)h Fa(<functional>)p
Fm(.)300 5182 y(It)33 b(supp)s(orts)e(a)i(v)m(ery)g(limited)e(set)i(of)
g(op)s(erations)g(for)f(creating)h(and)g(comp)s(osing)f(functoids)f
(that)j(are)300 5370 y(usable)42 b(\(in)h(monomorphic)f(form\))i(with)e
(algorithms)g(from)h(the)h Fa(<algorithm>)39 b Fm(library)-8
b(.)78 b(While)42 b(it)2032 5700 y(155)p eop
%%Page: 156 165
156 164 bop 300 91 a Fm(serv)m(es)31 b(a)f(useful)f(purp)s(ose)f(for)i
(a)h(n)m(um)m(b)s(er)e(of)h(C++)g(tasks,)h(it)e(is)h(inadequate)g(as)g
(a)h(basis)e(for)h(building)300 279 y(higher-order)f(p)s(olymorphic)e
(functoids.)441 466 y(L\177)-45 b(aufer)32 b([45)r(])h(presen)m(ts)f(a)
i(framew)m(ork)e(for)h(supp)s(orting)d(functional)i(programming)f(in)h
(C++.)47 b(His)300 654 y(approac)m(h)23 b(supp)s(orts)e(lazy)j(ev)-5
b(aluation,)24 b(higher-order)d(functions,)j(and)e(binding)e(v)-5
b(ariables)22 b(to)h(di\013eren)m(t)300 841 y(function)31
b(v)-5 b(alues.)47 b(His)32 b(implemen)m(tation)f(do)s(es)h(not)h
(include)d(p)s(olymorphic)g(functions,)i(though,)h(and)300
1028 y(also)28 b(uses)f(an)h(ine\016cien)m(t)f(means)h(for)f(represen)m
(ting)g(function)g(ob)5 b(jects.)40 b(In)27 b(man)m(y)h(w)m(a)m(ys,)i
(our)d(w)m(ork)h(on)300 1216 y(F)m(C++)e(can)h(b)s(e)e(view)m(ed)h(as)h
(an)f(extension)g(to)h(L\177)-45 b(aufer's;)27 b(our)f(framew)m(ork)g
(impro)m(v)m(es)g(on)g(his)f(b)m(y)h(adding)300 1403
y(b)s(oth)i(parametric)g(and)g(subt)m(yp)s(e)g(p)s(olymorphism,)e
(impro)m(ving)h(e\016ciency)-8 b(,)29 b(and)g(con)m(tributing)e(a)i
(large)300 1591 y(functional)k(library)-8 b(.)50 b(L\177)-45
b(aufer)34 b(also)g(examines)g(topics)g(that)h(w)m(e)g(did)d(not)j
(touc)m(h)g(up)s(on)e(in)g(this)g(pap)s(er,)300 1778
y(lik)m(e)21 b(arc)m(hitecture-sp)s(eci\014c)g(mec)m(hanisms)g(for)h
(con)m(v)m(erting)g(higher-order)e(functions)g(in)m(to)i(regular)f(C++)
300 1966 y(functions.)441 2153 y(Alexandrescu's)h(b)s(o)s(ok)f([2)q(])h
(con)m(tains)h(a)g(c)m(hapter)f(on)h(\\generalized)f(functors".)38
b(These)22 b(functors)g(are)300 2340 y(similar)27 b(to)k(our)e
(indirect)f(functoids,)h(except)i(that)f(they)g(do)g(not)g(supp)s(ort)e
(implicit)f(currying)h(or)i(sub-)300 2528 y(t)m(yp)s(e)41
b(p)s(olymorphism.)70 b(In)40 b(another)i(c)m(hapter,)j(Alexandrescu)40
b(also)h(describ)s(es)e(reference-coun)m(ting)300 2715
y(mec)m(hanisms,)49 b(including)42 b(in)m(trusiv)m(e)i(ref-coun)m(ts,)
50 b(lik)m(e)45 b(the)h(ones)g(w)m(e)g(use)f(with)g(F)m(C++'s)g(in)m
(ternal)300 2903 y(reference-coun)m(ted)32 b(p)s(oin)m(ters.)441
3090 y(The)44 b(Bo)s(ost)i(function)d(library)f([28)q(])j(pro)m(vides)e
(function)g(ob)5 b(jects)45 b(similar)d(to)j(F)m(C++)g(indirect)300
3278 y(functoids.)37 b(These)23 b(function)g(ob)5 b(jects)24
b(supp)s(ort)e(subt)m(yp)s(e)g(p)s(olymorphism)e(and)j(reference)h
(parameters,)300 3465 y(and)30 b(are)h(the)f(basis)f(for)h(a)h(prop)s
(osed)e(extension)h(to)h(the)g(C++)e(standard)h(library)-8
b(.)300 3705 y Fl(5.1.2)105 b(Lam)m(b)s(da)300 3951 y
Fm(Here)32 b(w)m(e)f(brie\015y)e(compare)j(our)f(approac)m(h)g(to)h
(implemen)m(ting)d(lam)m(b)s(da)h(to)h(that)h(of)f(the)h(other)f(ma)5
b(jor)300 4139 y(lam)m(b)s(da)35 b(libraries)e(for)i(C++:)51
b(the)36 b(Bo)s(ost)h(Lam)m(b)s(da)e(Library)f(\(BLL\)[35)r(])i(and)g
(F)-10 b(A)m(CT![60)q(].)3578 4106 y Fg(1)3675 4139 y
Fm(\(Note)300 4326 y(that)21 b(Section)g(5.1.3)h(men)m(tions)e(ho)m(w)h
(Ja)m(v)-5 b(a's)22 b(anon)m(ymous)e(inner)f(classes)i(e\013ectiv)m
(ely)g(pro)m(vide)f(\\lam)m(b)s(da")300 4514 y(for)30
b(Ja)m(v)-5 b(a.\))p 300 4655 1440 4 v 404 4709 a Ff(1)438
4741 y Fe(The)35 b(F)-9 b(A)n(CT!)36 b(library)-6 b(,)37
b(lik)n(e)e(F)n(C++,)h(includes)f(features)h(other)e(than)g(lam)n(b)r
(da,)j(e.g.)62 b(functions)35 b(lik)n(e)g Fd(map\(\))g
Fe(and)300 4832 y Fd(foldl\(\))f Fe(as)g(w)n(ell)g(as)g(data)f
(structures)g(for)h(lazy)f(ev)l(aluation.)57 b(BLL,)33
b(on)g(the)g(other)g(hand,)h(is)g(concerned)f(only)g(with)300
4924 y(lam)n(b)r(da.)2032 5700 y Fm(156)p eop
%%Page: 157 166
157 165 bop 450 91 a Fi(5.1.2.1)94 b(Bo)-5 b(ost)35 b(L)-5
b(amb)g(da)34 b(Libr)-5 b(ary)300 337 y Fm(Whereas)32
b(F)m(C++)e(tak)m(es)j(the)e(minimalist)c(approac)m(h,)32
b(BLL)f(tak)m(es)h(the)f(maximal)f(approac)m(h.)43 b(Practi-)300
525 y(cally)33 b(ev)m(ery)h(o)m(v)m(erloadable)f(op)s(erator)h(is)e
(supp)s(orted)g(within)e(lam)m(b)s(da)i(expressions,)h(and)g(the)g
(library)300 712 y(has)d(sp)s(ecial)f(lam)m(b)s(da-expression)g
(constructs)i(whic)m(h)e(mimic)g(the)h(con)m(trol)h(constructs)g(of)g
(C++)e(\(lik)m(e)300 900 y(while)i(lo)s(ops,)i(switc)m(hes,)h
(exception)f(handling,)e(etc\).)50 b(Lam)m(b)s(da)33
b(is)f(implicit)e(rather)j(than)g(explicit;)g(a)300 1087
y(reference)g(to)g(a)g(placeholder)e(v)-5 b(ariables)31
b(\(lik)m(e)h Fk(_1)p Fm(\))g(turns)f(an)h(expression)g(in)m(to)g(a)h
(lam)m(b)s(da)e(on-the-\015y)-8 b(.)300 1275 y(This)24
b(mak)m(es)j(it)e(imp)s(ossible)e(to)j(represen)m(t)g(some)h(anon)m
(ymous)f(functions)e(\(in)m(v)m(olving)h(nested)h(lam)m(b)s(da\))300
1462 y(using)31 b(BLL.)h(Custom)g(error)f(message)j(whic)m(h)d
(diagnose)g(common)i(statically-detectable)g(errors)f(are)300
1649 y(also)e(absen)m(t)h(from)f(BLL.)441 1837 y(Apart)i(from)f(sp)s
(ecial)f(supp)s(ort)f(for)i(function)f(comp)s(osition)h(and)f(explicit)
g(currying)g(\(binding\))f(of)300 2024 y(function)f(argumen)m(ts,)i
(BLL)f(lac)m(ks)h(syn)m(tactic)g(supp)s(ort)e(for)h(other)g(useful)f
(functional)f(constructs)j(lik)m(e)300 2212 y Fk(letrec)21
b Fm(or)i(monadic)f(comprehensions.)37 b(There)22 b(is)g(also)h(no)g
(supp)s(ort)e(for)i(naming)f(the)h(t)m(yp)s(e)g(of)g(lam)m(b)s(da)300
2399 y(expressions)36 b(\(lik)m(e)g(our)h Fk(LEType)p
Fm(\).)59 b(On)36 b(the)h(other)g(hand,)h(when)e(e\013ects)j(are)e
(desired,)g(BLL)g(can)h(b)s(e)300 2587 y(used)c(to)h(describ)s(e)e
(functions)g(with)g(side-e\013ects)i(more)g(gracefully)e(than)h(F)m
(C++.)53 b(Whereas)35 b(F)m(C++)300 2774 y(lam)m(b)s(da)22
b(expressions)g(can)h(only)f(ha)m(v)m(e)j(e\013ects)f(b)m(y)f
(dereferencing)g(p)s(oin)m(ters,)g(BLL)g(lam)m(b)s(da)f(expressions)300
2961 y(can)28 b(directly)e(manipulate)h(ob)5 b(ject)28
b(references)g(and)f(create)j(lam)m(b)s(das)c(whic)m(h)h(tak)m(e)i(m)m
(utable)e(reference)300 3149 y(parameters.)441 3336 y(BLL's)21
b(approac)m(h)f(mak)m(es)h(sense)g(giv)m(en)f(the)h(\\target)h
(audience";)i(the)c(Bo)s(ost)i(libraries)17 b(are)k(designed)300
3524 y(for)30 b(ev)m(eryda)m(y)i(C++)d(programmers.)40
b(These)30 b(are)h(p)s(eople)e(who)h(are)h(familiar)d(with)h(C++)g
(constructs,)300 3711 y(and)42 b(who)g(are)h(hop)s(efully)d(C++-sa)m
(vvy)j(enough)f(to)h(a)m(v)m(oid)g(most)g(of)g(the)g(pitfalls)d(of)j
(an)g(e\013ect-ful)300 3899 y(expression-template)34
b(lam)m(b)s(da)f(library)-8 b(.)50 b(In)33 b(con)m(trast,)k(F)m(C++)d
(is)f(designed)g(to)i(supp)s(ort)e(functional)300 4086
y(programming)23 b(in)h(the)h(st)m(yle)g(of)g(languages)g(lik)m(e)f
(Hask)m(ell.)38 b(A)25 b(n)m(um)m(b)s(er)e(of)i(our)g(users)e(come)j
(from)e(other-)300 4274 y(language)32 b(bac)m(kgrounds,)f(and)g(aren't)
g(to)s(o)h(familiar)d(with)h(the)i(in)m(tricacies)e(of)h(C++.)43
b(Th)m(us)30 b(F)m(C++'s)300 4461 y(lam)m(b)s(da)39 b(is)h(designed)g
(to)h(presen)m(t)g(a)g(simple)d(in)m(terface)j(with)f(syn)m(tax)h(and)f
(constructs)h(familiar)d(to)300 4648 y(functional)29
b(programmers,)h(and)g(to)h(shield)d(users)h(from)h(C++-complexities)f
(as)h(m)m(uc)m(h)h(as)f(p)s(ossible.)450 4888 y Fi(5.1.2.2)94
b(F)-9 b(A)n(CT!)300 5135 y Fm(Lik)m(e)20 b(F)m(C++,)i(F)-10
b(A)m(CT!)21 b(is)e(designed)h(to)h(supp)s(ort)d(pure)h(functional)g
(programming)g(constructs.)38 b(Lam)m(b)s(da)300 5322
y(expressions)i(alw)m(a)m(ys)h(p)s(erform)f(capture)h(\\b)m(y)h(v)-5
b(alue")41 b(and)f(the)i(resulting)d(functions)h(are)h(t)m(ypically)
2032 5700 y(157)p eop
%%Page: 158 167
158 166 bop 300 91 a Fm(e\013ect-free.)59 b(Lik)m(e)35
b(F)m(C++,)i(F)-10 b(A)m(CT!)36 b(has)g(an)f(explicit)f(lam)m(b)s(da)h
(construct;)k(the)d(user)f(can)g(de\014ne)g(his)300 279
y(o)m(wn)23 b(names)g(for)f(placeholder)g(v)-5 b(ariables,)23
b(but)f(con)m(v)m(en)m(tionally)h(names)g(lik)m(e)f Fk(x)h
Fm(and)f Fk(y)h Fm(are)g(used.)38 b(F)-10 b(A)m(CT!)300
466 y(de\014nes)26 b(just)h(one)h(primitiv)m(e)d(con)m(trol)j
(construct)g(in)e(its)g(lam)m(b)s(da)h(sublanguage)f(\(\\)p
Fk(where)p Fm(")h(for)h(if-then-)300 654 y(else\).)40
b(Lik)m(e)27 b(BLL,)g(ho)m(w)m(ev)m(er,)i(F)-10 b(A)m(CT!)27
b(o)m(v)m(erloads)h(man)m(y)f(C++)f(op)s(erators)h(\(lik)m(e)f
Fk(+)p Fm(\))h(for)g(use)f(in)g(lam)m(b)s(da)300 841
y(expressions.)46 b(Th)m(us)32 b(F)-10 b(A)m(CT!'s)33
b(in)m(terface)g(is)f(relativ)m(ely)g(simple)f(and)h(minimal,)e(but)i
(lam)m(b)s(da)g(expres-)300 1028 y(sions)d(are)i(not)g(as)f(visually)e
(distinctiv)m(e)h(as)i(they)f(are)h(in)e(F)m(C++.)441
1216 y(Lik)m(e)34 b(BLL,)f(F)-10 b(A)m(CT!)34 b(con)m(tains)g(no)f
(facilities)f(for)h(manipulating)e(monads,)j(naming)e(the)i(t)m(yp)s
(es)g(of)300 1403 y(lam)m(b)s(das,)29 b(or)i(doing)e(static)i(analyses)
f(and)g(issuing)e(custom)j(error)f(messages.)300 1641
y Fl(5.1.3)105 b(Applications)300 1887 y Fm(Certainly)29
b(a)i(lot)f(has)g(b)s(een)g(written)f(ab)s(out)i(language)f(supp)s(ort)
f(for)h(implemen)m(ting)f(design)g(patterns)300 2074
y(\(e.g.,)38 b([4)q(,)d(13)q(]\),)i(functional)d(tec)m(hniques)h(in)f
(OO)g(programming,)h(etc.)57 b(Some)35 b(of)g(the)h(approac)m(hes)f(in)
300 2262 y(the)c(literature)e(are)i(ev)m(en)g(v)m(ery)g(close)f(in)f
(philosoph)m(y)f(to)k(our)d(w)m(ork.)41 b(F)-8 b(or)31
b(instance:)436 2509 y Fh(\017)46 b Fm(Alexandrescu)35
b([2)q(])h(demonstrates)h(ho)m(w)f(the)g(meta-programming)g
(capabilities)e(of)j(the)f(C++)527 2697 y(language)31
b(can)g(b)s(e)e(used)h(to)h(yield)e(elegan)m(t)i(pattern)g(implemen)m
(tations.)436 2953 y Fh(\017)46 b Fm(K)s(\177)-48 b(uhne's)38
b(dissertation)g(prop)s(oses)g(sev)m(eral)h(patterns)g(inspired)d(b)m
(y)j(functional)e(programming)527 3140 y([44)q(].)436
3397 y Fh(\017)46 b Fm(Using)32 b(functional)f(tec)m(hniques)i
(\(higher-order)e(functions\))h(to)h(implemen)m(t)e(the)i(Observ)m(er)g
(and)527 3584 y(Command)23 b(patterns)g(is)g(common|in)f(fact,)k(ev)m
(en)e(standard)f(practice)g(in)f(Ja)m(v)-5 b(a)25 b(and)d(Smalltalk.)
436 3840 y Fh(\017)46 b Fm(The)31 b(b)s(ene\014ts)f(of)i(p)s
(olymorphic)c(and)j(higher-order)f(functions)g(ha)m(v)m(e)i(often)g(b)s
(een)f(discussed)e(in)527 4028 y(the)i(functional)e(programming)g
(literature)g([62)q(].)441 4275 y(Alexandrescu)e([2])h(o\013ers)f(a)h
(mature)g(C++)e(implemen)m(tation)g(of)i(the)f(Abstract)h(F)-8
b(actory)30 b(pattern.)300 4463 y(His)i(approac)m(h)g(consists)g(of)g
(a)h(generic)f(\(i.e.,)i(p)s(olymorphic\))29 b(Abstract)k(F)-8
b(actory)35 b(class)d(that)g(gets)i(pa-)300 4650 y(rameterized)29
b(statically)g(b)m(y)g(all)g(the)g(p)s(ossible)e(pro)s(ducts.)39
b(It)29 b(is)g(w)m(orth)g(noting)g(that)g(this)g(is)f(the)h(exact)300
4838 y(scenario)34 b(that)g(Baumgartner)g(et)g(al.)50
b([4)q(])34 b(studied.)49 b(Their)32 b(conclusion)g(w)m(as)i(that)g
(meta-ob)5 b(ject)36 b(pro-)300 5025 y(to)s(cols)31 b(should)e(b)s(e)i
(added)f(to)i(OO)e(languages)h(for)g(b)s(etter)g(pattern)h(supp)s(ort.)
40 b(Th)m(us,)31 b(Alexandrescu's)300 5213 y(implemen)m(tation)g(is)h
(a)h(great)h(demonstration)f(of)g(the)g(meta-programming)f
(capabilities)f(of)i(C++|)300 5400 y(the)j(language's)g(abilit)m(y)e
(to)j(p)s(erform)d(template)i(computation)g(on)g(static)g(prop)s
(erties)e(can)i(often)h(b)s(e)2032 5700 y(158)p eop
%%Page: 159 168
159 167 bop 300 91 a Fm(used)30 b(instead)f(of)i(meta-ob)5
b(ject)32 b(proto)s(cols.)441 279 y(G)m(\023)-43 b(eraud)37
b(and)f(Duret-Lutz)i([25)q(])e(o\013er)h(some)g(argumen)m(ts)g(for)g
(redesigning)d(patterns)j(to)g(emplo)m(y)300 466 y(parametric)e(p)s
(olymorphism.)53 b(Th)m(us,)36 b(they)f(prop)s(ose)g(that)h(parametric)
g(p)s(olymorphism)c(b)s(e)i(part)i(of)300 654 y(the)j(\\language")h
(used)e(to)h(sp)s(ecify)e(patterns.)66 b(In)38 b(con)m(trast,)k(our)c
(approac)m(h)h(is)f(to)h(use)f(parametric)300 841 y(p)s(olymorphism)28
b(with)j(t)m(yp)s(e)h(inference)f(in)f(the)i Fi(implementation)42
b Fm(of)32 b(patterns.)45 b(F)-8 b(rom)32 b(an)g(implemen-)300
1028 y(tation)37 b(standp)s(oin)m(t,)f(the)h(G)m(\023)-43
b(eraud)37 b(and)f(Duret-Lutz)h(suggestions)f(are)h(not)f(no)m(v)m(el:)
53 b(they)37 b(ha)m(v)m(e)g(long)300 1216 y(b)s(een)29
b(used)h(in)e(C++)i(design)f(pattern)h(implemen)m(tations.)39
b(F)-8 b(urthermore,)30 b(the)h(examples)e(w)m(e)i(o\013er)f(in)300
1403 y(Section)f(2.4)g(are)h(more)f(adv)-5 b(anced,)29
b(emplo)m(ying)f(t)m(yp)s(e)h(inference)f(and)g(manipulation)e(of)j(p)s
(olymorphic)300 1591 y(functions.)441 1778 y(The)22 b(Pizza)g(language)
g([56)q(])g(in)m(tegrates)h(functional-lik)m(e)d(supp)s(ort)h(to)h(Ja)m
(v)-5 b(a.)39 b(This)20 b(supp)s(ort)g(includes)300 1966
y(higher-order)42 b(functions,)47 b(parametric)c(p)s(olymorphism,)h
(datat)m(yp)s(e)h(de\014nition)c(through)j(patterns,)300
2153 y(and)27 b(more.)40 b(Pizza)29 b(op)s(erates)f(as)g(a)g(language)h
(extension)e(and)g(requires)g(a)h(pre-compiler.)38 b(Supp)s(ort)26
b(for)300 2340 y(parametric)h(p)s(olymorphism)d(in)i(Ja)m(v)-5
b(a)29 b(has)e(b)s(een)f(a)i(v)m(ery)g(activ)m(e)h(researc)m(h)f(topic)
f(\(e.g.,)j([1)q(,)e(8,)g(55)q(,)f(63)q(]\),)300 2528
y(and)37 b(a)h(solution)e(based)h(on)g(GJ)h([8])g(has)f(b)s(een)g
(recen)m(tly)h(adopted)f([7)q(].)62 b(T)m(yp)s(e)37 b(inference)g(is)g
(used)f(in)300 2715 y(GJ.)28 b(Nev)m(ertheless,)g(due)f(to)h(the)f(GJ)h
(translation)e(tec)m(hnique)h(\(erasure\))h(it)f(is)f(not)i(p)s
(ossible)c(to)k(extract)300 2903 y(static)j(t)m(yp)s(e)g(information)d
(nested)j(inside)d(template)i(parameters.)441 3090 y(It)21
b(should)e(b)s(e)i(noted)g(that)g(Ja)m(v)-5 b(a)22 b(inner)e(classes)h
([36)q(])g(are)g(excellen)m(t)h(for)f(implemen)m(ting)d(higher-order)
300 3278 y(functions.)39 b(Inner)28 b(classes)h(can)h(access)g(the)g
(state)g(of)g(their)e(enclosing)h(class,)g(and,)g(th)m(us,)h(can)f(b)s
(e)g(used)300 3465 y(to)j(express)f Fi(closur)-5 b(es)7
b Fm(|automatic)34 b(encapsulations)d(of)g(a)h(function)f(together)i
(with)d(the)i(data)g(it)f(acts)300 3653 y(on.)38 b(Ja)m(v)-5
b(a)25 b(inner)d(classes)i(can)g(b)s(e)g(anon)m(ymous,)h(allo)m(wing)d
(them)i(to)h(express)e(anon)m(ymous)h(functions|a)300
3840 y(capabilit)m(y)32 b(that)h(is)f(not)h(straigh)m(tforw)m(ard)f(to)
i(em)m(ulate)f(in)f(C++.)46 b(Man)m(y)34 b(of)f(our)f(observ)-5
b(ations)32 b(from)300 4027 y(Sections)24 b(2.4.1)j(and)d(2.4.2)i(also)
e(apply)g(to)h(Ja)m(v)-5 b(a.)40 b(In)24 b(fact,)i(the)f(most)g(common)
g(Ja)m(v)-5 b(a)25 b(implemen)m(tations)300 4215 y(of)c(the)f(Command)g
(and)g(Observ)m(er)g(design)f(patterns)i(use)f(inner)f(classes)i(for)f
(the)h(commands/callbac)m(ks.)300 4491 y Fj(5.2)140 b(Work)68
b(on)g(multip)-7 b(ar)g(adigm)67 b(languages)g(with)h(lo)-7
b(gic)68 b(c)-7 b(omp)g(o-)625 4641 y(nents)300 4887
y Fm(There)43 b(has)h(also)g(b)s(een)f(a)h(bit)f(of)h(w)m(ork)g(on)g(m)
m(ultiparadigm)d(languages)j(con)m(taining)f(a)i(logic)e(pro-)300
5074 y(gramming)h(comp)s(onen)m(t)h(\(that)g(is,)j(languages)c(whic)m
(h)g(supp)s(ort)f(b)s(oth)g(ob)5 b(ject-orien)m(ted)46
b(and)e(logic)300 5262 y(programming)33 b(\(\\OO-Log"\),)38
b(or)d(b)s(oth)f(functional)f(and)h(logic)g(programming)f(\(\\F)-8
b(un-Log"\),)38 b(or)d(all)2032 5700 y(159)p eop
%%Page: 160 169
160 168 bop 300 91 a Fm(three)31 b(paradigms\).)42 b(Here)31
b(w)m(e)g(compare)h(our)e(w)m(ork)h(with)f(other)h(w)m(ork)g(that)h
(extends)e(OO)h(languages)300 279 y(with)24 b(a)h(logic)g(comp)s(onen)m
(t,)i(as)e(w)m(ell)f(as)i(surv)m(ey)f(other)g(m)m(ultiparadigm)e(w)m
(ork)i(with)f(logic)h(comp)s(onen)m(ts.)300 519 y Fl(5.2.1)105
b(Logic)36 b(programming)e(extensions)i(to)e(OO)g(languages)300
765 y Fm(Section)29 b(3.4)g(pro)m(vides)f(a)h(detailed)f(description)f
(of)i(ho)m(w)g(LC++)e(compares)j(to)f(other)g(pro)5 b(jects)29
b(whic)m(h)300 952 y(add)g(supp)s(ort)e(for)i(logic)g(programming)f(to)
i(existing)e(ob)5 b(ject-orien)m(ted)30 b(languages.)41
b(Here)30 b(w)m(e)f(summa-)300 1140 y(rize)h(that)h(comparison.)441
1327 y(The)g(three)h(most-related)g(approac)m(hes)h(are)f(SOUL)f
(\(Smalltalk\),)g(J/MP)h(\(Ja)m(v)-5 b(a\),)34 b(and)d(MPC++)300
1515 y(\(C++\).)48 b(LC++)32 b(is)g(unique)g(compared)h(to)g(suc)m(h)g
(w)m(ork)g(b)s(ecause)g(it)g(in)m(tegrates)h(cleanly)e(the)h(con)m
(trol)300 1702 y(\015o)m(w)39 b(of)g(the)h(imp)s(erativ)m(e)e(and)g
(the)h(logic)g(programming)f(language)h(constructs.)68
b(All)37 b(three)i(of)h(the)300 1890 y(other)33 b(approac)m(hes)g(do)g
(not)f(lea)m(v)m(e)i(the)f(clien)m(t)g(in)e(con)m(trol)i(after)g(a)g
(query:)45 b(either)32 b(all)f(the)i(results)f(are)300
2077 y(returned)k(as)h(a)g(collection,)i(or)e(a)g(blo)s(c)m(k)f(of)h
(co)s(de)h(is)e(executed)h(once)h(on)f(eac)m(h)h(result.)59
b(In)36 b(con)m(trast,)300 2264 y(LC++)f(returns)h(the)g(query)g
(results)g(as)h(a)g(lazy)f(list,)h(lea)m(ving)f(the)h(clien)m(t)f(in)g
(con)m(trol)h(of)f(consuming)300 2452 y(and)30 b(pro)s(cessing)f(the)h
(results.)441 2639 y(There)k(are)h(t)m(w)m(o)h(other)f(notable)f
(di\013erences)g(b)s(et)m(w)m(een)h(our)f(w)m(ork)h(and)e(these)i
(other)g(three.)53 b(The)300 2827 y(\014rst)33 b(is)g(that)h(the)g
(other)f(approac)m(hes)i(ha)m(v)m(e)f(a)g(more)g(\\op)s(erational")g
(syn)m(tax)g(for)f(de\014ning)f(facts)j(and)300 3014
y(rules)23 b(and)h(p)s(erforming)e(queries,)j(whereas)f(LC++)f(preserv)
m(es)i(the)f(declarativ)m(e)h(syn)m(tax)g(found)e(in)g(logic)300
3202 y(languages)f(lik)m(e)g(Prolog.)38 b(A)22 b(second)g(di\013erence)
f(b)s(et)m(w)m(een)i(these)g(approac)m(hes)f(and)g(LC++)e(is)h(that)i
(none)300 3389 y(of)34 b(the)f(other)h(three)g(approac)m(hes)g(can)g
(duplicate)e(the)h(sp)s(ecialized)f(seman)m(tic)i(analyses)f(that)h
(LC++)300 3576 y(can)d(do.)300 3817 y Fl(5.2.2)105 b(Other)35
b(languages)g(with)f(a)h(logic-programming)g(comp)s(onen)m(t)300
4063 y Fm(There)24 b(are)g(quite)g(a)g(few)g(recen)m(t)h(examples)f(of)
g(languages)g(com)m(bining)f(functional)g(and)g(logic)h(program-)300
4250 y(ming.)39 b(G\177)-45 b(odel[27)q(],)28 b(Esc)m(her[20)q(],)h
(Curry[15)o(],)g(and)d(T)-8 b(o)m(y[64)r(])28 b(are)g(a)f(few)g
(examples)g(of)g(languages)h(in)e(this)300 4438 y(area.)40
b(Eac)m(h)27 b(of)g(these)g(languages)f(features)h(static)g(t)m(yping,)
g(p)s(olymorphism,)c(and)j(a)h(pure)e(\(e\013ect-free\))300
4625 y(st)m(yle)f(of)h(programming.)37 b(Mercury[53)q(])24
b(\014ts)g(in)m(to)g(this)f(group,)i(but)e(it)h(also)g(supp)s(orts)e
(parameter)i(mo)s(de)300 4812 y(and)30 b(determinism)e(declarations.)
441 5000 y(These)f(F)-8 b(un-Log)28 b(languages)g(tend)f(to)h(di\013er)
f(from)f(LC++)h(with)f(regards)h(to)h(op)s(erational)f(seman-)300
5187 y(tics:)40 b(whereas)28 b(LC++)g(requires)f(that)i(functions)e(b)s
(e)h(applied)f(only)g(to)j(b)s(ound)c(logic)j(v)-5 b(ariables,)27
b(these)300 5375 y(languages)32 b(are)g(lazy)-8 b(,)33
b(and)e(simply)e(susp)s(end)g(computations)j(un)m(til)d(the)j(v)-5
b(ariables)31 b(get)h(b)s(ound.)43 b(Some)2032 5700 y(160)p
eop
%%Page: 161 170
161 169 bop 300 91 a Fm(of)30 b(these)h(F)-8 b(un-Log)31
b(languages,)g(lik)m(e)e(Curry)-8 b(,)29 b(also)h(encapsulate)g(the)h
(searc)m(h)g(strategy)-8 b(,)32 b(so)e(that)h(in)e(ad-)300
279 y(dition)j(to)i(the)f(depth-\014rst)g(\(Prolog-st)m(yle\))h(searc)m
(h)g(that)g(LC++)e(supp)s(orts,)h(other)h(strategies)g(\(suc)m(h)300
466 y(as)d(breadth-\014rst\))e(can)i(b)s(e)f(used)f(as)i(drop-in)d
(replacemen)m(ts)j(for)f(the)h(logic)f(searc)m(h)h(engine.)441
654 y(Unlik)m(e)g(LC++,)h(whic)m(h)f(com)m(bines)h(logic)g(and)g(ob)5
b(ject-orien)m(ted)33 b(programming)e(b)m(y)h(adding)f(logic)300
841 y(programming)43 b(features)h(to)h(an)f(existing)g(OO)f(language,)
49 b(some)44 b(approac)m(hes)h(start)g(with)e(a)h(logic)300
1028 y(programming)36 b(language)h(and)f(extend)h(it)g(with)e(ob)5
b(ject-orien)m(ted)39 b(features.)60 b(One)37 b(example)f(in)g(this)300
1216 y(area)e(is)e(Jinni[37)n(].)48 b(Jinni)30 b(is)i(an)h(in)m
(terpreter)f(for)h(an)f(extended)h(v)m(ersion)g(of)g(Prolog)f(\(whic)m
(h)g(includes)300 1403 y(features)38 b(lik)m(e)f(classes)g(and)h
(inheritance\))e(that)i(is)f(written)g(in)f(Ja)m(v)-5
b(a.)63 b(Jinni)35 b(uses)i(Ja)m(v)-5 b(a's)39 b(re\015ection)300
1591 y(capabilities)21 b(to)k(pro)m(vide)d(a)i(mec)m(hanism)f(for)h
(the)f(logic)h(co)s(de)f(to)i(\\call)e(out")h(to)h(Ja)m(v)-5
b(a,)26 b(but)d(the)g(in)m(terface)300 1778 y(is)29 b(hea)m(vy)j(and)d
(there)i(is)e(a)i(clear)f(deliniation)e(b)s(et)m(w)m(een)j(logic)f(co)s
(de)h(and)e(ob)5 b(ject-orien)m(ted)32 b(co)s(de.)441
1966 y(A)24 b(few)f(languages)g(are)h(designed)e(to)i(supp)s(ort)d(all)
h(three)i(\(logic,)h(functional,)e(and)g(OO\))g(paradigms.)300
2153 y(The)45 b(language)g(Oz[54)q(])h(com)m(bines)e(all)h(three)g
(paradigms)f(in)g(a)h(dynamically)e(t)m(yp)s(ed,)49 b(concurren)m(t)300
2340 y(programming)38 b(language.)69 b(Oz)40 b(do)s(es)f(ha)m(v)m(e)i
(a)f(strong)g(ob)5 b(ject)40 b(mo)s(del,)h(but)e(logic)g(is)g(the)h
(dominan)m(t)300 2528 y(paradigm)28 b(and)g(programming)f(with)h(Oz)g
(lo)s(oks)h(and)f(feels)g(more)h(lik)m(e)f(logic)h(programming)e(than)i
(OO)300 2715 y(programming.)58 b(The)35 b(Leda[9)q(])i(language)g(w)m
(as)f(sp)s(eci\014cally)f(designed)g(as)h(a)h(language)g(for)f(teac)m
(hing)300 2903 y(the)g(three)h(paradigms;)h(Leda)e(is)f(statically)h(t)
m(yp)s(ed.)57 b(Both)37 b(J/MP[10)q(])g(and)e(Leda)h(w)m(ere)h(created)
g(b)m(y)300 3090 y(the)31 b(same)f(man,)h(and)e(they)i(share)f(man)m(y)
h(of)f(the)h(same)f(strengths)h(and)e(w)m(eaknesses.)2032
5700 y(161)p eop
%%Page: 162 171
162 170 bop 1663 91 a Fn(CHAPTER)45 b(VI)1605 588 y(CONCLUSIONS)300
1025 y Fm(Here)27 b(w)m(e)g(summarize)e(our)g(researc)m(h)i(con)m
(tributions)e(and)h(suggest)h(in)m(teresting)e(directions)g(for)h
(further)300 1212 y(researc)m(h.)300 1489 y Fj(6.1)140
b(Contributions)300 1735 y Fm(In)30 b(Chapter)f(1,)i(w)m(e)g(stated)h
(our)d(thesis:)664 1997 y(Constructs)23 b(for)i(functional)d(and)i
(logic)g(programming)f(can)i(b)s(e)f(smo)s(othly)f(in)m(tegrated)527
2185 y(in)m(to)35 b(an)f(existing)f(ob)5 b(ject-orien)m(ted)36
b(language.)53 b(W)-8 b(e)35 b(demonstrate)g(this)e(in)g(the)i(con)m
(text)527 2372 y(of)c(C++,)g(and)f(sho)m(w)h(that)g(the)h(resulting)d
(m)m(ultiparadigm)f(language)k(has)e(useful)f(appli-)527
2560 y(cations)i(in)e(real-w)m(orld)g(domains.)441 2822
y(Chapters)k(2)h(and)f(3)h(supp)s(orted)d(that)j(thesis)f(b)m(y)g
(describing)e(the)j(F)m(C++)f(and)g(LC++)g(libraries.)300
3009 y(These)k(libraries)d(demonstrated)i(a)i(smo)s(oth)e(in)m
(tegration)h(of)g(the)g(functional)e(and)i(logic)f(paradigms)300
3197 y(in)m(to)30 b(C++:)436 3459 y Fh(\017)46 b Fm(Both)31
b(F)m(C++)f(and)g(LC++)f(supp)s(ort)g(the)i(ma)5 b(jor)30
b(features)h(of)f(their)g(resp)s(ectiv)m(e)g(paradigms,)436
3721 y Fh(\017)46 b Fm(Eac)m(h)28 b(library)c(preserv)m(es)j(the)f
(concision)g(and)g(natural)g(syn)m(tax)h(found)e(in)h(languages)h(sp)s
(eci\014c)e(to)527 3908 y(that)31 b(paradigm,)436 4171
y Fh(\017)46 b Fm(The)36 b(in)m(terfaces)g(b)s(et)m(w)m(een)h(the)f
(paradigms)f(utilize)g(the)h(same)h(static)f(t)m(yp)s(e)h(system)f(and)
f(data)527 4358 y(represen)m(tations,)c(so)f(that)h(co)s(de)g(from)f
(di\013eren)m(t)g(paradigms)f(can)i(b)s(e)e(smo)s(othly)h(in)m
(tegrated,)436 4620 y Fh(\017)46 b Fm(The)f(libraries)e(supp)s(ort)h
(static)i(analyses)g(and)f(error-c)m(hec)m(king)h(sp)s(eci\014c)f(to)h
(the)g(resp)s(ectiv)m(e)527 4808 y(paradigms,)30 b(and)436
5070 y Fh(\017)46 b Fm(The)28 b(libraries)d(ha)m(v)m(e)k(practical)f
(applications)e(in)h(real-w)m(orld)g(domains)f(\(in)h(the)i(case)g(of)f
(F)m(C++,)527 5257 y(the)j(applications)d(are)j(n)m(umerous)f(and)f
(our)h(implemen)m(tation)f(is)h(v)m(ery)g(e\016cien)m(t\).)2032
5700 y(162)p eop
%%Page: 163 172
163 171 bop 441 91 a Fm(F)-8 b(urthermore,)40 b(Chapter)d(4)h
(demonstrates)g(that)h(man)m(y)f(of)g(our)f(ideas)g(can)h(b)s(e)f
(applied)f(outside)300 279 y(of)i(C++.)62 b(A)38 b(n)m(um)m(b)s(er)f
(of)h(our)f(ma)5 b(jor)38 b(ideas)f(are)h(re-cast)h(in)e(terms)h(of)g
(more)g(commonly-a)m(v)-5 b(ailable)300 466 y(language)33
b(constructs.)46 b(Restating)33 b(things)e(in)f(these)j(more)f(general)
h(terms)f(clari\014es)e(the)j(conceptual)300 654 y(con)m(tributions)c
(of)h(our)g(w)m(ork.)300 930 y Fj(6.2)140 b(F)-11 b(utur)k(e)50
b(work)300 1176 y Fm(Our)42 b(w)m(ork)i(suggests)g(a)f(n)m(um)m(b)s(er)
g(of)g(in)m(teresting)g(p)s(ossibilities)c(for)k(future)f(w)m(ork)i(in)
e(a)i(few)f(areas,)300 1364 y(including)27 b(m)m(ultiparadigm)h
(programming)h(and)h(extensible)f(languages.)441 1551
y(A)m(t)j(a)f(high)f(lev)m(el,)g(our)h(w)m(ork)g(demonstrates)g(the)g
(v)-5 b(alue)30 b(of)h(com)m(bining)f(paradigms.)40 b(The)31
b(ob)5 b(ject-)300 1739 y(orien)m(ted)43 b(and)f(functional)g
(paradigms)g(are)h(esp)s(ecially)e(synergistic.)78 b(Whereas)43
b(w)m(e)h(ha)m(v)m(e)g(demon-)300 1926 y(strated)33 b(ho)m(w)g
(functional)e(programming)g(can)i(impro)m(v)m(e)f(a)h(n)m(um)m(b)s(er)e
(of)i(ob)5 b(ject-orien)m(ted)34 b(design)d(pat-)300
2114 y(terns,)47 b(w)m(e)d(b)s(eliev)m(e)f(there)h(are)g(ev)m(en)g
(more)g(y)m(et-undisco)m(v)m(ered)h(applications|examples)c(where)j(a)
300 2301 y(functional)39 b(approac)m(h)j(simpli\014es)37
b(the)k(structure)g(or)g(optimizes)f(the)h(implemen)m(tation)f(of)h(a)h
(tradi-)300 2488 y(tional)30 b(ob)5 b(ject-orien)m(ted)31
b(design.)441 2676 y(With)g(regards)h(to)g(C++,)g(our)f(w)m(ork)h(has)f
(demonstrated)h(the)g(limits)e(of)h(the)h(extensibilit)m(y)e(capa-)300
2863 y(bilities)i(of)j(the)g(language.)54 b(This)33 b(w)m(ork)h(has)h
(already)f(help)s(ed)f(inspire)f(some)j(other)g(domain-sp)s(eci\014c)
300 3051 y(em)m(b)s(edded)i(libraries)f(in)h(C++,)j(and)e(w)m(e)h(exp)s
(ect)g(more)g(suc)m(h)f(libraries)e(will)g(b)s(e)i(dev)m(elop)s(ed)g
(as)h(the)300 3238 y(C++)32 b(language)h(b)s(ecomes)f(more)h(w)m
(ell-understo)s(o)s(d.)45 b(F)-8 b(urthermore,)33 b(a)g(clear)g
(understanding)d(of)j(the)300 3426 y(most)28 b(pressing)f(curren)m(t)g
(limitations)f(of)i(C++)f(is)g(helping)f(to)j(pa)m(v)m(e)g(the)f(w)m(a)
m(y)h(for)f(the)g(next)g(v)m(ersion)g(of)300 3613 y(the)h(language.)40
b(Whereas)30 b(some)f(future)e(extensions)h(\(suc)m(h)h(as)g(a)g
Fk(typeof)e Fm(op)s(erator\))i(are)g(already)f(b)s(e-)300
3800 y(coming)h(standardized,)g(others)g(\(suc)m(h)h(as)f(language)h
(supp)s(ort)e(for)h(\\concepts"\))j(still)27 b(require)h(a)i(great)300
3988 y(deal)g(more)g(researc)m(h.)441 4175 y(With)e(regards)h(to)h
(LC++)d(in)h(particular,)f(some)j(clear)e(a)m(v)m(en)m(ues)j(remain,)d
(including)d(adding)j(sup-)300 4363 y(p)s(ort)33 b(for)g(a)h(few)f
(more)h(common)g(logic)f(programming)f(features)i(\(lik)m(e)f(Prolog's)
h Fk(cut)e Fm(op)s(erator\))j(and)300 4550 y(pro)m(viding)24
b(a)i(more)g(e\016cien)m(t)g(implemen)m(tation.)38 b(It)26
b(also)g(remains)e(to)j(b)s(e)e(seen)h(if)e(a)j(library)c(lik)m(e)i
(LC++)300 4738 y(can)40 b(b)s(e)g(usefully)e(applied)g(in)h
(application)f(domains)h(that)i(are)f(not)h(traditionally)d(considered)
h(the)300 4925 y(domain)c(of)h(logic)f(programming)g(\(in)g(a)h(w)m(a)m
(y)g(similar)e(to)i(ho)m(w)g(F)m(C++)g(w)m(as)g(applied)d(to)k(OO)e
(design)300 5112 y(patterns\).)441 5300 y(Our)19 b(exp)s(erience)h(dev)
m(eloping)f(libraries)f(in)h(C++)g(has)h(suggested)h(whic)m(h)e(nativ)m
(e)i(language)g(features)2032 5700 y(163)p eop
%%Page: 164 173
164 172 bop 300 91 a Fm(are)32 b(most)f(useful)f(in)f(an)j(extensible)e
(language.)43 b(Section)31 b(4.3.2)i(discussed)d(this)g(in)g(detail.)42
b(Our)30 b(w)m(ork)300 279 y(can)j(inform)e(the)i(designs)f(of)h
(future)f(extensible)f(languages|those)j(with)d(a)j(small,)e(w)m(ell-c)
m(hosen)g(set)300 466 y(of)41 b(nativ)m(e)h(features)f(that)h(enable)e
(man)m(y)i(new)e(capabilities)f(to)j(b)s(e)f(smo)s(othly)f(added)g(as)i
(libraries.)300 654 y(Replicating)33 b(the)h(w)m(ork)g(w)m(e)h(ha)m(v)m
(e)g(done)f(\(extending)g(C++)f(with)g(F)m(C++)h(and)g(LC++\))f(migh)m
(t)h(b)s(e)g(a)300 841 y(useful)29 b(b)s(enc)m(hmark)g(to)i(test)g(the)
g(extensibilit)m(y)d(of)j(other)f(languages.)441 1028
y(Finally)-8 b(,)45 b(it)d(should)f(b)s(e)i(noted)g(that)g(aethetics)h
(are)g(imp)s(ortan)m(t)e(to)i(b)s(oth)e(language)h(designers)300
1216 y(and)36 b(library)f(designers.)59 b(In)36 b(addition)f(to)j(ha)m
(ving)e(a)h(deep)g(understanding)d(of)j(v)-5 b(arious)36
b(paradigms,)300 1403 y(p)s(erformance)29 b(issues,)f(p)s(oten)m(tial)h
(feature)g(in)m(teractions)g(and)g(suc)m(h,)g(a)h(go)s(o)s(d)f
(designer)f(has)h(the)g(abilit)m(y)300 1591 y(to)24 b(come)g(up)e(with)
f(concise)i(and)g(precise)f(syn)m(tax)i(for)e(expressing)g
(programmers')h(in)m(ten)m(tions.)37 b(P)m(erhaps)300
1778 y(future)27 b(in)m(v)m(estigations)g(will)e(lead)i(to)h(a)g(b)s
(etter)f(understanding)e(of)j(this)e(oft-o)m(v)m(erlo)s(ok)m(ed)k(asp)s
(ect)e(of)g(the)300 1966 y(design)40 b(of)h(languages)g(and)f
(libraries,)g(so)h(that)h(the)f(b)s(est)f(designs)f(are)i(not)g
(limited)e(to)i(just)f(those)300 2153 y(creators)31 b(who)f(ha)m(v)m(e)
i(some)f(in)m(tangible)d(qualit)m(y)-8 b(.)2032 5700
y(164)p eop
%%Page: 165 174
165 173 bop 1642 91 a Fn(REFERENCES)345 753 y Fm([1])47
b(O.)42 b(Agesen,)k(S.)c(F)-8 b(reund,)45 b(and)d(J.)g(Mitc)m(hell,)i
(\\Adding)e(t)m(yp)s(e)g(parameterization)g(to)h(the)g(ja)m(v)-5
b(a)487 866 y(language",)31 b Fi(Pr)-5 b(o)g(c.)33 b(Obje)-5
b(ct-Oriente)g(d)32 b(Pr)-5 b(o)g(gr)g(amming)35 b(Systems,)e(L)-5
b(anguages,)33 b(and)g(Applic)-5 b(ations)487 979 y(\(OOPSLA\))32
b(1997)p Fm(,)g(49-65.)345 1166 y([2])47 b(A.)38 b(Alexandrescu,)h
Fi(Mo)-5 b(dern)41 b(C++)e(Design:)55 b(Generic)39 b(Pr)-5
b(o)g(gr)g(amming)43 b(and)d(Design)f(Patterns)487 1279
y(Applie)-5 b(d)p Fm(,)32 b(Addison-W)-8 b(esley)29 b(Professional,)h
(2001.)345 1466 y([3])47 b(S.R.)24 b(Alp)s(ert,)g(K.)g(Bro)m(wn,)h(B.)g
(W)-8 b(o)s(olf,)25 b Fi(The)i(Design)f(Patterns)i(Smal)5
b(ltalk)28 b(Comp)-5 b(anion)p Fm(,)28 b(Addison-)487
1578 y(W)-8 b(esley)g(,)32 b(1998.)345 1765 y([4])47
b(G.)29 b(Baumgartner,)g(K.)g(L\177)-45 b(aufer,)28 b(V.F.)i(Russo,)f
(\\On)f(the)g(in)m(teraction)h(of)f(ob)5 b(ject-orien)m(ted)30
b(design)487 1878 y(patterns)d(and)f(programming)g(languages",)j(T)-8
b(ec)m(h.)28 b(Rep)s(ort)f(CSD-TR-96-020,)j(Dept.)e(of)f(Comp.)487
1991 y(Sci.,)j(Purdue)f(Univ)m(ersit)m(y)-8 b(,)30 b(F)-8
b(ebruary)30 b(1996.)345 2178 y([5])47 b(Bo)s(ehm-Demers-W)-8
b(eiser)32 b(conserv)-5 b(ativ)m(e)31 b(garbage)h(collector.)487
2291 y Fk(http://www.hpl.hp.com/pe)o(rso)o(nal/)o(Hans)o(_Bo)o(ehm/)o
(gc/)345 2477 y Fm([6])47 b(The)30 b(Bo)s(ost)h(w)m(ebsite:)41
b Fk(http://boost.org/)345 2664 y Fm([7])47 b(G.)27 b(Brac)m(ha,)i
(\\Add)d(generic)h(t)m(yp)s(es)f(to)i(the)e(Ja)m(v)-5
b(a)28 b(programming)d(language",)k(Ja)m(v)-5 b(a)27
b(Sp)s(eci\014cation)487 2777 y(Request)k(\(JSR\))f(14,)h(Sun)e
(Microsystems,)i(1999.)345 2964 y([8])47 b(G.)28 b(Brac)m(ha,)i(M.)f
(Odersky)-8 b(,)28 b(D.)h(Stoutamire)f(and)f(P)-8 b(.)29
b(W)-8 b(adler,)28 b(\\Making)h(the)f(future)f(safe)i(for)f(the)487
3077 y(past:)59 b(Adding)39 b(genericit)m(y)g(to)i(the)f(Ja)m(v)-5
b(a)40 b(programming)f(language",)k Fi(Pr)-5 b(o)g(c.)42
b(Obje)-5 b(ct-Oriente)g(d)487 3190 y(Pr)g(o)g(gr)g(amming)35
b(Systems,)e(L)-5 b(anguages,)34 b(and)f(Applic)-5 b(ations)35
b(\(OOPSLA\))c(1998)p Fm(.)345 3376 y([9])47 b(T.)62
b(Budd.)g Fi(Multip)-5 b(ar)g(adigm)65 b(pr)-5 b(o)g(gr)g(amming)66
b(in)c(L)-5 b(e)g(da)p Fm(.)64 b(Addison-W)-8 b(esley)g(,)71
b(Reading,)f(Mas-)487 3489 y(sac)m(h)m(usetts,)32 b(1995.)300
3676 y([10])47 b(T.)31 b(Budd.)g(\\The)g(Return)g(of)h(Jensen's)f
(Device",)i Fi(Multip)-5 b(ar)g(adigm)36 b(Pr)-5 b(o)g(gr)g(amming)36
b(with)f(Obje)-5 b(ct-)487 3789 y(Oriente)g(d)33 b(L)-5
b(anguages)33 b(\(MPOOL\))p Fm(,)d(Malaga,)i(Spain,)d(June)g(2002.)300
3976 y([11])47 b(J.)41 b(Bric)m(hau,)j(K.)d(Gyb)s(els,)i(and)e(R.)g(W)
-8 b(uyt.)43 b(\\T)-8 b(o)m(w)m(ards)42 b(Linguistic)d(Sym)m(biosis)g
(of)i(an)g(Ob)5 b(ject-)487 4089 y(Orien)m(ted)49 b(and)g(a)h(Logic)h
(Programming)e(Language",)56 b Fi(Multip)-5 b(ar)g(adigm)53
b(Pr)-5 b(o)g(gr)g(amming)53 b(with)487 4201 y(Obje)-5
b(ct-Oriente)g(d)32 b(L)-5 b(anguages)34 b(\(MPOOL\))p
Fm(,)29 b(Malaga,)j(Spain,)d(June)g(2002.)300 4388 y([12])47
b(K.)30 b(Briggs,)h Fi(The)i(XR)f(Exact)h(R)-5 b(e)g(al)34
b(Home)f(Page)p Fm(.)487 4501 y Fk(http://www.btexact.com/p)o(eop)o
(le/b)o(rigg)o(sk2)o(/XR.)o(html)300 4688 y Fm([13])47
b(C.)32 b(Cham)m(b)s(ers,)h(B.)g(Harrison,)g(and)f(J.)g(Vlissides,)f
(\\A)j(debate)f(on)g(language)g(and)f(to)s(ol)h(supp)s(ort)487
4801 y(for)27 b(design)f(patterns",)i Fi(A)n(CM)g(Symp)-5
b(osium)32 b(on)e(Principles)g(of)f(Pr)-5 b(o)g(gr)g(amming)32
b(L)-5 b(anguages)p Fm(,)29 b(2000)487 4914 y(\(P)m(oPL)i(00\).)300
5100 y([14])47 b(K.)30 b(Czarnec)m(ki,)h(and)f(U.)g(Eisenec)m(k)m(er,)i
Fi(Gener)-5 b(ative)33 b(Pr)-5 b(o)g(gr)g(amming)p Fm(.)33
b(Addison-W)-8 b(esley)g(,)30 b(2000.)300 5287 y([15])47
b(Curry:)39 b(A)30 b(T)-8 b(ruly)29 b(In)m(tegrated)j(F)-8
b(unctional)29 b(Logic)i(Language)487 5400 y Fk
(http://www.informatik.un)o(i-k)o(iel.)o(de/)p Fh(\030)o
Fk(mh/)o(curr)o(y/)2032 5700 y Fm(165)p eop
%%Page: 166 175
166 174 bop 300 91 a Fm([16])47 b(F.)27 b(Dabro)m(wksi,)g(and)f(F.)h
(Loulergue.)f(\\F)-8 b(unctional)27 b(Bulk)e(Sync)m(hronous)g(P)m
(arallel)h(Programming)487 204 y(in)20 b(C++.")g Fi(Applie)-5
b(d)26 b(Informatics)f(2003,)j(Symp)-5 b(osium)26 b(on)e(Par)-5
b(al)5 b(lel)25 b(and)g(Distribute)-5 b(d)25 b(Computing)487
317 y(and)33 b(Networks)h(\(PDCN)d(2003\))p Fm(.)300
505 y([17])47 b(L.)39 b(Dami,)i("More)f(F)-8 b(unctional)39
b(Reusabilit)m(y)e(in)h(C/C++/Ob)5 b(jectiv)m(e-C)38
b(with)g(Curried)f(F)-8 b(unc-)487 618 y(tions",)74 b(Ob)5
b(ject)65 b(Comp)s(osition,)73 b(Cen)m(tre)65 b(Univ)m(ersitaire)f
(d'Informatique,)73 b(Univ)m(ersit)m(y)65 b(of)487 731
y(Genev)-5 b(a,)31 b(pp.)f(85-98,)j(June)c(1991.)300
918 y([18])47 b(B.)40 b(Demo)s(en,)i(M.)e(Garcia)g(de)f(la)h(Banda,)i
(W.)e(Harv)m(ey)-8 b(,)43 b(K.)d(Marriott,)i(and)d(P)-8
b(.)40 b(Stuc)m(k)m(ey)-8 b(.)41 b(\\An)487 1031 y(o)m(v)m(erview)28
b(of)g(HAL.")h Fi(Pr)-5 b(o)g(c)g(e)g(e)g(dings)33 b(of)d(Principles)h
(and)g(Pr)-5 b(actic)g(e)31 b(of)g(Constr)-5 b(aint)32
b(Pr)-5 b(o)g(gr)g(amming)p Fm(,)487 1144 y(pages)31
b(174{188,)j(Octob)s(er)c(1999.)487 1257 y Fk(http://www.csse.monash.e)
o(du.)o(au/)p Fh(\030)o Fk(mban)o(da/)o(hal/)o(inde)o(x.h)o(tml)300
1445 y Fm([19])47 b(S.)30 b(Edw)m(ards.)f(\\MPC++)h(Resources",)i
Fi(class)h(web)g(p)-5 b(age)p Fm(,)31 b(a)m(v)-5 b(ailable)30
b(at)487 1557 y Fk(http://courses.cs.vt.edu)o(/)p Fh(\030)p
Fk(c)o(s531)o(4/Sp)o(rin)o(g02/)o(mpcp)o(p.p)o(hp)300
1745 y Fm([20])47 b(The)30 b(Esc)m(her)g(programming)f(language)487
1858 y Fk(http://www.cs.bris.ac.uk)o(/)p Fh(\030)p Fk(j)o(wl/e)o(sche)o
(r.h)o(tml)300 2046 y Fm([21])47 b(The)30 b(F)m(C++)g(w)m(eb)g(page:)
487 2159 y Fk(http://www.cc.gatech.edu)o(/~y)o(anni)o(s/fc)o(++/)300
2346 y Fm([22])47 b(J.)30 b(F)-8 b(okk)m(er,)32 b(F)-8
b(unctional)30 b(Programming,)g Fk(http://)487 2459 y
(haskell.org/bookshelf/fu)o(nct)o(iona)o(l-pr)o(ogr)o(ammi)o(ng.d)o(vi)
300 2647 y Fm([23])47 b(E.)d(Gamma,)k(R.)c(Helm,)i(R.)e(Johnson,)i(and)
e(J.)f(Vlissides,)i Fi(Design)f(Patterns:)67 b(Elements)46
b(of)487 2760 y(R)-5 b(eusable)33 b(Obje)-5 b(ct-Oriente)g(d)32
b(Softwar)-5 b(e)p Fm(.)33 b(Addison-W)-8 b(esley)g(,)30
b(1994.)300 2947 y([24])47 b(R.)22 b(Garcia,)j(J.)d(J\177)-45
b(arvi,)23 b(A.)f(Lumsdaine,)g(J.)g(Siek,)h(and)f(J.)g(Willco)s(c)m(k.)
g(A)g(comparativ)m(e)h(study)e(of)h(lan-)487 3060 y(guage)30
b(supp)s(ort)d(for)i(generic)g(programming.)f Fi(Pr)-5
b(o)g(c)g(e)g(e)g(dings)33 b(of)f(the)f(18th)i(A)n(CM)d(SIGPLAN)h(c)-5
b(on-)487 3173 y(fer)g(enc)g(e)35 b(on)g(Obje)-5 b(ct-oriente)g(d)36
b(pr)-5 b(o)g(gr)g(amming,)38 b(systems,)f(languages,)f(and)f(applic)-5
b(ations)38 b(\(OOP-)487 3286 y(SLA'03\))p Fm(,)31 b(pp.115-134.)i(A)m
(CM)e(Press,)f(Oct.)h(2003.)300 3474 y([25])47 b(T.)32
b(G)m(\023)-43 b(eraud)33 b(and)e(A.)i(Duret-Lutz,)h(\\Generic)e
(programming)f(redesign)g(of)i(patterns",)g(in)e(Pro)s(c.)487
3587 y Fi(Eur)-5 b(op)g(e)g(an)35 b(Conf.)d(on)i(Pattern)f(L)-5
b(anguages)33 b(of)g(Pr)-5 b(o)g(gr)g(ams,)35 b(2000)g(\(Eur)-5
b(oPL)g(oP'2000\))p Fm(.)300 3774 y([26])47 b(The)30
b(Glasgo)m(w)h(Hask)m(ell)f(Compiler)e(homepage:)487
3887 y Fk(http://www.haskell.org/g)o(hc/)300 4075 y Fm([27])47
b(The)30 b(G\177)-45 b(odel)30 b(Programming)f(Language)487
4188 y Fk(http://www.cs.bris.ac.uk)o(/)p Fh(\030)p Fk(b)o(ower)o(s/go)o
(ede)o(l.ht)o(ml)300 4375 y Fm([28])47 b(D.)31 b(Gregor.)g(The)f(Bo)s
(ost)i(function)d(library)-8 b(.)487 4488 y Fk
(http://www.boost.org/doc)o(/ht)o(ml/f)o(unct)o(ion)o(.htm)o(l)300
4676 y Fm([29])47 b(J.)30 b(de)g(Guzman,)h(et)g(al.)f(The)g(Bo)s(ost)h
(Spirit)d(Library)-8 b(.)29 b(Av)-5 b(ailable)29 b(at)487
4789 y Fk(http://www.boost.org/lib)o(s/s)o(piri)o(t/in)o(dex)o(.htm)o
(l)300 4976 y Fm([30])47 b Fi(Haskel)5 b(l)32 b(98)i(L)-5
b(anguage)33 b(R)-5 b(ep)g(ort)p Fm(.)33 b(Av)-5 b(ailable)29
b(online)g(at)487 5089 y Fk(http://www.haskell.org/o)o(nli)o(nere)o
(port)o(/)300 5277 y Fm([31])47 b(J.)31 b(Hamilton,)f("Mon)m(tana)j
(Smart)d(P)m(oin)m(ters:)42 b(They're)31 b(Smart,)g(and)f(They're)h(P)m
(oin)m(ters",)h(Pro)s(c.)487 5390 y(Conf.)e(Ob)5 b(ject-Orien)m(ted)30
b(T)-8 b(ec)m(hnologies)31 b(and)e(Systems)h(\(COOTS\),)g(P)m(ortland,)
g(June)f(1997.)2032 5700 y(166)p eop
%%Page: 167 176
167 175 bop 300 91 a Fm([32])47 b(The)30 b(Hugs)g(homepage:)487
204 y Fk(http://www.haskell.org/h)o(ugs)o(/)300 392 y
Fm([33])47 b(G.)37 b(Hutton,)h(and)e(E.)g(Meijer.)h(\\Monadic)f
(parsing)f(in)g(Hask)m(ell")i Fi(Journal)i(of)f(F)-7
b(unctional)40 b(Pr)-5 b(o-)487 505 y(gr)g(amming)p Fm(,)32
b(8\(4\):437-444,)j(Cam)m(bridge)30 b(Univ)m(ersit)m(y)f(Press,)h(July)
f(1998.)300 692 y([34])47 b Fi(ISO/IEC)32 b(14882:)45
b(Pr)-5 b(o)g(gr)g(amming)35 b(L)-5 b(anguages)33 b({)g(C++)p
Fm(.)d(ANSI,)g(1998.)300 880 y([35])47 b(J.)30 b(J\177)-45
b(arvi)29 b(and)h(G.)h(P)m(o)m(w)m(ell.)g(The)f(Bo)s(ost)h(Lam)m(b)s
(da)f(Library)-8 b(.)29 b(Av)-5 b(ailable)29 b(at)487
993 y Fk(http://boost.org/libs/la)o(mbd)o(a/do)o(c/in)o(dex)o(.htm)o(l)
300 1181 y Fm([36])47 b(Ja)m(v)-5 b(asoft,)32 b Fi(Java)h(Inner)g
(Classes)g(Sp)-5 b(e)g(ci\014c)g(ation)p Fm(,)33 b(1997.)g(In)487
1293 y Fk(http://java.sun.com/prod)o(uct)o(s/jd)o(k/1.)o(1/d)o(ocs/)24
b Fm(.)300 1481 y([37])47 b(Jinni:)38 b(Ja)m(v)-5 b(a)31
b(INference)g(Engine)e(and)h(Net)m(w)m(ork)m(ed)i(In)m(teractor.)487
1594 y Fk(http://www.binnetcorp.co)o(m/J)o(inni)o(/)300
1782 y Fm([38])47 b(R.)35 b(Johnson)f(and)g(B.)h(F)-8
b(o)s(ote,)38 b("Designing)d(Reusable)f(Classes",)i(Journal)d(of)i(Ob)5
b(ject-Orien)m(ted)487 1895 y(Programming,)30 b(1\(2\):)42
b(June/July)28 b(1988,)33 b(22-35.)300 2082 y([39])47
b(S.)28 b(P)-8 b(.)29 b(Jones)g(and)e(P)-8 b(.)30 b(W)-8
b(adler.)28 b(\\Imp)s(erativ)m(e)h(functional)e(programming,")h
Fi(20th)33 b(Symp)-5 b(osium)32 b(on)487 2195 y(Principles)24
b(of)h(Pr)-5 b(o)g(gr)g(amming)27 b(L)-5 b(anguages)p
Fm(,)24 b(A)m(CM)e(Press,)h(Charlotte,)g(North)e(Carolina,)h(Jan)m
(uary)487 2308 y(1993.)300 2496 y([40])47 b(S.)35 b(P)-8
b(.)35 b(Jones)h(and)e(J.)h(Hughes)g(\(eds.\),)j(Rep)s(ort)d(on)g(the)g
(Programming)g(Language)h(Hask)m(ell)f(98,)487 2609 y(a)m(v)-5
b(ailable)30 b(from)g Fk(www.haskell.org)p Fm(,)c(F)-8
b(ebruary)30 b(1999.)300 2796 y([41])47 b(A.)21 b(J.)g(Kfoury)f(and)g
(J.)h(Tiuryn,)g("T)m(yp)s(e)f(reconstruction)h(in)f(\014nite)f(rank)i
(fragmen)m(ts)g(of)g(the)h(second-)487 2909 y(order)30
b(lam)m(b)s(da-calculus",)f Fi(Information)34 b(and)g(Computation)p
Fm(,)f(98\(2\):228-257,)j(June)29 b(1992.)300 3097 y([42])47
b(O.)26 b(Kisely)m(o)m(v,)h("F)-8 b(unctional)25 b(St)m(yle)h(in)f
(C++:)37 b(Closures,)26 b(Late)h(Binding,)e(and)g(Lam)m(b)s(da)g
(Abstrac-)487 3210 y(tions",)46 b(p)s(oster)c(presen)m(tation,)k(In)m
(t.)d(Conf.)f(on)h(F)-8 b(unctional)42 b(Programming,)j(1998.)g(See)e
(also:)487 3323 y Fk(http://www.lh.com/~oleg/)o(ftp)o(/)25
b Fm(.)300 3510 y([43])47 b(S.)c(Krishnam)m(urthi,)g(M.)h(F)-8
b(elleisen,)46 b(D.)e(P)-8 b(.)44 b(F)-8 b(riedman,)47
b(\\Syn)m(thesizing)42 b(ob)5 b(ject-orien)m(ted)45 b(and)487
3623 y(functional)37 b(design)g(to)j(promote)f(re-use",)i
Fi(Eur)-5 b(op)g(e)g(an)42 b(Confer)-5 b(enc)g(e)41 b(on)g(Obje)-5
b(ct-Oriente)g(d)40 b(Pr)-5 b(o-)487 3736 y(gr)g(amming)34
b(\(ECOOP\))p Fm(,)c(Brussels,)f(Belgium,)g(July)g(1998.)300
3924 y([44])47 b(T.)24 b(K)s(\177)-48 b(uhne,)25 b Fi(A)i(F)-7
b(unctional)28 b(Pattern)g(System)g(for)g(Obje)-5 b(ct-Oriente)g(d)27
b(Design)p Fm(,)e(V)-8 b(erlag)26 b(Dr.)e(Ko)m(v)-5 b(ac,)487
4037 y(Ham)m(burg,)30 b(1999.)300 4224 y([45])47 b(K.)35
b(L\177)-45 b(aufer,)37 b(\\A)f(F)-8 b(ramew)m(ork)37
b(for)f(Higher-Order)e(F)-8 b(unctions)35 b(in)f(C++",)j
Fi(Pr)-5 b(o)g(c.)38 b(Conf.)g(Obje)-5 b(ct-)487 4337
y(Oriente)g(d)33 b(T)-7 b(e)i(chnolo)g(gies)34 b(\(COOTS\))p
Fm(,)d(Mon)m(terey)-8 b(,)32 b(CA,)f(June)e(1995.)300
4525 y([46])47 b(The)30 b(LC++)f(w)m(eb)h(page:)487 4638
y Fk(http://www.cc.gatech.edu)o(/~y)o(anni)o(s/lc)o(++/)300
4825 y Fm([47])47 b(J.)30 b(Maddo)s(c)m(k.)h(Bo)s(ost)h(library:)38
b(static)31 b(assertions.)f(Av)-5 b(ailable)29 b(at)487
4938 y Fk(http://boost.org/libs/st)o(ati)o(c_as)o(sert)o(/st)o(atic)o
(_ass)o(ert)o(.htm)300 5126 y Fm([48])47 b(B.)25 b(McNamara)h(and)d(Y.)
i(Smaragdakis,)g(\\F)m(C++:)38 b(F)-8 b(unctional)24
b(Programming)f(in)g(C++",)i Fi(Pr)-5 b(o)g(c.)487 5239
y(International)55 b(Confer)-5 b(enc)g(e)55 b(on)e(F)-7
b(unctional)55 b(Pr)-5 b(o)g(gr)g(amming)56 b(\(ICFP\))p
Fm(,)d(Mon)m(treal,)60 b(Canada,)487 5352 y(Septem)m(b)s(er)30
b(2000.)2032 5700 y(167)p eop
%%Page: 168 177
168 176 bop 300 91 a Fm([49])47 b(B.)d(McNamara,)k(and)42
b(Y.)i(Smaragdakis.)f(\\F)-8 b(unctional)43 b(Programming)f(with)g(the)
h(F)m(C++)g(li-)487 204 y(brary")30 b Fi(Journal)j(of)g(F)-7
b(unctional)34 b(Pr)-5 b(o)g(gr)g(amming)p Fm(,)33 b(to)f(app)s(ear.)
300 392 y([50])47 b(B.)78 b(McNamara,)91 b(and)77 b(Y.)h(Smaragdakis.)e
(\\Static)j(In)m(terfaces)f(in)e(C++")h Fi(Workshop)487
505 y(on)63 b(C++)f(T)-7 b(emplate)64 b(Pr)-5 b(o)g(gr)g(amming)73
b Fm(Octob)s(er)63 b(2000,)73 b(Erfurt,)d(German)m(y)-8
b(.)64 b(Av)-5 b(ailable)61 b(at)487 618 y Fk(http://www.oonumerics.or)
o(g/t)o(mpw0)o(0/)300 805 y Fm([51])47 b(B.)28 b(McNamara,)h(and)e(Y.)h
(Smaragdakis.)e(\\Syn)m(tax)i(sugar)f(for)g(F)m(C++:)39
b(lam)m(b)s(da,)27 b(in\014x,)f(monads,)487 918 y(and)k(more")h
Fi(DPCOOL'03)42 b Fm(Uppsala,)30 b(Sw)m(eden.)g(Av)-5
b(ailable)29 b(at)487 1031 y Fk(http://www.cc.gatech.edu)o(/~y)o(anni)o
(s/fc)o(++/)300 1219 y Fm([52])47 b(E.)36 b(Meijer)f(and)g(L.)h
(Kettner,)i("C++)d(as)h(a)g(F)-8 b(unctional)36 b(Language",)i
(discussion)c(in)g(Dagstuhl)487 1332 y(Seminar)29 b(99081.)j(See:)487
1445 y Fk(http://www.cs.unc.edu/~k)o(ett)o(ner/)o(piec)o(es/)o(flat)o
(ten.)o(htm)o(l)25 b Fm(.)300 1632 y([53])47 b(The)30
b(Mercury)g(Pro)5 b(ject.)31 b Fk(http://www.cs.mu.oz.au/res)o(ear)o
(ch/m)o(ercu)o(ry/)300 1820 y Fm([54])47 b(The)30 b(Mozart)i
(Programming)d(System.)i Fk(http://www.mozart-oz.or)o(g/)300
2007 y Fm([55])47 b(A.)35 b(My)m(ers,)h(J.)e(Bank)h(and)f(B.)h(Lisk)m
(o)m(v,)g(\\P)m(arameterized)h(t)m(yp)s(es)f(for)f(Ja)m(v)-5
b(a",)37 b Fi(A)n(CM)e(Symp)-5 b(osium)487 2120 y(on)33
b(Principles)g(of)g(Pr)-5 b(o)g(gr)g(amming)35 b(L)-5
b(anguages)p Fm(,)31 b(1997)h(\(P)m(oPL)g(97\).)300 2308
y([56])47 b(M.)30 b(Odersky)e(and)h(P)-8 b(.)30 b(W)-8
b(adler,)30 b("Pizza)g(in)m(to)g(Ja)m(v)-5 b(a:)41 b(T)-8
b(ranslating)28 b(theory)i(in)m(to)g(practice",)g(A)m(CM)487
2421 y(Symp)s(osium)d(on)k(Principles)c(of)j(Programming)g(Languages,)h
(1997)h(\(P)m(oPL)f(97\).)300 2609 y([57])47 b(J.)31
b(Siek)f(and)g(A.)h(Lumsdaine.)e(\\Concept)j(Chec)m(king:)41
b(Binding)29 b(P)m(arametric)j(P)m(olymorphism)c(in)487
2721 y(C++")41 b Fi(Workshop)j(on)g(C++)e(T)-7 b(emplate)44
b(Pr)-5 b(o)g(gr)g(amming)52 b Fm(Octob)s(er)41 b(2000,)47
b(Erfurt,)c(German)m(y)-8 b(.)487 2834 y(Av)j(ailable)29
b(at)i Fk(http://www.oonumerics.or)o(g/tm)o(pw00)o(/)300
3022 y Fm([58])47 b(Y.)41 b(Smaragdakis)g(and)f(B.)i(McNamara,)j(\\F)m
(C++:)62 b(F)-8 b(unctional)41 b(T)-8 b(o)s(ols)40 b(for)h(Ob)5
b(ject-Orien)m(ted)487 3135 y(T)-8 b(asks")31 b Fi(Softwar)-5
b(e)34 b(Pr)-5 b(actic)g(e)34 b(and)f(Exp)-5 b(erienc)g(e)p
Fm(,)31 b(August)g(2002.)300 3323 y([59])47 b(A.)40 b(Stepano)m(v)g
(and)f(M.)h(Lee,)j("The)c(Standard)g(T)-8 b(emplate)40
b(Library",)g(1995.)i(Incorp)s(orated)d(in)487 3435 y(ANSI/ISO)29
b(Committee)i(C++)e(Standard.)300 3623 y([60])47 b(J.)30
b(Striegnitz,)g Fi(F)-9 b(A)n(CT!)32 b(The)g(F)-7 b(unctional)34
b(Side)f(of)g(C++)p Fm(,)487 3736 y Fk(http://www.fz-juelich.de)o(/za)o
(m/FA)o(CT)p Fm(.)300 3924 y([61])47 b(B.)37 b(Stroustrup,)h("A)f
(History)g(of)g(C++:)53 b(1979-1991",)43 b(in)36 b(T.)h(Bergin,)h(and)e
(R.)h(Gibson)f(\(eds\),)487 4037 y(Pro)s(c.)i(2nd)g(A)m(CM)h(History)f
(of)g(Programming)g(Languages)h(Conference,)h(pp.)e(699-752.)j(A)m(CM)
487 4149 y(Press,)30 b(New)h(Y)-8 b(ork,)31 b(1996.)300
4337 y([62])47 b(S.)20 b(Thompson,)i(\\Higher-order)e(+)h(p)s
(olymorphic)d(=)i(reusable",)j Fi(unpublishe)-5 b(d)p
Fm(,)24 b(Ma)m(y)e(1997.)h(Av)-5 b(ail-)487 4450 y(able)30
b(at:)41 b Fk(http://www.cs.ukc.ac.uk/p)o(ubs/)o(1997)o(/22)o(4)24
b Fm(.)300 4638 y([63])47 b(K.)33 b(Thorup,)g(\\Genericit)m(y)i(in)d
(Ja)m(v)-5 b(a)35 b(with)d(virtual)g(t)m(yp)s(es",)j
Fi(Eur)-5 b(op)g(e)g(an)38 b(Confer)-5 b(enc)g(e)37 b(on)f(Obje)-5
b(ct-)487 4751 y(Oriente)g(d)33 b(Pr)-5 b(o)g(gr)g(amming)35
b(\(ECOOP\))d(1997)p Fm(,)g(444-471.)300 4938 y([64])47
b(The)30 b(T)-8 b(o)m(y)31 b(System.)f Fk(http://titan.sip.ucm.es/to)o
(y/)300 5126 y Fm([65])47 b(\\A)31 b(uniform)d(metho)s(d)i(for)g
(computing)f(function)g(ob)5 b(ject)32 b(return)d(t)m(yp)s(es")487
5239 y Fk(http://anubis.dkuug.dk/j)o(tc1)o(/sc2)o(2/wg)o(21/)o(docs)o
(/pap)o(ers)o(/200)o(3/n1)o(454)o(.htm)o(l)2032 5700
y Fm(168)p eop
%%Page: 169 178
169 177 bop 300 91 a Fm([66])47 b(T.)30 b(V)-8 b(eldh)m(uizen.)29
b(\\Expression)g(T)-8 b(emplates,")31 b Fi(C++)h(R)-5
b(ep)g(ort)p Fm(,)32 b(V)-8 b(ol.)31 b(7)f(No.)h(5)g(June)e(1995,)j
(pp.)e(26-)487 204 y(31.)h(See)g(also)487 317 y Fk(http://osl.iu.edu/)p
Fh(\030)p Fk(tveld)o(hui)o(/pap)o(ers/)o(Exp)o(ress)o(ion-)o(Tem)o
(plat)o(es/e)o(xpr)o(tmpl)o(.htm)o(l)300 505 y Fm([67])47
b(P)-8 b(.)30 b(W)-8 b(adler,)30 b("Comprehending)e(Monads",)i(Pro)s
(c.)g(A)m(CM)h(Conf.)e(on)g(Lisp)g(and)g(F)-8 b(unctional)29
b(Pro-)487 618 y(gramming,)h(p.)g(61-78,)i(1990.)300
805 y([68])47 b(P)-8 b(.)38 b(W)-8 b(adler,)41 b(W.)d(T)-8
b(aha,)41 b(and)c(D.)i(MacQueen,)i(\\Ho)m(w)e(to)g(add)e(laziness)g(to)
i(a)f(strict)g(language,)487 918 y(without)29 b(ev)m(en)i(b)s(eing)e(o)
s(dd",)h Fi(Workshop)35 b(on)e(Standar)-5 b(d)35 b(ML)p
Fm(,)30 b(Baltimore,)h(Septem)m(b)s(er)f(1998.)300 1106
y([69])47 b(P)-8 b(.)31 b(W)-8 b(adler.)32 b(\\Comprehending)d
(monads,")i Fi(Mathematic)-5 b(al)35 b(Structur)-5 b(es)34
b(in)f(Computer)i(Scienc)-5 b(e)p Fm(,)487 1219 y(Sp)s(ecial)27
b(issue)g(of)i(selected)g(pap)s(ers)e(from)i(6th)f(Conference)h(on)g
(Lisp)e(and)h(F)-8 b(unctional)27 b(Program-)487 1332
y(ming,)i(2:461-493,)35 b(1992.)300 1519 y([70])47 b(P)-8
b(.)36 b(W)-8 b(adler.)35 b(\\Monads)h(for)g(functional)d
(programming.")i(J.)h(Jeuring)d(and)i(E.)h(Meijer,)g(editors,)487
1632 y Fi(A)-5 b(dvanc)g(e)g(d)34 b(F)-7 b(unctional)34
b(Pr)-5 b(o)g(gr)g(amming)p Fm(,)33 b(Springer)28 b(V)-8
b(erlag,)32 b(LNCS)d(925,)j(1995.)2032 5700 y(169)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
